/**
 * @license
 * Lo-Dash 1.3.1 (Custom Build) lodash.com/license
 * Build: `lodash modern -o ./dist/lodash.js`
 * Underscore.js 1.4.4 underscorejs.org/LICENSE
 */

//     (c) 2010-2013 Jeremy Ashkenas, DocumentCloud Inc.
//     Backbone may be freely distributed under the MIT license.
//     For all details and documentation:
//     http://backbonejs.org

/*
 * jQuery Hotkeys Plugin
 * Copyright 2010, John Resig
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 * Based upon the plugin by Tzury Bar Yochay:
 * http://github.com/tzuryby/hotkeys
 *
 * Original idea by:
 * Binny V A, http://www.openjs.com/scripts/events/keyboard_shortcuts/
*/

/**
 * guiders.js
 *
 * version 2.0.0
 *
 * Released under the Apache License 2.0.
 * www.apache.org/licenses/LICENSE-2.0.html
 *
 * Questions about Guiders?
 * Email me (Jeff Pickhardt) at pickhardt@gmail.com
 *
 * Questions about Optimizely? Email one of the following:
 * sales@optimizely.com or support@optimizely.com
 *
 * Enjoy!
 */

/*!
* FitText.js 1.1
*
* Copyright 2011, Dave Rupert http://daverupert.com
* Released under the WTFPL license
* http://sam.zoy.org/wtfpl/
*
* Date: Thu May 05 14:23:00 2011 -0600
*/

/**
 * Backbone-tastypie.js 0.2
 * (c) 2011 Paul Uithol
 * 
 * Backbone-tastypie may be freely distributed under the MIT license.
 * Add or override Backbone.js functionality, for compatibility with django-tastypie.
 * Depends on Backbone (and thus on Underscore as well): https://github.com/documentcloud/backbone.
 */

 var Aviary = {}; 

 Aviary.Feather = function() {};

!function(e){function t(e,t,n){n=(n||0)-1;for(var r=e.length;++n<r;)if(e[n]===t)return n;return-1}function n(e,n){var r=typeof n;if(e=e.k,"boolean"==r||n==m)return e[n];"number"!=r&&"string"!=r&&(r="object");var i="number"==r?n:S+n;return e=e[r]||(e[r]={}),"object"==r?e[i]&&-1<t(e[i],n)?0:-1:e[i]?0:-1}function r(e){var t=this.k,n=typeof e;if("boolean"==n||e==m)t[e]=v;else{"number"!=n&&"string"!=n&&(n="object");var r="number"==n?e:S+e,i=t[n]||(t[n]={});"object"==n?(i[r]||(i[r]=[])).push(e)==this.b.length&&(t[n]=g):i[r]=v}}function i(e){return e.charCodeAt(0)}function s(e,t){var n=e.m,r=t.m;if(e=e.l,t=t.l,e!==t){if(e>t||typeof e=="undefined")return 1;if(e<t||typeof t=="undefined")return-1}return n<r?-1:1}function o(e){var t=-1,n=e.length,i=f();i["false"]=i["null"]=i["true"]=i.undefined=g;var s=f();for(s.b=e,s.k=i,s.push=r;++t<n;)s.push(e[t]);return i.object===!1?(c(s),m):s}function u(e){return"\\"+Q[e]}function a(){return y.pop()||[]}function f(){return b.pop()||{b:m,k:m,l:m,"false":g,m:0,leading:g,maxWait:0,"null":g,number:m,object:m,push:m,string:m,trailing:g,"true":g,"undefined":g,n:m}}function l(e){e.length=0,y.length<T&&y.push(e)}function c(e){var t=e.k;t&&c(t),e.b=e.k=e.l=e.object=e.number=e.string=e.n=m,b.length<T&&b.push(e)}function h(e,t,n){t||(t=0),typeof n=="undefined"&&(n=e?e.length:0);var r=-1;n=n-t||0;for(var i=Array(0>n?0:n);++r<n;)i[r]=e[t+r];return i}function p(r){function y(e){if(!e||vn.call(e)!=X)return g;var t=e.valueOf,n=typeof t=="function"&&(n=ln(t))&&ln(n);return n?e==n||ln(e)==n:at(e)}function b(e,t,n){if(!e||!K[typeof e])return e;t=t&&typeof n=="undefined"?t:tt.createCallback(t,n);for(var r=-1,i=K[typeof e]&&On(e),s=i?i.length:0;++r<s&&(n=i[r],t(e[n],n,e)!==!1););return e}function T(e,t,n){var r;if(!e||!K[typeof e])return e;t=t&&typeof n=="undefined"?t:tt.createCallback(t,n);for(r in e)if(t(e[r],r,e)===!1)break;return e}function Q(e,t,n){var r,i=e,s=i;if(!i)return s;for(var o=arguments,u=0,a=typeof n=="number"?2:o.length;++u<a;)if((i=o[u])&&K[typeof i])for(var f=-1,l=K[typeof i]&&On(i),c=l?l.length:0;++f<c;)r=l[f],"undefined"==typeof s[r]&&(s[r]=i[r]);return s}function G(e,t,n){var r,i=e,s=i;if(!i)return s;var o=arguments,u=0,a=typeof n=="number"?2:o.length;if(3<a&&"function"==typeof o[a-2])var f=tt.createCallback(o[--a-1],o[a--],2);else 2<a&&"function"==typeof o[a-1]&&(f=o[--a]);for(;++u<a;)if((i=o[u])&&K[typeof i])for(var l=-1,c=K[typeof i]&&On(i),h=c?c.length:0;++l<h;)r=c[l],s[r]=f?f(s[r],i[r]):i[r];return s}function Z(e){var t,n=[];if(!e||!K[typeof e])return n;for(t in e)cn.call(e,t)&&n.push(t);return n}function tt(e){return e&&typeof e=="object"&&!An(e)&&cn.call(e,"__wrapped__")?e:new rt(e)}function rt(e){this.__wrapped__=e}function it(e,t,n,r){function i(){var r=arguments,f=o?this:t;return s||(e=t[u]),n.length&&(r=r.length?(r=Cn.call(r),a?r.concat(n):n.concat(r)):n),this instanceof i?(f=vt(e.prototype)?gn(e.prototype):{},r=e.apply(f,r),vt(r)?r:f):e.apply(f,r)}var s=dt(e),o=!n,u=t;if(o){var a=r;n=t}else if(!s){if(!r)throw new Zt;t=e}return i}function st(e){return Mn[e]}function ot(){var e=(e=tt.indexOf)===Dt?t:e;return e}function ut(e){return function(t,n,r,i){return typeof n!="boolean"&&n!=m&&(i=r,r=i&&i[n]===t?d:n,n=g),r!=m&&(r=tt.createCallback(r,i)),e(t,n,r,i)}}function at(e){var t,n;return e&&vn.call(e)==X&&(t=e.constructor,!dt(t)||t instanceof t)?(T(e,function(e,t){n=t}),n===d||cn.call(e,n)):g}function ft(e){return _n[e]}function lt(e,t,n,r,i,s){var o=e;if(typeof t!="boolean"&&t!=m&&(r=n,n=t,t=g),typeof n=="function"){if(n=typeof r=="undefined"?n:tt.createCallback(n,r,1),o=n(o),typeof o!="undefined")return o;o=e}if(r=vt(o)){var u=vn.call(o);if(!J[u])return o;var f=An(o)}if(!r||!t)return r?f?h(o):G({},o):o;switch(r=kn[u],u){case R:case U:return new r(+o);case W:case $:return new r(o);case V:return r(o.source,O.exec(o))}u=!i,i||(i=a()),s||(s=a());for(var c=i.length;c--;)if(i[c]==e)return s[c];return o=f?r(o.length):{},f&&(cn.call(e,"index")&&(o.index=e.index),cn.call(e,"input")&&(o.input=e.input)),i.push(e),s.push(o),(f?Tt:b)(e,function(e,r){o[r]=lt(e,t,n,d,i,s)}),u&&(l(i),l(s)),o}function ct(e){var t=[];return T(e,function(e,n){dt(e)&&t.push(n)}),t.sort()}function ht(e){for(var t=-1,n=On(e),r=n.length,i={};++t<r;){var s=n[t];i[e[s]]=s}return i}function pt(e,t,n,r,i,s){var o=n===E;if(typeof n=="function"&&!o){n=tt.createCallback(n,r,2);var u=n(e,t);if(typeof u!="undefined")return!!u}if(e===t)return 0!==e||1/e==1/t;var f=typeof e,c=typeof t;if(e===e&&(!e||"function"!=f&&"object"!=f)&&(!t||"function"!=c&&"object"!=c))return g;if(e==m||t==m)return e===t;if(c=vn.call(e),f=vn.call(t),c==I&&(c=X),f==I&&(f=X),c!=f)return g;switch(c){case R:case U:return+e==+t;case W:return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case V:case $:return e==Yt(t)}if(f=c==q,!f){if(cn.call(e,"__wrapped__")||cn.call(t,"__wrapped__"))return pt(e.__wrapped__||e,t.__wrapped__||t,n,r,i,s);if(c!=X)return g;var c=e.constructor,h=t.constructor;if(c!=h&&(!dt(c)||!(c instanceof c&&dt(h)&&h instanceof h)))return g}for(h=!i,i||(i=a()),s||(s=a()),c=i.length;c--;)if(i[c]==e)return s[c]==t;var p=0,u=v;if(i.push(e),s.push(t),f){if(c=e.length,p=t.length,u=p==e.length,!u&&!o)return u;for(;p--;)if(f=c,h=t[p],o)for(;f--&&!(u=pt(e[f],h,n,r,i,s)););else if(!(u=pt(e[p],h,n,r,i,s)))break;return u}return T(t,function(t,o,a){return cn.call(a,o)?(p++,u=cn.call(e,o)&&pt(e[o],t,n,r,i,s)):void 0}),u&&!o&&T(e,function(e,t,n){return cn.call(n,t)?u=-1<--p:void 0}),h&&(l(i),l(s)),u}function dt(e){return typeof e=="function"}function vt(e){return!!e&&!!K[typeof e]}function mt(e){return typeof e=="number"||vn.call(e)==W}function gt(e){return typeof e=="string"||vn.call(e)==$}function yt(e,t,n){var r=arguments,i=0,s=2;if(!vt(e))return e;if(n===E)var o=r[3],u=r[4],f=r[5];else{var c=v,u=a(),f=a();typeof n!="number"&&(s=r.length),3<s&&"function"==typeof r[s-2]?o=tt.createCallback(r[--s-1],r[s--],2):2<s&&"function"==typeof r[s-1]&&(o=r[--s])}for(;++i<s;)(An(r[i])?Tt:b)(r[i],function(t,n){var r,i,s=t,a=e[n];if(t&&((i=An(t))||y(t))){for(s=u.length;s--;)if(r=u[s]==t){a=f[s];break}if(!r){var l;o&&(s=o(a,t),l=typeof s!="undefined")&&(a=s),l||(a=i?An(a)?a:[]:y(a)?a:{}),u.push(t),f.push(a),l||(a=yt(a,t,E,o,u,f))}}else o&&(s=o(a,t),typeof s=="undefined"&&(s=t)),typeof s!="undefined"&&(a=s);e[n]=a});return c&&(l(u),l(f)),e}function bt(e){for(var t=-1,n=On(e),r=n.length,i=Wt(r);++t<r;)i[t]=e[n[t]];return i}function wt(e,t,n){var r=-1,i=ot(),s=e?e.length:0,o=g;return n=(0>n?Sn(0,s+n):n)||0,s&&typeof s=="number"?o=-1<(gt(e)?e.indexOf(t,n):i(e,t,n)):b(e,function(e){return++r<n?void 0:!(o=e===t)}),o}function Et(e,t,n){var r=v;t=tt.createCallback(t,n),n=-1;var i=e?e.length:0;if(typeof i=="number")for(;++n<i&&(r=!!t(e[n],n,e)););else b(e,function(e,n,i){return r=!!t(e,n,i)});return r}function St(e,t,n){var r=[];t=tt.createCallback(t,n),n=-1;var i=e?e.length:0;if(typeof i=="number")for(;++n<i;){var s=e[n];t(s,n,e)&&r.push(s)}else b(e,function(e,n,i){t(e,n,i)&&r.push(e)});return r}function xt(e,t,n){t=tt.createCallback(t,n),n=-1;var r=e?e.length:0;if(typeof r!="number"){var i;return b(e,function(e,n,r){return t(e,n,r)?(i=e,g):void 0}),i}for(;++n<r;){var s=e[n];if(t(s,n,e))return s}}function Tt(e,t,n){var r=-1,i=e?e.length:0;if(t=t&&typeof n=="undefined"?t:tt.createCallback(t,n),typeof i=="number")for(;++r<i&&t(e[r],r,e)!==!1;);else b(e,t);return e}function Nt(e,t,n){var r=-1,i=e?e.length:0;if(t=tt.createCallback(t,n),typeof i=="number")for(var s=Wt(i);++r<i;)s[r]=t(e[r],r,e);else s=[],b(e,function(e,n,i){s[++r]=t(e,n,i)});return s}function Ct(e,t,n){var r=-1/0,s=r;if(!t&&An(e)){n=-1;for(var o=e.length;++n<o;){var u=e[n];u>s&&(s=u)}}else t=!t&&gt(e)?i:tt.createCallback(t,n),Tt(e,function(e,n,i){n=t(e,n,i),n>r&&(r=n,s=e)});return s}function kt(e,t){var n=-1,r=e?e.length:0;if(typeof r=="number")for(var i=Wt(r);++n<r;)i[n]=e[n][t];return i||Nt(e,t)}function Lt(e,t,n,r){if(!e)return n;var i=3>arguments.length;t=tt.createCallback(t,r,4);var s=-1,o=e.length;if(typeof o=="number")for(i&&(n=e[++s]);++s<o;)n=t(n,e[s],s,e);else b(e,function(e,r,s){n=i?(i=g,e):t(n,e,r,s)});return n}function At(e,t,n,r){var i=e?e.length:0,s=3>arguments.length;if(typeof i!="number")var o=On(e),i=o.length;return t=tt.createCallback(t,r,4),Tt(e,function(r,u,a){u=o?o[--i]:--i,n=s?(s=g,e[u]):t(n,e[u],u,a)}),n}function Ot(e,t,n){var r;t=tt.createCallback(t,n),n=-1;var i=e?e.length:0;if(typeof i=="number")for(;++n<i&&!(r=t(e[n],n,e)););else b(e,function(e,n,i){return!(r=t(e,n,i))});return!!r}function Mt(e){var r=-1,i=ot(),s=e?e.length:0,u=un.apply(en,Cn.call(arguments,1)),a=[],f=s>=x&&i===t;if(f){var l=o(u);l?(i=n,u=l):f=g}for(;++r<s;)l=e[r],0>i(u,l)&&a.push(l);return f&&c(u),a}function _t(e,t,n){if(e){var r=0,i=e.length;if(typeof t!="number"&&t!=m){var s=-1;for(t=tt.createCallback(t,n);++s<i&&t(e[s],s,e);)r++}else if(r=t,r==m||n)return e[0];return h(e,0,xn(Sn(0,r),i))}}function Dt(e,n,r){if(typeof r=="number"){var i=e?e.length:0;r=0>r?Sn(0,i+r):r||0}else if(r)return r=Ht(e,n),e[r]===n?r:-1;return e?t(e,n,r):-1}function Pt(e,t,n){if(typeof t!="number"&&t!=m){var r=0,i=-1,s=e?e.length:0;for(t=tt.createCallback(t,n);++i<s&&t(e[i],i,e);)r++}else r=t==m||n?1:Sn(0,t);return h(e,r)}function Ht(e,t,n,r){var i=0,s=e?e.length:i;for(n=n?tt.createCallback(n,r,1):Rt,t=n(t);i<s;)r=i+s>>>1,n(e[r])<t?i=r+1:s=r;return i}function Bt(e){for(var t=-1,n=e?Ct(kt(e,"length")):0,r=Wt(0>n?0:n);++t<n;)r[t]=kt(e,t);return r}function jt(e,t){for(var n=-1,r=e?e.length:0,i={};++n<r;){var s=e[n];t?i[s]=t[n]:i[s[0]]=s[1]}return i}function Ft(e,t){return Ln.fastBind||mn&&2<arguments.length?mn.call.apply(mn,arguments):it(e,t,Cn.call(arguments,2))}function It(e,t,n){function r(){on(h),on(p),f=0,h=p=m}function i(){var t=d&&(!y||1<f);r(),t&&(c!==!1&&(l=new Vt),u=e.apply(a,o))}function s(){r(),(d||c!==t)&&(l=new Vt,u=e.apply(a,o))}var o,u,a,f=0,l=0,c=g,h=m,p=m,d=v;if(t=Sn(0,t||0),n===v)var y=v,d=g;else vt(n)&&(y=n.leading,c="maxWait"in n&&Sn(t,n.maxWait||0),d="trailing"in n?n.trailing:d);return function(){if(o=arguments,a=this,f++,on(p),c===!1)y&&2>f&&(u=e.apply(a,o));else{var n=new Vt;!h&&!y&&(l=n);var r=c-(n-l);0<r?h||(h=dn(s,r)):(on(h),h=m,l=n,u=e.apply(a,o))}return t!==c&&(p=dn(i,t)),u}}function qt(e){var t=Cn.call(arguments,1);return dn(function(){e.apply(d,t)},1)}function Rt(e){return e}function Ut(e){Tt(ct(e),function(t){var n=tt[t]=e[t];tt.prototype[t]=function(){var e=this.__wrapped__,t=[e];return hn.apply(t,arguments),t=n.apply(tt,t),e&&typeof e=="object"&&e===t?this:new rt(t)}})}function zt(){return this.__wrapped__}r=r?et.defaults(e.Object(),r,et.pick(e,F)):e;var Wt=r.Array,Xt=r.Boolean,Vt=r.Date,$t=r.Function,Jt=r.Math,Kt=r.Number,Qt=r.Object,Gt=r.RegExp,Yt=r.String,Zt=r.TypeError,en=[],tn=Qt.prototype,nn=r._,rn=Gt("^"+Yt(tn.valueOf).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/valueOf|for [^\]]+/g,".+?")+"$"),sn=Jt.ceil,on=r.clearTimeout,un=en.concat,an=Jt.floor,fn=$t.prototype.toString,ln=rn.test(ln=Qt.getPrototypeOf)&&ln,cn=tn.hasOwnProperty,hn=en.push,pn=r.setImmediate,dn=r.setTimeout,vn=tn.toString,mn=rn.test(mn=vn.bind)&&mn,gn=rn.test(gn=Qt.create)&&gn,yn=rn.test(yn=Wt.isArray)&&yn,bn=r.isFinite,wn=r.isNaN,En=rn.test(En=Qt.keys)&&En,Sn=Jt.max,xn=Jt.min,Tn=r.parseInt,Nn=Jt.random,Cn=en.slice,Jt=rn.test(r.attachEvent),Jt=mn&&!/\n|true/.test(mn+Jt),kn={};kn[q]=Wt,kn[R]=Xt,kn[U]=Vt,kn[z]=$t,kn[X]=Qt,kn[W]=Kt,kn[V]=Gt,kn[$]=Yt,rt.prototype=tt.prototype;var Ln=tt.support={};Ln.fastBind=mn&&!Jt,tt.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:M,variable:"",imports:{_:tt}};var An=yn,On=En?function(e){return vt(e)?En(e):[]}:Z,Mn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},_n=ht(Mn),Xt=ut(function Pn(e,t,n){for(var r=-1,i=e?e.length:0,s=[];++r<i;){var o=e[r];n&&(o=n(o,r,e)),An(o)?hn.apply(s,t?o:Pn(o)):s.push(o)}return s}),Dn=ut(function(e,r,i){var s=-1,u=ot(),f=e?e.length:0,h=[],p=!r&&f>=x&&u===t,d=i||p?a():h;if(p){var v=o(d);v?(u=n,d=v):(p=g,d=i?d:(l(d),h))}for(;++s<f;){var v=e[s],m=i?i(v,s,e):v;(r?!s||d[d.length-1]!==m:0>u(d,m))&&((i||p)&&d.push(m),h.push(v))}return p?(l(d.b),c(d)):i&&l(d),h});return Jt&&Y&&typeof pn=="function"&&(qt=Ft(pn,r)),pn=8==Tn(D+"08")?Tn:function(e,t){return Tn(gt(e)?e.replace(P,""):e,t||0)},tt.after=function(e,t){return 1>e?t():function(){return 1>--e?t.apply(this,arguments):void 0}},tt.assign=G,tt.at=function(e){for(var t=-1,n=un.apply(en,Cn.call(arguments,1)),r=n.length,i=Wt(r);++t<r;)i[t]=e[n[t]];return i},tt.bind=Ft,tt.bindAll=function(e){for(var t=1<arguments.length?un.apply(en,Cn.call(arguments,1)):ct(e),n=-1,r=t.length;++n<r;){var i=t[n];e[i]=Ft(e[i],e)}return e},tt.bindKey=function(e,t){return it(e,t,Cn.call(arguments,2),E)},tt.compact=function(e){for(var t=-1,n=e?e.length:0,r=[];++t<n;){var i=e[t];i&&r.push(i)}return r},tt.compose=function(){var e=arguments;return function(){for(var t=arguments,n=e.length;n--;)t=[e[n].apply(this,t)];return t[0]}},tt.countBy=function(e,t,n){var r={};return t=tt.createCallback(t,n),Tt(e,function(e,n,i){n=Yt(t(e,n,i)),cn.call(r,n)?r[n]++:r[n]=1}),r},tt.createCallback=function(e,t,n){if(e==m)return Rt;var r=typeof e;if("function"!=r){if("object"!=r)return function(t){return t[e]};var i=On(e);return function(t){for(var n=i.length,r=g;n--&&(r=pt(t[i[n]],e[i[n]],E)););return r}}return typeof t=="undefined"||_&&!_.test(fn.call(e))?e:1===n?function(n){return e.call(t,n)}:2===n?function(n,r){return e.call(t,n,r)}:4===n?function(n,r,i,s){return e.call(t,n,r,i,s)}:function(n,r,i){return e.call(t,n,r,i)}},tt.debounce=It,tt.defaults=Q,tt.defer=qt,tt.delay=function(e,t){var n=Cn.call(arguments,2);return dn(function(){e.apply(d,n)},t)},tt.difference=Mt,tt.filter=St,tt.flatten=Xt,tt.forEach=Tt,tt.forIn=T,tt.forOwn=b,tt.functions=ct,tt.groupBy=function(e,t,n){var r={};return t=tt.createCallback(t,n),Tt(e,function(e,n,i){n=Yt(t(e,n,i)),(cn.call(r,n)?r[n]:r[n]=[]).push(e)}),r},tt.initial=function(e,t,n){if(!e)return[];var r=0,i=e.length;if(typeof t!="number"&&t!=m){var s=i;for(t=tt.createCallback(t,n);s--&&t(e[s],s,e);)r++}else r=t==m||n?1:t||r;return h(e,0,xn(Sn(0,i-r),i))},tt.intersection=function(e){for(var r=arguments,i=r.length,s=-1,u=a(),f=-1,h=ot(),p=e?e.length:0,d=[],v=a();++s<i;){var m=r[s];u[s]=h===t&&(m?m.length:0)>=x&&o(s?r[s]:v)}e:for(;++f<p;){var g=u[0],m=e[f];if(0>(g?n(g,m):h(v,m))){for(s=i,(g||v).push(m);--s;)if(g=u[s],0>(g?n(g,m):h(r[s],m)))continue e;d.push(m)}}for(;i--;)(g=u[i])&&c(g);return l(u),l(v),d},tt.invert=ht,tt.invoke=function(e,t){var n=Cn.call(arguments,2),r=-1,i=typeof t=="function",s=e?e.length:0,o=Wt(typeof s=="number"?s:0);return Tt(e,function(e){o[++r]=(i?t:e[t]).apply(e,n)}),o},tt.keys=On,tt.map=Nt,tt.max=Ct,tt.memoize=function(e,t){function n(){var r=n.cache,i=S+(t?t.apply(this,arguments):arguments[0]);return cn.call(r,i)?r[i]:r[i]=e.apply(this,arguments)}return n.cache={},n},tt.merge=yt,tt.min=function(e,t,n){var r=1/0,s=r;if(!t&&An(e)){n=-1;for(var o=e.length;++n<o;){var u=e[n];u<s&&(s=u)}}else t=!t&&gt(e)?i:tt.createCallback(t,n),Tt(e,function(e,n,i){n=t(e,n,i),n<r&&(r=n,s=e)});return s},tt.omit=function(e,t,n){var r=ot(),i=typeof t=="function",s={};if(i)t=tt.createCallback(t,n);else var o=un.apply(en,Cn.call(arguments,1));return T(e,function(e,n,u){(i?!t(e,n,u):0>r(o,n))&&(s[n]=e)}),s},tt.once=function(e){var t,n;return function(){return t?n:(t=v,n=e.apply(this,arguments),e=m,n)}},tt.pairs=function(e){for(var t=-1,n=On(e),r=n.length,i=Wt(r);++t<r;){var s=n[t];i[t]=[s,e[s]]}return i},tt.partial=function(e){return it(e,Cn.call(arguments,1))},tt.partialRight=function(e){return it(e,Cn.call(arguments,1),m,E)},tt.pick=function(e,t,n){var r={};if(typeof t!="function")for(var i=-1,s=un.apply(en,Cn.call(arguments,1)),o=vt(e)?s.length:0;++i<o;){var u=s[i];u in e&&(r[u]=e[u])}else t=tt.createCallback(t,n),T(e,function(e,n,i){t(e,n,i)&&(r[n]=e)});return r},tt.pluck=kt,tt.range=function(e,t,n){e=+e||0,n=+n||1,t==m&&(t=e,e=0);var r=-1;t=Sn(0,sn((t-e)/n));for(var i=Wt(t);++r<t;)i[r]=e,e+=n;return i},tt.reject=function(e,t,n){return t=tt.createCallback(t,n),St(e,function(e,n,r){return!t(e,n,r)})},tt.rest=Pt,tt.shuffle=function(e){var t=-1,n=e?e.length:0,r=Wt(typeof n=="number"?n:0);return Tt(e,function(e){var n=an(Nn()*(++t+1));r[t]=r[n],r[n]=e}),r},tt.sortBy=function(e,t,n){var r=-1,i=e?e.length:0,o=Wt(typeof i=="number"?i:0);for(t=tt.createCallback(t,n),Tt(e,function(e,n,i){var s=o[++r]=f();s.l=t(e,n,i),s.m=r,s.n=e}),i=o.length,o.sort(s);i--;)e=o[i],o[i]=e.n,c(e);return o},tt.tap=function(e,t){return t(e),e},tt.throttle=function(e,t,n){var r=v,i=v;return n===!1?r=g:vt(n)&&(r="leading"in n?n.leading:r,i="trailing"in n?n.trailing:i),n=f(),n.leading=r,n.maxWait=t,n.trailing=i,e=It(e,t,n),c(n),e},tt.times=function(e,t,n){e=-1<(e=+e)?e:0;var r=-1,i=Wt(e);for(t=tt.createCallback(t,n,1);++r<e;)i[r]=t(r);return i},tt.toArray=function(e){return e&&typeof e.length=="number"?h(e):bt(e)},tt.transform=function(e,t,n,r){var i=An(e);return t=tt.createCallback(t,r,4),n==m&&(i?n=[]:(r=e&&e.constructor,n=vt(r&&r.prototype)?gn(r&&r.prototype):{})),(i?Tt:b)(e,function(e,r,i){return t(n,e,r,i)}),n},tt.union=function(e){return An(e)||(arguments[0]=e?Cn.call(e):en),Dn(un.apply(en,arguments))},tt.uniq=Dn,tt.unzip=Bt,tt.values=bt,tt.where=St,tt.without=function(e){return Mt(e,Cn.call(arguments,1))},tt.wrap=function(e,t){return function(){var n=[e];return hn.apply(n,arguments),t.apply(this,n)}},tt.zip=function(e){return e?Bt(arguments):[]},tt.zipObject=jt,tt.collect=Nt,tt.drop=Pt,tt.each=Tt,tt.extend=G,tt.methods=ct,tt.object=jt,tt.select=St,tt.tail=Pt,tt.unique=Dn,Ut(tt),tt.chain=tt,tt.prototype.chain=function(){return this},tt.clone=lt,tt.cloneDeep=function(e,t,n){return lt(e,v,t,n)},tt.contains=wt,tt.escape=function(e){return e==m?"":Yt(e).replace(B,st)},tt.every=Et,tt.find=xt,tt.findIndex=function(e,t,n){var r=-1,i=e?e.length:0;for(t=tt.createCallback(t,n);++r<i;)if(t(e[r],r,e))return r;return-1},tt.findKey=function(e,t,n){var r;return t=tt.createCallback(t,n),b(e,function(e,n,i){return t(e,n,i)?(r=n,g):void 0}),r},tt.has=function(e,t){return e?cn.call(e,t):g},tt.identity=Rt,tt.indexOf=Dt,tt.isArguments=function(e){return vn.call(e)==I},tt.isArray=An,tt.isBoolean=function(e){return e===v||e===!1||vn.call(e)==R},tt.isDate=function(e){return e?typeof e=="object"&&vn.call(e)==U:g},tt.isElement=function(e){return e?1===e.nodeType:g},tt.isEmpty=function(e){var t=v;if(!e)return t;var n=vn.call(e),r=e.length;return n==q||n==$||n==I||n==X&&typeof r=="number"&&dt(e.splice)?!r:(b(e,function(){return t=g}),t)},tt.isEqual=pt,tt.isFinite=function(e){return bn(e)&&!wn(parseFloat(e))},tt.isFunction=dt,tt.isNaN=function(e){return mt(e)&&e!=+e},tt.isNull=function(e){return e===m},tt.isNumber=mt,tt.isObject=vt,tt.isPlainObject=y,tt.isRegExp=function(e){return e?typeof e=="object"&&vn.call(e)==V:g},tt.isString=gt,tt.isUndefined=function(e){return typeof e=="undefined"},tt.lastIndexOf=function(e,t,n){var r=e?e.length:0;for(typeof n=="number"&&(r=(0>n?Sn(0,r+n):xn(n,r-1))+1);r--;)if(e[r]===t)return r;return-1},tt.mixin=Ut,tt.noConflict=function(){return r._=nn,this},tt.parseInt=pn,tt.random=function(e,t){e==m&&t==m&&(t=1),e=+e||0,t==m?(t=e,e=0):t=+t||0;var n=Nn();return e%1||t%1?e+xn(n*(t-e+parseFloat("1e-"+((n+"").length-1))),t):e+an(n*(t-e+1))},tt.reduce=Lt,tt.reduceRight=At,tt.result=function(e,t){var n=e?e[t]:d;return dt(n)?e[t]():n},tt.runInContext=p,tt.size=function(e){var t=e?e.length:0;return typeof t=="number"?t:On(e).length},tt.some=Ot,tt.sortedIndex=Ht,tt.template=function(e,t,n){var r=tt.templateSettings;e||(e=""),n=Q({},n,r);var i,s=Q({},n.imports,r.imports),r=On(s),s=bt(s),o=0,a=n.interpolate||H,f="__p+='",a=Gt((n.escape||H).source+"|"+a.source+"|"+(a===M?A:H).source+"|"+(n.evaluate||H).source+"|$","g");e.replace(a,function(t,n,r,s,a,l){return r||(r=s),f+=e.slice(o,l).replace(j,u),n&&(f+="'+__e("+n+")+'"),a&&(i=v,f+="';"+a+";__p+='"),r&&(f+="'+((__t=("+r+"))==null?'':__t)+'"),o=l+t.length,t}),f+="';\n",a=n=n.variable,a||(n="obj",f="with("+n+"){"+f+"}"),f=(i?f.replace(N,""):f).replace(C,"$1").replace(k,"$1;"),f="function("+n+"){"+(a?"":n+"||("+n+"={});")+"var __t,__p='',__e=_.escape"+(i?",__j=Array.prototype.join;function print(){__p+=__j.call(arguments,'')}":";")+f+"return __p}";try{var l=$t(r,"return "+f).apply(d,s)}catch(c){throw c.source=f,c}return t?l(t):(l.source=f,l)},tt.unescape=function(e){return e==m?"":Yt(e).replace(L,ft)},tt.uniqueId=function(e){var t=++w;return Yt(e==m?"":e)+t},tt.all=Et,tt.any=Ot,tt.detect=xt,tt.findWhere=xt,tt.foldl=Lt,tt.foldr=At,tt.include=wt,tt.inject=Lt,b(tt,function(e,t){tt.prototype[t]||(tt.prototype[t]=function(){var t=[this.__wrapped__];return hn.apply(t,arguments),e.apply(tt,t)})}),tt.first=_t,tt.last=function(e,t,n){if(e){var r=0,i=e.length;if(typeof t!="number"&&t!=m){var s=i;for(t=tt.createCallback(t,n);s--&&t(e[s],s,e);)r++}else if(r=t,r==m||n)return e[i-1];return h(e,Sn(0,i-r))}},tt.take=_t,tt.head=_t,b(tt,function(e,t){tt.prototype[t]||(tt.prototype[t]=function(t,n){var r=e(this.__wrapped__,t,n);return t==m||n&&typeof t!="function"?r:new rt(r)})}),tt.VERSION="1.3.1",tt.prototype.toString=function(){return Yt(this.__wrapped__)},tt.prototype.value=zt,tt.prototype.valueOf=zt,Tt(["join","pop","shift"],function(e){var t=en[e];tt.prototype[e]=function(){return t.apply(this.__wrapped__,arguments)}}),Tt(["push","reverse","sort","unshift"],function(e){var t=en[e];tt.prototype[e]=function(){return t.apply(this.__wrapped__,arguments),this}}),Tt(["concat","slice","splice"],function(e){var t=en[e];tt.prototype[e]=function(){return new rt(t.apply(this.__wrapped__,arguments))}}),tt}var d,v=!0,m=null,g=!1,y=[],b=[],w=0,E={},S=+(new Date)+"",x=75,T=40,N=/\b__p\+='';/g,C=/\b(__p\+=)''\+/g,k=/(__e\(.*?\)|\b__t\))\+'';/g,L=/&(?:amp|lt|gt|quot|#39);/g,A=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,O=/\w*$/,M=/<%=([\s\S]+?)%>/g,_=(_=/\bthis\b/)&&_.test(p)&&_,D=" 	\f ﻿\n\r\u2028\u2029 ᠎             　",P=RegExp("^["+D+"]*0+(?=.$)"),H=/($^)/,B=/[&<>"']/g,j=/['\n\r\t\u2028\u2029\\]/g,F="Array Boolean Date Function Math Number Object RegExp String _ attachEvent clearTimeout isFinite isNaN parseInt setImmediate setTimeout".split(" "),I="[object Arguments]",q="[object Array]",R="[object Boolean]",U="[object Date]",z="[object Function]",W="[object Number]",X="[object Object]",V="[object RegExp]",$="[object String]",J={};J[z]=g,J[I]=J[q]=J[R]=J[U]=J[W]=J[X]=J[V]=J[$]=v;var K={"boolean":g,"function":v,object:v,number:g,string:g,"undefined":g},Q={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"},G=K[typeof exports]&&exports,Y=K[typeof module]&&module&&module.exports==G&&module,Z=K[typeof global]&&global;!Z||Z.global!==Z&&Z.window!==Z||(e=Z);var et=p();typeof define=="function"&&typeof define.amd=="object"&&define.amd?(e._=et,define("underscore",[],function(){return et})):G&&!G.nodeType?Y?(Y.exports=et)._=et:G._=et:e._=et}(this),define("jquery",[],function(){return window.jQuery}),function(){var e=this,t=e.Backbone,n=[],r=n.push,i=n.slice,s=n.splice,o;typeof exports!="undefined"?o=exports:o=e.Backbone={},o.VERSION="1.0.0";var u=e._;!u&&typeof require!="undefined"&&(u=require("underscore")),o.$=e.jQuery||e.Zepto||e.ender||e.$,o.noConflict=function(){return e.Backbone=t,this},o.emulateHTTP=!1,o.emulateJSON=!1;var a=o.Events={on:function(e,t,n){if(!l(this,"on",e,[t,n])||!t)return this;this._events||(this._events={});var r=this._events[e]||(this._events[e]=[]);return r.push({callback:t,context:n,ctx:n||this}),this},once:function(e,t,n){if(!l(this,"once",e,[t,n])||!t)return this;var r=this,i=u.once(function(){r.off(e,i),t.apply(this,arguments)});return i._callback=t,this.on(e,i,n)},off:function(e,t,n){var r,i,s,o,a,f,c,h;if(!this._events||!l(this,"off",e,[t,n]))return this;if(!e&&!t&&!n)return this._events={},this;o=e?[e]:u.keys(this._events);for(a=0,f=o.length;a<f;a++){e=o[a];if(s=this._events[e]){this._events[e]=r=[];if(t||n)for(c=0,h=s.length;c<h;c++)i=s[c],(t&&t!==i.callback&&t!==i.callback._callback||n&&n!==i.context)&&r.push(i);r.length||delete this._events[e]}}return this},trigger:function(e){if(!this._events)return this;var t=i.call(arguments,1);if(!l(this,"trigger",e,t))return this;var n=this._events[e],r=this._events.all;return n&&c(n,t),r&&c(r,arguments),this},stopListening:function(e,t,n){var r=this._listeners;if(!r)return this;var i=!t&&!n;typeof t=="object"&&(n=this),e&&((r={})[e._listenerId]=e);for(var s in r)r[s].off(t,n,this),i&&delete this._listeners[s];return this}},f=/\s+/,l=function(e,t,n,r){if(!n)return!0;if(typeof n=="object"){for(var i in n)e[t].apply(e,[i,n[i]].concat(r));return!1}if(f.test(n)){var s=n.split(f);for(var o=0,u=s.length;o<u;o++)e[t].apply(e,[s[o]].concat(r));return!1}return!0},c=function(e,t){var n,r=-1,i=e.length,s=t[0],o=t[1],u=t[2];switch(t.length){case 0:while(++r<i)(n=e[r]).callback.call(n.ctx);return;case 1:while(++r<i)(n=e[r]).callback.call(n.ctx,s);return;case 2:while(++r<i)(n=e[r]).callback.call(n.ctx,s,o);return;case 3:while(++r<i)(n=e[r]).callback.call(n.ctx,s,o,u);return;default:while(++r<i)(n=e[r]).callback.apply(n.ctx,t)}},h={listenTo:"on",listenToOnce:"once"};u.each(h,function(e,t){a[t]=function(t,n,r){var i=this._listeners||(this._listeners={}),s=t._listenerId||(t._listenerId=u.uniqueId("l"));return i[s]=t,typeof n=="object"&&(r=this),t[e](n,r,this),this}}),a.bind=a.on,a.unbind=a.off,u.extend(o,a);var p=o.Model=function(e,t){var n,r=e||{};t||(t={}),this.cid=u.uniqueId("c"),this.attributes={},u.extend(this,u.pick(t,d)),t.parse&&(r=this.parse(r,t)||{});if(n=u.result(this,"defaults"))r=u.defaults({},r,n);this.set(r,t),this.changed={},this.initialize.apply(this,arguments)},d=["url","urlRoot","collection"];u.extend(p.prototype,a,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return u.clone(this.attributes)},sync:function(){return o.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return u.escape(this.get(e))},has:function(e){return this.get(e)!=null},set:function(e,t,n){var r,i,s,o,a,f,l,c;if(e==null)return this;typeof e=="object"?(i=e,n=t):(i={})[e]=t,n||(n={});if(!this._validate(i,n))return!1;s=n.unset,a=n.silent,o=[],f=this._changing,this._changing=!0,f||(this._previousAttributes=u.clone(this.attributes),this.changed={}),c=this.attributes,l=this._previousAttributes,this.idAttribute in i&&(this.id=i[this.idAttribute]);for(r in i)t=i[r],u.isEqual(c[r],t)||o.push(r),u.isEqual(l[r],t)?delete this.changed[r]:this.changed[r]=t,s?delete c[r]:c[r]=t;if(!a){o.length&&(this._pending=!0);for(var h=0,p=o.length;h<p;h++)this.trigger("change:"+o[h],this,c[o[h]],n)}if(f)return this;if(!a)while(this._pending)this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,u.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var n in this.attributes)t[n]=void 0;return this.set(t,u.extend({},e,{unset:!0}))},hasChanged:function(e){return e==null?!u.isEmpty(this.changed):u.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?u.clone(this.changed):!1;var t,n=!1,r=this._changing?this._previousAttributes:this.attributes;for(var i in e){if(u.isEqual(r[i],t=e[i]))continue;(n||(n={}))[i]=t}return n},previous:function(e){return e==null||!this._previousAttributes?null:this._previousAttributes[e]},previousAttributes:function(){return u.clone(this._previousAttributes)},fetch:function(e){e=e?u.clone(e):{},e.parse===void 0&&(e.parse=!0);var t=this,n=e.success;return e.success=function(r){if(!t.set(t.parse(r,e),e))return!1;n&&n(t,r,e),t.trigger("sync",t,r,e)},j(this,e),this.sync("read",this,e)},save:function(e,t,n){var r,i,s,o=this.attributes;e==null||typeof e=="object"?(r=e,n=t):(r={})[e]=t;if(r&&(!n||!n.wait)&&!this.set(r,n))return!1;n=u.extend({validate:!0},n);if(!this._validate(r,n))return!1;r&&n.wait&&(this.attributes=u.extend({},o,r)),n.parse===void 0&&(n.parse=!0);var a=this,f=n.success;return n.success=function(e){a.attributes=o;var t=a.parse(e,n);n.wait&&(t=u.extend(r||{},t));if(u.isObject(t)&&!a.set(t,n))return!1;f&&f(a,e,n),a.trigger("sync",a,e,n)},j(this,n),i=this.isNew()?"create":n.patch?"patch":"update",i==="patch"&&(n.attrs=r),s=this.sync(i,this,n),r&&n.wait&&(this.attributes=o),s},destroy:function(e){e=e?u.clone(e):{};var t=this,n=e.success,r=function(){t.trigger("destroy",t,t.collection,e)};e.success=function(i){(e.wait||t.isNew())&&r(),n&&n(t,i,e),t.isNew()||t.trigger("sync",t,i,e)};if(this.isNew())return e.success(),!1;j(this,e);var i=this.sync("delete",this,e);return e.wait||r(),i},url:function(){var e=u.result(this,"urlRoot")||u.result(this.collection,"url")||B();return this.isNew()?e:e+(e.charAt(e.length-1)==="/"?"":"/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},isValid:function(e){return this._validate({},u.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=u.extend({},this.attributes,e);var n=this.validationError=this.validate(e,t)||null;return n?(this.trigger("invalid",this,n,u.extend(t||{},{validationError:n})),!1):!0}});var v=["keys","values","pairs","invert","pick","omit"];u.each(v,function(e){p.prototype[e]=function(){var t=i.call(arguments);return t.unshift(this.attributes),u[e].apply(u,t)}});var m=o.Collection=function(e,t){t||(t={}),t.url&&(this.url=t.url),t.model&&(this.model=t.model),t.comparator!==void 0&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,u.extend({silent:!0},t))},g={add:!0,remove:!0,merge:!0},y={add:!0,merge:!1,remove:!1};u.extend(m.prototype,a,{model:p,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return o.sync.apply(this,arguments)},add:function(e,t){return this.set(e,u.defaults(t||{},y))},remove:function(e,t){e=u.isArray(e)?e.slice():[e],t||(t={});var n,r,i,s;for(n=0,r=e.length;n<r;n++){s=this.get(e[n]);if(!s)continue;delete this._byId[s.id],delete this._byId[s.cid],i=this.indexOf(s),this.models.splice(i,1),this.length--,t.silent||(t.index=i,s.trigger("remove",s,this,t)),this._removeReference(s)}return this},set:function(e,t){t=u.defaults(t||{},g),t.parse&&(e=this.parse(e,t)),u.isArray(e)||(e=e?[e]:[]);var n,i,o,a,f,l,c=t.at,h=this.comparator&&c==null&&t.sort!==!1,p=u.isString(this.comparator)?this.comparator:null,d=[],v=[],m={};for(n=0,i=e.length;n<i;n++){if(!(o=this._prepareModel(e[n],t)))continue;(f=this.get(o))?(t.remove&&(m[f.cid]=!0),t.merge&&(f.set(o.attributes,t),h&&!l&&f.hasChanged(p)&&(l=!0))):t.add&&(d.push(o),o.on("all",this._onModelEvent,this),this._byId[o.cid]=o,o.id!=null&&(this._byId[o.id]=o))}if(t.remove){for(n=0,i=this.length;n<i;++n)m[(o=this.models[n]).cid]||v.push(o);v.length&&this.remove(v,t)}d.length&&(h&&(l=!0),this.length+=d.length,c!=null?s.apply(this.models,[c,0].concat(d)):r.apply(this.models,d)),l&&this.sort({silent:!0});if(t.silent)return this;for(n=0,i=d.length;n<i;n++)(o=d[n]).trigger("add",o,this,t);return l&&this.trigger("sort",this,t),this},reset:function(e,t){t||(t={});for(var n=0,r=this.models.length;n<r;n++)this._removeReference(this.models[n]);return t.previousModels=this.models,this._reset(),this.add(e,u.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),this},push:function(e,t){return e=this._prepareModel(e,t),this.add(e,u.extend({at:this.length},t)),e},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return e=this._prepareModel(e,t),this.add(e,u.extend({at:0},t)),e},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(e,t){return this.models.slice(e,t)},get:function(e){return e==null?void 0:this._byId[e.id!=null?e.id:e.cid||e]},at:function(e){return this.models[e]},where:function(e,t){return u.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),u.isString(this.comparator)||this.comparator.length===1?this.models=this.sortBy(this.comparator,this):this.models.sort(u.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},sortedIndex:function(e,t,n){t||(t=this.comparator);var r=u.isFunction(t)?t:function(e){return e.get(t)};return u.sortedIndex(this.models,e,r,n)},pluck:function(e){return u.invoke(this.models,"get",e)},fetch:function(e){e=e?u.clone(e):{},e.parse===void 0&&(e.parse=!0);var t=e.success,n=this;return e.success=function(r){var i=e.reset?"reset":"set";n[i](r,e),t&&t(n,r,e),n.trigger("sync",n,r,e)},j(this,e),this.sync("read",this,e)},create:function(e,t){t=t?u.clone(t):{};if(!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var n=this,r=t.success;return t.success=function(i){t.wait&&n.add(e,t),r&&r(e,i,t)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof p)return e.collection||(e.collection=this),e;t||(t={}),t.collection=this;var n=new this.model(e,t);return n._validate(e,t)?n:(this.trigger("invalid",this,e,t),!1)},_removeReference:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){if((e==="add"||e==="remove")&&n!==this)return;e==="destroy"&&this.remove(t,r),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],t.id!=null&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments)}});var b=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];u.each(b,function(e){m.prototype[e]=function(){var t=i.call(arguments);return t.unshift(this.models),u[e].apply(u,t)}});var w=["groupBy","countBy","sortBy"];u.each(w,function(e){m.prototype[e]=function(t,n){var r=u.isFunction(t)?t:function(e){return e.get(t)};return u[e](this.models,r,n)}});var E=o.View=function(e){this.cid=u.uniqueId("view"),this._configure(e||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},S=/^(\S+)\s*(.*)$/,x=["model","collection","el","id","attributes","className","tagName","events"];u.extend(E.prototype,a,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,t){return this.$el&&this.undelegateEvents(),this.$el=e instanceof o.$?e:o.$(e),this.el=this.$el[0],t!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=u.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var n=e[t];u.isFunction(n)||(n=this[e[t]]);if(!n)continue;var r=t.match(S),i=r[1],s=r[2];n=u.bind(n,this),i+=".delegateEvents"+this.cid,s===""?this.$el.on(i,n):this.$el.on(i,s,n)}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_configure:function(e){this.options&&(e=u.extend({},u.result(this,"options"),e)),u.extend(this,u.pick(e,x)),this.options=e},_ensureElement:function(){if(!this.el){var e=u.extend({},u.result(this,"attributes"));this.id&&(e.id=u.result(this,"id")),this.className&&(e["class"]=u.result(this,"className"));var t=o.$("<"+u.result(this,"tagName")+">").attr(e);this.setElement(t,!1)}else this.setElement(u.result(this,"el"),!1)}}),o.sync=function(e,t,n){var r=T[e];u.defaults(n||(n={}),{emulateHTTP:o.emulateHTTP,emulateJSON:o.emulateJSON});var i={type:r,dataType:"json"};n.url||(i.url=u.result(t,"url")||B()),n.data==null&&t&&(e==="create"||e==="update"||e==="patch")&&(i.contentType="application/json",i.data=JSON.stringify(n.attrs||t.toJSON(n))),n.emulateJSON&&(i.contentType="application/x-www-form-urlencoded",i.data=i.data?{model:i.data}:{});if(n.emulateHTTP&&(r==="PUT"||r==="DELETE"||r==="PATCH")){i.type="POST",n.emulateJSON&&(i.data._method=r);var s=n.beforeSend;n.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override",r);if(s)return s.apply(this,arguments)}}i.type!=="GET"&&!n.emulateJSON&&(i.processData=!1),i.type==="PATCH"&&window.ActiveXObject&&(!window.external||!window.external.msActiveXFilteringEnabled)&&(i.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var a=n.xhr=o.ajax(u.extend(i,n));return t.trigger("request",t,a,n),a};var T={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};o.ajax=function(){return o.$.ajax.apply(o.$,arguments)};var N=o.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},C=/\((.*?)\)/g,k=/(\(\?)?:\w+/g,L=/\*\w+/g,A=/[\-{}\[\]+?.,\\\^$|#\s]/g;u.extend(N.prototype,a,{initialize:function(){},route:function(e,t,n){u.isRegExp(e)||(e=this._routeToRegExp(e)),u.isFunction(t)&&(n=t,t=""),n||(n=this[t]);var r=this;return o.history.route(e,function(i){var s=r._extractParameters(e,i);n&&n.apply(r,s),r.trigger.apply(r,["route:"+t].concat(s)),r.trigger("route",t,s),o.history.trigger("route",r,t,s)}),this},navigate:function(e,t){return o.history.navigate(e,t),this},_bindRoutes:function(){if(!this.routes)return;this.routes=u.result(this,"routes");var e,t=u.keys(this.routes);while((e=t.pop())!=null)this.route(e,this.routes[e])},_routeToRegExp:function(e){return e=e.replace(A,"\\$&").replace(C,"(?:$1)?").replace(k,function(e,t){return t?e:"([^/]+)"}).replace(L,"(.*?)"),new RegExp("^"+e+"$")},_extractParameters:function(e,t){var n=e.exec(t).slice(1);return u.map(n,function(e){return e?decodeURIComponent(e):null})}});var O=o.History=function(){this.handlers=[],u.bindAll(this,"checkUrl"),typeof window!="undefined"&&(this.location=window.location,this.history=window.history)},M=/^[#\/]|\s+$/g,_=/^\/+|\/+$/g,D=/msie [\w.]+/,P=/\/$/;O.started=!1,u.extend(O.prototype,a,{interval:50,getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(e==null)if(this._hasPushState||!this._wantsHashChange||t){e=this.location.pathname;var n=this.root.replace(P,"");e.indexOf(n)||(e=e.substr(n.length))}else e=this.getHash();return e.replace(M,"")},start:function(e){if(O.started)throw new Error("Backbone.history has already been started");O.started=!0,this.options=u.extend({},{root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var t=this.getFragment(),n=document.documentMode,r=D.exec(navigator.userAgent.toLowerCase())&&(!n||n<=7);this.root=("/"+this.root+"/").replace(_,"/"),r&&this._wantsHashChange&&(this.iframe=o.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(t)),this._hasPushState?o.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!r?o.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=t;var i=this.location,s=i.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!s)return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&s&&i.hash&&(this.fragment=this.getHash().replace(M,""),this.history.replaceState({},document.title,this.root+this.fragment+i.search));if(!this.options.silent)return this.loadUrl()},stop:function(){o.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),O.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe)));if(t===this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(e){var t=this.fragment=this.getFragment(e),n=u.any(this.handlers,function(e){if(e.route.test(t))return e.callback(t),!0});return n},navigate:function(e,t){if(!O.started)return!1;if(!t||t===!0)t={trigger:t};e=this.getFragment(e||"");if(this.fragment===e)return;this.fragment=e;var n=this.root+e;if(this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}t.trigger&&this.loadUrl(e)},_updateHash:function(e,t,n){if(n){var r=e.href.replace(/(javascript:|#).*$/,"");e.replace(r+"#"+t)}else e.hash="#"+t}}),o.history=new O;var H=function(e,t){var n=this,r;e&&u.has(e,"constructor")?r=e.constructor:r=function(){return n.apply(this,arguments)},u.extend(r,n,t);var i=function(){this.constructor=r};return i.prototype=n.prototype,r.prototype=new i,e&&u.extend(r.prototype,e),r.__super__=n.prototype,r};p.extend=m.extend=N.extend=E.extend=O.extend=H;var B=function(){throw new Error('A "url" property or function must be specified')},j=function(e,t){var n=t.error;t.error=function(r){n&&n(e,r,t),e.trigger("error",e,r,t)}}}.call(this),define("backbone",["underscore","jquery"],function(e){return function(){var t,n;return t||e.Backbone}}(this)),define("app/wigevents",["underscore","backbone"],function(e,t){var n=_.clone(t.Events);return n.debounceMap={},n.onDebounce=function(e,t){var n=_.debounce(t,50);return this.debounceMap[t]=n,this.on(e,n)},n.offDebounce=function(e,t){var n=this.debounceMap[t];return this.off(e,n)},n}),define("app/wigbackbone",["backbone","app/wigevents"],function(e,t){var n=e.Model.extend({save:function(){var n=e.Model.prototype.save.apply(this,arguments);t.trigger("savestart",this),n.done(function(){t.trigger("savecomplete")}),n.fail(function(){t.trigger("savefail")})}});return{Model:n}}),define("app/models/brick",["app/wigbackbone"],function(e){var t=e.Model.extend({defaults:{name:"Brick",thumb_html:"<i></i>",html:"<div></div>",category:"none",description:"Brick Description",scaling:!1,css:{}}});return t}),define("app/collections/thumbcollection",["backbone","app/models/brick"],function(e,t){var n=e.Collection.extend({model:t,getByCategory:function(e){return this.where({category:e})}});return n}),define("app/views/barview",["backbone"],function(e){var t=e.View.extend({tagName:"div",events:{},initialize:function(){this.$el.addClass("bar-view"),this.types=["Text","Image","Interactive","Shapes"],this.active=[],this.barInit.apply(this,arguments)},barInit:function(){},show:function(){this.$el.css("display","inline-block"),this.delegateEvents(this.events)},hide:function(){this.$el.hide(),this.undelegateEvents()},setActive:function(e){this.active=e},afterDOM:function(){}});return t}),define("app/models/placedbrick",["backbone","underscore","app/models/brick"],function(e,t,n){var r=n.extend({defaults:{position:{top:0,left:0,right:0,bottom:0,height:0,width:0},stackOrder:0,style:"",wrapper:""},initialize:function(){this.set("position",t.clone(this.get("position")))},updateBox:function(){var e=this.view.$el,n=e.position(),r=e.width(),i=e.height(),s=t.clone(this.get("position")),o=t.clone(this.attributes),u;o.position=t.clone(o.position),$.contains(document.documentElement,this.view.el)&&(s.top=n.top,s.left=n.left,s.right=n.left+r,s.bottom=n.top+i,s.width=r,s.height=i),this.set("position",s);var a=this.view.$content.clone();a.find(".dznly-remove").remove(),e.css({"pointer-events":""}),a.find("*").addBack().removeAttr("contenteditable");var f="";a.length>0&&(f=a[0].outerHTML,this.get("category")==="Embed"&&(f=f.replace(/script/g,"wwscr"))),this.set("html",f),this.set("style",e.attr("style")),u=t.clone(this.attributes),u.position=t.clone(u.position),this.trigger("update",this,o,u)},getStyle:function(){var e=this.get("position"),t="";t+="top:"+e.top+"px;",t+="left:"+e.left+"px;",t+="width:"+e.width+"px;",t+="height:"+e.height+"px;"},updateView:function(){var e=this.attributes;this.view.$el.attr("style",e.style),this.view.setContent(e.html)},getHtml:function(e){var n={"class":!1,inlineStyles:!0};t.extend(n,e);var r;this.view?r=this.view.$el[0].outerHTML:r='<div class="brick-full" style="'+this.getStyle()+'">'+this.get("html").replace(/wwscr/g,"script")+"</div>";var i=$(r);if(this.get("category")==="Embed"){var s=this.get("embed_code")||"";i.find(".embed-wrap").html(s.replace(/wwscr/g,"script").replace(/\s{2,}/g," "))}return n.class&&i.addClass(n.class),n.inlineStyles||(i.removeAttr("style"),i.find(".brick-content").removeAttr("style")),r=i[0].outerHTML,r}});return r}),define("app/collections/brickcollection",["backbone","underscore","app/models/placedbrick","app/wigevents"],function(e,t,n,r){var i=e.Collection.extend({model:n,initialize:function(){var e=this;this.active=[],this.activeCount=0,this.on("remove",function(n){var r=n.get("stackOrder");t.each(e.filter(function(e){return e.get("stackOrder")>r?!0:!1}),function(e){var t=e.get("stackOrder");e.set("stackOrder",t-1,{silent:!0}),e.trigger("change:stackOrder",e,"undoredo")})}),this.acDB=function(t){e.trigger("activechange",t)};var n=this.acDB;this.on("activate",function(e,r){r||this.deactivateAll(),t.indexOf(this.active,e)===-1&&this.active.push(e),this.activeCount=this.active.length,n(this.active)}),this.on("deactivate",function(e){this.active=t.reject(this.active,function(t){return t===e}),this.activeCount=this.active.length,n(this.active)}),this.on("remove",function(e){this.active=t.reject(this.active,function(t){return t===e}),this.activeCount=this.active.length,n(this.active)})},getBoxes:function(){return this.map(function(e){var t=e.get("position");return{pb:e,box:new Box(t.top,t.left,t.height,t.width)}})},updateAllBoxes:function(){this.forEach(function(e){e.updateBox()})},getActive:function(){return this.active},deactivateAll:function(){t.each(this.getActive(),function(e){e.view.deactivate()});try{appView.activeSlide.$slideInt.css("overflow","hidden")}catch(e){}this.acDB([])},maxStack:function(){return this.max(function(e){return e.get("stackOrder")}).get("stackOrder")},addAndOrder:function(e){t.isArray(e)?this.addAndOrderAll(e):(this.length>0?e.set("stackOrder",this.maxStack()+1):e.set("stackOrder",0),this.add(e))},addAndOrderAll:function(e){var n=this;t.each(e,function(e){n.length>0?e.set("stackOrder",n.maxStack()+1):e.set("stackOrder",0),n.add(e)})},activateSelected:function(e,n){n=n||[];var r=function(e,t){var n=e.left,r=e.top,i=e.left+e.width,s=e.top+e.height,o=t.view.$el.offset().left,u=t.view.$el.offset().top,a=t.view.$el.offset().left+t.get("position").width,f=t.view.$el.offset().top+t.get("position").height,l=n<=a&&o<=i&&r<=f&&u<=s;return l};this.forEach(function(i){r(e,i)?(i.view.activate(!0),i.view.activateControls()):i.view.active&&t.indexOf(n,i)===-1&&i.view.deactivate()})}});return i}),define("app/models/slide",["backbone","underscore","app/collections/brickcollection"],function(e,t,n){var r=e.Model.extend({defaults:{name:"Slide",bricks:[],height:600,slide_html:"",order_index:-1,slide_style:"",style_sheet:"",is_template:!1},initialize:function(){var e=this;this.bc=new n,this.bc.slide=this,this.on("childupdate",function(){e.bc.set(e.get("bricks")),e.view&&(e.view.$el.attr("style",e.get("slide_style")),e.view.$slideInt.css("height",e.get("height")))}),this.trigger("childupdate"),this.get("order_index")===-1&&this.collection&&this.set("order_index",this.collection.length,{silent:!0})},orderDown:function(){var e=this.get("order_index");e<this.collection.maxOrderIndex()&&this.set("order_index",e+1)},orderUp:function(){var e=this.get("order_index");e>0&&this.set("order_index",e-1)},cloneJSON:function(){var e=t.omit(this.toJSON(),"id","resource_uri","");return e},toJSON:function(){var e=t.omit(t.clone(this.attributes),"pk"),n=this.view.$slideInt.clone(),r=this;e.bricks=[];var i="",s="el",o="",u="#section-"+this.get("id");o+=u+"{margin:0;"+this.get("slide_style")+"}",o+=u+" .slide-int{box-shadow:none;height:"+this.get("height")+"px;"+"}",this.bc.forEach(function(t,n){t.set("slide",r.get("resource_uri")),t.updateBox(),e.bricks.push(t.toJSON()),i+=t.getHtml({"class":s+n,inlineStyles:!1}),t.styleGroup&&(t.styleGroup.set("selector",u+" ."+s+n),t.contentStyle.set("selector",u+" ."+s+n+" .brick-content"),t.styleGroup.fetchStyle(),t.contentStyle.fetchStyle(),o+=t.styleGroup.print(""),o+=t.contentStyle.print(""))}),e.style_sheet=o;var a=[];this.bc.forEach(function(e){var t=e.view.$content.css("font-family")||"",n=t.replace(/'/g,""),r=window.fonts[n];!r||a.push(r)}),e.fonts=t.unique(a).join("|"),e.slide_style=this.view.$el.attr("style"),n=$("<div></div>").append($(i)),n.find(".brick-modal,.slide-resizer,.dznly-remove").remove(),n.find("*").removeClass("highlighted active-brick"),n.find("[contenteditable=true]").removeAttr("contenteditable"),n.find("font").each(function(){var e=this.innerHTML,t=$(this);$span=$("<span></span>").html(e).attr("style",t.attr("style")).css({color:this.color}),$(this).replaceWith($span)});var f=n.html()||"";return f=f.replace(/\s{2}/g," &nbsp;"),e.slide_html=f,e.slide_type&&!e.has_content&&(e.bricks=[]),e},urlRoot:"/api/v1/slides/"});return r}),define("app/collections/slidecollection",["underscore","backbone","app/models/slide"],function(e,t,n){var r=t.Collection.extend({model:n,url:"/api/v1/slides/",comparator:"order_index",initialize:function(){var t=this;this.on("remove",function(n){var r=t.filter(function(e){return e.get("order_index")<n.get("order_index")?!1:!0});e.each(r,function(e){e.set("order_index",e.get("order_index")-1)})}),this.on("add:between",function(){t.forEach(function(e,t){e.set("order_index",t,{silent:!0})})}),this.on("change:order_index",function(e,n){var r=e.previous("order_index"),i=t.filter(function(t){return t===e?!1:t.get("order_index")===n?!0:!1});i.length>0&&i[0].set("order_index",r,{silent:!0}),t.sort()}),this.on("sort",function(){var e=this,t=e.maxOrderIndex();e.forEach(function(e,n){var r="UD";n===0&&(r="D"),n===t&&(r="U"),e.trigger("updownenable",r)})})},add:function(){t.Collection.prototype.add.apply(this,arguments);if(!arguments[1])return;if(e.isUndefined(arguments[1].at))return;this.trigger("add:between")},maxOrderIndex:function(){return e.max(this.pluck("order_index"))}});return r}),define("app/models/stack",["app/wigbackbone","underscore","app/collections/slidecollection"],function(e,t,n){var r=e.Model.extend({defaults:function(){return{name:"Stack Name",domain:"",slides:[],fonts:"",global_slides:[],publish:!1}},initialize:function(){var e=this;this.sc=new n,this.siteSlides=new n,this.on("childupdate",function(){e.sc.set(e.get("slides")),e.sc.forEach(function(e){e.trigger("childupdate")}),e.sc.trigger("render:now");var n=site_json.global_slides,r=t.filter(e.get("global_slides"),function(e){return e.has_content});e.siteSlides.set(r),e.siteSlides.forEach(function(e){e.trigger("childupdate")})}),this.trigger("childupdate")},getSiteSlide:function(e){return this.siteSlides.findWhere({slide_type:e})},toJSON:function(){function r(e){e.bc.forEach(function(e){var t=e.view.$content.css("font-family")||"",r=t.replace(/'/g,""),i=window.fonts[r];!i||n.push(i)})}var e="http://fonts.googleapis.com/css?family=",n=[];this.sc.forEach(r),this.siteSlides.forEach(r),e+=t.unique(n).join("|"),this.set("fonts",e);var i=t.omit(t.clone(this.attributes),"pk"),s=this;return i.slides=[],this.sc.forEach(function(e){e.set("stack",s.get("resource_uri")),i.slides.push(e.toJSON())}),i.global_slides=[],this.siteSlides.forEach(function(e){i.global_slides.push(e.toJSON())}),i},urlRoot:"/api/v1/stacks/"});return r}),define("app/views/modalcontrol",["backbone"],function(e){var t=e.View.extend({tagName:"div",className:"brick-modal",state:"always",css:{},initialize:function(e){this.targets=["Heading","Text","Image","Button","Circle","Square"],this.brick=e.brick,this.modalInit(e),this.el.contentEditable=!1},modalInit:function(e){},show:function(){this.$el.show()},render:function(){return this.$el.append(this.html).css({"background-color":"white"}).css(this.css).hide(),this},update:function(){this.brick.model.updateBox()},enable:function(){this.delegateEvents(this.events)},disable:function(){this.undelegateEvents()}});return t}),define("app/views/filepicker",["jquery","app/views/modalcontrol","filepicker","app/wigevents"],function(e,t,n,r){var i=function(){return n.setKey("Aot8fYXgVS2GWgufrTbEsz"),t.extend({state:"hover",html:"",css:{cursor:"pointer"},events:{click:"pickImage"},modalInit:function(){var t=this;this.targets=["Image"],this.listenTo(this.brick,"pickimage",function(e){t.pickImage(e)}),this.$spinner=e('<div class="dznly-remove"><svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="48px" height="48px" viewbox="0 0 48 48" enable-background="new 0 0 16 16" xml:space="preserve" fill="#000000" class="svg replaced-svg"> <path d="M 45.00,27.00l-6.00,0.00 c-1.659,0.00-3.00-1.341-3.00-3.00c0.00-1.656, 1.341-3.00, 3.00-3.00l6.00,0.00 c 1.659,0.00, 3.00,1.344, 3.00,3.00C 48.00,25.659, 46.659,27.00, 45.00,27.00z M 36.726,15.516c-1.173,1.173-3.069,1.173-4.242,0.00s-1.173-3.069,0.00-4.242l 4.242-4.245 c 1.173-1.17, 3.069-1.17, 4.242,0.00c 1.173,1.173, 1.173,3.072,0.00,4.245L 36.726,15.516z M 24.00,48.00c-1.656,0.00-3.00-1.341-3.00-3.00l0.00,-6.00 c0.00-1.656, 1.344-3.00, 3.00-3.00 c 1.659,0.00, 3.00,1.344, 3.00,3.00l0.00,6.00 C 27.00,46.659, 25.659,48.00, 24.00,48.00z M 24.00,12.00C 22.344,12.00, 21.00,10.659, 21.00,9.00L21.00,3.00 c0.00-1.656, 1.344-3.00, 3.00-3.00c 1.659,0.00, 3.00,1.344, 3.00,3.00l0.00,6.00 C 27.00,10.659, 25.659,12.00, 24.00,12.00z M 11.271,40.971c-1.173,1.173-3.069,1.173-4.242,0.00s-1.173-3.072,0.00-4.242l 4.242-4.245 c 1.173-1.17, 3.072-1.17, 4.242,0.00c 1.173,1.173, 1.173,3.072,0.00,4.245L 11.271,40.971z M 11.271,15.516L 7.029,11.274 c-1.173-1.173-1.173-3.072,0.00-4.245c 1.173-1.17, 3.069-1.17, 4.242,0.00l 4.242,4.245c 1.173,1.173, 1.173,3.069,0.00,4.242 C 14.343,16.686, 12.444,16.686, 11.271,15.516z M 12.00,24.00c0.00,1.659-1.344,3.00-3.00,3.00L3.00,27.00 C 1.344,27.00,0.00,25.659,0.00,24.00c0.00-1.656, 1.344-3.00, 3.00-3.00l6.00,0.00 C 10.656,21.00, 12.00,22.344, 12.00,24.00z M 36.726,32.484l 4.242,4.245c 1.173,1.17, 1.173,3.069,0.00,4.242s-3.069,1.173-4.242,0.00l-4.242-4.242c-1.173-1.173-1.173-3.072,0.00-4.245 C 33.657,31.314, 35.556,31.314, 36.726,32.484z"></path></svg></div>'),this.$spinner.find("svg").attr("style","-webkit-animation:spin 2s infinite linear;-moz-animation:spin 2s infinite linear;animation:spin 2s infinite linear;"),this.$spinner.css({position:"absolute",width:48,height:48,top:"50%",left:"50%","margin-left":"-24px","margin-top":"-24px"})},show:function(){this.brick.model.get("name")==="Image"&&this.$el.css({top:this.brick.$el.height()-this.$el.height(),left:0}).show()},showSpinner:function(){this.brick.$el.append(this.$spinner)},hideSpinner:function(){this.$spinner.detach()},pickImage:function(t){var i=this.brick,s=this,o=i.model.firstPlacement;n.pickAndStore({mimetype:"image/*",multiple:!1},{location:"S3",access:"public"},function(n){i.$content.css({background:"white"}),s.showSpinner();var o=window.config.UPLOADS_URL+window.encodeURIComponent(n[0].key);e("<img/>").attr("src",o).on("load",function(e){i.$content.css({"background-color":"","background-image":'url("'+o+'")',"background-size":"cover","background-position":"center",width:t?t.width:this.width,height:t?t.height:this.height}),i.$el.css({width:t?t.width:this.width,height:t?t.height:this.height}),s.hideSpinner(),s.update(),i.deactivate(),i.activate(),r.trigger("changepoint","Change Image")})},function(){o&&i.model.collection.remove(i.model)})}})}();return i}),define("app/views/embedder",["jquery","app/views/modalcontrol","app/wigevents"],function(e,t,n){var r=function(){return t.extend({state:"",html:"",modalInit:function(){var e=this;this.targets=["Embed"],this.listenTo(this.brick,"embed",function(){e.promptCode()}),this.$modalPrompt=!1},show:function(){},promptCode:function(){this.$modalPrompt||(this.$modalPrompt=e("#embed-modal"),this.$modalPrompt.modal({show:!1}),this.$submit=this.$modalPrompt.find(".submit-embed"),this.$code=this.$modalPrompt.find(".embed-box")),this.$modalPrompt.modal("show");var t=this,n=t.brick.model.get("embed_code");n||(n=this.brick.$(".embed-wrap").html()),this.$code.val(n.replace(/wwscr/g,"script"));var r=function(n){var s=t.$code.val(),o;t.$submit.off("click",r),t.$modalPrompt.off("hide",i);try{o=e('<div class="embed-wrap"></div>').append(e(s))}catch(u){i();return}o.children().on("load",function(){t.brick.$el.css({height:o.height(),width:o.width()}),t.brick.$content.css({height:o.height(),width:o.width()}),t.brick.deactivate(),t.brick.activate()});var a=s.replace(/script/g,"wwscr");t.brick.model.set("embed_code",a);try{t.brick.$content.find(".embed-wrap").replaceWith(o)}catch(u){}s===""&&i(),t.$code.val(""),t.$modalPrompt.modal("hide")};this.$submit.on("click",r);var i=function(e){t.$code.val(t.brick.$(".embed-wrap").html()),t.brick.$(".embed-wrap").html()===""&&t.brick.model.collection.remove(t.brick.model),t.$submit.off("click",r),t.$modalPrompt.off("hide",i)};this.$modalPrompt.on("hide",i)}})}();return r}),define("app/modalcontrols",["app/views/filepicker","app/views/embedder"],function(e,t){return arguments});var Box=function(e,t,n,r){n=n?n:0,r=r?r:0,this.top=e,this.left=t,this.height=n,this.width=r,this.bottom=e+n,this.right=t+r};Box.prototype.vCenter=function(){return parseInt(this.top+this.height/2)},Box.prototype.hCenter=function(){return parseInt(this.left+this.width/2)},Box.prototype.getAspect=function(){return this.width/this.height},Box.prototype.resizeAR=function(e,t){var n={height:this.height,width:this.width},r=this.getAspect();return t===0?(n.height=this.height+e,n.width=this.width+e*r):(n.width=this.width+t,n.height=this.height+t/r),this.height=n.height,this.width=n.width,this},Box.prototype.relativeTo=function(e){return this.top=this.top-e.top,this.left=this.left-e.left,this.bottom=this.top+this.height,this.right=this.left+this.width,this},Box.prototype.overlap=function(e){return this.right<e.left?!1:this.bottom<e.top?!1:e.right<this.left?!1:e.bottom<this.top?!1:!0},Box.prototype.overlapBox=function(e){var t=new Box(0,0,0,0);return this.overlap(e)?(t.left=this.left<e.left?e.left:this.left,t.top=this.top<e.top?e.top:this.top,t.width=Math.max(0,Math.min(this.right,e.right)-Math.max(this.left,e.left)),t.height=Math.max(0,Math.min(this.bottom,e.bottom)-Math.max(this.top,e.top)),t.right=t.left+t.width,t.bottom=t.top+t.height,t):!1},Box.prototype.surround=function(e){var t=e.top<this.top?e.top:this.top,n=e.left<this.left?e.left:this.left,r=e.bottom>this.bottom?e.bottom:this.bottom,i=e.right>this.right?e.right:this.right;return new Box(t,n,r-t,i-n)},Box.prototype.justBox=function(){return{top:this.top,left:this.left,height:this.height,width:this.width}},function(e){e.fn.getBox=function(){var t,n,r,i,s,o,u,a,f=!0;return this.each(function(){s=e(this),o=s.offset(),f?(t=o.top,n=o.left,r=s.width(),i=s.height(),f=!1):(o.top<t&&(t=o.top),o.left<n&&(n=o.left),a=o.top-t+s.height(),u=o.left-n+s.width(),a>i&&(i=a),u>r&&(r=u))}),new Box(t,n,i,r)},e.fn.inViewPort=function(e){e=e||{},e=_.extend({top:0,left:0,bottom:0,right:0},e);var t={top:window.scrollY+e.top,left:window.scrollX+e.left,bottom:window.scrollY+window.innerHeight-e.bottom,right:window.scrollX+window.innerWidth-e.right},n=this.getBox(),r=n.overlapBox(t);return r}}(window.jQuery),define("jqbox",function(){}),function(e){var t=null,n=null,r=null,i=null,o=null,u=null,a,f,l,c;e.fn.top=function(){var e=$(this[0]);return Math.round(e.position().top)},e.fn.left=function(){var e=$(this[0]);return Math.round(e.position().left)},e.fn.bottom=function(){var e=$(this[0]);return Math.round(e.top()+e.height())},e.fn.right=function(){var e=$(this[0]);return Math.round(e.left()+e.width())},e.fn.hCenter=function(){var e=$(this[0]);return parseInt(e.top()+e.height()/2)},e.fn.vCenter=function(){var e=$(this[0]);return parseInt(e.left()+e.width()/2)},e.fn.wigSnap=function(){var e=arguments[0],s={},h=e.event;e.mode==="start"?(a=e.slide,f=e.sel,grid=e.grid,innerX=h.pageX-a.offset().left,innerY=h.pageY-a.offset().top,t=innerX-this.left(),n=this.right()-innerX,r=innerY-this.top(),i=this.bottom()-innerY,o=parseInt(innerX-this.vCenter()),u=parseInt(innerY-this.hCenter()),l=a.find(f).not(".active-brick"),c=[],l.each(function(){var e=$(this),t=new Box(e.top(),e.left(),e.height(),e.width());c.push(t)})):e.mode==="snap"?(s.position={top:this.position().top,left:this.position().left},v(this,h,s,grid),this.css(s.position),this.drawLines({width:1,height:1}),this.updateRulers()):e.mode==="stop"&&(w(),S())},e.fn.wigResizeSnap=function(){var e=arguments[0],s={},o=e.event,u;if(e.mode==="start")a=e.slide,handle=e.handle,f=e.sel,grid=e.grid,aspectFixed=!1,innerX=o.pageX,innerY=o.pageY,t=innerX-this.left(),n=this.right()-innerX,r=innerY-this.top(),i=this.bottom()-innerY,aspectRatio=this.width()/this.height(),startBottom=this.bottom(),startRight=this.right(),l=a.find(f).not(this),c=[],l.each(function(){var e=$(this),t=new Box(e.top(),e.left(),e.height(),e.width());c.push(t)});else if(e.mode==="snap"){s.position={top:this.position().top,left:this.position().left,width:this.width(),height:this.height()};var h=e.exclude||"";d(this,o,s,handle,grid,e.matchClass,h,e.sizeOnly,e.ignoreSlide),this.css(s.position),e.skipLines||(this.drawLines({hCenter:1,vCenter:1}),this.updateRulers())}else e.mode==="stop"&&(e.matchClass&&(l.removeClass(e.matchClass),this.removeClass(e.matchClass)),w(),S())};var h=function(e,t){return e.top()<=t.bottom()&&t.top()<=e.bottom()},p=function(e,t){return e.left()<=t.right()&&t.left()<=e.right()},d=function(e,s,o,u,f,h,p,d,v){var m=999,g=999,y=new Box(e.top(),e.left(),e.height(),e.width()),b,w;p.match("x")?b=function(){return!1}:b=function(e,t){var n=Math.abs(e-t),r=n<5&&n<m;return r&&(m=n),r},p.match("y")?w=function(){return!1}:w=function(e,t){var n=Math.abs(e-t),r=n<5&&n<g;return r&&(g=n),r},f&&((u.hasClass("NE")||u.hasClass("E")||u.hasClass("SE"))&&b((s.pageX+n)%70,50)&&(o.position.width=e.width()+(50-(s.pageX+n)%70)),(u.hasClass("NW")||u.hasClass("W")||u.hasClass("SW"))&&b((s.pageX-t+30)%70,30)&&(o.position.width=e.width()+(30+s.pageX-t)%70-30,o.position.left=e.left()-(30+s.pageX-t)%70+30)),v||((u.hasClass("NE")||u.hasClass("E")||u.hasClass("SE"))&&b(s.pageX+n,a.width())&&(o.position.width=a.width()-e.left()),(u.hasClass("NW")||u.hasClass("W")||u.hasClass("SW"))&&b(s.pageX-t,0)&&(o.position.left=0,o.position.width=e.right()),(u.hasClass("NE")||u.hasClass("N")||u.hasClass("NW"))&&w(s.pageY-r,0)&&(o.position.top=0,o.position.height=e.bottom()),(u.hasClass("SW")||u.hasClass("S")||u.hasClass("SE"))&&w(s.pageY+i,a.height())&&(o.position.height=a.height()-e.top()));var E=0,S;$.each(c,function(e){var a=l.eq(e),f=!1;if(u.hasClass("NE")||u.hasClass("E")||u.hasClass("SE"))d||(b(s.pageX+n,this.right)&&(f=!0,o.position.width=this.right-y.left),b(s.pageX+n,this.left)&&(f=!0,o.position.width=this.left-y.left)),b(y.width,this.width)&&(f=!0,o.position.width=this.width);if(u.hasClass("NW")||u.hasClass("W")||u.hasClass("SW"))d||(b(s.pageX-t,this.left)&&(f=!0,o.position.left=this.left,o.position.width=y.right-this.left),b(s.pageX-t,this.right)&&(f=!0,o.position.left=this.right,o.position.width=y.right-this.right)),b(y.width,this.width)&&(f=!0,o.position.width=this.width,o.position.left=y.right-this.width);if(u.hasClass("NE")||u.hasClass("N")||u.hasClass("NW"))d||(w(s.pageY-r,this.top)&&(f=!0,o.position.top=this.top,o.position.height=y.bottom-this.top),w(s.pageY-r,this.bottom)&&(f=!0,o.position.top=this.bottom,o.position.height=y.bottom-this.bottom)),b(y.height,this.height)&&(f=!0,o.position.height=this.height,o.position.top=y.bottom-this.height);if(u.hasClass("SW")||u.hasClass("S")||u.hasClass("SE"))d||(w(s.pageY+i,this.top)&&(f=!0,o.position.height=this.top-y.top),w(s.pageY+i,this.bottom)&&(f=!0,o.position.height=this.bottom-y.top)),w(y.height,this.height)&&(f=!0,o.position.height=this.height);f&&h&&(E++,S=a)}),E===0&&h?(e.removeClass(h),l.removeClass(h)):h&&(e.addClass(h),targetH=S.height(),l.filter(function(){return $(this).height()===targetH}).addClass(h)),aspectFixed&&(u.hasClass("N")||u.hasClass("S")||u.hasClass("NE")?o.position.width=Math.round(o.position.height*aspectRatio):o.position.height=Math.round(o.position.width/aspectRatio),u.hasClass("NW")&&(o.position.top=startBottom-o.position.height))},v=function(e,f,l,h){var p=99999,d=99999,v=function(e,t){var n=Math.abs(e-t),r=n<5&&n<p;return r&&(p=n),r},m=function(e,t){var n=Math.abs(e-t),r=n<5&&n<d;return r&&(d=n),r};s=a;var g=f.pageX-a.offset().left,y=f.pageY-a.offset().top;v(g+n,s.width())&&(l.position.left=s.width()-e.width()),v(g-t,0)&&(l.position.left=0),m(y-r,0)&&(l.position.top=0),m(y+i,s.height())&&(l.position.top=s.height()-e.height()),v(g-o,parseInt(s.width()/2))&&(l.position.left=parseInt(s.width()/2-e.width()/2)),m(y-u,parseInt(s.height()/2))&&(l.position.top=parseInt(s.height()/2-e.height()/2)),h&&(v((g+n)%70,50)&&(l.position.left=g-t+(50-(g+n)%70)),v((g-t+30)%70,30)&&(l.position.left=g-t-(30+g-t)%70+30));var b=e.width(),w=e.height();$.each(c,function(){v(g+n,this.right)&&(l.position.left=this.right-b),v(g-t,this.left)&&(l.position.left=this.left),v(g-t,this.right)&&(l.position.left=this.right),v(g+n,this.left)&&(l.position.left=this.left-b),m(y-r,this.top)&&(l.position.top=this.top),m(y+i,this.bottom)&&(l.position.top=this.bottom-w),m(y+i,this.top)&&(l.position.top=this.top-w),m(y-r,this.bottom)&&(l.position.top=this.bottom),v(g-o,this.hCenter())&&(l.position.left=this.hCenter()-parseInt(b/2)),m(y-u,this.vCenter())&&(l.position.top=this.vCenter()-parseInt(w/2))})},m=function(e,t,n,r){var i="width: 100%; left: 0; border-color: orange";if(t!=undefined&&n!=undefined){var s=t.left<n.left?t.left:n.left,o=t.right>n.right?t.right:n.right;i="width: "+(o-s)+"px ; left: "+s+"px;"}var u=!!r.querySelector("#h"+e),a=$('<div class="hLine" id="h'+e+'" style="top: '+e+"px;"+i+'"></div>');u||r.appendChild(a[0])},g=function(e,t,n,r){var i="height: 100%; top: 0; border-color: orange";if(t!=undefined&&n!=undefined){var s=t.top<n.top?t.top:n.top,o=t.bottom>n.bottom?t.bottom:n.bottom;i="height: "+(o-s)+"px ; top: "+s+"px;"}var u=!!r.querySelector("#v"+e),a=$('<div class="vLine" id="v'+e+'" style="left: '+e+"px; "+i+'"></div>');u||r.appendChild(a[0])},y=function(e,t){var n=!!t.querySelector("#hh"+e.left+e.top),r=$('<div class="hLine" id="hh'+e.left+e.top+'" style="left: '+e.left+"px; top: "+(e.top-10)+"px; width: "+e.width+'px"></div>'),i=$('<div class="vLine" id="hh'+e.left+e.top+'" style="left: '+e.left+"px; top: "+(e.top-15)+'px; height: 10px"></div>'),s=$('<div class="vLine" id="hh'+e.left+e.top+'" style="left: '+e.right+"px; top: "+(e.top-15)+'px; height: 10px"></div>');n||(t.appendChild(r[0]),t.appendChild(i[0]),t.appendChild(s[0]))},b=function(e,t){var n=!!t.querySelector("#vv"+e.left+e.top),r=$('<div class="vLine" id="vv'+e.left+e.top+'" style="top: '+e.top+"px; left: "+(e.left-10)+"px; height: "+e.height+'px"></div>'),i=$('<div class="hLine" id="vv'+e.left+e.top+'" style="left: '+(e.left-15)+"px; top: "+e.top+'px; width: 10px"></div>'),s=$('<div class="hLine" id="vv'+e.left+e.top+'" style="left: '+(e.left-15)+"px; top: "+e.bottom+'px; width: 10px"></div>');n||(t.appendChild(r[0]),t.appendChild(i[0]),t.appendChild(s[0]))},w=function(){$(".vLine,.hLine").remove()},E=function(){$(".hRuler, .vRuler").length==0&&(hRuler=$('<div class="hRuler" style="width: '+$(a).width()+'px; height: 10px;"><div class="hMarker"></div></div>'),vRuler=$('<div class="vRuler" style="width: 10px; height: '+($(a).height()-10)+'px;"><div class="vMarker"></div></div>'),a.before(hRuler),a.before(vRuler))};e.fn.updateRulers=function(){E();var e=$(".hRuler").find(".hMarker"),t=$(".vRuler").find(".vMarker");e.css("margin-left",$(this).left()+"px"),e.css("width",$(this).width()+"px"),t.css("margin-top",$(this).top()-10+"px"),t.css("height",$(this).height()+"px")};var S=function(){$(".hRuler, .vRuler").remove()};e.fn.drawLines=function(e){var t=$(this);oBox=new Box(t.top(),t.left(),t.height(),t.width()),e===undefined&&(e={}),$(".vLine, .hLine").remove();var n=document.createDocumentFragment();$.each(c,function(t){var r=$(l[t]);e.left||(oBox.left==this.left&&g(oBox.left,oBox,this,n),oBox.left==this.right&&g(oBox.left,oBox,this,n)),e.top||(oBox.top==this.top&&m(oBox.top,oBox,this,n),oBox.top==this.bottom&&m(oBox.top,oBox,this,n)),e.right||(oBox.right==this.left&&g(oBox.right,oBox,this,n),oBox.right==this.right&&g(oBox.right,oBox,this,n)),e.bottom||(oBox.bottom==this.top&&m(oBox.bottom,oBox,this,n),oBox.bottom==this.bottom&&m(oBox.bottom,oBox,this,n)),e.vCenter||oBox.vCenter()==this.vCenter()&&m(oBox.vCenter(),oBox,this,n),e.hCenter||oBox.hCenter()==this.hCenter()&&g(oBox.hCenter(),oBox,this,n),e.width||oBox.width==this.width&&(y(this,n),y(oBox,n)),e.height||oBox.height==this.height&&(b(this,n),b(oBox,n))});if(!e.vCenter){var r=parseInt(a.height()/2);Math.abs(oBox.vCenter()-r)<2&&m(oBox.vCenter(),undefined,undefined,n)}if(!e.hCenter){var r=parseInt(a.width()/2);Math.abs(oBox.hCenter()-r)<2&&g(oBox.hCenter(),undefined,undefined,n)}a.append(n)}}(window.jQuery),define("snaps",function(){}),define("app/views/brickfull",["underscore","backbone","jquery","app/appview","app/models/placedbrick","app/modalcontrols","app/wigevents","snaps","jqbox"],function(e,t,n,r,i,s,o){var u=t.View.extend({tagName:"div",className:"brick-full",placed:!0,active:!1,editing:!1,rendered:!1,initialize:function(){this.modals=[],r=require("app/appview")},render:function(){if(!this.rendered){var e=this.model.get("position"),t=n(this.model.get("html")).addClass("brick-content");if(this.model.get("category")==="Embed"){var r=this.model.get("embed_code");if(r)try{t.find(".embed-wrap").html(r.replace(/wwscr/g,"script"))}catch(i){}else this.model.set("embed_code",t.find(".embed-wrap").html());this.$el.attr("data-original-title","Your embedded content may go blank during editing, but it will still appear on your saved page.").tooltip("fixTitle")}this.$content=t.appendTo(this.el),this.$el.attr("style",this.model.get("style")).css({top:e.top,left:e.left,width:e.width,height:e.height});var s=this.$content.attr("style")||"";s.match(/font-family/)||this.$content.css({"font-family":"Open Sans"});var o=this.model.get("wrapper");o!==""&&this.$content.wrap(o),this.model.get("category")==="Embed"&&this.$content.has(".embed-cover.dznly-remove").length===0&&this.$content.append('<div class="embed-cover dznly-remove"></div>'),this.$spinner=n('<div class="dznly-remove"><svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="48px" height="48px" viewbox="0 0 48 48" enable-background="new 0 0 16 16" xml:space="preserve" fill="#000000" class="svg replaced-svg"> <path d="M 45.00,27.00l-6.00,0.00 c-1.659,0.00-3.00-1.341-3.00-3.00c0.00-1.656, 1.341-3.00, 3.00-3.00l6.00,0.00 c 1.659,0.00, 3.00,1.344, 3.00,3.00C 48.00,25.659, 46.659,27.00, 45.00,27.00z M 36.726,15.516c-1.173,1.173-3.069,1.173-4.242,0.00s-1.173-3.069,0.00-4.242l 4.242-4.245 c 1.173-1.17, 3.069-1.17, 4.242,0.00c 1.173,1.173, 1.173,3.072,0.00,4.245L 36.726,15.516z M 24.00,48.00c-1.656,0.00-3.00-1.341-3.00-3.00l0.00,-6.00 c0.00-1.656, 1.344-3.00, 3.00-3.00 c 1.659,0.00, 3.00,1.344, 3.00,3.00l0.00,6.00 C 27.00,46.659, 25.659,48.00, 24.00,48.00z M 24.00,12.00C 22.344,12.00, 21.00,10.659, 21.00,9.00L21.00,3.00 c0.00-1.656, 1.344-3.00, 3.00-3.00c 1.659,0.00, 3.00,1.344, 3.00,3.00l0.00,6.00 C 27.00,10.659, 25.659,12.00, 24.00,12.00z M 11.271,40.971c-1.173,1.173-3.069,1.173-4.242,0.00s-1.173-3.072,0.00-4.242l 4.242-4.245 c 1.173-1.17, 3.072-1.17, 4.242,0.00c 1.173,1.173, 1.173,3.072,0.00,4.245L 11.271,40.971z M 11.271,15.516L 7.029,11.274 c-1.173-1.173-1.173-3.072,0.00-4.245c 1.173-1.17, 3.069-1.17, 4.242,0.00l 4.242,4.245c 1.173,1.173, 1.173,3.069,0.00,4.242 C 14.343,16.686, 12.444,16.686, 11.271,15.516z M 12.00,24.00c0.00,1.659-1.344,3.00-3.00,3.00L3.00,27.00 C 1.344,27.00,0.00,25.659,0.00,24.00c0.00-1.656, 1.344-3.00, 3.00-3.00l6.00,0.00 C 10.656,21.00, 12.00,22.344, 12.00,24.00z M 36.726,32.484l 4.242,4.245c 1.173,1.17, 1.173,3.069,0.00,4.242s-3.069,1.173-4.242,0.00l-4.242-4.242c-1.173-1.173-1.173-3.072,0.00-4.245 C 33.657,31.314, 35.556,31.314, 36.726,32.484z"></path></svg></div>'),this.$spinner.find("svg").attr("style","-webkit-animation:spin 2s infinite linear;-moz-animation:spin 2s infinite linear;animation:spin 2s infinite linear;"),this.$spinner.css({position:"absolute",width:48,height:48,top:"50%",left:"50%","margin-left":"-24px","margin-top":"-24px"}),this.rendered=!0}return this},showSpinner:function(){this.$spinner.appendTo(this.el)},hideSpinner:function(){this.$spinner.detach()},setContent:function(e){var t=n(e);this.$content.replaceWith(t),this.$content=t},startDrag:function(e){this.$el.css({top:Math.round(e.pageY-this.$el.height()/2),left:Math.round(e.pageX-this.$el.width()/2),"z-index":99999999}).show().addClass("not-droppable")},moveBy:function(e,t,n){var i,s,o=e.pageX-t.x,u=e.pageY-t.y,a=r.activeSlide,f=this.model.collection;n&&(s=this.$el.position(),this.startPos={top:s.top,left:s.left}),this.model.trigger("moveby",{x:o,y:u,evt:e})},moveTo:function(e,t){t=t?t:{x:0,y:0},this.$el.css({top:e.pageY-Math.round(this.$el.height()/2),left:e.pageX-Math.round(this.$el.width()/2)})},endDrag:function(e){var t=this.$el.offset(),n=r.activeSlide.$el.offset(),i,s=r.activeSlide,o=r.activeSlide.model.bc;return this.placed?(this.placeBrick(),this.placed&&this.model.updateBox(),!0):s.pointInside({top:e.pageY,left:e.pageX})?(this.placeBrick(),this.placed&&this.model.updateBox(),!0):(this.placed?o.remove(this.model):this.$el.hide(),!1)},placeBrick:function(){this.placed||(placedBrick=new i(this.model.attributes),placedBrick.set("position",this.$el.getBox().relativeTo(r.activeSlide.$slideInt.getBox()).justBox()),placedBrick.firstPlacement=!0,r.activeSlide.model.bc.addAndOrder(placedBrick),placedBrick.view.activate(!1),this.$el.hide(),o.trigger("changepoint","Add "+this.model.get("name"))),this.$el.removeClass("droppable").removeClass("not-droppable")},activateControls:function(){var t=this,r=!1;this.modals.length===0&&(e.each(s,function(n){var r=new n({brick:t});e.indexOf(r.targets,t.model.get("name"))>-1?t.modals.push(r):r.remove()}),this.model.firstPlacement&&(this.trigger("pickimage"),this.trigger("embed"),this.model.firstPlacement=!1)),this.delegateEvents({contextmenu:function(e){if(!this.editing)return!1},"click a":function(e){e.preventDefault()},mouseover:function(){this.active||this.$el.addClass("hover")},mouseout:function(){this.active||this.$el.removeClass("hover")},mousedown:function(t){t.preventDefault(),t.stopPropagation(),!this.active&&!t.metaKey&&!t.shiftKey?this.activate(!1):this.active?this.active&&(t.metaKey||t.shiftKey)&&this.deactivate():this.activate(!0);var i=this,s=this.$el.offset(),u={x:t.pageX,y:t.pageY},a=!0,f=i.model.collection.getActive();r=!1;if(!this.editing){i.model.trigger("startdrag",t),o.trigger("pagedragstart"),this.destinationSV=!1,i.listenTo(o,"pagedragenter",function(t){this.destinationSV=t,e.each(f,function(e){e.view.$el.addClass("moving")})}),t.preventDefault();function l(t){t.preventDefault(),r?a=!1:(r=!0,e.each(f,function(e){e.view.$el.css({"pointer-events":"none"})})),i.moveBy(t,u,a)}function c(t){n(window).off("mousemove",l).off("mouseup",c),i.stopListening(o,"pagedragenter"),i.destinationSV?(i.destinationSV.brickDrop(f),o.trigger("changepoint","Move")):(i.active?e.each(f,function(e){e.view.endDrag(t)}):i.endDrag(t),r&&o.trigger("changepoint","Move")),i.model.trigger("enddrag",t),o.trigger("pagedragend"),e.each(f,function(e){e.view.$el.css({"pointer-events":""}).removeClass("moving")})}n(window).mousemove(l).mouseup(c)}t.which===3&&!i.editing&&o.trigger("rightclick",this.model)},dblclick:function(e){e.preventDefault(),this.model.get("category")==="Text"||this.model.get("category")==="Interactive"?(this.active||this.activate(!1),this.editing||this.startEdit()):this.model.get("category")==="Embed"?this.trigger("embed"):this.model.get("category")==="Image"&&o.trigger("image:edit",this.model)}})},activate:function(e){var t=r.activeSlide;this.active=!0,this.$el.removeClass("hover"),this.$el.addClass("active-brick");var n=t.closestInside(this.$el),i=this.$el.offset();(n.top!==i.top||n.left!==i.left)&&t.$slideInt.css("overflow","visible"),this.model.trigger("activate",this.model,e)},deactivate:function(){this.editing&&this.stopEdit(),this.active=!1,this.editing=!1,this.$el.removeClass("active-brick"),this.model.trigger("deactivate",this.model)},startEdit:function(){if(this.$content.parent()[0].tagName==="A"){var e=this.$content.parent().css("color");this.$content.unwrap(),this.$content.wrap(n("<span></span>").css({color:e}))}this.$el.find("a").css({"pointer-events":"none"}),this.$content.wysiwyg(),this.editing=!0,o.trigger("edittext"),this.$content.on("click",function(e){e.stopPropagation()}).on("mousedown",function(e){e.stopPropagation()}).on("mousemove",function(e){e.stopPropagation()}),this.$content.text()==="Double Click to Add Heading"||this.$content.text()==="Double Click To Add Text"?this.$content.text("").blur().focus():this.$content.blur().focus();var t=this.$el,r=this.$content;this.clickPreventer=function(e){e.preventDefault()},this.$content.on("click",this.clickPreventer),this.moveProxy=function(e){n(window).trigger({type:"mousemove",pageX:e.pageX,pageY:e.pageY})},this.$content.on("mousemove",this.moveProxy),this.pasteHandler=function(e){var n=window.scrollY;r.trigger("savesel"),t.append('<div id="copy-receiver"></div>');var i=t.find("#copy-receiver");i.attr("contenteditable","true"),i.css({opacity:"0"}),i.focus(),setTimeout(function(){var e=r.html();i.html(i.html().replace(/\n/g,"").replace(/<div>/g,"").replace(/<\/div>/g,"<br>").replace(/<br[^>]*>/g,"\n")),r.trigger("command","insertText "+i.text()),i.remove(),r.focus(),window.scrollTo(0,n)},100)},n(window).on("keydown",null,"ctrl+v meta+v",this.pasteHandler),this.tabHandler=function(e){e.preventDefault(),e.stopPropagation(),r.trigger("command","insertText     ")},r.on("keydown",null,"tab",this.tabHandler)},stopEdit:function(){this.$content.parent()[0].tagName==="SPAN"&&(this.$content.unwrap(),this.$content.wrap(this.model.get("wrapper"))),this.$el.find("*").css({"pointer-events":""}),this.model.updateBox(),window.getSelection().removeAllRanges(),this.$content.stopWysiwyg(),o.trigger("stopedittext"),this.editing=!1,this.$el.removeAttr("contentEditable"),this.$content.off(),this.$content.text()===""?this.$content.html("Double Click To Add Text"):o.trigger("changepoint","Edit Text"),this.$content.off("click",this.clickPreventer),this.$content.off("mousemove",this.moveProxy),n(window).off("keydown",this.pasteHandler),this.$content.off("keydown",this.tabHandler)},removeAll:function(){n.each(this.modals,function(){this.remove()}),this.editing&&this.stopEdit(),this.remove()},disable:function(){this.undelegateEvents(),this.delegateEvents({"click a":function(e){e.preventDefault()}})},enable:function(){this.activateControls()}});return u}),define("app/views/brickpreview",["backbone","app/views/brickfull"],function(e,t){var n=t.extend({placed:!1,render:function(){return this.$el.append(this.model.get("html")).hide(),this.$el.css({"font-family":"Open Sans"}),this.$el.find("*").css({"font-family":"Open Sans"}),this}});return n}),define("app/views/brickthumb",["backbone","app/models/stack","app/views/brickpreview","app/views/appeditview","app/models/placedbrick","app/wigevents"],function(e,t,n,r,i,s){var o=e.View.extend({tagName:"button",className:"brick-thumb btn btn-single",events:{mousedown:"startDrag"},initialize:function(){this.brickPreview=new n({model:this.model}),this.brickPreview.render().$el.css({"pointer-events":"none"}).hide().appendTo("body")},render:function(){return this.$el.append(this.model.get("thumb_html")),this},startDrag:function(e){function r(e){n=!0,t.brickPreview.moveTo(e)}function o(e){$(window).off("mousemove",r).off("mouseup",o),s.trigger("pagedragend");if(!n){var u=new i(t.brickPreview.model.attributes),a=_.pick(t.brickPreview.$el.getBox(),"width","height");_.extend(a,{top:0,left:100}),u.set("position",a),u.firstPlacement=!0,s.trigger("placebrick",[u],40,!0),t.brickPreview.$el.hide(),s.trigger("changepoint","Add "+u.get("name"))}else if(t.destinationSV){var u=new i(t.brickPreview.model.attributes),a=t.brickPreview.$el.getBox();u.set("position",{top:a.top,left:a.left,right:a.right,bottom:a.bottom,width:a.width,height:a.height}),u.firstPlacement=!0,t.destinationSV.brickDrop([u]),t.brickPreview.$el.hide(),s.trigger("changepoint","Add "+u.get("name"))}else t.brickPreview.$el.hide()}var t=this,n=!1;e.preventDefault(),s.trigger("pagedragstart"),this.destinationSV=!1,this.listenTo(s,"pagedragenter",function(e){this.destinationSV=e,this.brickPreview.$el.removeClass("not-droppable"),this.brickPreview.$el.addClass("droppable")}),this.listenTo(s,"pagedragleave",function(e){this.brickPreview.$el.removeClass("droppable"),this.brickPreview.$el.addClass("not-droppable")}),this.brickPreview.startDrag(e),$(window).mousemove(r).mouseup(o)}});return o}),define("app/views/binview",["underscore","jquery","app/views/barview","app/views/brickthumb","app/collections/thumbcollection","app/wigevents"],function(e,t,n,r,i,s){var o=n.extend({tagName:"div",className:"slide-bin",events:{"click .open-lib":function(e){e.stopPropagation(),s.trigger("sidemenu:show"),s.trigger("sidemenu:componentlib")}},barInit:function(){var n=this.bin=new i;this.listenTo(n,"add",function(e){var t=new r({model:e});this.$openLib.before(t.render().el)}),this.listenTo(s,"stylechange",function(n,r){var i,s=this.bin;e.isArray(n)?(i=[],e.each(n,function(e){i.push(s.findWhere({name:e}))})):i=s.where({category:n}),e.each(i,function(e){var n=t(e.get("html"));n.css(r),e.set("html",n[0].outerHTML)})})},render:function(){return this.renderAll(),this.$openLib=t('<button class="brick-thumb btn btn-single open-lib"><svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="20px" height="20px" viewbox="0 0 48 48" enable-background="new 0 0 16 16" xml:space="preserve" fill="#000000" class="svg replaced-svg"> <path d="M 39.00,48.00L9.00,48.00 c-4.971,0.00-9.00-4.032-9.00-9.00L0.00,9.00 c0.00-4.971, 4.029-9.00, 9.00-9.00l30.00,0.00 c 4.971,0.00, 9.00,4.029, 9.00,9.00l0.00,30.00 C 48.00,43.968, 43.971,48.00, 39.00,48.00z M 42.00,9.00c0.00-1.656-1.341-3.00-3.00-3.00L9.00,6.00 C 7.344,6.00, 6.00,7.344, 6.00,9.00l0.00,30.00 c0.00,1.659, 1.344,3.00, 3.00,3.00l30.00,0.00 c 1.659,0.00, 3.00-1.341, 3.00-3.00L42.00,9.00 z M 27.00,27.00l9.00,0.00 l0.00,9.00 L27.00,36.00 L27.00,27.00 z M 30.00,33.00l3.00,0.00 l0.00,-3.00 l-3.00,0.00 L30.00,33.00 z M 27.00,12.00l9.00,0.00 l0.00,9.00 L27.00,21.00 L27.00,12.00 z M 30.00,18.00l3.00,0.00 L33.00,15.00 l-3.00,0.00 L30.00,18.00 z M 12.00,27.00l9.00,0.00 l0.00,9.00 L12.00,36.00 L12.00,27.00 z M 15.00,33.00l3.00,0.00 l0.00,-3.00 L15.00,30.00 L15.00,33.00 z M 12.00,12.00l9.00,0.00 l0.00,9.00 L12.00,21.00 L12.00,12.00 z M 15.00,18.00l3.00,0.00 L18.00,15.00 L15.00,15.00 L15.00,18.00 z"></path></svg><h5>More</h5></button>').appendTo(this.el),this},renderAll:function(){var e=this;return this.bin.forEach(function(t){var n=new r({model:t});e.$el.append(n.render().el)}),this}});return o}),define("app/views/slidecontrols",["underscore","backbone","jquery","app/models/placedbrick","app/wigevents"],function(e,t,n,r,i){var s,o=t.View.extend({el:".top-controls-container",events:{"click #delete-selected":"delete","click #cut-selected":"brickCut","click #copy-selected":"brickCopy","click #paste-selected":"brickPaste","click #up-layer":"moveToTop","click #down-layer":"moveToBottom","click #preview":"togglePreview","click #stack-publish":"publish","click #save-button":"save","click #revert-all":"revert","click #undo":function(){s.undoRedo.undo()},"click #redo":function(){s.undoRedo.redo()},"click #grid-toggle":"toggleGrid"},initialize:function(){this.active=[],this.listenTo(i,"activechange",function(e){this.active=e,this.updateControls(e.length>0)}),this.changed=!1,this.listenToOnce(i,"appstart",function(e){s=e,this.listenTo(i,"changepoint undo redo",function(){this.changed=!0})})},render:function(){var t=this;this.$activeControls=n("#up-layer,#down-layer,#delete-selected,#copy-selected,#cut-selected,#change-color").addClass("inactive"),n("#paste-selected").addClass("inactive"),this.$urControls=n("#undo,#redo").addClass("inactive"),this.$clipboardDropdown=n(".clipboard-controls .dropdown-toggle"),this.listenTo(i,"rightclick",function(n){e.delay(function(){t.$clipboardDropdown.parent().addClass("open")},100)}),this.listenTo(i,"urenable",function(e,t,n){this.$urControls.addClass("inactive");var r=this.$urControls.first(),i=this.$urControls.last();e.match(/U/)?(r.removeClass("inactive").attr("data-original-title","Undo "+t).tooltip("fixTitle"),r.next().is(".tooltip")&&r.tooltip("show")):r.tooltip("hide"),e.match(/R/)?(i.removeClass("inactive").attr("data-original-title","Redo "+n).tooltip("fixTitle"),i.next().is(".tooltip")&&i.tooltip("show")):i.tooltip("hide")}),this.$save=this.$("#save-button"),this.$saveTxt=this.$save.find("span"),this.listenToOnce(i,"appstart",function(){this.listenTo(i,"savestart",function(){this.$saveTxt.text("Saving...")}),this.listenTo(i,"changepoint undo redo",function(){this.$saveTxt.text("Saved a few seconds ago")}),this.listenTo(i,"savecomplete",function(){this.$save.removeClass("problem"),this.$saveTxt.text("All changes saved"),this.changed=!1}),this.listenTo(i,"savefail",function(){this.$save.addClass("problem"),this.$saveTxt.text("Save error, click to retry")})}),this.$saveModal=n("#pagenav-modal"),this.$saveModal.modal({show:!1});var r=function(){t.$saveModal.find(".pagenav-proceed").removeClass("btn-danger").addClass("btn-primary").text("Proceed"),t.$saveModal.find(".pagenav-save").hide(),t.$saveModal.find(".status-text").text("Save was successful. Click proceed to carry on.").removeClass("problem")},o=function(){t.$saveModal.find(".pagenav-save").show(),t.$saveModal.find(".status-text").text("Whoops, there was an error while saving. Make sure you're connected to the Internet then try again.").addClass("problem")};this.$aTags=this.$("a").not('[href=#],[href="javascript:void(0)"]').not("[target=_blank]"),this.$saveModal.on("hide",function(){t.changed&&i.trigger("setnavalert"),t.stopListening(i,"savecomplete",r),t.stopListening(i,"savefail",o)});var u=function(e){if(!t.changed)return!0;e.preventDefault(),t.$saveModal.modal("show"),t.$saveModal.find(".pagenav-save").hide(),t.$saveModal.find(".pagenav-proceed").attr("href",n(this).attr("href")).removeClass("btn-primary").addClass("btn-danger"),t.$saveModal.find(".status-text").html("&nbsp;")};return t.$saveModal.find(".pagenav-save").on("click",function(){t.$saveModal.find(".status-text").html("&nbsp;"),t.save()}),window.config.DEMO||t.$aTags.on("click",u),t.$saveModal.on("shown",function(){t.listenTo(i,"savecomplete",r),t.listenTo(i,"savefail",o),t.save(),i.trigger("killnavalert")}),this.$publishModal=n("#publish-modal").modal({show:!1}),this.pubAfterSave=function(){var e=s.stack.get("task_id");t.checkPublished(e)},this.pubAfterFail=function(){this.$publishModal.find(".publish-spin-wrap").removeClass("do-spin").removeClass("done").addClass("problem"),this.$publishModal.find(".publish-done").css({visibility:"visible"}).text("Publish error! Make sure you are connected to the Internet and please try again."),this.$publishModal.find(".publish-nav").css({visibility:"hidden"}),t.cleanupPublished()},this.$publishModal.find(".publish-nav").attr("href",window.page_live_url).attr("target","_blank"),this.listenTo(i,"publish:complete",function(){this.$publishModal.find(".publish-spin-wrap").removeClass("do-spin").removeClass("problem").addClass("done"),this.$publishModal.find(".publish-done").css({visibility:"visible"}).text("All Done!"),this.$publishModal.find(".publish-nav").css({visibility:"visible"}),this.cleanupPublished()}),this.listenTo(i,"publish:fail",this.pubAfterFail),this},updateControls:function(e){e?this.$activeControls.removeClass("inactive"):this.$activeControls.addClass("inactive")},getBC:function(){return s.activeSlide.model.bc},moveToTop:function(t){t&&t.preventDefault();if(this.active.length===0)return;var n=e.sortBy(this.active,function(e){return e.get("stackOrder")*-1}),r=this.active[0].collection.maxStack(),s=e.first(n),o=s.get("stackOrder"),u=r-o;if(u===0)return!1;e.each(n,function(t){var r=t.get("stackOrder"),i=r+u,s;s=n[0].collection.filter(function(t){var s=t.get("stackOrder");return e.indexOf(n,t)===-1?r<s&&s<=i:!1}),e.each(s,function(e){var t=e.get("stackOrder");e.set("stackOrder",t-1)}),t.set("stackOrder",i)}),i.trigger("changepoint","Move to Top")},moveToBottom:function(t){t&&t.preventDefault();if(this.active.length===0)return;var n=e.sortBy(this.active,function(e){return e.get("stackOrder")}),r=0,s=e.first(n),o=s.get("stackOrder"),u=r-o;if(u===0)return!1;e.each(n,function(t){var r=t.get("stackOrder"),i=r+u,s;s=n[0].collection.filter(function(t){var s=t.get("stackOrder");return e.indexOf(n,t)===-1?s<r&&s>=i:!1}),e.each(s,function(e){var t=e.get("stackOrder");e.set("stackOrder",t+1)}),t.set("stackOrder",i)}),i.trigger("changepoint","Move to Bottom")},moveUp:function(t){var n=e.sortBy(this.getBC().getActive(),function(e){return e.get("stackOrder")*-1}),r=this.getBC().maxStack(),s=!1,o=this;t&&t.preventDefault();if(this.active.length===0)return;s=e.some(n,function(e){return e.get("stackOrder")===r?!0:!1});if(s)return!1;e.each(n,function(e){var t=e.get("stackOrder"),n=t+1;o.getBC().findWhere({stackOrder:n}).set("stackOrder",t),e.set("stackOrder",n)}),i.trigger("changepoint","Move Up")},moveDown:function(t){var n=e.sortBy(this.getBC().getActive(),function(e){return e.get("stackOrder")}),r=0,s=!1,o=this;t&&t.preventDefault();if(this.active.length===0)return;s=e.some(n,function(e){return e.get("stackOrder")===r?!0:!1});if(s)return!1;e.each(n,function(e){var t=e.get("stackOrder"),n=t-1;o.getBC().findWhere({stackOrder:n}).set("stackOrder",t),e.set("stackOrder",n)}),i.trigger("changepoint","Move Down")},toggleGrid:function(){s.grid=!s.grid,s.grid?(n(".slide-int").addClass("grid"),i.trigger("grid:on")):(n(".slide-int").removeClass("grid"),i.trigger("grid:off"))},brickCut:function(e){e&&e.preventDefault();if(this.active.length===0)return;this.brickCopy(),this.delete()},brickCopy:function(t){t&&t.preventDefault();if(this.active.length===0)return;var i=this.clipboard=[],s=n();e.each(this.active,function(e){i.push(new r(e.attributes)),s=s.add(e.view.$el)}),this.$copyEls=s,this.copyBox=s.getBox(),this.$("#paste-selected").removeClass("inactive")},brickPaste:function(t){var n=this.clipboard?this.clipboard:[],o,u=s.activeSlide.model.bc,a=0;t&&t.preventDefault();if(n.length>0){u.updateAllBoxes(),u.deactivateAll();var f={top:window.scrollY+145,left:window.scrollX,bottom:window.scrollY+window.innerHeight,right:window.scrollX+window.innerWidth};this.copyBox.overlap(f)?a=!1:a=this.copyBox.left,i.trigger("placebrick",e.map(n,function(e){var t=new r(e.attributes),n=t.get("position");return t.set("position",{top:n.top+20,left:n.left+20}),t}),a),i.trigger("changepoint","Paste")}},"delete":function(t){var r=this.active;t&&t.preventDefault();if(this.active.length>0){var s=n();e.each(r,function(e){s=s.add(e.view.el)}),s.inViewPort({top:145})?(e.each(this.active,function(e){e.collection.remove(e)}),i.trigger("changepoint","Delete")):(window.scrollTo(0,s.getBox().top-175),e.each(r,function(e,t){e.view.$el.fadeOut(function(){e.collection.remove(e),t===r.length-1&&i.trigger("changepoint","Delete")})}))}},togglePreview:function(e){e&&e.preventDefault();if(n(".preview-hide").length>0)n("*").removeClass("preview-hide"),n(".page-container").removeClass("published"),n("#preview>p").text("Preview"),n(".top-controls-container").removeClass("preview-mode");else{var t=n(".slide-int").parents().add(".slide,.slide-int,.slide-int *,.top-controls-container,.top-controls-container *,.modal,.modal *");n("#preview>p").text("End Preview"),n("*").not(t).addClass("preview-hide"),n(".page-container").addClass("published"),n(".top-controls-container").addClass("preview-mode")}},save:function(e){window.config.DEMO||(this.changed||e)&&s.stack.save()},publish:function(){var e=this;this.cleanupPublished(),this.$publishModal.find(".publish-spin-wrap").removeClass("done").removeClass("problem").addClass("do-spin"),this.$publishModal.find(".publish-done").css({visibility:"hidden"}),this.$publishModal.find(".publish-nav").css({visibility:"hidden"}),this.$publishModal.modal("show"),s.stack.set("publish",!0),this.listenToOnce(i,"savecomplete",this.pubAfterSave),this.listenToOnce(i,"savefail",this.pubAfterFail),s.stack.save(!0),s.stack.set("publish",!1)},checkPublished:function(t){t=t||"null";var r="/api/v1/tasks/"+t+"/",s=2e3,o=3e4,u=new Date,a=!1,f=function(){n.ajax({url:r,method:"GET"}).done(function(t){var n=t.status;n==="SUCCESS"?(a=!0,e.delay(function(){i.trigger("publish:complete")},2e3)):n==="FAILURE"&&(a=!0,i.trigger("publish:fail"))}).always(function(){var t=new Date,n=t-u;!a&&n<=o?e.delay(f,s):n>o&&i.trigger("publish:fail")})};f()},cleanupPublished:function(){this.stopListening(i,"savecomplete",this.pubAfterSave),this.stopListening(i,"savefail",this.pubAfterFail)},revert:function(){s.stack.set(window.stack_json),s.stack.trigger("childupdate"),i.trigger("changepoint","Revert All Changes")}});return o}),define("app/models/template",["app/models/slide"],function(e){var t=e.extend({urlRoot:"/api/v1/slides/",initialize:function(){e.prototype.initialize.call(this),this.set("is_template",!0)},toJSON:function(){return Backbone.Model.prototype.toJSON.apply(this)}});return t}),define("app/jst/jst-tmp",[],function(){return this["jst-tmps"]=this["jst-tmps"]||{},this["jst-tmps"]["catview-jst"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<a href="#" class="clib-category"> <i class="icon-plus clib-plus-minus">&nbsp;</i>'+((__t=name)==null?"":__t)+'</a>\n<ul class="clib-list"></ul>';return __p},this["jst-tmps"].negspacer=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='\n<p class="info"></p>\n<div class="resizer"></div>';return __p},this["jst-tmps"]["slideview-tmp"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='\n<div class="slide-controls-wrapper">\n  <div class="controls left">\n    <h3 class="slide-count">#<span class="number">30</span></h3>\n  </div>\n  <div class="slide-int">\n    <div class="slide-resizer"></div>\n  </div>\n  <div class="controls dropdown pull-right">\n    <button title="Section settings" data-toggle="dropdown" class="settings dropdown-toggle"><svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="48px" height="48px" viewbox="0 0 48 48" enable-background="new 0 0 16 16" xml:space="preserve" fill="#000000" class="svg replaced-svg"> <path d="M 45.00,21.00l-3.00,0.00 c-0.105,0.00-0.192,0.051-0.297,0.06 c-0.456-2.769-1.527-5.316-3.093-7.506c 0.075-0.063, 0.168-0.087, 0.24-0.159l 2.121-2.121c 1.173-1.173, 1.173-3.069,0.00-4.242 s-3.072-1.173-4.245,0.00L 34.605,9.15c-0.069,0.069-0.096,0.165-0.159,0.24C 32.259,7.821, 29.709,6.753, 26.94,6.297 C 26.949,6.192, 27.00,6.105, 27.00,6.00L27.00,3.00 c0.00-1.656-1.341-3.00-3.00-3.00S 21.00,1.344, 21.00,3.00l0.00,3.00 c0.00,0.105, 0.051,0.192, 0.06,0.297 C 18.291,6.753, 15.741,7.821, 13.554,9.39C 13.491,9.315, 13.464,9.222, 13.395,9.15L 11.274,7.029c-1.173-1.173-3.072-1.173-4.245,0.00 c-1.17,1.173-1.17,3.069,0.00,4.242l 2.124,2.121C 9.222,13.464, 9.312,13.491, 9.39,13.554C 7.821,15.744, 6.753,18.291, 6.297,21.06 C 6.192,21.051, 6.105,21.00, 6.00,21.00L3.00,21.00 C 1.341,21.00,0.00,22.344,0.00,24.00s 1.341,3.00, 3.00,3.00l3.00,0.00 c 0.105,0.00, 0.192-0.048, 0.297-0.06 c 0.456,2.769, 1.527,5.316, 3.093,7.506c-0.075,0.063-0.168,0.087-0.237,0.159l-2.124,2.121c-1.17,1.173-1.17,3.072,0.00,4.242 c 1.173,1.173, 3.072,1.173, 4.245,0.00l 2.121-2.121c 0.069-0.069, 0.096-0.165, 0.159-0.24c 2.187,1.569, 4.737,2.637, 7.506,3.096 C 21.051,41.808, 21.00,41.895, 21.00,42.00l0.00,3.00 c0.00,1.659, 1.341,3.00, 3.00,3.00s 3.00-1.341, 3.00-3.00l0.00,-3.00 c0.00-0.105-0.051-0.192-0.06-0.297 c 2.769-0.459, 5.316-1.527, 7.506-3.096c 0.063,0.075, 0.087,0.171, 0.159,0.24l 2.121,2.121c 1.173,1.173, 3.072,1.173, 4.245,0.00 c 1.173-1.17, 1.173-3.069,0.00-4.242l-2.121-2.121c-0.072-0.069-0.165-0.093-0.24-0.159c 1.566-2.19, 2.637-4.737, 3.093-7.506 C 41.808,26.952, 41.895,27.00, 42.00,27.00l3.00,0.00 c 1.659,0.00, 3.00-1.344, 3.00-3.00S 46.659,21.00, 45.00,21.00z M 24.00,33.00c-4.971,0.00-9.00-4.032-9.00-9.00c0.00-4.971, 4.029-9.00, 9.00-9.00s 9.00,4.029, 9.00,9.00 C 33.00,28.968, 28.971,33.00, 24.00,33.00z"></path></svg>\n    </button>\n    <ul role="menu" aria-labelledby="dropdownMenu" class="dropdown-menu">\n      <li><a href="javascript:void(0)" class="change-color"> <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="48px" height="48px" viewbox="0 0 48 48" enable-background="new 0 0 16 16" xml:space="preserve" fill="#000000" class="svg replaced-svg"> <path d="M 24.00,48.00c-8.286,0.00-15.00-6.714-15.00-15.00S 24.00,0.00, 24.00,0.00s 15.00,24.714, 15.00,33.00S 32.286,48.00, 24.00,48.00z M 32.832,31.653C 32.058,35.832, 28.404,39.00, 24.00,39.00s-8.058-3.168-8.832-7.347C 15.066,32.154, 15.00,32.619, 15.00,33.00c0.00,4.971, 4.029,9.00, 9.00,9.00s 9.00-4.029, 9.00-9.00 C 33.00,32.619, 32.934,32.154, 32.832,31.653z"></path></svg>Background Color</a></li>\n      <li><a href="javascript:void(0)" class="change-image"> <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="48px" height="48px" viewbox="0 0 48 48" enable-background="new 0 0 16 16" xml:space="preserve" fill="#000000" class="svg replaced-svg"> <path d="M 19.407,33.093c-2.229,0.00-5.718-8.814-7.407-5.25 c-0.702,1.482-1.872,4.641-3.00,7.17L9.00,36.00 c0.00,1.659, 1.344,3.00, 3.00,3.00l24.00,0.00 c 1.659,0.00, 3.00-1.341, 3.00-3.00l0.00,-1.398 c-1.695-3.816-3.891-10.14-6.00-12.57 C 28.686,17.064, 23.532,33.093, 19.407,33.093z M 39.00,0.00L9.00,0.00 C 4.029,0.00,0.00,4.029,0.00,9.00l0.00,30.00 c0.00,4.968, 4.029,9.00, 9.00,9.00l30.00,0.00 c 4.968,0.00, 9.00-4.032, 9.00-9.00L48.00,9.00 C 48.00,4.029, 43.968,0.00, 39.00,0.00z M 42.00,39.00c0.00,1.659-1.341,3.00-3.00,3.00L9.00,42.00 c-1.656,0.00-3.00-1.341-3.00-3.00L6.00,9.00 c0.00-1.656, 1.344-3.00, 3.00-3.00l30.00,0.00 c 1.659,0.00, 3.00,1.344, 3.00,3.00L42.00,39.00 z M 13.50,18.00C 15.987,18.00, 18.00,15.987, 18.00,13.50S 15.987,9.00, 13.50,9.00S 9.00,11.013, 9.00,13.50S 11.013,18.00, 13.50,18.00z"></path></svg>Background Image</a></li>\n      <li><a href="javascript:void(0)" class="adv-background"><svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="48px" height="48px" viewbox="0 0 48 48" enable-background="new 0 0 16 16" xml:space="preserve" fill="#000000" class="svg replaced-svg"> <path d="M 45.363,32.634L 33.00,20.271L33.00,6.00 c 1.659,0.00, 3.00-1.344, 3.00-3.00s-1.341-3.00-3.00-3.00L15.00,0.00 C 13.344,0.00, 12.00,1.344, 12.00,3.00s 1.344,3.00, 3.00,3.00l0.00,14.271 l-12.366,12.363c-3.513,3.516-3.513,9.213,0.00,12.729C 4.392,47.121, 6.696,48.00, 9.00,48.00l30.00,0.00 c 2.304,0.00, 4.605-0.879, 6.363-2.637C 48.879,41.847, 48.879,36.15, 45.363,32.634z M 41.121,41.121C 40.356,41.886, 39.462,42.00, 39.00,42.00L9.00,42.00 c-0.465,0.00-1.356-0.114-2.124-0.879c-1.17-1.17-1.17-3.075,0.00-4.245L 21.00,22.758L21.00,6.00 l6.00,0.00 l0.00,16.758 l 14.121,14.118 C 41.886,37.641, 42.00,38.535, 42.00,38.997C 42.00,39.462, 41.886,40.356, 41.121,41.121zM 33.00,33.00 L 39.00,39.00 L 9.00,39.00 L 15.00,33.00 Z"></path></svg>Advanced Backgrounds</a></li>\n      <li class="divider bkg"></li>\n      <li><a href="javascript:void(0)" class="add-slide-above"><svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="48px" height="48px" viewbox="0 0 48 48" enable-background="new 0 0 16 16" xml:space="preserve" fill="#000000" class="svg replaced-svg"> <path d="M 9.00,24.00l30.00,0.00 L39.00,21.00 L9.00,21.00 L9.00,24.00 z M 9.00,18.00l30.00,0.00 L39.00,15.00 L9.00,15.00 L9.00,18.00 z M 39.00,0.00L9.00,0.00 C 4.029,0.00,0.00,4.029,0.00,9.00l0.00,30.00 c0.00,4.971, 4.029,9.00, 9.00,9.00l30.00,0.00 c 4.971,0.00, 9.00-4.029, 9.00-9.00L48.00,9.00 C 48.00,4.029, 43.971,0.00, 39.00,0.00z M 42.00,39.00c0.00,1.659-1.341,3.00-3.00,3.00L9.00,42.00 c-1.656,0.00-3.00-1.341-3.00-3.00L6.00,9.00 c0.00-1.656, 1.344-3.00, 3.00-3.00l30.00,0.00 c 1.659,0.00, 3.00,1.344, 3.00,3.00L42.00,39.00 z M 9.00,12.00l30.00,0.00 L39.00,9.00 L9.00,9.00 L9.00,12.00 z M 26.121,27.882C 25.536,27.297, 24.768,27.00, 24.00,27.00S 22.464,27.297, 21.879,27.882 l-6.00,6.00c-0.855,0.855-1.113,2.142-0.651,3.267C 15.69,38.271, 16.788,39.00, 18.00,39.00l12.00,0.00 c 1.212,0.00, 2.31-0.729, 2.772-1.851 c 0.462-1.119, 0.207-2.415-0.651-3.27L 26.121,27.882z"></path></svg>Add Section Above</a></li>\n      <li><a href="javascript:void(0)" class="add-slide-below"><svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="48px" height="48px" viewbox="0 0 48 48" enable-background="new 0 0 16 16" xml:space="preserve" fill="#000000" class="svg replaced-svg"> <path d="M 9.00,21.00L 39.00,21.00L 39.00,24.00L 9.00,24.00zM 9.00,15.00L 39.00,15.00L 39.00,18.00L 9.00,18.00zM 39.00,0.00L9.00,0.00 C 4.029,0.00,0.00,4.029,0.00,9.00l0.00,30.00 c0.00,4.971, 4.029,9.00, 9.00,9.00l30.00,0.00 c 4.971,0.00, 9.00-4.029, 9.00-9.00L48.00,9.00 C 48.00,4.029, 43.971,0.00, 39.00,0.00z M 42.00,39.00c0.00,1.659-1.341,3.00-3.00,3.00L9.00,42.00 c-1.656,0.00-3.00-1.341-3.00-3.00L6.00,9.00 c0.00-1.656, 1.344-3.00, 3.00-3.00l30.00,0.00 c 1.659,0.00, 3.00,1.344, 3.00,3.00L42.00,39.00 zM 9.00,9.00L 39.00,9.00L 39.00,12.00L 9.00,12.00zM 30.00,27.00 C 31.212,27.00 32.31,27.729 32.772,28.851 C 33.234,29.976 32.976,31.263 32.121,32.118 L 26.121,38.118 C 25.536,38.703 24.768,39.00 24.00,39.00 C 23.232,39.00 22.464,38.703 21.879,38.118 L 15.879,32.121 C 15.021,31.266 14.766,29.97 15.228,28.851 C 15.69,27.729 16.788,27.00 18.00,27.00 L 30.00,27.00 Z"></path></svg>Add Section Below</a></li>\n      <li><a href="javascript:void(0)" class="copy-slide"><svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="48px" height="48px" viewbox="0 0 48 48" enable-background="new 0 0 16 16" xml:space="preserve" fill="#000000" class="svg replaced-svg"> <path d="M 45.00,48.00L15.00,48.00 c-1.659,0.00-3.00-1.341-3.00-3.00l0.00,-9.00 L3.00,36.00 c-1.659,0.00-3.00-1.341-3.00-3.00L0.00,3.00 c0.00-1.659, 1.341-3.00, 3.00-3.00l30.00,0.00 c 1.659,0.00, 3.00,1.341, 3.00,3.00l0.00,9.00 l9.00,0.00 c 1.659,0.00, 3.00,1.341, 3.00,3.00l0.00,30.00 C 48.00,46.659, 46.659,48.00, 45.00,48.00z M 42.00,18.00L18.00,18.00 l0.00,24.00 l24.00,0.00 L42.00,18.00 z"></path></svg>Duplicate Section</a></li>\n      <li class="divider add"></li>\n      <li><a href="javascript:void(0)" class="move-slide-up"><svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="48px" height="48px" viewbox="0 0 48 48" enable-background="new 0 0 16 16" xml:space="preserve" fill="#000000" class="svg replaced-svg"> <path d="M 39.00,48.00l-6.00,0.00 l0.00,-6.00 l6.00,0.00 c 1.659,0.00, 3.00-1.341, 3.00-3.00L42.00,12.00 L6.00,12.00 l0.00,27.00 c0.00,1.659, 1.341,3.00, 3.00,3.00l6.00,0.00 l0.00,6.00 L9.00,48.00 c-4.971,0.00-9.00-4.032-9.00-9.00L0.00,9.00 c0.00-4.971, 4.029-9.00, 9.00-9.00l30.00,0.00 c 4.971,0.00, 9.00,4.029, 9.00,9.00l0.00,30.00 C 48.00,43.968, 43.971,48.00, 39.00,48.00z M 9.00,3.00C 7.341,3.00, 6.00,4.344, 6.00,6.00 s 1.341,3.00, 3.00,3.00s 3.00-1.344, 3.00-3.00S 10.659,3.00, 9.00,3.00z M 21.879,24.876C 22.464,24.291, 23.232,23.997, 24.00,23.997s 1.536,0.294, 2.121,0.879l 6.00,6.00 c 0.855,0.858, 1.113,2.148, 0.651,3.273C 32.31,35.268, 31.212,36.00, 30.00,36.00L27.00,36.00 l0.00,9.00 c0.00,1.659-1.341,3.00-3.00,3.00c-1.656,0.00-3.00-1.341-3.00-3.00l0.00,-9.00 L18.00,36.00 c-1.212,0.00-2.31-0.732-2.772-1.851c-0.462-1.122-0.207-2.415, 0.651-3.273L 21.879,24.876z"></path></svg>Move Section Up</a></li>\n      <li><a href="javascript:void(0)" class="move-slide-down"> <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="48px" height="48px" viewbox="0 0 48 48" enable-background="new 0 0 16 16" xml:space="preserve" fill="#000000" class="svg replaced-svg"> <path d="M 48.00,38.994c0.00,4.971-4.029,9.00-9.00,9.00l-5.268,0.00 l 2.64-2.64 c 0.966-0.972, 1.68-2.124, 2.115-3.36L39.00,41.994 c 1.659,0.00, 3.00-1.341, 3.00-3.00L42.00,11.997 L6.00,11.997 l0.00,26.997 c0.00,1.659, 1.344,3.00, 3.00,3.00l0.51,0.00 c 0.438,1.242, 1.152,2.397, 2.124,3.369l 2.634,2.631L9.00,47.994 c-4.971,0.00-9.00-4.029-9.00-9.00L0.00,8.997 c0.00-4.971, 4.029-9.00, 9.00-9.00l30.00,0.00 c 4.971,0.00, 9.00,4.029, 9.00,9.00L48.00,38.994 z M 9.00,2.997c-1.656,0.00-3.00,1.344-3.00,3.00s 1.344,3.00, 3.00,3.00s 3.00-1.344, 3.00-3.00S 10.656,2.997, 9.00,2.997z M 18.00,35.994l3.00,0.00 L21.00,26.997 c0.00-1.659, 1.344-3.00, 3.00-3.00 c 1.659,0.00, 3.00,1.341, 3.00,3.00l0.00,8.997 l3.00,0.00 c 1.212,0.00, 2.31,0.732, 2.772,1.854c 0.462,1.125, 0.204,2.415-0.651,3.27l-6.00,6.00C 25.536,47.703, 24.768,48.00, 24.00,48.00 s-1.536-0.297-2.121-0.882l-6.00-6.00c-0.858-0.855-1.113-2.151-0.651-3.27C 15.69,36.726, 16.788,35.994, 18.00,35.994z"></path></svg>Move Section Down</a></li>\n      <li class="divider move"></li>\n      <li><a href="javascript:void(0)" class="save-template"><svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="48px" height="48px" viewbox="0 0 48 48" enable-background="new 0 0 16 16" xml:space="preserve" fill="#000000" class="svg replaced-svg"> <path d="M 42.00,27.00l6.00,0.00 l0.00,6.00 l-6.00,0.00 L42.00,27.00 z M 42.00,15.00l6.00,0.00 l0.00,6.00 l-6.00,0.00 L42.00,15.00 z M 39.00,6.00L39.00,0.00 c 4.971,0.00, 9.00,4.029, 9.00,9.00l-6.00,0.00 C 42.00,7.344, 40.659,6.00, 39.00,6.00z M 33.00,27.00L27.00,27.00 l0.00,6.00 c0.00,1.659-1.341,3.00-3.00,3.00c-1.656,0.00-3.00-1.341-3.00-3.00L21.00,27.00 L15.00,27.00 C 13.344,27.00, 12.00,25.659, 12.00,24.00c0.00-1.656, 1.344-3.00, 3.00-3.00l6.00,0.00 L21.00,15.00 c0.00-1.656, 1.344-3.00, 3.00-3.00c 1.659,0.00, 3.00,1.344, 3.00,3.00l0.00,6.00 l6.00,0.00 c 1.659,0.00, 3.00,1.344, 3.00,3.00C 36.00,25.659, 34.659,27.00, 33.00,27.00z M 27.00,0.00l6.00,0.00 l0.00,6.00 L27.00,6.00 L27.00,0.00 z M 15.00,0.00l6.00,0.00 l0.00,6.00 L15.00,6.00 L15.00,0.00 z M0.00,39.00l6.00,0.00 c0.00,1.659, 1.344,3.00, 3.00,3.00l0.00,6.00 C 4.029,48.00,0.00,43.971,0.00,39.00z M 6.00,9.00L0.00,9.00 c0.00-4.971, 4.029-9.00, 9.00-9.00l0.00,6.00 C 7.344,6.00, 6.00,7.344, 6.00,9.00z M 6.00,21.00L0.00,21.00 L0.00,15.00 l6.00,0.00 L6.00,21.00 z M 6.00,33.00L0.00,33.00 L0.00,27.00 l6.00,0.00 L6.00,33.00 z M 21.00,48.00L15.00,48.00 l0.00,-6.00 l6.00,0.00 L21.00,48.00 z M 33.00,48.00L27.00,48.00 l0.00,-6.00 l6.00,0.00 L33.00,48.00 z M 42.00,39.00l6.00,0.00 c0.00,4.971-4.029,9.00-9.00,9.00l0.00,-6.00 C 40.659,42.00, 42.00,40.659, 42.00,39.00z"></path></svg>Save as Template</a></li>\n      <li><a href="javascript:void(0)" class="delete-slide"><svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="48px" height="48px" viewbox="0 0 48 48" enable-background="new 0 0 16 16" xml:space="preserve" fill="#000000" class="svg replaced-svg"> <path d="M 42.00,15.00l0.00,24.00 c0.00,4.971-4.032,9.00-9.00,9.00L15.00,48.00 c-4.971,0.00-9.00-4.029-9.00-9.00L6.00,15.00 C 4.344,15.00, 3.00,13.659, 3.00,12.00 s 1.344-3.00, 3.00-3.00l9.00,0.00 l0.00,0.00c0.00-4.971, 4.029-9.00, 9.00-9.00c 4.968,0.00, 9.00,4.029, 9.00,9.00l0.00,0.00l9.00,0.00 c 1.659,0.00, 3.00,1.341, 3.00,3.00S 43.659,15.00, 42.00,15.00z M 24.00,6.00C 22.344,6.00, 21.00,7.341, 21.00,9.00l6.00,0.00 C 27.00,7.341, 25.659,6.00, 24.00,6.00z M 12.00,15.00l0.00,24.00 c0.00,1.659, 1.344,3.00, 3.00,3.00l18.00,0.00 c 1.659,0.00, 3.00-1.341, 3.00-3.00L36.00,15.00 L12.00,15.00 z M 28.50,36.00C 27.675,36.00, 27.00,35.328, 27.00,34.50l0.00,-12.00 C 27.00,21.672, 27.675,21.00, 28.50,21.00C 29.328,21.00, 30.00,21.672, 30.00,22.50l0.00,12.00 C 30.00,35.328, 29.328,36.00, 28.50,36.00z M 19.50,36.00C 18.672,36.00, 18.00,35.328, 18.00,34.50l0.00,-12.00 C 18.00,21.672, 18.672,21.00, 19.50,21.00C 20.328,21.00, 21.00,21.672, 21.00,22.50l0.00,12.00 C 21.00,35.328, 20.328,36.00, 19.50,36.00z"></path></svg>Delete Section</a></li>\n    </ul>\n  </div>\n  <div class="controls bottom">\n    <button title="Resize Section" class="resize-slide"><i class="icon-sort"></i></button>\n  </div>\n</div>';return __p},this["jst-tmps"].templatepickerjst=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='\n<div class="picker-outer">\n  <div class="picker-int">\n    <div class="selector-row">\n      <div data-toggle="buttons-radio" class="btn-group">\n        <button id="templates-btn" class="btn active btn-primary">Templates</button>\n        <button id="your-slides-btn" class="btn btn-inverse">Your Sections</button>\n      </div>\n    </div>\n    <div class="picker-row"></div>\n    <div class="picker-row"></div>\n  </div>\n</div>';return __p},this["jst-tmps"].textbar=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='\n<div data-role="editor-toolbar" data-target=".slide-int" class="text-controls">\n  <div class="style-group">\n    <h6>Font Family</h6>\n    <div class="btn-group">\n      <button class="btn btn-inverse current-font">Open Sans</button>\n      <button data-toggle="dropdown" class="btn btn-inverse dropdown-toggle"><span class="caret"> </span></button>\n      <ul class="dropdown-menu font-selector">\n        <li><a href="#">Open Sans</a></li>\n        <li class="divider"></li>\n        <li><a href="#">Gotham</a></li>\n        <li><a href="#">Helvetica</a></li>\n        <li><a href="#">Times New Roman</a></li>\n        <li><a href="#">Courier New</a></li>\n      </ul>\n    </div>\n  </div>\n  <div class="style-group">\n    <h6>Font Styles</h6>\n    <div class="btn-group">\n      <button data-edit="bold" class="btn"><i class="icon-bold"></i></button>\n      <button data-edit="italic" class="btn"><i class="icon-italic"></i></button>\n      <button data-edit="underline" class="btn"><i class="icon-underline"></i></button>\n      <button data-edit="strikethrough" class="btn"><i class="icon-strikethrough"></i></button>\n    </div>\n  </div>\n  <div class="style-group">\n    <h6>Font Size</h6>\n    <div class="btn-group font-size">\n      <button title="Increase Font Size" data-edit="font-up" class="btn"><i class="icon-plus"></i></button>\n      <button title="Descrease Font Size" data-edit="font-down" class="btn"><i class="icon-minus"></i></button>\n      <button title="Restore Font Size" data-edit="font-reset" class="btn"><i class="icon-repeat"></i></button>\n    </div>\n  </div>\n  <div class="style-group">\n    <h6>Alignment</h6>\n    <div class="btn-group">\n      <button data-edit="justifyleft" class="btn"><i class="icon-align-left"></i></button>\n      <button data-edit="justifycenter" class="btn"><i class="icon-align-center"></i></button>\n      <button data-edit="justifyright" class="btn"><i class="icon-align-right"></i></button>\n      <button data-edit="justifyfull" class="btn"><i class="icon-align-justify"></i></button>\n    </div>\n  </div>\n  <div class="style-group">\n    <h6>Color</h6>\n    <div class="btn-group">\n      <button data-color="rgb(0,0,0)" class="btn text-color-picker"><i class="icon-pencil"></i></button>\n    </div>\n  </div>\n</div>';return __p},this["jst-tmps"]}),define("app/loadtemplate",["underscore","app/jst/jst-tmp"],function(e,t){var n=function(n,r){return r=r?r:{},e.extend(r,window.config),t[n](r)};return n}),define("app/views/groupedit",["underscore","backbone","jquery","app/wigevents","app/appview","snaps"],function(e,t,n,r,i){var s=t.View.extend({tagName:"div",className:"all-of-the-bricks highlighted dznly-remove",events:{"mousedown .handle":"startResize"},initialize:function(){i=require("app/appview"),this.bricks=[]},render:function(){var e='<div class="dznly-remove" style="position: static; display: block;"><div class="handle N"></div><div class="handle NW"></div><div class="handle NE"></div><div class="handle S"></div><div class="handle SE"></div><div class="handle SW"></div><div class="handle E"></div><div class="handle W"></div>';return this.$el.html(e),this.on("groupbox:update",function(){this.bricks.length>0&&this.updateBox(this.bricks)}),this},updateBox:function(t){this.bricks=t;var n=-99999,r=-99999,i=99999,s=99999;e.each(t,function(e){var t=e.view.$el;i=t.top()<i?t.top():i,n=t.bottom()>n?t.bottom():n,r=t.right()>r?t.right():r,s=t.left()<s?t.left():s});var o=n-i,u=r-s;this.$el.css({height:o,width:u,top:i,left:s}),this.top=i,this.left=s},startDrag:function(t){e.each(this.bricks,function(e){e.updateBox()}),this.updateBox(this.bricks),this.posBricks=e.map(this.bricks,function(e){return{pb:e,pos:e.get("position")}}),this.$el.wigSnap({mode:"start",event:t,grid:i.grid,slide:this.slide,sel:".brick-full"})},moveBy:function(t){this.$el.css({top:this.top+t.y,left:this.left+t.x}),this.$el.wigSnap({mode:"snap",event:t.evt});var n=this.$el.left()-this.left,r=this.$el.top()-this.top;e.each(this.posBricks,function(e){var t=e.pb,i=e.pos;t.view.$el.css({left:i.left+n,top:i.top+r})})},moveGroupTo:function(t){this.updateBox(this.bricks),this.$el.css({top:t.y,left:t.x});var n=this.$el.top()-this.top,r=this.$el.left()-this.left;e.each(this.bricks,function(e){e.view.$el.css({left:e.get("position").left+r,top:e.get("position").top+n}),e.updateBox()}),this.updateBox(this.bricks)},endDrag:function(e){this.$el.wigSnap({mode:"stop",event:e}),this.updateBox(this.bricks)},startResize:function(t){function d(t){n(window).off("mousemove",moveHandler).off("mouseup",d),u.wigResizeSnap({mode:"stop",event:t}),e.each(a,function(e){e.updateBox()}),r.trigger("activechange",a),r.trigger("changepoint","Resize")}t.preventDefault(),t.stopPropagation();var s=this,o=this.bricks.length===1&&this.bricks[0].get("category")==="Image",u=this.$el,a=this.bricks;e.each(a,function(t){t.updateBox(),t.view.$content.css("background-size")==="auto"&&t.view.$content.css("background-size",t.view.$content.width()+"px "+t.view.$content.height()+"px"),t.view.$content.css("background-size")!="cover"&&(t.set("bgXPos",parseInt(t.view.$content.css("background-position").split(" ")[0],10)),t.set("bgYPos",parseInt(t.view.$content.css("background-position").split(" ")[1],10)),t.set("bgW",parseInt(e.first(t.view.$content.css("background-size").split(" ")),10)),t.set("bgH",parseInt(e.last(t.view.$content.css("background-size").split(" ")),10)))});var f=e.map(a,function(t){return{pb:t,pos:e.clone(t.get("position"))}}),l={x:t.pageX,y:t.pageY,boxX:this.$el.position().left,boxY:this.$el.position().top,boxW:this.$el.width(),boxH:this.$el.height()},c=n(t.target);u.wigResizeSnap({mode:"start",slide:i.activeSlide.$slideInt,grid:i.grid,sel:".brick-full",aspectFixed:o,handle:c,event:t});var h=function(e,t,n,r,i){s=e.view.$content;var o=r/t,u=i/n;s.css("background-size",parseInt(o*e.get("bgW"))+"px "+parseInt(u*e.get("bgH"))+"px"),s.css("background-position",parseInt(e.get("bgXPos")*o)+"px "+parseInt(e.get("bgYPos")*u)+"px")},p=function(t){var n=t.pageX-l.x,r=t.pageY-l.y,i=l.boxW,s=l.boxH;t.preventDefault(),t.stopPropagation();if(c.hasClass("SW")||c.hasClass("S")||c.hasClass("SE"))s=l.boxH+r,u.css({height:s,width:i});if(c.hasClass("NE")||c.hasClass("E")||c.hasClass("SE"))i=l.boxW+n,u.css({width:i,height:s});if(c.hasClass("N")||c.hasClass("NE")||c.hasClass("NW")){var o=l.boxY+r;s=l.boxH-r,u.css({top:o,height:s,width:i})}if(c.hasClass("W")||c.hasClass("SW")||c.hasClass("NW")){var a=l.boxX+n;i=l.boxW-n,u.css({left:a,width:i,height:s})}u.wigResizeSnap({mode:"snap",event:t});var p=u.height()/2/(l.boxH/2),d=u.width()/2/(l.boxW/2);e.each(f,function(e){var t=e.pb,n=e.pos,r=n.width,i=n.height;t.view.$el.css("top",Math.round((n.top-l.boxY)*p)+u.top()),t.view.$el.css("height",Math.round(n.height*p)),t.view.$content.css("height",Math.round(n.height*p)),t.view.$el.css("left",Math.round((n.left-l.boxX)*d)+u.left()),t.view.$el.css("width",Math.round(n.width*d)),t.view.$content.css("width",Math.round(n.width*d));var s=t.view.$el.width(),o=t.view.$el.height();t.view.$content.css("background-size")!="cover"&&h(t,r,i,s,o)})};moveHandler=function(e,t){p(e)},n(window).mousemove(moveHandler).mouseup(d)}});return s}),define("app/views/negspace",["underscore","backbone","jquery","app/loadtemplate","jqbox"],function(e,t,n,r){var i=t.Model.extend({defaults:{top:0,height:0,last:!1},idAttribute:"top"}),s=t.View.extend({tagName:"div",className:"negative-spacer",events:{"mousedown .resizer":"startResize",mouseenter:"displayAcross",mouseleave:"stopAcross"},initialize:function(){this.resizing=!1,this.active=!1},render:function(){var e=this;this.$el.html(r("negspacer")),this.$resizer=this.$(".resizer"),this.$info=this.$(".info");var t=function(){e.$el.css({top:e.model.get("top"),height:e.model.get("height")})};return this.listenTo(this.model,"change",t),t(),this.listenTo(this.model.collection,"spacer:resize",function(e,t){var n=this.model.get("top");n>e.get("top")&&this.model.set("top",n+t)}),this},place:function(e){this.$el.css({top:e.top,height:e.height})},activate:function(){this.active=!0,this.$el.addClass("active"),this.displayAcross()},deactivate:function(){this.active=!1,this.$el.removeClass("active"),this.stopAcross()},displayAcross:function(){this.$el.css({width:n(document).width()})},stopAcross:function(){this.resizing||this.$el.css({width:""})},activeToggle:function(){this.active?this.deactivate():this.activate()},startResize:function(e){e.preventDefault(),e.stopPropagation();var t=this,r={y:e.pageY,height:this.model.get("height")};this.displayAcross(),this.resizing=!0,this.$el.wigResizeSnap({mode:"start",slide:this.$el.parent(),sel:".negative-spacer",grid:!1,aspectFixed:!1,handle:n("<div/>").addClass("S"),event:e}),this.model.trigger("spacer:resizestart",this.model);var i=function(e){e.stopPropagation(),e.preventDefault();var n=e.pageY-r.y,i=r.height,s=i+n;s=s>2?s:2,t.$el.css({height:s});var o=t.$el.css("width");t.$el.wigResizeSnap({mode:"snap",event:e,matchClass:"snap-match",skipLines:!0,exclude:"x",sizeOnly:!0,ignoreSlide:!0}),t.$el.css("width",o);var u=t.$el.height(),a=u-t.model.get("height");t.model.set("height",u),t.model.trigger("spacer:resize",t.model,a)},s=function(e){e.preventDefault(),e.stopPropagation(),t.$el.wigResizeSnap({mode:"stop",event:e,matchClass:"snap-match"}),t.model.trigger("spacer:resizeend"),n(window).off("mousemove",i).off("mouseup",s),t.resizing=!1,t.stopAcross()};n(window).on("mousemove",i).on("mouseup",s)}}),o=t.Collection.extend({model:i,comparator:"top"}),u=t.View.extend({tagName:"div",className:"negative-wrapper",initialize:function(){this.spacers=new o,this.shown=!1},render:function(){return this.hide(),this.listenTo(this.spacers,"add",function(e){e.view=new s({model:e}),e.view.render(),this.$el.append(e.view.el)}),this.listenTo(this.spacers,"spacer:resizestart",function(){this.$el.css("pointer-events","auto")}),this.listenTo(this.spacers,"spacer:resizeend",function(){this.$el.css("pointer-events","")}),this.listenTo(this.spacers,"remove",function(e){e.view.remove()}),this},setPos:function(e){this.$el.css({width:e})},getSpaces:function(t,n){var r=[],i=[];t.forEach(function(e){var t=e.get("category"),n;n=e.get("position");var i=new Box(n.top,0,n.height+1,n.width);r.push(i)}),r=e.sortBy(r,"top");var s=new Box(0,0,0,10);return e.each(r,function(e){e.overlap(s)?s=s.surround(e):(i.push(new Box(s.bottom,0,e.top-s.bottom,0)),s=e)}),s.bottom<n.get("height")&&i.push(new Box(s.bottom,-1,n.get("height")-s.bottom,0)),i},update:function(t,n){var r=e.map(this.getSpaces(t,n),function(t){return e.pick(t,"top","height")});this.spacers.set(r)},show:function(){this.$el.show(),this.shown=!0},hide:function(){this.$el.hide(),this.shown=!1}});return u}),define("app/models/stylegroup",["underscore","backbone","jquery"],function(e,t,n){var r=t.Model.extend({defaults:{prop:"",value:"",query:"",qp_id:""},idAttribute:"qp_id",initialize:function(){this.set("qp_id",this.get("query")+this.get("prop"))},print:function(){return this.get("prop")+":"+this.get("value")+";"}}),i=t.Collection.extend({model:r,print:function(e){return e=e||"",this.reduce(function(t,n){return n.get("query")!==e?t:t+n.print()},"")}}),s=t.Model.extend({defaults:function(){return{selector:"",properties:!1}},initialize:function(e,t){this.props=new i,this.query="",this.disableAuto=!!t.disableAuto,this.ignore=[];if(t.$el){this.$el=t.$el;var n=this.$el.attr("id");n&&this.set("selector","#"+n)}var r=this.get("properties");r&&this.props.set(r),this.on("change:properties",function(e,t){this.props.set(t)})},setQuery:function(e){this.query=e},addStyle:function(e,t){this.props.add({prop:e,value:t,query:this.query},{merge:!0})},readStyle:function(t){var r=[],i=this,s=this.query===""?!1:!0;if(t){var o=t.split(";");e.last(o)===""&&o.pop(),e.forEach(o,function(t){var o=t.split(":"),u=o.slice(1).join(":"),a={prop:n.trim(o[0]),value:u,query:i.query};if(a.prop==="background-image"&&i.$el&&i.$el.css("background-size")==="cover"){var f=u||"";f=f.replace("url(","").replace(/'/g,"").replace(/\)$/,""),r.push({query:i.query,prop:"-ms-filter",value:"\"progid:DXImageTransform.Microsoft.AlphaImageLoader( src='"+f+"', sizingMethod='scale')\""})}var l=!0;if(s){var c=i.props.get(a.prop);c&&c.get("value")===a.value&&(l=!1)}else{var h=i.props.get(a.prop);if(h){var p=h.get("value");if(p!==a.value){var d=e.reject(e.unique(i.props.pluck("query")),function(e){return e===""}),v=e.map(d,function(e){return{query:e,prop:a.prop,value:p}});i.props.add(v)}}}l&&r.push(a)})}this.props.remove(this.props.where({query:this.query})),this.props.set(r,{remove:!1})},fetchStyle:function(){this.disableAuto||this.readStyle(this.$el.attr("style"))},replaceStyle:function(t){t=t||this.query;var n=this.props.where({query:t}),r=e.reduce(n,function(e,t){return e[t.get("prop")]=t.get("value"),e},{});t===""&&this.$el.removeAttr("style"),this.$el.css(r)},revert:function(){this.props.remove(this.props.reject(function(e){return e.get("query")===""}))},print:function(){return this.get("selector")+"{"+this.props.print("")+"}"},toJSON:function(){var e=t.Model.prototype.toJSON.apply(this);return e.properties=this.props.toJSON(),e}});return s}),define("app/views/slideview",["underscore","backbone","jquery","app/views/brickfull","app/models/template","app/wigevents","app/loadtemplate","app/views/groupedit","app/views/negspace","app/models/stylegroup","filepicker"],function(e,t,n,r,i,s,o,u,a,f,l){var c,h=e.debounce(function(e){s.trigger("changepoint",e)},700),p=t.View.extend({tagName:"div",className:"slide",events:{click:function(e){e.preventDefault(),this.$slideInt.is(e.target)&&(this.isActive||this.activate(),this.model.bc.deactivateAll())},"click .change-color":function(e){var t=this;e.stopPropagation(),s.trigger("pickcolor",n(e.target),"absolute",this.$el.css("background-color")),s.on("colorpicked",function(e){t.$el.css({"background-color":e,"background-image":""}),t.model.set("slide_style",t.$el.attr("style")),h("Change Section Color")})},"click .change-image":function(e){var t=this;l.pickAndStore({mimetype:"image/*",multiple:!1},{location:"S3",access:"public"},function(e){var n=window.config.UPLOADS_URL+window.encodeURIComponent(e[0].key);t.$el.css({"background-color":"","background-image":'url("'+n+'")'}),t.model.set("slide_style",t.$el.attr("style")),s.trigger("changepoint","Change Section Image")})},"click .adv-background":function(){s.trigger("bkg:settings",this.model)},"click .delete-slide":"deleteSlide","click .save-template":function(e){this.saveAsTemplate()},"click .move-slide-up":function(e){this.model.orderUp(),this.model.collection.trigger("render:now"),s.trigger("changepoint","Move Section Up")},"click .move-slide-down":function(e){this.model.orderDown(),this.model.collection.trigger("render:now"),s.trigger("changepoint","Move Section Down")},"click .add-slide-above":function(e){e.preventDefault(),e.stopPropagation(),this.addSlide("above")},"click .add-slide-below":function(e){e.preventDefault(),e.stopPropagation(),this.addSlide("below")},"click .copy-slide":function(e){this.copySlide()},"mousedown .resize-slide":function(e){function o(e){e.preventDefault();var n=e.pageX-t.x,i=e.pageY-t.y;r.$slideInt.css({height:t.height+i});var s=-1*i;s=s<0?0:s,s+="px",r.$el.css({"margin-bottom":s,height:t.height+i})}function u(e){r.$(".slide-resizer").hide(),n(window).off("mousemove",o).off("mouseup",u),r.model.set("height",r.$slideInt.height()),r.$el.css({"margin-bottom":"",height:""}),n(".controls.right").css({"pointer-events":""}),r.adjustResizer(),s.trigger("changepoint","Resize Slide")}e.preventDefault(),e.stopPropagation();var t={x:e.pageX,y:e.pageY,height:this.$slideInt.height()},r=this;n(window).on("mousemove",o).on("mouseup",u);var i=r.$el.css("margin-bottom");this.$(".slide-resizer").show(),n(".controls.right").css({"pointer-events":"none"})},mousedown:function(t){function c(t){t.preventDefault();var n=t.pageX,r=t.pageY,i={width:Math.abs(n-f.x),height:Math.abs(r-f.y),left:f.x<n?f.x:n,top:f.y<r?f.y:r};a=(new Box(i.top,i.left,i.height,i.width)).relativeTo(o),l(f,{x:n,y:r}),e.each(s,function(e){var t=e.box.overlap(a);t&&!e.pb.view.active?e.pb.view.activate(!0):!t&&e.pb.view.active&&e.pb.view.deactivate()})}function h(e){n(window).off("mousemove",c(e)).off("mouseup",h),n("#select-box").remove()}t.preventDefault(),t.stopPropagation();var r=[],i=this,s,o=i.$slideInt.getBox();t.metaKey||t.shiftKey?r=e.clone(this.model.bc.getActive()):this.model.bc.deactivateAll(),s=e.reject(i.model.bc.getBoxes(),function(t){return e.indexOf(r,t.pb)>-1});var u=n('<div id="select-box" style="z-index:99999; background-color: rgba(0,0,0,0.05); border: 1px solid #CCC; position: absolute;"></div>');n("body").append(u);var a=u.getBox(),f={x:t.pageX,y:t.pageY},l=function(e,t){u.css({width:Math.abs(t.x-e.x),height:Math.abs(t.y-e.y),left:e.x<t.x?e.x:t.x,top:e.y<t.y?e.y:t.y})};n(window).on("mousemove",c).on("mouseup",h)}},initialize:function(){this.appView=require("app/appview");var e=this;this.isActive=!1,this.normalEvents=!0,this.listenTo(this.model,"updownenable",function(e){this.$slideUp.addClass("disabled"),this.$slideDown.addClass("disabled"),e.match("U")&&this.$slideUp.removeClass("disabled"),e.match("D")&&this.$slideDown.removeClass("disabled")}),this.listenTo(this.model.bc,"activechange",function(e){!this.isActive&&e.length>0&&this.activate(),this.isActive&&s.trigger("activechange",e)});var t=function(){s.trigger("pagedragenter",e)},n=function(){s.trigger("pagedragleave",e)};this.listenTo(s,"pagedragstart",function(e){this.$el.on("mouseenter",t),this.$el.on("mouseleave",n)}),this.listenTo(s,"pagedragend",function(){this.$el.off("mouseenter",t),this.$el.off("mouseleave",n),this.isActive||this.$slideInt.css({overflow:"hidden"})})},brickDrop:function(t){var n=this;if(t.length>0)if(t[0].collection)t[0].collection!==this.model.bc&&(t[0].collection.deactivateAll(),e.each(t,function(e){e.view.$el.css(e.view.$el.getBox().relativeTo(n.$slideInt.getBox()).justBox()),e.collection.remove(e),n.model.bc.addAndOrder(e),e.view.activate(!0)}));else{var r=t[0].get("position"),i=new Box(r.top,r.left,r.height,r.width),s=t[0],o=i.relativeTo(n.$slideInt.getBox());s.set("position",{top:o.top,left:o.left,right:o.right,bottom:o.bottom,height:o.height,width:o.width}),n.model.bc.addAndOrder(s),s.view.activate(!1),s.updateBox()}},adjustResizer:function(){var e=this.$slideInt.height(),t=this.$(".controls.bottom button");e<108?t.parent().addClass("side-step"):t.parent().removeClass("side-step")},render:function(){var t=this,i=this.model.bc;this.$el.append(o("slideview-tmp")).attr("style",this.model.get("slide_style"));var l=this.model.get("id");this.$name=this.$(".slide-count"),l?this.$el.attr("id","section-"+l):this.listenToOnce(this.model,"change:id",function(e,t){this.$el.attr("id","section-"+t)}),this.$slideInt=this.$(".slide-int").css({height:this.model.get("height")}),this.adjustResizer(),this.$num=this.$(".slide-count .number"),this.listenTo(s,"showslidenums",function(){this.$name.show()}),this.listenTo(s,"hideslidenums",function(){this.$name.hide()}),this.listenTo(this.model.collection,"render:now",function(){this.$num.text(this.model.collection.indexOf(this.model)+1)}),this.groupEdit=new u,this.groupEdit.render(),this.$slideInt.append(this.groupEdit.el),this.groupEdit.$el.hide(),this.appView.grid&&this.$slideInt.addClass("grid"),this.groupEdit.listenTo(this.model.bc,"activechange keyboardmove",function(e){e.length===0?(this.$el.hide(),this.bricks=[]):(this.$el.show(),this.bricks=e,this.updateBox(e))}),this.groupEdit.listenTo(this.model.bc,"startdrag",function(e){this.startDrag(e)}),this.groupEdit.listenTo(this.model.bc,"moveby",function(e){this.moveBy(e)}),this.groupEdit.listenTo(this.model.bc,"enddrag",function(e){this.endDrag(e)}),this.groupEdit.listenTo(this.model.bc,"movegroup",function(e,t){this.moveGroupTo(t)}),this.groupEdit.slide=this.$slideInt,this.$settingsMenu=this.$(".slide-settings-group"),this.$slideUp=this.$(".move-slide-up").parent(),this.$slideDown=this.$(".move-slide-down").parent(),window.is_staff||this.$(".save-template").remove(),this.listenTo(i,"add",function(e){e.view||(e.view=new r({model:e}),e.styleGroup=new f(e.get("style_group"),{$el:e.view.$el}),s.trigger("style:newgroup",e.styleGroup),e.view.render(),e.contentStyle=new f(e.get("content_style_group"),{$el:e.view.$content}),s.trigger("style:newgroup",e.contentStyle)),e.view.$el.css({"z-index":e.get("stackOrder"),width:e.view.$el.width()}).appendTo(t.$slideInt),e.view.activateControls(t),e.get("category")==="Embed"&&e.view.$el.tooltip("fixTitle"),e.updateBox()}),i.forEach(function(e){i.trigger("add",e)}),this.listenTo(i,"remove",function(e){s.trigger("style:removegroup",e.styleGroup),s.trigger("style:removegroup",e.contentStyle),e.view.$el.tooltip("destroy"),e.view.removeAll()}),this.listenTo(i,"change:stackOrder",function(e,t){e.view.$el.css("z-index",t)}),this.negSpace=new a,this.negSpace.render();var c=function(){var e=t.$slideInt.offset();t.negSpace.setPos(e.left)};n(window).on("resize",c),this.listenTo(this.model.collection,"change:height",function(){this.negSpace.update(this.model.bc,this.model)}),this.$el.prepend(this.negSpace.el),this.listenTo(s,"grid:on",function(){c(),this.negSpace.show(),this.negSpace.update(this.model.bc,this.model),this.negSpace.listenTo(t.model.bc,"change:position remove",function(){this.update(t.model.bc,t.model)}),this.negSpace.listenTo(t.model.bc,"add",function(){e.delay(function(){t.negSpace.update(t.model.bc,t.model)},10)})});var h=[],p=function(n,r){e.each(h,function(e){e.view.$el.css({top:e.view.$el.position().top+r})}),t.$slideInt.css({height:t.$slideInt.height()+r}),t.groupEdit.trigger("groupbox:update")},d=function(n){e.each(h,function(e){e.updateBox()}),t.model.set("height",t.$slideInt.height()),t.stopListening(t.negSpace.spacers,"spacer:resize",p),t.stopListening(t.negSpace.spacers,"spacer:resizeend",d)};return this.listenTo(this.negSpace.spacers,"spacer:resizestart",function(e){var t=e.get("top")+e.get("height");h=this.model.bc.filter(function(e){return e.get("position").top>=t}),this.listenTo(this.negSpace.spacers,"spacer:resize",p),this.listenTo(this.negSpace.spacers,"spacer:resizeend",d)}),this.listenTo(s,"grid:off",function(){this.negSpace.hide(),this.negSpace.stopListening(t.model.bc,"change:position")}),this},renderAll:function(){var e=this;return this.render(),this.model.bc.forEach(function(t){e.$slideInt.append(t.view.render().el)}),this},closestInside:function(e){var t=this.getBox(e),n=this.getBox(this.$slideInt),r={top:t.top,left:t.left};return t.left<n.left?r.left=n.left:t.right>n.right&&(r.left=n.right-t.width),t.top<n.top?r.top=n.top:t.bottom>n.bottom&&(r.top=n.bottom-t.height),r},getBox:function(e){var t=e.offset();return{top:t.top,left:t.left,bottom:t.top+e.height(),right:t.left+e.width(),width:e.width(),height:e.height()}},pointInside:function(e){var t=this.getBox(this.$slideInt);return e.left<t.left?!1:e.left>t.right?!1:e.top<t.top?!1:e.top>t.bottom?!1:!0},anyPartInside:function(e){var t=e.getBox(),n=this.$slideInt.getBox();return t.overlap(n)},deleteSlide:function(e){confirm("Press OK to delete this section")&&(this.model.collection.remove(this.model),s.trigger("changepoint","Delete Section"))},viewPortMiddle:function(){return this.$slideInt.inViewPort({top:145})},deactivate:function(e){this.isActive=!1,this.model.bc.deactivateAll(),this.$slideInt.css({overflow:"hidden"}),e?(this.$el.addClass("inactive"),this.delegateEvents({click:function(e){this.activate()},"click .controls":function(e){this.$settingsMenu.slideDown(150)}}),this.normalEvents=!1,this.model.bc.forEach(function(e){e.view.disable()})):(this.$el.removeClass("inactive"),this.normalEvents||(this.delegateEvents(this.events),this.model.bc.forEach(function(e){e.view.enable()}),this.normalEvents=!0))},activate:function(){this.isActive=!0,this.$el.removeClass("inactive"),this.$slideInt.css({overflow:"visible"}),this.model.trigger("activate:slide",this.model),this.normalEvents||(this.delegateEvents(this.events),this.model.bc.forEach(function(e){e.view.enable()}),this.normalEvents=!0)},saveAsTemplate:function(){this.model.set("is_template",!0),this.model.save()},addSlide:function(t){var n=0,r,i=this.appView.stack;t==="above"?n=0:t==="below"&&(n=1),r=this.model.get("order_index")+n,this.appView.templatePicker.show(),this.appView.templatePicker.once("picked",function(t){window.config.DEMO?i.sc.add({name:"New Slide",stack:i.get("resource_uri"),bricks:e.clone(t.get("bricks")),height:t.get("height"),slide_html:t.get("slide_html"),slide_style:t.get("slide_style")},{at:r}):i.sc.create({name:"New Slide",stack:i.get("resource_uri"),bricks:e.clone(t.get("bricks")),height:t.get("height"),slide_html:t.get("slide_html"),slide_style:t.get("slide_style")},{at:r}),i.sc.trigger("render:now"),s.trigger("changepoint","Add Section"),slideToggles()})},copySlide:function(){this.model.collection.create(this.model.cloneJSON(),{at:this.model.get("order_index")+1}),this.model.collection.trigger("render:now"),s.trigger("changepoint","Copy Section")}});return p}),define("app/views/templatepicker",["underscore","backbone","jquery","app/collections/slidecollection","app/models/template","app/loadtemplate"],function(e,t,n,r,i,s){var o=t.View.extend({tagName:"div",className:"picker-slide",events:{click:function(){this.model.trigger("picked",this.model)}},template:function(e){return'<div class="slide-pick-wrap"><div class="mini-slide-int">'+e+"</div></div>"},render:function(e){if(e){var t=n(this.template(this.model.get("slide_html"))),r=t.find(".mini-slide-int");r.attr("style",this.model.get("slide_style")),r.css({height:this.model.get("height")}),r.find(".embed-brick").html(""),this.$el.addClass("live"),this.$el.html(t);var i=Math.round(this.model.get("height")*.43);i=i>258?258:i,this.$el.css({height:i})}else{var s=n("<img>").attr("src",this.model.get("thumbnail"));this.$el.html(s)}return this}}),u=r.extend({model:i,url:"/api/v1/templates/"}),a=t.View.extend({tagName:"div",className:"template-picker",events:{"click #templates-btn":function(){this.$templateRow.show(),this.$yourRow.hide()},"click #your-slides-btn":function(){this.$templateRow.hide(),this.$yourRow.show()}},initialize:function(){this.sc=new u,this.yourSlides=new u;var e=this;this.rendered=!1,this.render(),this.yourSlides.url="/api/v1/myslides/",this.listenTo(this.sc,"add",function(t){var n=new o({model:t});n.render(),t.view=n,e.addOne(n,this.$templateRow)}),this.listenTo(this.sc,"picked",function(e){this.trigger("picked",e),this.hide()}),this.listenTo(this.yourSlides,"add",function(t){var n=new o({model:t});n.render(!0),t.view=n,e.addOne(n,this.$yourRow)}),this.listenTo(this.yourSlides,"change",function(e){e.view.render(!0)}),this.listenTo(this.yourSlides,"picked",function(e){this.trigger("picked",e),this.hide()}),this.listenTo(this.yourSlides,"remove",function(e){e.view.remove()}),this.sc.add({name:"Blank Slide",thumbnail:window.config.STATIC_URL+"img/blank-tmp.png"}),this.sc.fetch({remove:!1,data:{limit:0}}),window.config.DEMO||this.yourSlides.fetch({data:{limit:0}})},render:function(){return this.rendered||(this.$el.html(s("templatepickerjst")),this.$pickerInt=this.$(".picker-int"),this.$caretLeft=this.$(".picker-left"),this.$caretRight=this.$(".picker-right"),this.$templateRow=this.$(".picker-row").first(),this.$yourRow=this.$templateRow.next().hide(),this.rendered=!0),this},addOne:function(e,t){t.append(e.el)},onOutsideClick:function(e){this.$el.has(e.target).length===0&&this.hide()},bindOutsideClick:function(){function t(t){e.$el.has(t.target).length===0&&e.hide()}var e=this;this.onOutsideClick=t,n(window).on("click",t)},show:function(){this.$el.show(),this.delegateEvents(this.events),e.each(this.pickViews,function(e){e.delegateEvents(e.events)}),this.bindOutsideClick(),this.sc.fetch({remove:!1,data:{limit:0}}),window.config.DEMO||this.yourSlides.fetch({data:{limit:0}})},hide:function(){this.$el.hide(),this.undelegateEvents(),e.each(this.pickViews,function(e){e.undelegateEvents()}),this.off(),n(window).off("click",this.onOutsideClick)}});return a}),define("app/views/commandbar",["underscore","backbone","app/wigevents"],function(e,t,n){var r=t.View.extend({tagName:"div",className:"brick-bar",initialize:function(){var e=this;this.bars=[],this.dom=!1,this.listenTo(n,"activechange",function(t){e.showBars(t)})},addBar:function(e,t){e.parent=this,e.render().hide(),t?this.defaultBar=e:this.bars.push(e),this.$el.has(e.el).length===0&&this.$el.append(e.el),this.dom&&e.afterDOM()},showBars:function(t){if(t.length===0){this.defaultBar.show(),this.defaultBar.setActive(t),e.each(this.bars,function(e){e.hide()});return}e.each(this.bars,function(e){e.hide()});var n=e.map(t,function(e){return e.get("category")}),r=e.clone(this.bars),i;e.each(n,function(t){r=e.filter(r,function(n){return e.indexOf(n.types,t)>-1})}),i=e.difference(r),e.each(i,function(e){e.hide()}),e.each(r,function(e){e.show(),e.setActive(t)}),r.length===0?(this.defaultBar.show(),this.defaultBar.setActive(t)):this.defaultBar.hide()},showNamedBar:function(t){var n=!1;e.each(this.bars,function(e){e.name===t?(e.show(),n=!0):e.hide()}),n&&this.defaultBar.hide()},domInserted:function(){this.dom=!0,e.each(this.bars,function(e){e.afterDOM()}),this.defaultBar.afterDOM()}});return r}),function(e){function t(t){typeof t.data=="string"&&(t.data={keys:t.data});if(!t.data)return;if(!t.data.keys||typeof t.data.keys!="string")return;var n=t.handler,r=t.data.keys.toLowerCase().split(" "),i=["text","password","number","email","url","range","date","month","week","time","datetime","datetime-local","search","color"];t.handler=function(t){if(this!==t.target&&(/textarea|select/i.test(t.target.nodeName)||e.inArray(t.target.type,i)>-1))return;var s=t.type!=="keypress"&&e.hotkeys.specialKeys[t.which],o=String.fromCharCode(t.which).toLowerCase(),u,a="",f={};t.altKey&&s!=="alt"&&(a+="alt+"),t.ctrlKey&&s!=="ctrl"&&(a+="ctrl+"),t.metaKey&&!t.ctrlKey&&s!=="meta"&&(a+="meta+"),t.shiftKey&&s!=="shift"&&(a+="shift+"),s?f[a+s]=!0:(f[a+o]=!0,f[a+e.hotkeys.shiftNums[o]]=!0,a==="shift+"&&(f[e.hotkeys.shiftNums[o]]=!0));for(var l=0,c=r.length;l<c;l++)if(f[r[l]])return n.apply(this,arguments)}}e.hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",186:";",191:"/",220:"\\",222:"'",224:"meta"},shiftNums:{"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"}},e.each(["keydown","keyup","keypress"],function(){e.event.special[this]={add:t}})}(window.jQuery),define("jqhotkeys",function(){}),function(e){var t=function(t){var n=e.Deferred(),r=new FileReader;return r.onload=function(e){n.resolve(e.target.result)},r.onerror=n.reject,r.onprogress=n.notify,r.readAsDataURL(t),n.promise()};e.fn.cleanHtml=function(){var t=e(this).html();return t&&t.replace(/(<br>|\s|<div><br><\/div>|&nbsp;)*$/,"")},e.fn.stopWysiwyg=function(){var t=this,n,r,i,s=function(e,t){},o=function(e){t.parent().unbind("keydown").unbind("keyup")},u=function(e,t){e.find(i).unbind("click",f.f1),e.find("[data-toggle=dropdown]").unbind("click",f.restoreSelection),e.find("input[type=text][data-"+t.commandRole+"]").unbind("webkitspeechchange change",f.f2).unbind("focus",f.f3).unbind("blur",f.f4),e.find("input[type=file][data-"+t.commandRole+"]").unbind("change",f.f5)},a=function(){t.unbind("dragenter dragover").unbind("drop",f.f6)};r=e.extend({},e.fn.wysiwyg.defaults);var f=e.fn.wysiwyg.defaults.fns;return e.data(t[0],"wysiwig-started")&&(i="a[data-"+r.commandRole+"],button[data-"+r.commandRole+"],input[type=button][data-"+r.commandRole+"]",o(r.hotKeys),r.dragAndDropImages&&a(),u(e(r.toolbarSelector),r),t.removeAttr("contenteditable").unbind("mouseup keyup mouseout").off("keydown",f.returnHandler),e.data(t[0],"wysiwig-started",!1)),this},e.fn.wysiwyg=function(n){var r=this,i,s,o,u=function(){s.activeToolbarClass&&e(s.toolbarSelector).find(o).each(function(){var t=e(this).data(s.commandRole),n=!1;try{var n=document.queryCommandState(t)}catch(r){n=!1}n?e(this).addClass(s.activeToolbarClass):e(this).removeClass(s.activeToolbarClass)})},a=function(e,t){var n=e.split(" "),i=n.shift(),s=n.join(" ")+(t||""),o="";i.match(/^justify/)?(i==="justifyleft"?o="left":i==="justifyright"?o="right":i==="justifycenter"?o="center":i==="justifyfull"&&(o="justify"),r.parent().css({"text-align":o})):document.execCommand(i,0,s),u()},f=function(t){e.each(t,function(e,t){r.parent().keydown(e,function(e){r.attr("contenteditable")&&r.is(":visible")&&(e.preventDefault(),e.stopPropagation(),a(t))}).keyup(e,function(e){r.attr("contenteditable")&&r.is(":visible")&&(e.preventDefault(),e.stopPropagation())})})},l=function(){var e=window.getSelection();if(e.getRangeAt&&e.rangeCount)return e.getRangeAt(0)},c=function(){i=l()},h=function(){var e=window.getSelection();if(i){try{e.removeAllRanges()}catch(t){document.body.createTextRange().select(),document.selection.empty()}e.addRange(i)}},p=function(n){r.focus(),e.each(n,function(n,r){/^image\//.test(r.type)?e.when(t(r)).done(function(e){a("insertimage",e)}).fail(function(e){s.fileUploadError("file-reader",e)}):s.fileUploadError("unsupported-file-type",r.type)})},d=function(e,t){h(),document.queryCommandSupported("hiliteColor")&&document.execCommand("hiliteColor",0,t||"transparent"),c(),e.data(s.selectionMarker,t)},v=function(){h(),r.focus(),a(e(this).data(s.commandRole)),c()},m=function(){var t=this.value;this.value="",h(),t&&(r.focus(),a(e(this).data(s.commandRole),t)),c()},g=function(){var t=e(this);t.data(s.selectionMarker)||(d(t,s.selectionColor),t.focus())},y=function(){var t=e(this);t.data(s.selectionMarker)&&d(t,!1)},b=function(){h(),this.type==="file"&&this.files&&this.files.length>0&&p(this.files),c(),this.value=""},w=function(e){var t=e.originalEvent.dataTransfer;e.stopPropagation(),e.preventDefault(),t&&t.files&&t.files.length>0&&p(t.files)},E=function(e,t){e.find(o).click(v),e.find("[data-toggle=dropdown]").click(h),e.find("input[type=text][data-"+t.commandRole+"]").on("webkitspeechchange change",m).on("focus",g).on("blur",y),e.find("input[type=file][data-"+t.commandRole+"]").change(b),e.on("command",function(e,t){a(t)}),r.on("command",function(e,t){h(),r.focus(),a(t),c()})},S=function(){r.on("dragenter dragover",!1).on("drop",w)};s=e.extend({},e.fn.wysiwyg.defaults,n),o="a[data-"+s.commandRole+"],button[data-"+s.commandRole+"],input[type=button][data-"+s.commandRole+"]",f(s.hotKeys),s.dragAndDropImages&&S(),E(e(s.toolbarSelector),s);var x=function(e){e.stopPropagation(),e.preventDefault();var t=window.getSelection(),n=t.getRangeAt(0),i=document.createElement("br");return n.deleteContents(),n.insertNode(i),n.setStartAfter(i),n.setEndAfter(i),r.children().last().is(i)&&r.append("<br>"),n.collapse(!1),t.removeAllRanges(),t.addRange(n),!1};r.attr("contenteditable",!0).on("mouseup keyup mouseout",function(e){window.setTimeout(function(){c(),u()},50)}).on("savesel",function(){c()}),e(window).bind("touchend",function(e){var t=r.is(e.target)||r.has(e.target).length>0,n=l(),i=n&&n.startContainer===n.endContainer&&n.startOffset===n.endOffset;if(!i||t)c(),u()});var T={f1:v,f2:m,f3:g,f4:y,f5:b,f6:w,restoreSelection:h};return e.fn.wysiwyg.defaults.fns=T,e.data(r[0],"wysiwig-started",!0),this},e.fn.wysiwyg.defaults={hotKeys:{"ctrl+b meta+b":"bold","ctrl+i meta+i":"italic","ctrl+u meta+u":"underline","ctrl+z meta+z":"undo","ctrl+y meta+y meta+shift+z":"redo","ctrl+l meta+l":"justifyleft","ctrl+r meta+r":"justifyright","ctrl+e meta+e":"justifycenter","ctrl+j meta+j":"justifyfull","shift+tab":"outdent",tab:"indent"},toolbarSelector:"[data-role=editor-toolbar]",commandRole:"edit",activeToolbarClass:"btn-info",selectionMarker:"edit-focus-marker",selectionColor:"darkgrey",dragAndDropImages:!0,fileUploadError:function(e,t){console.log("File upload error",e,t)}}}($),define("wysiwyg",function(){}),define("app/views/textbar",["underscore","backbone","jquery","app/views/barview","app/wigevents","wysiwyg","jqhotkeys"],function(e,t,n,r,i){var s=r.extend({events:{"click .font-selector a":function(t){var r=t.target.innerHTML;t.preventDefault(),this.$fontSelector.text(r),e.each(this.active,function(e){e.view.$content.css({"font-family":r}),e.view.$content.find("a,span").each(function(){var e=n(this);e.css({"font-family":r})})}),i.trigger("changepoint","Change Font"),i.trigger("stylechange","Text",{"font-family":r})},"click .font-size button.font-ud":function(e){this.changeFontSize(n(e.currentTarget).data("edit"))},"submit #font-size-form":function(e){var t=this.$fontSize.val();e.preventDefault(),this.changeFontSize("font-to",t),this.$fontSize.blur()}},altEvents:{"click [data-edit=bold]":function(t){var n=this.active[0].view.$content.css("font-weight");n=n==="bold"?"normal":"bold",e.each(this.active,function(e){e.view.$content.css({"font-weight":n})}),i.trigger("changepoint","Bold Text")},"click [data-edit=italic]":function(t){var n=this.active[0].view.$content.css("font-style");n=n==="italic"?"normal":"italic",e.each(this.active,function(e){e.view.$content.css({"font-style":n})}),i.trigger("changepoint","Italicize Text")},"click [data-edit=underline]":function(t){var n=this.active[0].view.$content.css("text-decoration");n=n==="underline"?"none":"underline",e.each(this.active,function(e){e.view.$content.css({"text-decoration":n})}),i.trigger("changepoint","Underline Text")},"click [data-edit=strikethrough]":function(t){var n=this.active[0].view.$content.css("text-decoration");n=n==="line-through"?"none":"line-through",e.each(this.active,function(e){e.view.$content.css({"text-decoration":n})}),i.trigger("changepoint","Strikethrough Text")},"click [data-edit=justifyleft]":function(t){e.each(this.active,function(e){e.view.$el.css({"text-align":"left"})}),i.trigger("changepoint","Align Text Left")},"click [data-edit=justifycenter]":function(t){e.each(this.active,function(e){e.view.$el.css({"text-align":"center"})}),i.trigger("changepoint","Align Text Center")},"click [data-edit=justifyright]":function(t){e.each(this.active,function(e){e.view.$el.css({"text-align":"right"})}),i.trigger("changepoint","Align Text Right")},"click [data-edit=justifyfull]":function(t){e.each(this.active,function(e){e.view.$el.css({"text-align":"justify"})}),i.trigger("changepoint","Justify Text")}},barInit:function(){var t=this;this.$el.attr("data-role","editor-toolbar"),this.$el.attr("data-target",".slint-int"),this.editing=!1,this.types=["Text","Interactive"],this.listenTo(i,"edittext",function(){t.undelegateEvents(),t.delegateEvents(t.events),t.editing=!0}),this.listenTo(i,"stopedittext",function(){t.delegateEvents(e.extend(e.clone(t.events),t.altEvents)),t.editing=!1})},setActive:function(t){var n=t[0].view.$content;this.$fontSelector.text(n.css("font-family").split(",")[0].replace(/'/g,""));var r=e.uniq(e.map(t,function(e){return e.view.$content.css("font-size")}));r.length===1?this.$fontSize.val("").attr("placeholder",r[0].replace("px","")):this.$fontSize.val("").attr("placeholder",""),this.active=t},show:function(){this.$el.css({display:"inline-block"}),this.editing||this.delegateEvents(e.extend(e.clone(this.events),this.altEvents))},render:function(){return this.$fontSelector=this.$(".current-font"),this.$fontSize=this.$(".font-size-input"),this},changeFontSize:function(t,n){var r;t==="font-up"?n="+=5px":t==="font-down"?n="-=5px":t==="font-to"&&(n+="px");var s=0,o=[];e.each(this.active,function(e){e.view.$content.css("font-size",n),s++,o.push(e.view.$content.css("font-size"))}),s>0&&(o=e.uniq(o),o.length===1?this.$fontSize.val("").attr("placeholder",o[0].replace("px","")):this.$fontSize.val("").attr("placeholder","")),i.trigger("stylechange",[this.active[0].get("name")],{"font-size":this.active[0].view.$content.css("font-size")}),i.trigger("changepoint","Change Font Size")}});return s}),define("app/collections/undoredo",["underscore","backbone","app/wigevents"],function(e,t,n){function r(t){var n=e.clone(t);return e.each(n,function(e,t){_isObject(e)&&(n[t]=r(e))}),n}var i=t.Model.extend({defaults:{json:{},description:""}}),s=t.Collection.extend({model:i,cursor:-1,maxLen:150,initialize:function(e){var t=this;this.appView=e,this.listenTo(n,"changepoint",function(e){t.smartAdd({json:t.appView.stack.toJSON(),description:e})}),this.listenTo(n,"undo",function(){t.undo()}),this.listenTo(n,"redo",function(){t.redo()})},smartAdd:function(e){this.cursor+1<this.length&&this.remove(this.slice(this.cursor+1,this.length)),this.add(e),this.updateCursor(1);while(this.length>this.maxLen)this.shift();this.cursor=this.length-1},undo:function(){var e=this.appView,t;this.cursor>0&&(t=window.scrollY,n.trigger("cancelall"),e.stack.set(this.at(this.cursor-1).get("json")),e.stack.trigger("childupdate"),this.updateCursor(-1),window.scrollTo(0,t))},redo:function(){var e=this.appView,t;this.cursor<this.length-1&&(t=window.scrollY,n.trigger("cancelall"),e.stack.set(this.at(this.cursor+1).get("json")),e.stack.trigger("childupdate"),this.updateCursor(1),window.scrollTo(0,t))},updateCursor:function(e){var t="",r="",i="";this.cursor+=e,this.cursor<=0||(t+="U",r=this.at(this.cursor).get("description")),this.cursor>=this.length-1||(t+="R",i=this.at(this.cursor+1).get("description")),n.trigger("urenable",t,r,i)}});return s}),define("app/collections/stackcollection",["backbone","app/models/stack"],function(e,t){var n=e.Collection.extend({model:t,url:"/api/v1/stacks/"});return n}),define("app/views/linkbar",["underscore","backbone","app/views/barview","app/collections/stackcollection","app/wigevents"],function(e,t,n,r,i){var s=t.View.extend({tagName:"li",template:function(e){return'<a href="#">'+e+"</a>"},events:{click:function(e){e.preventDefault(),this.model.trigger("picked",this.model)}},render:function(){return this.$el.html(this.template(this.model.get("name"))),this}}),o=t.View.extend({tagName:"li",template:function(e){return'<a href="#">#'+e+"</a>"},events:{click:function(e){e.preventDefault(),this.model.trigger("picked",this.model)}},render:function(){return this.$el.html(this.template(this.model.collection.indexOf(this.model)+1)),this}}),u=n.extend({el:".link-controls",events:{"mouseup .add-link":function(t){var n,r=this.active,i=this,s=[],o="",u;this.$stackList.find("li a").removeClass("btn-primary"),i.$(".current").text("Sections in This Page").removeClass("btn-primary"),r.length===1&&r[0].view.editing?s=[]:s=e.map(r,function(e){return e.view.$content.parent().attr("href")||""}),s=e.uniq(s),s.length===1&&(o=s[0]),o.match(/^\$/)?(u=this.stacks.findWhere({id:Number(o.replace("$",""))}),u.view.$el.find("a").addClass("btn-primary"),this.$linkBox.val("")):o.match(/^#/)?(slide=this.slides.findWhere({id:Number(o.replace("#section-",""))}),i.$(".current").text("#"+(slide.collection.indexOf(slide)+1)).addClass("btn-primary")):this.$linkBox.val(o);var a=this.$linkBox;e.delay(function(){a.blur().focus()},1)},"click .link-adder":function(e){e.stopPropagation()},"click .remove-link":"removeLink","submit #link-form":function(e){e.preventDefault(),this.customLinkSet()},mouseenter:function(e){$(e.target).hasClass("tooltip")||i.trigger("showslidenums")},"mouseenter .tooltip":function(){i.trigger("hideslidenums")},mouseleave:function(){i.trigger("hideslidenums")}},barInit:function(){var t=this;this.stacks=new r,i.once("appstart",function(n){t.appView=n,n.stack.get("site")&&!window.config.DEMO&&t.stacks.fetch({data:{site:window.site_json.id,limit:0}}),t.slides=n.stack.sc;var r=document.createDocumentFragment(),i=[];t.slides.forEach(function(e){var t=new o({model:e});i.push(t),r.appendChild(t.render().el)}),t.$inPageLinks.html(r),t.listenTo(t.slides,"sort",function(){e.each(i,function(e){e.remove()}),i=[];var n=document.createDocumentFragment();t.slides.forEach(function(e){var t=new o({model:e});i.push(t),n.appendChild(t.render().el)}),t.$inPageLinks.html(n)}),t.listenTo(t.slides,"picked",function(e){var n=String("#section-"+e.get("id"));t.setLink(n)})}),renderStacksDB=e.debounce(function(){t.renderStacks()},100),this.stacks.on("add",function(e){e.view=new s({model:e}),e.view.render(),renderStacksDB()}),this.stacks.on("picked",function(e){var n=String("$"+e.get("id"));t.setLink(n)})},render:function(){return this.$addLink=this.$(".add-link"),this.$addLink.dropdown(),this.$removeLink=this.$(".remove-link"),this.$linkAdder=this.$(".link-adder"),this.$stackList=this.$(".other-pages"),this.$linkBox=this.$(".link-box"),this.$inPageLinks=this.$(".in-page-links"),this},setActive:function(e){this.active=e},renderStacks:function(){var e=document.createDocumentFragment(),t=this;this.stacks.forEach(function(t){e.appendChild(t.view.el)}),this.$stackList.html(e)},customLinkSet:function(){var e=this.$(".link-box").val();!!e.match("@")&&!e.match(/^mailto/)?e="mailto:"+e:!e.match(/^http/)&&!e.match(/^mailto/)&&(e="http://"+e),this.setLink(e)},setLink:function(t){var n='<a href="'+t+'"></a>';e.each(this.active,function(e){var r=e.view.$content;e.view.editing?r.trigger("command","createLink "+t):(r.find("a").each(function(){var e=$(this),t=e.html();e.attr("style")?e.replaceWith('<span style="'+e.attr("style")+'">'+t+"</span>"):e.replaceWith(t)}),r.parent()[0].tagName==="A"&&(r.unwrap(),e.set("wrapper","")),r[0].tagName==="A"?r.attr("href",t):(e.view.$content.wrap(n),e.set("wrapper",n)),i.trigger("changepoint","Add Link"))}),this.$inPageLinks.parent().removeClass("open").css("margin"),this.$addLink.parent().removeClass("open")},removeLink:function(){e.each(this.active,function(e){var t=e.view.$content;e.view.editing?t.trigger("command","unlink"):t.parent()[0].tagName==="A"&&(t.unwrap(),e.set("wrapper",""))})}});return u}),window.slideToggles=function(){$(".slide-controls-wrapper .controls button").tooltip({toggle:"tooltip",delay:{show:0,hide:50},placement:"right"})},$(function(){$(".top-controls-container .controls button").tooltip({toggle:"tooltip",delay:{show:200,hide:0},placement:"bottom"}),$(".brick-bar button").tooltip({toggle:"tooltip",delay:{show:200,hide:0},placement:"bottom",container:".brick-bar"}),window.slideToggles(),$(".dropdown-toggle").dropdown(),$("li.font").find("a").each(function(){$(this).css("font-family",$(this).attr("data-value"))})}),define("mine",function(e){return function(){var t,n;return t||e.slideToggles}}(this)),define("app/views/colorbar",["underscore","jquery","app/views/barview","app/wigevents"],function(e,t,n,r){var i=e.debounce(function(){r.trigger("changepoint","Change Color")},700),s=n.extend({el:".color-controls",events:{"click .change-active-color":function(e){e.stopPropagation(),this.changeColor(),t(".brick-bar").trigger("savesel")}},barInit:function(){this.types=["Shapes","Text"]},changeColor:function(){var e=this,t="";if(this.active.length>0)if(this.active[0].view.editing)try{t=document.queryCommandValue("foreColor")}catch(n){}else{var i=this.active[0].get("category");i==="Text"?t=this.active[0].view.$content.css("color"):i==="Shapes"&&(t=this.active[0].view.$content.css("background-color"))}r.trigger("pickcolor",this.$el,"fixed",t),r.on("colorpicked",function(t){e.receiveColor(t)})},receiveColor:function(n){e.each(this.active,function(e){var i=e.get("category");i==="Shapes"?(e.view.$content.css({"background-color":n}),r.trigger("stylechange","Shapes",{"background-color":n})):i==="Text"&&(e.view.editing?(e.view.$content.trigger("command","foreColor "+n),e.view.$content.find("font>a").each(function(){var e=t(this),n=e.parent();e.css({color:n.attr("color")})})):(e.view.$content.css({color:n}),e.view.$content.find("a").each(function(){var e=t(this);style=e.attr("style"),style?style.match("color")||e.css({color:n}):e.css({color:n})}),e.view.$content.find("font").each(function(){var e=t(this);e.replaceWith(e.html())}),e.view.$content.find("span").each(function(){var e=t(this);e.css({color:""}),e.attr("style")||e.replaceWith(e.html())})),r.trigger("stylechange","Text",{color:n}))}),i()}});return s}),define("app/views/roundbar",["underscore","backbone","app/views/barview","app/wigevents"],function(e,t,n,r){var i=n.extend({el:".round-controls",events:{"click .decrease-radius":function(e){this.changeRadius(-5)},"click .increase-radius":function(e){this.changeRadius(5)},"submit #radius-form":function(e){e.preventDefault(),this.changeRadiusTo(this.$radiusBox.val())}},barInit:function(){this.types=["Shapes","Image"]},setActive:function(t){this.active=t;if(e.some(t,function(e){return e.get("name")==="Circle"}))this.$el.hide();else{var n=e.uniq(e.map(t,function(e){return e.view.$content.css("border-radius")}));n.length===1?this.$radiusBox.val("").attr("placeholder",n[0].replace("px","")):this.$radiusBox.val("").attr("placeholder","")}},changeRadiusTo:function(t){t>=0&&(e.each(this.active,function(e){(e.get("name")==="Square"||e.get("name")==="Image")&&e.view.$content.css({"border-radius":t+"px"})}),this.logUndo())},changeRadius:function(t){var n=0,r=1e3,i=0,s=[];e.each(this.active,function(o){var u=0,a;if(o.get("name")==="Square"||o.get("name")==="Image")a=o.view.$content.css("border-radius"),a&&(u=Number(a.replace("%","").replace("px",""))),u+=t,u=e.min([u,r]),u=e.max([u,n]),o.view.$content.css({"border-radius":u+"px"}),i++,s.push(u)}),i>0&&(this.logUndo(),s=e.uniq(s),s.length===1&&this.$radiusBox.val("").attr("placeholder",s[0]))},logUndo:e.debounce(function(){r.trigger("changepoint","Round Corners"),r.trigger("stylechange",["Square"],{"border-radius":this.active[0].view.$content.css("border-radius")})},1500),render:function(){return this.$radiusBox=this.$(".radius-box"),this}});return i}),define("app/views/imagebar",["underscore","jquery","backbone","app/views/barview","app/wigevents","jqbox"],function(e,t,n,r,i){var s=r.extend({el:".image-controls",cropoverlay_html:'<div class="dznly-remove crop-overlay"></div>',cropbox_html:'<div class="dznly-remove crop-box"><div style="position: static; display: block;"><div class="handle N"></div><div class="handle NW"></div><div class="handle NE"></div><div class="handle S"></div><div class="handle SE"></div><div class="handle SW"></div><div class="handle E"></div><div class="handle W"></div></div></div>',events:{"click #img-replace":"replaceImage","click #img-edit":"editImage","click #img-fit":"imgFit"},barInit:function(){var e=this;this.types=["Image"],this.listenTo(i,"appstart",function(t){e.appView=t})},render:function(){return this.$cropBox=t(this.cropbox_html).css({"border-color":"blue"}),this.$cropBox.find(".handle").css({"background-color":"blue"}),this.$cropOverlay=t(this.cropoverlay_html),this},setActive:function(e){e.length>1&&this.hide(),this.active=e},editImage:function(){i.trigger("image:edit",this.active[0])},replaceImage:function(){this.active[0].view.trigger("pickimage",this.active[0].get("position"))},imgFit:function(){var t=!1,n=!1;e.each(this.active,function(e){var r=e.get("position"),i=new Box(r.top,r.left,r.height,r.width),s=!1;t||(t=e.view.$el.parent().getBox()),i.width>t.width&&(i.resizeAR(0,t.width-r.width),s=!0),i.height>t.height&&(i.resizeAR(t.height-r.height,0),s=!0),s&&(e.view.$el.css({width:i.width,height:i.height}),e.view.$content.css({width:i.width,height:i.height}),e.updateBox(),n=!0)}),n&&e.each(this.active,function(e){e.view.activate(!0)}),i.trigger("changepoint","Fit Image")}});return s}),define("app/views/siteslideview",["jquery","app/views/slideview","app/wigevents","app/loadtemplate"],function(e,t,n,r){var i=t.prototype,s=t.extend({initialize:function(){i.initialize.call(this);var e=this;this.slideChange=function(){e.stopListening(e.model,"change",e.slideChange),e.stopListening(e.model.bc,"change add remove",e.slideChange),e.model.set("has_content",!0)}},render:function(){return i.render.call(this),this.$slideUp.remove(),this.$slideDown.remove(),this.$(".add-slide-above,.add-slide-below,.copy-slide,.save-template").remove(),this.$(".divider.add,.divider.move").remove(),this.$name.text(this.model.get("slide_type").toUpperCase()),this.$(".controls.left").css({left:"-120px"}),this.$modal=e("#hf-modal").modal({show:!1}),this},deleteSlide:function(){var e=this;this.$modal.modal("show"),this.$modal.find(".slide-type").text(this.model.get("slide_type"));var t=function(){e.model.set("has_content",!1),e.model.save(),e.model.collection.remove(e.model),e.$modal.modal("hide")},n=function(){e.model.collection.remove(e.model),e.$modal.modal("hide")},r=function(){e.$modal.off("hide",r),e.$modal.find(".del-site").off("click",t),e.$modal.find(".del-page").off("click",n)};this.$modal.on("hide",r),this.$modal.find(".del-site").on("click",t),this.$modal.find(".del-page").on("click",n)},activate:function(){var e=this;this.old_json={},this.model.get("has_content")||(this.old_json=this.model.toJSON(),this.model.bc.set([]),this.listenToOnce(this.model,"change",e.slideChange),this.listenToOnce(this.model.bc,"change add remove",e.slideChange)),i.activate.call(this)},deactivate:function(){var e=this;e.stopListening(e.model,"change",e.slideChange),e.stopListening(e.model.bc,"change add remove",e.slideChange),!this.model.get("has_content")&&this.old_json&&(e.model.set(this.old_json),e.model.trigger("childupdate")),i.deactivate.apply(this,arguments)}});return s}),define("app/views/componentlib",["jquery","underscore","backbone","app/loadtemplate","app/wigevents","app/models/placedbrick"],function(e,t,n,r,i,s){var o=n.Model.extend({defaults:{label:"Component",screenshot:"thumb.png",description:"Long description",name:"Text",html:"<div></div>",category:"Text",thumb_html:'<i class="icon-plus-sign"></i><h5>Add</h5>'},getBrickAttr:function(){return t.pick(this.attributes,"name","html","category","thumb_html")}}),u=n.View.extend({tagName:"li",className:"component",events:{click:"picked"},initialize:function(){this.$imgCache=!1},render:function(){return this.$el.html('<a href="#">'+this.model.get("label")+"</a>"),this},picked:function(e){e.preventDefault(),e.stopPropagation(),this.preload(),this.model.trigger("picked",this.model)},preload:function(){this.$imgCache||(this.$imgCache=e("<img/>").attr("src",this.model.get("screenshot")))}}),a=n.Collection.extend({model:o}),f=n.Model.extend({constructor:function(){this.components=new a,this.listenTo(this.components,"picked",function(e){this.trigger("picked",e)}),this.subCategories=new l,this.listenTo(this.subCategories,"picked",function(e){this.trigger("picked",e)}),n.Model.apply(this,arguments)},initialize:function(){this.components.set(this.get("components")),this.subCategories.set(this.get("subcategories"))},defaults:function(){return{name:"Category",subcategories:[],components:[]}},urlRoot:"",parse:function(e){return this.components.set(e.components),this.subCategories.set(e.subcategories),e}}),l=n.Collection.extend({model:f,url:"http://lib-designly.herokuapp.com/categories.json",fetch:function(e){e=e||{};var r={type:"GET",dataType:"jsonp",jsonp:"jsonpCallback"};return t.extend(r,e),n.Collection.prototype.fetch.call(this,r)},parse:function(e){return e.categories}}),c=n.View.extend({tagName:"li",events:{click:"toggleCategory"},initialize:function(){this.listenTo(this.model.components,""),this.childrenShown=!1},render:function(){var e=this;return this.$el.html(r("catview-jst",this.model.toJSON())),this.$list=this.$(".clib-list"),this.model.subCategories.forEach(function(t){t.view=new c({model:t}),t.view.render(),e.$list.append(t.view.el)}),this.model.components.forEach(function(t){t.view=new u({model:t}),t.view.render(),e.$list.append(t.view.el)}),this.$plusMinus=this.$(">a>.clib-plus-minus"),this.hideChildren(),this},toggleCategory:function(e){e.preventDefault(),e.stopPropagation(),this.childrenShown?this.hideList():this.showList()},hideChildren:function(){this.model.subCategories.forEach(function(e){e.view.hideChildren()}),this.$list.hide(),this.$plusMinus.removeClass("icon-minus").addClass("icon-plus"),this.childrenShown=!1},showChildren:function(){this.model.subCategories.forEach(function(e){e.view.showChildren()}),this.$list.show(),this.$plusMinus.removeClass("icon-plus").addClass("icon-minus"),this.childrenShown=!0},initChildren:function(){this.$list.show(),this.childrenShown=!0,this.$plusMinus.removeClass("icon-plus").addClass("icon-minus"),this.model.subCategories.forEach(function(e){e.components.length===0&&e.view.initChildren()})},showList:function(){this.childrenShown||(this.$list.slideDown("fast"),this.childrenShown=!0,this.$plusMinus.removeClass("icon-plus").addClass("icon-minus"),this.model.components.forEach(function(e){e.view.preload()}))},hideList:function(){this.childrenShown&&(this.$list.slideUp("fast"),this.childrenShown=!1,this.$plusMinus.removeClass("icon-minus").addClass("icon-plus"))}}),h=n.View.extend({el:".clib-side-menu",events:{"click .clib-add":"add"},initialize:function(){this.categories=new l,this.activeComp=!1,this.listenTo(this.categories,"picked",function(e){this.$addBtn.removeClass("disabled"),this.$imgPreview.replaceWith(e.view.$imgCache),this.$imgPreview=e.view.$imgCache,this.activeComp=e}),this.listenToOnce(this.categories,"sync",function(e){this.renderAll()})},render:function(){return this.$list=this.$(".clib-list"),this.$imgPreview=this.$(".clib-preview img"),this.$addBtn=this.$(".clib-add").addClass("disabled"),this.categories.fetch(),this},renderAll:function(){var e=document.createDocumentFragment();this.categories.forEach(function(t){t.view=new c({model:t}),t.view.render(),t.view.initChildren(),e.appendChild(t.view.el)}),this.$list.append(e)},add:function(){if(this.activeComp){var e=new s(this.activeComp.getBrickAttr());e.firstPlacement=!1,i.trigger("placebrick",[e],40,!0),e.view.$el.css({width:e.view.$content.width(),height:e.view.$content.height()}),e.updateBox(),e.view.deactivate(),e.view.activate(!1),i.trigger("changepoint","Added "+e.get("name")),i.trigger("sidemenu:hide")}}});return h}),define("app/views/bkgbar",["underscore","backbone","app/views/barview","app/wigevents","filepicker"],function(e,t,n,r,i){var s=e.debounce(function(e){r.trigger("changepoint",e)},700),o=n.extend({el:".bkg-controls",events:{click:function(){this.adjustButtons(this.slide.view.$el),this.slide.set("slide_style",this.slide.view.$el.attr("style"))},"click .bkg-set-image":function(e){e.stopPropagation();var t=this.slide.view,n=this;i.pickAndStore({mimetype:"image/*",multiple:!1},{location:"S3",access:"public"},function(e){var i=window.config.UPLOADS_URL+window.encodeURIComponent(e[0].key);t.$el.css({"background-image":"url("+i+")"}),t.model.set("slide_style",t.$el.attr("style")),n.adjustButtons(t.$el),r.trigger("changepoint","Change Section Image")})},"click .bkg-edit-image":function(){r.trigger("image:bkgedit",this.slide.view)},"click .bkg-remove-image":function(){this.slide.view.$el.css("background-image",""),r.trigger("changepoint","Remove Background Image")},"click .bkg-cover":function(){this.slide.view.$el.css("background-size","cover"),r.trigger("changepoint","Set Background Image Cover")},"click .bkg-fixed":function(){this.slide.view.$el.css("background-size","auto"),r.trigger("changepoint","Set Background Image Size")},"click .bkg-change-color":function(e){e.stopPropagation();var t=this.slide.view,n=this;r.trigger("pickcolor",$(e.target),"fixed",t.$el.css("background-color")),r.on("colorpicked",function(e){t.$el.css({"background-color":e}),t.model.set("slide_style",t.$el.attr("style")),n.adjustButtons(t.$el),s("Change Section Color")})},"click .bkg-attachment":function(){this.$attached.hasClass("active")?(this.slide.view.$el.css("background-attachment","scroll"),r.trigger("changepoint","Background Scrolls")):(this.slide.view.$el.css("background-attachment","fixed"),r.trigger("changepoint","Background Stays"))},"click .bkg-left":function(){this.setPosition({x:"0%"})},"click .bkg-center":function(){this.setPosition({x:"50%"})},"click .bkg-right":function(){this.setPosition({x:"100%"})},"click .bkg-top":function(){this.setPosition({y:"0%"})},"click .bkg-middle":function(){this.setPosition({y:"50%"})},"click .bkg-bottom":function(){this.setPosition({y:"100%"})},"click .bkg-xrepeat":function(){this.$repeatX.hasClass("active")?this.$repeatY.hasClass("active")?this.slide.view.$el.css({"background-repeat":"no-repeat repeat"}):this.slide.view.$el.css({"background-repeat":"no-repeat"}):this.$repeatY.hasClass("active")?this.slide.view.$el.css({"background-repeat":"repeat"}):this.slide.view.$el.css({"background-repeat":"repeat no-repeat"}),r.trigger("changepoint","Change Background Repeat")},"click .bkg-yrepeat":function(){this.$repeatY.hasClass("active")?this.$repeatX.hasClass("active")?this.slide.view.$el.css({"background-repeat":"repeat no-repeat"}):this.slide.view.$el.css({"background-repeat":"no-repeat"}):this.$repeatX.hasClass("active")?this.slide.view.$el.css({"background-repeat":"repeat"}):this.slide.view.$el.css({"background-repeat":"no-repeat repeat"}),r.trigger("changepoint","Change Background Repeat")},"click .bkg-close":function(){this.slide.view.$el.trigger("mousedown")}},barInit:function(){this.types=[],this.name="background"},setSlide:function(e){this.slide=e,this.adjustButtons(e.view.$el)},render:function(){return this.$imgRemove=this.$(".bkg-remove-image"),this.$bkgCover=this.$(".bkg-cover"),this.$bkgFixed=this.$(".bkg-fixed"),this.$sizeGroup=this.$(".bkg-size-group"),this.$attached=this.$(".bkg-attachment"),this.$positionGroup=this.$(".bkg-position-group"),this.$left=this.$(".bkg-left"),this.$center=this.$(".bkg-center"),this.$right=this.$(".bkg-right"),this.$top=this.$(".bkg-top"),this.$middle=this.$(".bkg-middle"),this.$bottom=this.$(".bkg-bottom"),this.$repeatX=this.$(".bkg-xrepeat"),this.$repeatY=this.$(".bkg-yrepeat"),this.listenTo(r,"cancelall",function(){var t=this;this.slide&&e.delay(function(){t.adjustButtons(t.slide.view.$el)},1)}),this},hide:function(){this.slide=!1,this.$el.hide(),this.undelegateEvents()},setPosition:function(t){var n=this.slide.view.$el.css("background-position").split(" "),i={x:n[0]||"50%",y:n[1]||"50%"};e.extend(i,t),this.slide.view.$el.css({"background-position":i.x+" "+i.y}),r.trigger("changepoint","Change Background Position")},adjustButtons:function(t){var n={size:t.css("background-size"),position:t.css("background-position").split(" "),repeat:t.css("background-repeat").split(" "),attachment:t.css("background-attachment"),image:t.css("background-image")};n.size==="cover"?(this.$sizeGroup.addClass("disabled"),this.$positionGroup.addClass("disabled"),this.$bkgCover.addClass("active"),this.$bkgFixed.removeClass("active")):(this.$sizeGroup.removeClass("disabled"),this.$positionGroup.removeClass("disabled"),this.$bkgCover.removeClass("active"),this.$bkgFixed.addClass("active")),e.first(n.position)==="0%"?(this.$left.addClass("active"),this.$center.removeClass("active"),this.$right.removeClass("active")):e.first(n.position)==="50%"?(this.$left.removeClass("active"),this.$center.addClass("active"),this.$right.removeClass("active")):e.first(n.position)==="100%"&&(this.$left.removeClass("active"),this.$center.removeClass("active"),this.$right.addClass("active")),e.last(n.position)==="0%"?(this.$top.addClass("active"),this.$middle.removeClass("active"),this.$bottom.removeClass("active")):e.last(n.position)==="50%"?(this.$top.removeClass("active"),this.$middle.addClass("active"),this.$bottom.removeClass("active")):e.last(n.position)==="100%"&&(this.$top.removeClass("active"),this.$middle.removeClass("active"),this.$bottom.addClass("active")),e.first(n.repeat)==="repeat"&&e.last(n.repeat)==="repeat"?(this.$repeatX.addClass("active"),this.$repeatY.addClass("active")):e.first(n.repeat)==="repeat"||e.first(n.repeat)==="repeat-x"?(this.$repeatX.addClass("active"),this.$repeatY.removeClass("active")):e.last(n.repeat)==="repeat"||e.first(n.repeat)==="repeat-y"?(this.$repeatX.removeClass("active"),this.$repeatY.addClass("active")):(this.$repeatX.removeClass("active"),this.$repeatY.removeClass("active")),n.attachment==="fixed"?this.$attached.addClass("active"):this.$attached.removeClass("active"),n.image==="none"?this.$imgRemove.addClass("disabled"):this.$imgRemove.removeClass("disabled")},setActive:function(e){}});return o}),define("app/views/featherview",["underscore","backbone","jquery","app/wigevents","filepicker"],function(e,t,n,r,i){var s=t.View.extend({initialize:function(){var e=this;this.activePb=!1,this.mode="brick",this.featherEditor=new Aviary.Feather({apiKey:"mmpfdxsp333bshn8",apiVersion:3,tools:"crop,enhance,warmth,focus,effects,orientation,brightness,contrast,saturation,warmth,sharpness,splash,draw,redeye,whiten,blemish",theme:"light",appendTo:"",onSave:function(t,n){e.afterSave(t,n)},onError:function(e){}}),this.listenTo(r,"image:edit",function(e){this.startAviary(e)}),this.listenTo(r,"image:bkgedit",function(e){this.startAviaryBkg(e)})},afterSave:function(e,t){this.mode==="brick"?this.updateImage(e,t):this.mode==="bkg"&&this.updateBkg(e,t)},startAviaryBkg:function(e){var t=e.$el.css("background-image");this.sv=e,this.mode="bkg";if(!t)return;t=t.replace("url(","").replace(")","").replace(/[",']/g,"");var n=document.createElement("img");n.src=t,this.featherEditor.launch({image:n,url:t})},updateBkg:function(e,t){fv=this,this.featherEditor.close(),i.store({url:t},function(e){destURL=window.config.UPLOADS_URL+window.encodeURIComponent(e.key),fv.sv.$el.css({"background-image":"url("+destURL+")"}),r.trigger("changepoint","Edit Background Image")})},startAviary:function(e){if(e.get("category")!=="Image")return;var t=e.view.$content.css("background-image");if(!t)return;this.mode="brick",this.activePb=e,t=t.replace("url(","").replace(")","").replace(/[",']/g,"");var n=document.createElement("img");n.src=t,this.featherEditor.launch({image:n,url:t})},updateImage:function(e,t){var n=this.featherEditor.getImageDimensions(),s=n.width/n.height,o=t,u=this.activePb;u.updateBox();var a=u.get("position");this.featherEditor.close(),i.store({url:t},function(e){o=window.config.UPLOADS_URL+window.encodeURIComponent(e.key),u.view.hideSpinner();var t=Math.round(1/s*a.width);u.view.$content.css({"background-image":"url("+o+")",height:t}),u.view.$el.css({height:t}),u.updateBox(),u.view.deactivate(),u.view.activate(!1),r.trigger("changepoint","Edit Image")}),u.view.showSpinner()}});return s}),define("app/views/appeditview",["underscore","backbone","jquery","app/collections/thumbcollection","app/views/binview","app/models/slide","app/views/slidecontrols","app/views/slideview","app/views/templatepicker","app/views/commandbar","app/views/textbar","app/wigevents","app/collections/undoredo","app/views/linkbar","mine","app/views/colorbar","app/views/roundbar","app/views/imagebar","app/views/siteslideview","app/views/componentlib","app/views/bkgbar","app/views/featherview"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){var S=t.View.extend({el:"body",events:{"click .add-slide.btn":"addSlide","click #restore-header .add-slide-controls button":"addHeader","click #restore-footer .add-slide-controls button":"addFooter"},initialize:function(){this.binView=new i,this.undoRedo=new h(this),this.thumbs=this.binView.bin,this.templatePicker=new a,this.grid=!1},start:function(t){var n=this;this.stack=t;var r=e.debounce(function(){n.renderSlides()},100,!0),i=e.debounce(function(){r()},100);this.listenTo(this.stack.sc,"add",function(e){e.view=new u({model:e}),e.view.render(),n.setActiveSlide(e.view),i()}),this.listenTo(this.stack.sc,"remove",function(e,t){var r=e.get("order_index");r=r>=t.length?t.length-1:r,n.setActiveSlide(t.at(r).view),e.view.remove()}),this.listenTo(this.stack.sc,"render:now",function(){r()}),this.listenTo(this.stack.siteSlides,"remove",function(e){e.view.remove(),i()}),this.listenTo(this.stack.siteSlides,"add",function(e){e.view=new y({model:e}),e.view.render(),e.view.deactivate(!0),i()}),this.stack.sc.forEach(function(e){t.sc.trigger("add",e)}),this.stack.siteSlides.forEach(function(e){t.siteSlides.trigger("add",e)}),this.stack.sc.trigger("render:now"),this.listenTo(this.stack.sc,"activate:slide",function(e){this.stack.sc.forEach(function(t){t!==e&&t.view.deactivate(!1)}),this.stack.siteSlides.forEach(function(t){t!==e&&t.view.deactivate(!0)}),this.setActiveSlide(e.view)}),this.listenTo(this.stack.siteSlides,"activate:slide",function(e){this.stack.sc.forEach(function(t){t!==e&&t.view.deactivate(!0)}),this.stack.siteSlides.forEach(function(t){t!==e&&t.view.deactivate(!1)}),this.setActiveSlide(e.view)}),c.trigger("changepoint","Initial State"),c.trigger("appstart",this)},renderSlides:function(){var e=document.createDocumentFragment(),t=this,n=this.stack.getSiteSlide("Header"),r=this.stack.getSiteSlide("Footer");n?(e.appendChild(n.view.el),this.$restoreHeader.hide()):window.site_json.global_slides&&this.$restoreHeader.show(),this.stack.sc.forEach(function(t){e.appendChild(t.view.el)}),r?(e.appendChild(r.view.el),this.$restoreFooter.find(".add-slide-controls").hide()):window.site_json.global_slides&&this.$restoreFooter.find(".add-slide-controls").show();try{t.$restoreFooter.before(e)}catch(i){}d()},render:function(){var t=this,r=document.createDocumentFragment();this.$slidesArea=this.$(".slides-outer"),this.$addSlide=this.$slidesArea.find(".add-slide-container"),this.$restoreHeader=this.$("#restore-header"),this.$restoreFooter=this.$("#restore-footer"),this.$sideMenu=this.$(".side-menu");var i=function(e){t.$sideMenu.has(e.target).length===0&&!t.$sideMenu.is(e.target)&&c.trigger("sidemenu:hide")};return this.listenTo(c,"sidemenu:show",function(){this.$sideMenu.show(),n(window).on("click",i)}),this.listenTo(c,"sidemenu:hide",function(){this.$sideMenu.hide(),n(window).off("click",i)}),this.componentLib=new b,this.componentLib.render(),this.slideControls=new o,this.slideControls.render(),this.featherView=new E,this.featherView.render(),this.commandBar=new f({el:n(".brick-bar")}),this.commandBar.addBar(this.binView,!0),this.textBar=new l({el:n(".text-controls")[0]}),this.textBar.render(),this.commandBar.addBar(this.textBar),this.linkBar=new p,this.linkBar.render(),this.commandBar.addBar(this.linkBar),this.colorBar=new v,this.colorBar.render(),this.commandBar.addBar(this.colorBar),this.roundBar=new m,this.roundBar.render(),this.commandBar.addBar(this.roundBar),this.imageBar=new g,this.imageBar.render(),this.commandBar.addBar(this.imageBar),this.bkgBar=new w,this.bkgBar.render(),this.commandBar.addBar(this.bkgBar),this.$(".brick-bar").append(this.commandBar.render().el),this.commandBar.domInserted(),this.commandBar.showBars([]),this.listenTo(c,"bkg:settings",function(e){this.bkgBar.setSlide(e),this.commandBar.showNamedBar("background")}),this.listenTo(c,"placebrick",function(t,n,r){var i=this.activeSlide,s=this.activeSlide.viewPortMiddle();if(!s||!i.model.collection)i=this.stack.sc.find(function(e){return s=e.view.viewPortMiddle(),!!s}).view;i.model.bc.addAndOrder(t),e.each(t,function(e,t){e.updateBox(),t===0?e.view.activate(!1):e.view.activate(!0)});if(n!==!1){var o=n;r||(o-=i.$slideInt.getBox().left),t[0].trigger("movegroup",t[0],{x:o,y:s.relativeTo(i.$slideInt.getBox()).top})}}),this.templatePicker.hide(),this.$el.append(this.templatePicker.el),d(),this},addSlide:function(t){t.stopPropagation();var n=this.stack;this.templatePicker.show(),c.trigger("starttemplatepicker"),this.templatePicker.once("picked",function(t){window.config.DEMO?n.sc.add({name:"New Slide",stack:n.get("resource_uri"),bricks:e.clone(t.get("bricks")),height:t.get("height"),slide_html:t.get("slide_html"),slide_style:t.get("slide_style")}):n.sc.create({name:"New Slide",stack:n.get("resource_uri"),bricks:e.clone(t.get("bricks")),height:t.get("height"),slide_html:t.get("slide_html"),slide_style:t.get("slide_style")}),n.sc.trigger("render:now"),c.trigger("changepoint","Add Section"),d()})},setActiveSlide:function(e){e&&(this.activeSlide=e)},addHeader:function(){this.addGlobal("Header")},addFooter:function(){this.addGlobal("Footer")},addGlobal:function(t){var n=window.site_json.global_slides,r=e.findWhere(n,{slide_type:t});r.bricks.length===0?(r.bricks=[{name:"Heading",thumb_html:'<i class="icon-font"></i><h5>Heading</h5>',html:"<h1 style=\"font-family: 'Open Sans'; background-size: 446px 37px; height: 54px; width: 446px; background-position: 0px 0px;\">This is Your "+r.slide_type+"</h1>",category:"Text",description:"Brick Description",scaling:!1,css:{},position:{top:5,left:0,height:54,width:446,right:446,bottom:59},stackOrder:0,style:"top: 5px; left: 0px; width: 446px; height: 54px; z-index: 0;",wrapper:"",slide:"/api/v1/slides/40/",bgXPos:0,bgYPos:0,bgW:549,bgH:37},{name:"Text",thumb_html:'<i class="icon-align-left"></i><h5>Text</h5>',html:"<p style=\"display: inline-block; width: 525px; font-family: 'Open Sans'; background-size: 525px 69px; height: 99px; background-position: 0px 0px;\">Right now, it has no content. Don't worry, this message won't appear on your final page. Click "+(r.slide_type==="Header"?"up":"down")+" here to start editing.<br><br>Once you add content to this section, it will appear on all of the pages on this site. You can control which pages have me from your other pages.<br></p>",category:"Text",description:"Brick Description",scaling:!1,css:{},position:{top:52,left:4.5,height:99,width:525,right:529.5,bottom:151},stackOrder:1,style:"top: 52px; left: 4.5px; width: 525px; height: 99px; z-index: 1;",wrapper:"",slide:"/api/v1/slides/40/",bgXPos:0,bgYPos:0,bgW:468,bgH:69}],r.height=170,r.has_content=!1):r.has_content=!0,this.stack.siteSlides.add(r)}});return S}),define("app/appview",["app/views/appeditview"],function(e){var t=new e;return t}),define("app/views/colorpicker",["underscore","backbone","jquery","app/wigevents"],function(e,t,n,r){function i(e){e=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);var t="";try{t="#"+("0"+parseInt(e[1],10).toString(16)).slice(-2)+("0"+parseInt(e[2],10).toString(16)).slice(-2)+("0"+parseInt(e[3],10).toString(16)).slice(-2)}catch(n){t=""}return t}var s=t.Model.extend({defaults:{hex:"FFEEAA"},idAttribute:"hex"}),o=t.View.extend({tagName:"a",className:"swatch",events:{click:"changeColor","submit form":function(e){e.preventDefault()}},initialize:function(){this.$el.attr("href","#")},render:function(){return this.$el.css({"background-color":"#"+this.model.get("hex")}),this},changeColor:function(e){e.preventDefault(),this.model.trigger("changecolor",this)}}),u=t.Collection.extend({model:s,toUrlString:function(){return this.pluck("hex").join("-")}}),a=t.View.extend({el:"#picker-panel",events:{click:function(e){e.stopPropagation()}},initialize:function(t){this.lastHexUrl="ffffff",this.stack=t;var a=this;this.started=!1,a.usedColors=new u,a.standardColors=new u,a.suggestedColors=new u,a.suppressChange=!1,this.listenTo(r,"pickcolor",function(e,t,r){r&&(a.suppressChange=!0,n.farbtastic("#colorpicker").setColor(i(r))),a.show(e,t)}),this.listenTo(r,"appstart",function(e){a.appView=e,a.updateUsed(),a.getSuggested(),a.started=!0}),this.listenTo(this.standardColors,"add",function(e){e.view=new o({model:e}),e.view.render(),a.$("#standard-palette").append(e.view.el)}),this.listenTo(this.usedColors,"add",function(e){e.view=new o({model:e}),e.view.render()}),this.listenTo(this.usedColors,"reset",function(){var e=document.createDocumentFragment();a.usedColors.forEach(function(t){e.appendChild(t.view.el)}),a.$("#used-palette").html(e)}),this.listenTo(this.suggestedColors,"add",function(e){e.view=new o({model:e}),e.view.render(),a.$("#suggested-palette").append(e.view.el)}),this.listenTo(this.suggestedColors,"reset",function(){var e=document.createDocumentFragment();a.suggestedColors.forEach(function(t){t.view=new o({model:t}),t.view.render(),e.appendChild(t.view.el)}),a.$("#suggested-palette").html(e)}),this.listenTo(this.usedColors,"changecolor",function(e){c(e)}),this.listenTo(this.standardColors,"changecolor",function(e){c(e)}),this.listenTo(this.suggestedColors,"changecolor",function(e){c(e)});var f=["3ECAAF","1ECE6D","2C97DE","9C55B8","32485F","3DB49D","4DBF7D","227FBB","8F3FAF","2A3D50","F3C502","E87E02","EA4A34","ECF0F1","94A5A6","F7B031","D65301","C23723","BDC3C7","7E8C8D"];e.each(f,function(e){var t=new s({hex:e});a.standardColors.add(t)}),this.suggestedColors.parse=function(t){var n=e.map(t,function(e){return{hex:e}});return n};var l=e.debounce(function(e){a.started&&(a.updateUsed(),a.getSuggested())},1e3);this.$("#color").on("wwcolorchange",function(e,t){a.suppressChange?a.suppressChange=!1:(r.trigger("colorpicked",t),l(t))});var c=function(e){n.farbtastic("#colorpicker").setColor("#"+e.model.get("hex"))},h=function(e){}},initUsed:function(t){var n=t.slice(0,5);e.each(n,function(e){var t=new s({hex:e.replace("#","")});picker.usedColors.add(t)})},updateUsed:function(){var t,n=this,r;t=this.retrieveUsedColors(),r=e.map(t,function(e){return{hex:e.replace("#","")}}),n.usedColors.set(r),n.usedColors.trigger("reset")},getSuggested:function(){var e=this.usedColors.toUrlString();this.lastHexUrl=e,e=e===""?"ffffff":e,this.suggestedColors.fetch({type:"GET",dataType:"jsonp",url:"http://dribbble-colors.herokuapp.com/hex/"+e+".json",jsonp:"jsonpCallback",reset:!0})},show:function(t,r){var i,s=this;r==="fixed"?i=t.position():i=t.offset(),this.$el.css({position:r,top:i.top+20,left:e.max([i.left-this.$el.width(),0]),"z-index":9999999999}),this.updateUsed(),this.lastHexUrl!==this.usedColors.toUrlString()&&this.getSuggested(),this.$el.show(),this.clickHandler=function(e){s.hide()},n(document).on("click",this.clickHandler)},hide:function(){this.$el.hide(),n(document).off("click",this.clickHandler),r.off("colorpicked")},retrieveUsedColors:function(){var t=["#000000","#ffffff",""],r=[],s,o=this.appView,u=function(s){var o=i(s.view.$el.css("background-color"));e.indexOf(t,o)===-1&&r.push(o),s.bc.forEach(function(s){var o="",u=s.get("category");u==="Shapes"?(o=i(s.view.$content.css("background-color")),e.indexOf(t,o)===-1&&r.push(o)):u==="Text"&&(o=i(s.view.$content.css("color")),e.indexOf(t,o)===-1&&r.push(o),s.view.$content.find("*").each(function(){var s=i(n(this).css("color"));e.indexOf(t,s)===-1&&r.push(s)}))})};return o.stack.sc.forEach(u),o.stack.siteSlides.forEach(u),s=e.countBy(r,function(e){return e}),e.pluck(e.sortBy(e.pairs(s),function(e){return-1*e[1]}),0)}});return a});var guiders=function(e){var t=e.guiders={};t.version="2.0.0",t._defaultSettings={attachTo:null,autoFocus:!1,buttons:[{name:"Close"}],buttonCustomHTML:"",classString:null,closeOnEscape:!1,description:"Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.",highlight:null,isHashable:!0,maxWidth:null,offset:{top:null,left:null},onClose:null,onHide:null,onShow:null,overlay:!1,position:0,shouldSkip:function(){},title:"Sample title goes here",width:400,xButton:!1},t._htmlSkeleton=["<div class='guider'>","  <div class='guiders_content'>","    <h1 class='guiders_title'></h1>","    <div class='guiders_close'></div>","    <p class='guiders_description'></p>","    <div class='guiders_buttons_container'>","    </div>","  </div>","  <div class='guiders_arrow'>","  </div>","</div>"].join(""),t._arrowSize=42,t._backButtonTitle="Back",t._buttonAttributes={href:"javascript:void(0);"},t._buttonClassName="guiders_button",t._buttonClickEvent="click touch",t._buttonElement="<a></a>",t._closeButtonTitle="Close",t._currentGuiderID=null,t._fixedOrAbsolute="fixed",t._guiders={},t._lastCreatedGuiderID=null,t._nextButtonTitle="Next",t._offsetNameMapping={topLeft:11,top:12,topRight:1,rightTop:2,right:3,rightBottom:4,bottomRight:5,bottom:6,bottomLeft:7,leftBottom:8,left:9,leftTop:10},t._windowHeight=0;var n=navigator.userAgent.match(/MSIE\s([\d.]+)/);return t._isIE=n&&n.length>1,t._ieVersion=n&&n.length>1?Number(n[1]):-1,t._addButtons=function(n){var r=n.elem.find(".guiders_buttons_container");if(n.buttons===null||n.buttons.length===0){r.remove();return}for(var i=n.buttons.length-1;i>=0;i--){var s=n.buttons[i],o=e(t._buttonElement,e.extend({"class":t._buttonClassName,html:s.name},t._buttonAttributes,s.html||{}));typeof s.classString!="undefined"&&s.classString!==null&&o.addClass(s.classString),r.append(o);var u=s.name.toLowerCase();if(s.onclick)o.bind(t._buttonClickEvent,s.onclick);else switch(u){case t._closeButtonTitle.toLowerCase():o.bind(t._buttonClickEvent,function(){t.hideAll(),n.onClose&&n.onClose(n,!1),e("body").trigger("guidersClose")});break;case t._nextButtonTitle.toLowerCase():o.bind(t._buttonClickEvent,function(){!n.elem.data("locked")&&t.next()});break;case t._backButtonTitle.toLowerCase():o.bind(t._buttonClickEvent,function(){!n.elem.data("locked")&&t.prev()})}}if(n.buttonCustomHTML!==""){var a=e(n.buttonCustomHTML);n.elem.find(".guiders_buttons_container").append(a)}n.buttons.length===0&&r.remove()},t._addXButton=function(n){var r=n.elem.find(".guiders_close"),i=e("<div></div>",{"class":"guiders_x_button",role:"button"});r.append(i),i.click(function(){t.hideAll(),n.onClose&&n.onClose(n,!0),e("body").trigger("guidersClose")})},t._attach=function(n){if(typeof n!="object")return;var r=e(n.attachTo),i=n.elem.innerHeight(),s=n.elem.innerWidth();if(n.position===0||r.length===0){var o="fixed";t._isIE&&t._ieVersion<9&&(o="absolute"),n.elem.css("position",o),n.elem.css("top",(e(window).height()-i)/3+"px"),n.elem.css("left",(e(window).width()-s)/2+"px");return}var u=r.offset(),a=u.top,f=u.left,l=e("body").outerHeight(!0)-e("body").outerHeight(!1);a-=l,t._offsetNameMapping[n.position]&&(n.position=t._offsetNameMapping[n.position]);var c=r.innerHeight(),h=r.innerWidth(),p=.9*t._arrowSize,d={1:[-p-i,h-s],2:[0,p+h],3:[c/2-i/2,p+h],4:[c-i,p+h],5:[p+c,h-s],6:[p+c,h/2-s/2],7:[p+c,0],8:[c-i,-s-p],9:[c/2-i/2,-s-p],10:[0,-s-p],11:[-p-i,0],12:[-p-i,h/2-s/2]},v=d[n.position];a+=v[0],f+=v[1];var m="absolute";return r.css("position")==="fixed"&&t._fixedOrAbsolute==="fixed"&&(m="fixed",a-=e(window).scrollTop(),f-=e(window).scrollLeft()),n.offset.top!==null&&(a+=n.offset.top),n.offset.left!==null&&(f+=n.offset.left),t._styleArrow(n),n.elem.css({position:m,top:a,left:f}),n},t._dehighlightElement=function(t){e(t).removeClass("guiders_highlight")},t._hideOverlay=function(){e("#guiders_overlay").fadeOut("fast")},t._highlightElement=function(t){e(t).addClass("guiders_highlight")},t._initializeOverlay=function(){e("#guiders_overlay").length===0&&e("<div id='guiders_overlay'></div>").hide().appendTo("body")},t._showOverlay=function(n){e("#guiders_overlay").fadeIn("fast",function(){this.style.removeAttribute&&this.style.removeAttribute("filter")}),t._isIE&&e("#guiders_overlay").css("position","absolute")},t._styleArrow=function(n){var r=n.position||0;if(!r)return;var i=e(n.elem.find(".guiders_arrow")),s={1:"guiders_arrow_down",2:"guiders_arrow_left",3:"guiders_arrow_left",4:"guiders_arrow_left",5:"guiders_arrow_up",6:"guiders_arrow_up",7:"guiders_arrow_up",8:"guiders_arrow_right",9:"guiders_arrow_right",10:"guiders_arrow_right",11:"guiders_arrow_down",12:"guiders_arrow_down"};i.addClass(s[r]);var o=n.elem.innerHeight(),u=n.elem.innerWidth(),a=t._arrowSize/2,f={1:["right",a],2:["top",a],3:["top",o/2-a],4:["bottom",a],5:["right",a],6:["left",u/2-a],7:["left",a],8:["bottom",a],9:["top",o/2-a],10:["top",a],11:["left",a],12:["left",u/2-a]},r=f[n.position];i.css(r[0],r[1]+"px")},t._showIfHashed=function(e){var n="guider=",r=window.location.hash.indexOf(n);if(r!==-1){var i=window.location.hash.substr(r+n.length);e.id.toLowerCase()===i.toLowerCase()&&t.show(e.id)}},t._updatePositionOnResize=function(){var n=undefined;e(window).resize(function(){typeof n!="undefined"&&clearTimeout(n),n=setTimeout(function(){n=undefined,typeof t!="undefined"&&t.reposition()},20)})},t._updatePositionOnResize(),t._unwireEscape=function(t){e(document).unbind("keydown")},t._wireEscape=function(n){e(document).keydown(function(r){if(r.keyCode==27||r.which==27)return t.hideAll(),n.onClose&&n.onClose(n,!0),e("body").trigger("guidersClose"),!1})},t.createGuider=function(n){if(n===null||n===undefined)n={};myGuider=e.extend({},t._defaultSettings,n),myGuider.id=myGuider.id||"guider_random_"+String(Math.floor(Math.random()*1e3));var r=e("#"+myGuider.id);r.length||(r=e(t._htmlSkeleton)),myGuider.elem=r,typeof myGuider.classString!="undefined"&&myGuider.classString!==null&&myGuider.elem.addClass(myGuider.classString),Number(myGuider.width)===myGuider.width&&(myGuider.width=String(myGuider.width)+"px"),Number(myGuider.maxWidth)===myGuider.maxWidth&&(myGuider.maxWidth=String(myGuider.maxWidth)+"px"),myGuider.elem.css("width",myGuider.width),myGuider.elem.css("maxWidth",myGuider.maxWidth);var i=r.find(".guiders_title");return i.html(myGuider.title),r.find(".guiders_description").html(myGuider.description),t._addButtons(myGuider),myGuider.xButton&&t._addXButton(myGuider),r.hide(),r.appendTo("body"),r.attr("id",myGuider.id),typeof myGuider.attachTo!="undefined"&&myGuider!==null&&t._attach(myGuider),t._initializeOverlay(),t._guiders[myGuider.id]=myGuider,t._lastCreatedGuiderID!=null&&(myGuider.prev=t._lastCreatedGuiderID),t._lastCreatedGuiderID=myGuider.id,myGuider.isHashable&&t._showIfHashed(myGuider),t},t.get=function(e){return typeof t._guiders[e]=="undefined"?null:t._guiders[e]||null},t.getCurrentGuider=function(){return t._guiders[t._currentGuiderID]||null},t.hideAll=function(n,r){r=r||!1,e(".guider:visible").each(function(n,i){var s=t.get(e(i).attr("id"));s.onHide&&s.onHide(s,r)}),e(".guider").fadeOut("fast");var i=t._guiders[t._currentGuiderID];return i&&i.highlight&&t._dehighlightElement(i.highlight),(typeof n=="undefined"||n!==!0)&&t._hideOverlay(),t},t.next=function(){var e=t._guiders[t._currentGuiderID];if(typeof e=="undefined")return null;e.elem.data("locked",!0);var n=e.next||null;if(n!==null&&n!==""){var r=t.get(n),i=r.overlay?!0:!1;return t.hideAll(i,!0),e&&e.highlight&&t._dehighlightElement(e.highlight),r.shouldSkip&&r.shouldSkip()?(t._currentGuiderID=r.id,t.next(),t.getCurrentGuider()):(t.show(n),t.getCurrentGuider())}},t.prev=function(){var e=t._guiders[t._currentGuiderID];if(typeof e=="undefined")return null;if(e.prev===null)return null;var n=t._guiders[e.prev];n.elem.data("locked",!0);var r=n.id||null;if(r!==null&&r!==""){var i=t.get(r),s=i.overlay?!0:!1;return t.hideAll(s,!0),n&&n.highlight&&t._dehighlightElement(n.highlight),t.show(r),i}},t.reposition=function(){var e=t._guiders[t._currentGuiderID];t._attach(e)},t.scrollToCurrent=function(){var n=t._guiders[t._currentGuiderID];if(typeof n=="undefined")return;var r=t._windowHeight,i=e(window).scrollTop(),s=n.elem.offset(),o=n.elem.height(),u=Math.round(Math.max(s.top+o/2-r/2,0));window.scrollTo(0,u)},t.show=function(n){!n&&t._lastCreatedGuiderID&&(n=t._lastCreatedGuiderID);var r=t.get(n);r.overlay&&(t._showOverlay(r),r.highlight&&r.attachTo&&t._highlightElement(r.attachTo)),r.closeOnEscape?t._wireEscape(r):t._unwireEscape(r),r.onShow&&r.onShow(r),t._attach(r),r.elem.fadeIn("fast").data("locked",!1),t._currentGuiderID=n;var i=t._windowHeight=e(window).height(),s=e(window).scrollTop(),o=r.elem.offset(),u=r.elem.height(),a=s+i<o.top+u,f=o.top<s;return r.autoFocus&&(a||f)&&setTimeout(t.scrollToCurrent,10),e(r.elem).trigger("guiders.show"),t},e.fn.guider=function(n){n=n||{};var r=e.extend({},n);r.id=e(this).attr("id");var i=[];e(this).find(".guiders_buttons_container").children().each(function(){var t={name:e(this).html(),classString:e(this).attr("class")};if(e(this).attr("data-onclick")){var n=e(this).attr("data-onclick");t.onclick=function(){window[n]()}}e(this).remove(),i.push(t)}),r.buttons=i,title=e(this).find(".guiders_title").html(),title&&(r.title=title),description=e(this).find(".guiders_description").html(),description&&(r.description=description);for(var s in t._defaultSettings){if(!t._defaultSettings.hasOwnProperty(s))continue;var o=e(this).attr("data-"+s);if(o===undefined||o===null)continue;o=="true"?o=!0:o=="false"&&(o=!1),r[s]=o}return t.createGuider(r),this},t}.call(this,jQuery);define("guiders",["jquery"],function(e){return function(){var t,n;return t||e.guiders}}(this)),function(e){e.fn.fitText=function(t,n){var r=t||1,i=e.extend({minFontSize:Number.NEGATIVE_INFINITY,maxFontSize:Number.POSITIVE_INFINITY},n);return this.each(function(){var t=e(this),n=function(){t.css("font-size",Math.max(Math.min(t.width()/(r*10),parseFloat(i.maxFontSize)),parseFloat(i.minFontSize)))};n(),e(window).on("resize.fittext orientationchange.fittext",n)})}}(jQuery),define("jqfittext",function(){}),function(e){var t,n;typeof window=="undefined"?(t=require("underscore"),n=require("backbone")):(t=window._,n=window.Backbone),n.Tastypie={doGetOnEmptyPostResponse:!0,doGetOnEmptyPutResponse:!1,apiKey:{username:"",key:""},csrfToken:""},n.oldSync=n.sync,n.sync=function(e,r,i){var s={};n.Tastypie.apiKey&&n.Tastypie.apiKey.username&&(s.Authorization="ApiKey "+n.Tastypie.apiKey.username+":"+n.Tastypie.apiKey.key),n.Tastypie.csrfToken&&(s["X-CSRFToken"]=n.Tastypie.csrfToken),s=t.extend(s,i.headers),i.headers=s;if(e==="create"&&n.Tastypie.doGetOnEmptyPostResponse||e==="update"&&n.Tastypie.doGetOnEmptyPutResponse){var o=new $.Deferred,u=i.success;o.done(function(e,n,r){t.isFunction(u)&&u(e)}),i.success=function(e,t,u){if(!!e||u.status!==201&&u.status!==202&&u.status!==204)return o.resolveWith(i.context||i,[e,t,u]);var a=u.getResponseHeader("Location")||r.id;return n.ajax({url:a,headers:s,success:o.resolve,error:o.reject})};var a=i.error;return o.fail(function(e,n,r){t.isFunction(a)&&a(e.responseText)}),i.error=function(e,t,n){o.rejectWith(i.context||i,[e,t,e.responseText])},o.request=n.oldSync(e,r,i),o}return n.oldSync(e,r,i)},n.Model.prototype.idAttribute="resource_uri",n.Model.prototype.url=function(){var e=this.id;return e||(e=t.isFunction(this.urlRoot)?this.urlRoot():this.urlRoot,e=e||this.collection&&(t.isFunction(this.collection.url)?this.collection.url():this.collection.url),e&&this.has("id")&&(e=r(e)+this.get("id"))),e=e&&r(e),e||null},n.Model.prototype.parse=function(e){return e&&e.objects&&(t.isArray(e.objects)?e.objects[0]:e.objects)||e},n.Collection.prototype.parse=function(e){return e&&e.meta&&(this.meta=e.meta),e&&e.objects||e},n.Collection.prototype.url=function(e){var n=t.isFunction(this.urlRoot)?this.urlRoot():this.urlRoot;if(!n){var i=e&&e.length&&e[0];n=i&&(t.isFunction(i.urlRoot)?i.urlRoot():i.urlRoot)}n=n&&r(n);if(e&&e.length){var s=t.map(e,function(e){var n=t.compact(e.id.split("/"));return n[n.length-1]});n+="set/"+s.join(";")+"/"}return n||null};var r=function(e){return e+(e.length>0&&e.charAt(e.length-1)==="/"?"":"/")}}(),define("tastypie",function(){}),jQuery.fn.farbtastic=function(e){return $.farbtastic(this,e),this},jQuery.farbtastic=function(e,t){var e=$(e).get(0);return e.farbtastic||(e.farbtastic=new jQuery._farbtastic(e,t))},jQuery._farbtastic=function(e,t){var n=this;$(e).html('<div class="farbtastic"><div class="color"></div><div class="wheel"></div><div class="overlay"></div><div class="h-marker marker"></div><div class="sl-marker marker"></div></div>');var r=$(".farbtastic",e);n.wheel=$(".wheel",e).get(0),n.radius=84,n.square=100,n.width=194,navigator.appVersion.match(/MSIE [0-6]\./)&&$("*",r).each(function(){if(this.currentStyle.backgroundImage!="none"){var e=this.currentStyle.backgroundImage;e=this.currentStyle.backgroundImage.substring(5,e.length-2),$(this).css({backgroundImage:"none",filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, sizingMethod=crop, src='"+e+"')"})}}),n.linkTo=function(e){typeof n.callback=="object"&&$(n.callback).unbind("keyup",n.updateValue),n.color=null;if(typeof e=="function")n.callback=e;else if(typeof e=="object"||typeof e=="string")n.callback=$(e),n.callback.on("keydown",null,"return",function(e){e.preventDefault(),n.updateValue.apply(this,e)}),n.callback.get(0).value&&n.setColor(n.callback.get(0).value);return this},n.updateValue=function(e){n.setColor(this.value)},n.setColor=function(e){var t=n.unpack(e);return t&&(n.color=e,n.rgb=t,n.hsl=n.RGBToHSL(n.rgb)),n.updateDisplay(),this},n.setHSL=function(e){return n.hsl=e,n.rgb=n.HSLToRGB(e),n.color=n.pack(n.rgb),n.updateDisplay(),this},n.widgetCoords=function(e){var t,r,i=e.target||e.srcElement,s=n.wheel;if(typeof e.offsetX!="undefined"){var o={x:e.offsetX,y:e.offsetY},u=i;while(u)u.mouseX=o.x,u.mouseY=o.y,o.x+=u.offsetLeft,o.y+=u.offsetTop,u=u.offsetParent;var u=s,a={x:0,y:0};while(u){if(typeof u.mouseX!="undefined"){t=u.mouseX-a.x,r=u.mouseY-a.y;break}a.x+=u.offsetLeft,a.y+=u.offsetTop,u=u.offsetParent}u=i;while(u)u.mouseX=undefined,u.mouseY=undefined,u=u.offsetParent}else{var o=n.absolutePosition(s);t=(e.pageX||0*(e.clientX+$("html").get(0).scrollLeft))-o.x,r=(e.pageY||0*(e.clientY+$("html").get(0).scrollTop))-o.y}return{x:t-n.width/2,y:r-n.width/2}},n.mousedown=function(e){document.dragging||($(document).bind("mousemove",n.mousemove).bind("mouseup",n.mouseup),document.dragging=!0);var t=n.widgetCoords(e);return n.circleDrag=Math.max(Math.abs(t.x),Math.abs(t.y))*2>n.square,n.mousemove(e),!1},n.mousemove=function(e){var t=n.widgetCoords(e);if(n.circleDrag){var r=Math.atan2(t.x,-t.y)/6.28;r<0&&(r+=1),n.setHSL([r,n.hsl[1],n.hsl[2]])}else{var i=Math.max(0,Math.min(1,-(t.x/n.square)+.5)),s=Math.max(0,Math.min(1,-(t.y/n.square)+.5));n.setHSL([n.hsl[0],i,s])}return!1},n.mouseup=function(){$(document).unbind("mousemove",n.mousemove),$(document).unbind("mouseup",n.mouseup),document.dragging=!1},n.updateDisplay=function(){var e=n.hsl[0]*6.28;$(".h-marker",r).css({left:Math.round(Math.sin(e)*n.radius+n.width/2)+"px",top:Math.round(-Math.cos(e)*n.radius+n.width/2)+"px"}),$(".sl-marker",r).css({left:Math.round(n.square*(.5-n.hsl[1])+n.width/2)+"px",top:Math.round(n.square*(.5-n.hsl[2])+n.width/2)+"px"}),$(".color",r).css("backgroundColor",n.pack(n.HSLToRGB([n.hsl[0],1,.5]))),typeof n.callback=="object"?($(n.callback).css({backgroundColor:n.color,color:n.hsl[2]>.5?"#000":"#fff"}),$(n.callback).each(function(){this.value&&this.value!=n.color&&(this.value=n.color),$(this).trigger("wwcolorchange",n.color)})):typeof n.callback=="function"&&n.callback.call(n,n.color)},n.absolutePosition=function(e){var t={x:e.offsetLeft,y:e.offsetTop};if(e.offsetParent){var r=n.absolutePosition(e.offsetParent);t.x+=r.x,t.y+=r.y}return t},n.pack=function(e){var t=Math.round(e[0]*255),n=Math.round(e[1]*255),r=Math.round(e[2]*255);return"#"+(t<16?"0":"")+t.toString(16)+(n<16?"0":"")+n.toString(16)+(r<16?"0":"")+r.toString(16)},n.unpack=function(e){if(e.length==7)return[parseInt("0x"+e.substring(1,3))/255,parseInt("0x"+e.substring(3,5))/255,parseInt("0x"+e.substring(5,7))/255];if(e.length==4)return[parseInt("0x"+e.substring(1,2))/15,parseInt("0x"+e.substring(2,3))/15,parseInt("0x"+e.substring(3,4))/15]},n.HSLToRGB=function(e){var t,n,r,i,s,o=e[0],u=e[1],a=e[2];return n=a<=.5?a*(u+1):a+u-a*u,t=a*2-n,[this.hueToRGB(t,n,o+.33333),this.hueToRGB(t,n,o),this.hueToRGB(t,n,o-.33333)]},n.hueToRGB=function(e,t,n){return n=n<0?n+1:n>1?n-1:n,n*6<1?e+(t-e)*n*6:n*2<1?t:n*3<2?e+(t-e)*(.66666-n)*6:e},n.RGBToHSL=function(e){var t,n,r,i,s,o,u=e[0],a=e[1],f=e[2];return t=Math.min(u,Math.min(a,f)),n=Math.max(u,Math.max(a,f)),r=n-t,o=(t+n)/2,s=0,o>0&&o<1&&(s=r/(o<.5?2*o:2-2*o)),i=0,r>0&&(n==u&&n!=a&&(i+=(a-f)/r),n==a&&n!=f&&(i+=2+(f-u)/r),n==f&&n!=u&&(i+=4+(u-a)/r),i/=6),[i,s,o]},$("*",r).mousedown(n.mousedown),n.setColor("#000000"),t&&n.linkTo(t)},define("farbtastic",function(){}),requirejs.config({paths:{jquery:"lib/jquerycdnhelper",jqhotkeys:"lib/jquery.hotkeys",jqbox:"lib/jquery.box",jqfittext:"lib/jquery.fittext",mine:"lib/mine",underscore:"lib/lodash.modern.min",backbone:"lib/backbone",wysiwyg:"lib/bootstrap-wysiwyg",tastypie:"lib/backbone-tastypie",filepicker:"//api.filepicker.io/v1/filepicker",snaps:"lib/snaps",farbtastic:"lib/farbtastic",guiders:"lib/guiders"},shim:{jqhotkeys:["jquery"],jqbox:["jquery"],mine:{deps:[],exports:"slideToggles"},wysiwyg:["jquery","jqhotkeys"],backbone:{deps:["underscore","jquery"],exports:"Backbone"},tastypie:["backbone"],filepicker:{deps:[],exports:"filepicker"},snaps:["jquery","jqbox"],farbtastic:["jquery"],guiders:{deps:["jquery"],exports:"guiders"}}}),require(["underscore","backbone","jquery","app/appview","app/views/textbar","app/models/stack","app/wigevents","app/views/colorpicker","guiders","jqhotkeys","jqfittext","mine","tastypie","farbtastic"],function(e,t,n,r,i,s,o,u,a){function l(e){var t=null;if(document.cookie&&document.cookie!=""){var n=document.cookie.split(";");for(var r=0;r<n.length;r++){var i=jQuery.trim(n[r]);if(i.substring(0,e.length+1)==e+"="){t=decodeURIComponent(i.substring(e.length+1));break}}}return t}var f={};f.init=function(){function c(t,s,o){if(n("[contenteditable=true]").length===0){var u=r.activeSlide.model.bc.getActive();e.each(u,function(e){e.view.$el.css({top:"+="+s,left:"+="+t})}),u.length>0&&(u[0].trigger("keyboardmove",u),o.preventDefault(),i())}}function h(){n("[contenteditable=true]").length===0&&e.each(r.activeSlide.model.bc.getActive(),function(e){e.updateBox()})}function p(){e.each(r.activeSlide.model.bc.getActive(),function(e){r.activeSlide.model.bc.remove(e)})}r.render(),t.Tastypie.csrfToken=l("csrftoken"),n(window).on("keydown",null,"ctrl+c meta+c",function(e){n("[contenteditable=true]").length===0&&(e.preventDefault(),r.slideControls.brickCopy())}).on("keydown",null,"ctrl+v meta+v",function(e){n("[contenteditable=true]").length===0&&(e.preventDefault(),r.slideControls.brickPaste())}).on("keydown",null,"ctrl+x meta+x",function(e){n("[contenteditable=true]").length===0&&(e.preventDefault(),r.slideControls.brickCut())}),n(".tab-bar,.slide-bin,.brick-bar,.page-container,.slide").on("click",function(e){e.target===this&&(e.preventDefault(),r.activeSlide.model.bc.deactivateAll(),o.trigger("deadzone"))});var i=e.debounce(function(){o.trigger("changepoint","Move")},1e3);n(window).on("keydown",null,"up",function(e){c(0,-10,e)}).on("keydown",null,"down",function(e){c(0,10,e)}).on("keydown",null,"left",function(e){c(-10,0,e)}).on("keydown",null,"right",function(e){c(10,0,e)}).on("keydown",null,"shift+up",function(e){c(0,-1,e)}).on("keydown",null,"shift+down",function(e){c(0,1,e)}).on("keydown",null,"shift+left",function(e){c(-1,0,e)}).on("keydown",null,"shift+right",function(e){c(1,0,e)}).on("keyup",null,"up down left right shift+up shift+down shift+left shift+right",function(e){h()}).on("keydown",null,"meta+s",function(e){e.preventDefault(),r.slideControls.save()}).on("keydown",null,"backspace del",function(e){n("[contenteditable=true]").length===0&&(e.preventDefault(),r.slideControls.delete())}).on("keydown",null,"ctrl+z meta+z",function(e){n("[contenteditable=true]").length===0&&(e.preventDefault(),o.trigger("undo"))}).on("keydown",null,"ctrl+y meta+y meta+shift+z",function(e){n("[contenteditable=true]").length===0&&(e.preventDefault(),o.trigger("redo"))}).on("keydown",null,"ctrl+a meta+a",function(e){n("[contenteditable=true]").length===0&&(e.preventDefault(),r.activeSlide.model.bc.forEach(function(e){e.view.activate(!0)}))}).on("keydown",null,"ctrl+g meta+g",function(e){e.preventDefault(),r.slideControls.toggleGrid()}),f.a=r;var d=new s(stack_json,{parse:!0});n("#colorpicker").farbtastic("#color");var v=new u;f.colorPicker=v,r.start(d);var m=e.throttle(function(){r.slideControls.save()},window.editor_autosave_wait,{leading:!1});!window.config.DEMO&&window.is_owner&&o.on("changepoint undo redo",function(){m()});var g=function(){return"You have unsaved changes"};window.config.DEMO||(o.on("changepoint setnavalert",function(){window.onbeforeunload=g}),o.on("savecomplete killnavalert",function(){window.onbeforeunload=null}));var y=function(){var e=function(){a.next()};a.createGuider({buttons:[{name:"Close"},{name:"Next"}],title:"Welcome!",attachTo:".help",description:"Are you pumped to start making a website? We have a few quick (super helpful) tips to get you going, and you can always come back to them by clicking this lightbulb.",id:"g1",next:"g2",position:6,xButton:!0}),a.createGuider({buttons:[{name:"Close"},{name:"Next"}],attachTo:".slide-int",title:"Sections",description:"Your page is made up of multiple sections stacked on top of each other. These are great for grouping content.",id:"g2",next:"g3",position:12,offset:{top:100,left:0},xButton:!0}),a.createGuider({buttons:[{name:"Close"},{name:"Next"}],attachTo:".settings.dropdown-toggle",title:"Section Settings",description:"You can do some pretty cool stuff to your sections in this menu, like change it’s background and the order of the sections on the page.",id:"g3",next:"g4",position:9,xButton:!0}),a.createGuider({buttons:[{name:"Close"},{name:"Next"}],attachTo:".resize-slide",title:"Section Re-sizer",description:"Click and drag this up and down to resize sections.",onShow:function(){var e=n(".resize-slide").offset().top;window.scrollTo(0,e-175)},id:"g4",next:"g5",position:9,xButton:!0}),a.createGuider({buttons:[{name:"Click on Add Section to continue",onclick:function(){a.hideAll()}}],onShow:function(){n(".add-slide")[0].scrollIntoView(),o.once("starttemplatepicker",function(){a.hideAll(),a.next()})},attachTo:".add-slide",title:"Add Section",description:"Can you guess what this button does? Try giving it a click just to make sure.",id:"g5",next:"g6",position:12,xButton:!0}),a.createGuider({buttons:[{name:"Close"},{name:"Next"}],attachTo:".picker-outer",title:"Section Templates",description:"You can add a fresh, new, blank section, but we’ve also made a bunch of templates to help speed things up (and to make up for all this time spent reading).",id:"g6",next:"g7",position:9,xButton:!0}),a.createGuider({buttons:[{name:"Close"},{name:"Next"}],attachTo:".slide-bin",onShow:function(){window.scrollTo(0,0)},title:"Content Menu",description:"This one is a biggie. Sure it's where you get all the awesome pieces to build your site, but it ALSO changes to a context menu depending on what stuff you have selected. Try adding a heading to see it in action.",id:"g7",next:"g8",position:6,xButton:!0}),a.createGuider({buttons:[{name:"Close"},{name:"Next"}],attachTo:".clipboard-controls",title:"Edit Controls",description:"This buttons opens a list with options like copy and paste, but also has controls to arrange which objects are above others.",id:"g8",next:"g9",position:6,xButton:!0}),a.createGuider({buttons:[{name:"Close"},{name:"Next"}],attachTo:"#undo",title:"Undo/Redo",description:"You can also use keyboard shortcuts like ctrl (or command) + z for undo, or ctrl (or command) + y for redo.",id:"g9",next:"g10",position:6,xButton:!0}),a.createGuider({buttons:[{name:"Close"},{name:"Next"}],attachTo:"#save-button",title:"Saving",description:"Your page automatically saves every 30 seconds if you’ve made changes (awesome, right?) but if you don’t trust it, you can also click here to do it manually.",id:"g10",next:"g11",position:6,xButton:!0}),a.createGuider({buttons:[{name:"Close"},{name:"Next"}],attachTo:"#save-button",title:"Publishing",description:'Saving only saves your page in a draft state, so when you’re ready for your changes to be live for the world to see, hit that "Publish" button',id:"g11",next:"g12",position:6,xButton:!0}),a.createGuider({buttons:[{name:"Close"},{name:"Next"}],attachTo:"#grid-toggle",title:"Top Bar Controls",description:"Alright, I know you’re itching to dive in, so lets just blast through these last couple. The home button takes you to your dashboard where you can add pages and change settings. The pages button opens a list of your other pages for quick switching. The preview eye will hide all these pesky buttons and let you see your site (hover around up here to bring the menu back). Finally, theres a grid button to help you keep your page all lined up and pretty.",id:"g12",next:"g13",position:6,xButton:!0}),a.createGuider({buttons:[{name:"Close"}],attachTo:"#habla_window_div",title:"That's it!",description:"Phew, we made it. If you have any other questions (or want to show us your awesome page), you can chat with us here. You can always email us at hi@designly.com too. Happy building!",id:"g13",next:"g14",position:11,xButton:!0})};y(),first_time&&a.show("g1"),n(".help").on("click",function(){a.hideAll(),a.show("g1")})},f.demo=function(){var e=r.thumbs;e.add({name:"Heading",thumb_html:'<i class="icon-font"></i><h5>Heading</h5>',html:"<h1>Double Click to Add Heading</h1>",category:"Text"}),e.add({name:"Text",thumb_html:'<i class="icon-align-left"></i><h5>Text</h5>',html:'<p style="display:inline-block;width:100%;">Double Click To Add Text</p>',category:"Text"}),e.add({name:"Image",thumb_html:'<i class="icon-picture"></i><h5>Image</h5>',html:'<div class="image-brick">',scaling:!0,category:"Image"}),e.add({name:"Circle",thumb_html:'<i class="icon-circle"></i><h5>Circle</h5>',html:'<div class="circle-shape"> </div>',category:"Shapes",scaling:!0}),e.add({name:"Square",thumb_html:'<i class="icon-stop"></i><h5>Square</h5>',html:'<div class="square-shape"> </div>',category:"Shapes",scaling:!0}),e.add({name:"Embed",thumb_html:'<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="20px" height="20px" viewbox="0 0 48 48" enable-background="new 0 0 16 16" xml:space="preserve" fill="#000000" class="svg replaced-svg"> <path d="M 39.00,48.00L9.00,48.00 c-4.971,0.00-9.00-4.032-9.00-9.00L0.00,9.00 c0.00-4.971, 4.029-9.00, 9.00-9.00l30.00,0.00 c 4.968,0.00, 9.00,4.029, 9.00,9.00l0.00,30.00 C 48.00,43.968, 43.968,48.00, 39.00,48.00z M 42.00,9.00c0.00-1.656-1.341-3.00-3.00-3.00L9.00,6.00 C 7.344,6.00, 6.00,7.344, 6.00,9.00l0.00,30.00 c0.00,1.659, 1.344,3.00, 3.00,3.00l30.00,0.00 c 1.659,0.00, 3.00-1.341, 3.00-3.00L42.00,9.00 z M 36.00,27.00l0.00,3.00 c0.00,4.968-4.032,9.00-9.00,9.00l0.00,-6.00 c 1.659,0.00, 3.00-1.341, 3.00-3.00L30.00,27.00 c 1.659,0.00, 3.00-1.344, 3.00-3.00s-1.341-3.00-3.00-3.00L30.00,18.00 c0.00-1.656-1.341-3.00-3.00-3.00L27.00,9.00 c 4.968,0.00, 9.00,4.029, 9.00,9.00l0.00,3.00 c 1.659,0.00, 3.00,1.344, 3.00,3.00S 37.659,27.00, 36.00,27.00z M 12.00,30.00L12.00,27.00 C 10.344,27.00, 9.00,25.656, 9.00,24.00s 1.344-3.00, 3.00-3.00L12.00,18.00 c0.00-4.971, 4.029-9.00, 9.00-9.00l0.00,6.00 C 19.344,15.00, 18.00,16.344, 18.00,18.00l0.00,3.00 C 16.344,21.00, 15.00,22.344, 15.00,24.00s 1.344,3.00, 3.00,3.00l0.00,3.00 c0.00,1.659, 1.344,3.00, 3.00,3.00l0.00,6.00 C 16.029,39.00, 12.00,34.968, 12.00,30.00z"></path></svg><h5>Embed</h5>',html:'<div class="embed-brick"><div class="embed-wrap"></div><div class="embed-cover dznly-remove"></div></div>',category:"Embed"})},n(document).ready(function(){f.init(),f.demo();var e=config.DEMO?"Demo":"Editor";o.on("changepoint",function(t){mixpanel.track(e+" Change",{change:t,site_name:site_info.name})}),o.on("publish:complete",function(){mixpanel.track(e+" Change",{change:"Publish",site_name:site_info.name})})}),window.brick=f}),define("edit",function(){});