var requirejs,require,define;if(function(global){function isFunction(e){return"[object Function]"===ostring.call(e)}function isArray(e){return"[object Array]"===ostring.call(e)}function each(e,t){if(e){var n;for(n=0;n<e.length&&(!e[n]||!t(e[n],n,e));n+=1);}}function eachReverse(e,t){if(e){var n;for(n=e.length-1;n>-1&&(!e[n]||!t(e[n],n,e));n-=1);}}function hasProp(e,t){return hasOwn.call(e,t)}function getOwn(e,t){return hasProp(e,t)&&e[t]}function eachProp(e,t){var n;for(n in e)if(hasProp(e,n)&&t(e[n],n))break}function mixin(e,t,n,i){return t&&eachProp(t,function(t,r){(n||!hasProp(e,r))&&(i&&"string"!=typeof t?(e[r]||(e[r]={}),mixin(e[r],t,n,i)):e[r]=t)}),e}function bind(e,t){return function(){return t.apply(e,arguments)}}function scripts(){return document.getElementsByTagName("script")}function defaultOnError(e){throw e}function getGlobal(e){if(!e)return e;var t=global;return each(e.split("."),function(e){t=t[e]}),t}function makeError(e,t,n,i){var r=new Error(t+"\nhttp://requirejs.org/docs/errors.html#"+e);return r.requireType=e,r.requireModules=i,n&&(r.originalError=n),r}function newContext(e){function t(e){var t,n;for(t=0;e[t];t+=1)if(n=e[t],"."===n)e.splice(t,1),t-=1;else if(".."===n){if(1===t&&(".."===e[2]||".."===e[0]))break;t>0&&(e.splice(t-1,2),t-=2)}}function n(e,n,i){var r,o,a,s,l,c,u,d,h,f,p,g=n&&n.split("/"),m=g,v=k.map,y=v&&v["*"];if(e&&"."===e.charAt(0)&&(n?(m=getOwn(k.pkgs,n)?g=[n]:g.slice(0,g.length-1),e=m.concat(e.split("/")),t(e),o=getOwn(k.pkgs,r=e[0]),e=e.join("/"),o&&e===r+"/"+o.main&&(e=r)):0===e.indexOf("./")&&(e=e.substring(2))),i&&v&&(g||y)){for(s=e.split("/"),l=s.length;l>0;l-=1){if(u=s.slice(0,l).join("/"),g)for(c=g.length;c>0;c-=1)if(a=getOwn(v,g.slice(0,c).join("/")),a&&(a=getOwn(a,u))){d=a,h=l;break}if(d)break;!f&&y&&getOwn(y,u)&&(f=getOwn(y,u),p=l)}!d&&f&&(d=f,h=p),d&&(s.splice(0,h,d),e=s.join("/"))}return e}function i(e){isBrowser&&each(scripts(),function(t){return t.getAttribute("data-requiremodule")===e&&t.getAttribute("data-requirecontext")===w.contextName?(t.parentNode.removeChild(t),!0):void 0})}function r(e){var t=getOwn(k.paths,e);return t&&isArray(t)&&t.length>1?(t.shift(),w.require.undef(e),w.require([e]),!0):void 0}function o(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function a(e,t,i,r){var a,s,l,c,u=null,d=t?t.name:null,h=e,f=!0,p="";return e||(f=!1,e="_@r"+($+=1)),c=o(e),u=c[0],e=c[1],u&&(u=n(u,d,r),s=getOwn(S,u)),e&&(u?p=s&&s.normalize?s.normalize(e,function(e){return n(e,d,r)}):n(e,d,r):(p=n(e,d,r),c=o(p),u=c[0],p=c[1],i=!0,a=w.nameToUrl(p))),l=!u||s||i?"":"_unnormalized"+(A+=1),{prefix:u,name:p,parentMap:t,unnormalized:!!l,url:a,originalName:h,isDefine:f,id:(u?u+"!"+p:p)+l}}function s(e){var t=e.id,n=getOwn(_,t);return n||(n=_[t]=new w.Module(e)),n}function l(e,t,n){var i=e.id,r=getOwn(_,i);!hasProp(S,i)||r&&!r.defineEmitComplete?(r=s(e),r.error&&"error"===t?n(r.error):r.on(t,n)):"defined"===t&&n(S[i])}function c(e,t){var n=e.requireModules,i=!1;t?t(e):(each(n,function(t){var n=getOwn(_,t);n&&(n.error=e,n.events.error&&(i=!0,n.emit("error",e)))}),i||req.onError(e))}function u(){globalDefQueue.length&&(apsp.apply(N,[N.length-1,0].concat(globalDefQueue)),globalDefQueue=[])}function d(e){delete _[e],delete E[e]}function h(e,t,n){var i=e.map.id;e.error?e.emit("error",e.error):(t[i]=!0,each(e.depMaps,function(i,r){var o=i.id,a=getOwn(_,o);!a||e.depMatched[r]||n[o]||(getOwn(t,o)?(e.defineDep(r,S[o]),e.check()):h(a,t,n))}),n[i]=!0)}function f(){var e,t,n,o,a=1e3*k.waitSeconds,s=a&&w.startTime+a<(new Date).getTime(),l=[],u=[],d=!1,p=!0;if(!y){if(y=!0,eachProp(E,function(n){if(e=n.map,t=e.id,n.enabled&&(e.isDefine||u.push(n),!n.error))if(!n.inited&&s)r(t)?(o=!0,d=!0):(l.push(t),i(t));else if(!n.inited&&n.fetched&&e.isDefine&&(d=!0,!e.prefix))return p=!1}),s&&l.length)return n=makeError("timeout","Load timeout for modules: "+l,null,l),n.contextName=w.contextName,c(n);p&&each(u,function(e){h(e,{},{})}),s&&!o||!d||!isBrowser&&!isWebWorker||C||(C=setTimeout(function(){C=0,f()},50)),y=!1}}function p(e){hasProp(S,e[0])||s(a(e[0],null,!0)).init(e[1],e[2])}function g(e,t,n,i){e.detachEvent&&!isOpera?i&&e.detachEvent(i,t):e.removeEventListener(n,t,!1)}function m(e){var t=e.currentTarget||e.srcElement;return g(t,w.onScriptLoad,"load","onreadystatechange"),g(t,w.onScriptError,"error"),{node:t,id:t&&t.getAttribute("data-requiremodule")}}function v(){var e;for(u();N.length;){if(e=N.shift(),null===e[0])return c(makeError("mismatch","Mismatched anonymous define() module: "+e[e.length-1]));p(e)}}var y,b,w,x,C,k={waitSeconds:7,baseUrl:"./",paths:{},pkgs:{},shim:{},config:{}},_={},E={},T={},N=[],S={},R={},$=1,A=1;return x={require:function(e){return e.require?e.require:e.require=w.makeRequire(e.map)},exports:function(e){return e.usingExports=!0,e.map.isDefine?e.exports?e.exports:e.exports=S[e.map.id]={}:void 0},module:function(e){return e.module?e.module:e.module={id:e.map.id,uri:e.map.url,config:function(){var t,n=getOwn(k.pkgs,e.map.id);return t=n?getOwn(k.config,e.map.id+"/"+n.main):getOwn(k.config,e.map.id),t||{}},exports:S[e.map.id]}}},b=function(e){this.events=getOwn(T,e.id)||{},this.map=e,this.shim=getOwn(k.shim,e.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},b.prototype={init:function(e,t,n,i){i=i||{},this.inited||(this.factory=t,n?this.on("error",n):this.events.error&&(n=bind(this,function(e){this.emit("error",e)})),this.depMaps=e&&e.slice(0),this.errback=n,this.inited=!0,this.ignore=i.ignore,i.enabled||this.enabled?this.enable():this.check())},defineDep:function(e,t){this.depMatched[e]||(this.depMatched[e]=!0,this.depCount-=1,this.depExports[e]=t)},fetch:function(){if(!this.fetched){this.fetched=!0,w.startTime=(new Date).getTime();var e=this.map;return this.shim?(w.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,function(){return e.prefix?this.callPlugin():this.load()})),void 0):e.prefix?this.callPlugin():this.load()}},load:function(){var e=this.map.url;R[e]||(R[e]=!0,w.load(this.map.id,e))},check:function(){if(this.enabled&&!this.enabling){var e,t,n=this.map.id,i=this.depExports,r=this.exports,o=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,this.depCount<1&&!this.defined){if(isFunction(o)){if(this.events.error&&this.map.isDefine||req.onError!==defaultOnError)try{r=w.execCb(n,o,i,r)}catch(a){e=a}else r=w.execCb(n,o,i,r);if(this.map.isDefine&&(t=this.module,t&&void 0!==t.exports&&t.exports!==this.exports?r=t.exports:void 0===r&&this.usingExports&&(r=this.exports)),e)return e.requireMap=this.map,e.requireModules=this.map.isDefine?[this.map.id]:null,e.requireType=this.map.isDefine?"define":"require",c(this.error=e)}else r=o;this.exports=r,this.map.isDefine&&!this.ignore&&(S[n]=r,req.onResourceLoad&&req.onResourceLoad(w,this.map,this.depMaps)),d(n),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else this.fetch()}},callPlugin:function(){var e=this.map,t=e.id,i=a(e.prefix);this.depMaps.push(i),l(i,"defined",bind(this,function(i){var r,o,u,h=this.map.name,f=this.map.parentMap?this.map.parentMap.name:null,p=w.makeRequire(e.parentMap,{enableBuildCallback:!0});return this.map.unnormalized?(i.normalize&&(h=i.normalize(h,function(e){return n(e,f,!0)})||""),o=a(e.prefix+"!"+h,this.map.parentMap),l(o,"defined",bind(this,function(e){this.init([],function(){return e},null,{enabled:!0,ignore:!0})})),u=getOwn(_,o.id),u&&(this.depMaps.push(o),this.events.error&&u.on("error",bind(this,function(e){this.emit("error",e)})),u.enable()),void 0):(r=bind(this,function(e){this.init([],function(){return e},null,{enabled:!0})}),r.error=bind(this,function(e){this.inited=!0,this.error=e,e.requireModules=[t],eachProp(_,function(e){0===e.map.id.indexOf(t+"_unnormalized")&&d(e.map.id)}),c(e)}),r.fromText=bind(this,function(n,i){var o=e.name,l=a(o),u=useInteractive;i&&(n=i),u&&(useInteractive=!1),s(l),hasProp(k.config,t)&&(k.config[o]=k.config[t]);try{req.exec(n)}catch(d){return c(makeError("fromtexteval","fromText eval for "+t+" failed: "+d,d,[t]))}u&&(useInteractive=!0),this.depMaps.push(l),w.completeLoad(o),p([o],r)}),i.load(e.name,p,r,k),void 0)})),w.enable(i,this),this.pluginMaps[i.id]=i},enable:function(){E[this.map.id]=this,this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,function(e,t){var n,i,r;if("string"==typeof e){if(e=a(e,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[t]=e,r=getOwn(x,e.id))return this.depExports[t]=r(this),void 0;this.depCount+=1,l(e,"defined",bind(this,function(e){this.defineDep(t,e),this.check()})),this.errback&&l(e,"error",bind(this,this.errback))}n=e.id,i=_[n],hasProp(x,n)||!i||i.enabled||w.enable(e,this)})),eachProp(this.pluginMaps,bind(this,function(e){var t=getOwn(_,e.id);t&&!t.enabled&&w.enable(e,this)})),this.enabling=!1,this.check()},on:function(e,t){var n=this.events[e];n||(n=this.events[e]=[]),n.push(t)},emit:function(e,t){each(this.events[e],function(e){e(t)}),"error"===e&&delete this.events[e]}},w={config:k,contextName:e,registry:_,defined:S,urlFetched:R,defQueue:N,Module:b,makeModuleMap:a,nextTick:req.nextTick,onError:c,configure:function(e){e.baseUrl&&"/"!==e.baseUrl.charAt(e.baseUrl.length-1)&&(e.baseUrl+="/");var t=k.pkgs,n=k.shim,i={paths:!0,config:!0,map:!0};eachProp(e,function(e,t){i[t]?"map"===t?(k.map||(k.map={}),mixin(k[t],e,!0,!0)):mixin(k[t],e,!0):k[t]=e}),e.shim&&(eachProp(e.shim,function(e,t){isArray(e)&&(e={deps:e}),!e.exports&&!e.init||e.exportsFn||(e.exportsFn=w.makeShimExports(e)),n[t]=e}),k.shim=n),e.packages&&(each(e.packages,function(e){var n;e="string"==typeof e?{name:e}:e,n=e.location,t[e.name]={name:e.name,location:n||e.name,main:(e.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}}),k.pkgs=t),eachProp(_,function(e,t){e.inited||e.map.unnormalized||(e.map=a(t))}),(e.deps||e.callback)&&w.require(e.deps||[],e.callback)},makeShimExports:function(e){function t(){var t;return e.init&&(t=e.init.apply(global,arguments)),t||e.exports&&getGlobal(e.exports)}return t},makeRequire:function(t,r){function o(n,i,l){var u,d,h;return r.enableBuildCallback&&i&&isFunction(i)&&(i.__requireJsBuild=!0),"string"==typeof n?isFunction(i)?c(makeError("requireargs","Invalid require call"),l):t&&hasProp(x,n)?x[n](_[t.id]):req.get?req.get(w,n,t,o):(d=a(n,t,!1,!0),u=d.id,hasProp(S,u)?S[u]:c(makeError("notloaded",'Module name "'+u+'" has not been loaded yet for context: '+e+(t?"":". Use require([])")))):(v(),w.nextTick(function(){v(),h=s(a(null,t)),h.skipMap=r.skipMap,h.init(n,i,l,{enabled:!0}),f()}),o)}return r=r||{},mixin(o,{isBrowser:isBrowser,toUrl:function(e){var i,r=e.lastIndexOf("."),o=e.split("/")[0],a="."===o||".."===o;return-1!==r&&(!a||r>1)&&(i=e.substring(r,e.length),e=e.substring(0,r)),w.nameToUrl(n(e,t&&t.id,!0),i,!0)},defined:function(e){return hasProp(S,a(e,t,!1,!0).id)},specified:function(e){return e=a(e,t,!1,!0).id,hasProp(S,e)||hasProp(_,e)}}),t||(o.undef=function(e){u();var n=a(e,t,!0),r=getOwn(_,e);i(e),delete S[e],delete R[n.url],delete T[e],r&&(r.events.defined&&(T[e]=r.events),d(e))}),o},enable:function(e){var t=getOwn(_,e.id);t&&s(e).enable()},completeLoad:function(e){var t,n,i,o=getOwn(k.shim,e)||{},a=o.exports;for(u();N.length;){if(n=N.shift(),null===n[0]){if(n[0]=e,t)break;t=!0}else n[0]===e&&(t=!0);p(n)}if(i=getOwn(_,e),!t&&!hasProp(S,e)&&i&&!i.inited){if(!(!k.enforceDefine||a&&getGlobal(a)))return r(e)?void 0:c(makeError("nodefine","No define call for "+e,null,[e]));p([e,o.deps||[],o.exportsFn])}f()},nameToUrl:function(e,t,n){var i,r,o,a,s,l,c,u,d;if(req.jsExtRegExp.test(e))u=e+(t||"");else{for(i=k.paths,r=k.pkgs,s=e.split("/"),l=s.length;l>0;l-=1){if(c=s.slice(0,l).join("/"),o=getOwn(r,c),d=getOwn(i,c)){isArray(d)&&(d=d[0]),s.splice(0,l,d);break}if(o){a=e===o.name?o.location+"/"+o.main:o.location,s.splice(0,l,a);break}}u=s.join("/"),u+=t||(/^data\:|\?/.test(u)||n?"":".js"),u=("/"===u.charAt(0)||u.match(/^[\w\+\.\-]+:/)?"":k.baseUrl)+u}return k.urlArgs?u+((-1===u.indexOf("?")?"?":"&")+k.urlArgs):u},load:function(e,t){req.load(w,e,t)},execCb:function(e,t,n,i){return t.apply(i,n)},onScriptLoad:function(e){if("load"===e.type||readyRegExp.test((e.currentTarget||e.srcElement).readyState)){interactiveScript=null;var t=m(e);w.completeLoad(t.id)}},onScriptError:function(e){var t=m(e);return r(t.id)?void 0:c(makeError("scripterror","Script error for: "+t.id,e,[t.id]))}},w.require=w.makeRequire(),w}function getInteractiveScript(){return interactiveScript&&"interactive"===interactiveScript.readyState?interactiveScript:(eachReverse(scripts(),function(e){return"interactive"===e.readyState?interactiveScript=e:void 0}),interactiveScript)}var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.1.9",commentRegExp=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,ap=Array.prototype,apsp=ap.splice,isBrowser=!("undefined"==typeof window||"undefined"==typeof navigator||!window.document),isWebWorker=!isBrowser&&"undefined"!=typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),contexts={},cfg={},globalDefQueue=[],useInteractive=!1;if("undefined"==typeof define){if("undefined"!=typeof requirejs){if(isFunction(requirejs))return;cfg=requirejs,requirejs=void 0}"undefined"==typeof require||isFunction(require)||(cfg=require,require=void 0),req=requirejs=function(e,t,n,i){var r,o,a=defContextName;return isArray(e)||"string"==typeof e||(o=e,isArray(t)?(e=t,t=n,n=i):e=[]),o&&o.context&&(a=o.context),r=getOwn(contexts,a),r||(r=contexts[a]=req.s.newContext(a)),o&&r.configure(o),r.require(e,t,n)},req.config=function(e){return req(e)},req.nextTick="undefined"!=typeof setTimeout?function(e){setTimeout(e,4)}:function(e){e()},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],function(e){req[e]=function(){var t=contexts[defContextName];return t.require[e].apply(t,arguments)}}),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=defaultOnError,req.createNode=function(e){var t=e.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return t.type=e.scriptType||"text/javascript",t.charset="utf-8",t.async=!0,t},req.load=function(e,t,n){var i,r=e&&e.config||{};if(isBrowser)return i=req.createNode(r,t,n),i.setAttribute("data-requirecontext",e.contextName),i.setAttribute("data-requiremodule",t),!i.attachEvent||i.attachEvent.toString&&i.attachEvent.toString().indexOf("[native code")<0||isOpera?(i.addEventListener("load",e.onScriptLoad,!1),i.addEventListener("error",e.onScriptError,!1)):(useInteractive=!0,i.attachEvent("onreadystatechange",e.onScriptLoad)),i.src=n,currentlyAddingScript=i,baseElement?head.insertBefore(i,baseElement):head.appendChild(i),currentlyAddingScript=null,i;if(isWebWorker)try{importScripts(n),e.completeLoad(t)}catch(o){e.onError(makeError("importscripts","importScripts failed for "+t+" at "+n,o,[t]))}},isBrowser&&!cfg.skipDataMain&&eachReverse(scripts(),function(e){return head||(head=e.parentNode),dataMain=e.getAttribute("data-main"),dataMain?(mainScript=dataMain,cfg.baseUrl||(src=mainScript.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath),mainScript=mainScript.replace(jsSuffixRegExp,""),req.jsExtRegExp.test(mainScript)&&(mainScript=dataMain),cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript],!0):void 0}),define=function(e,t,n){var i,r;"string"!=typeof e&&(n=t,t=e,e=null),isArray(t)||(n=t,t=null),!t&&isFunction(n)&&(t=[],n.length&&(n.toString().replace(commentRegExp,"").replace(cjsRequireRegExp,function(e,n){t.push(n)}),t=(1===n.length?["require"]:["require","exports","module"]).concat(t))),useInteractive&&(i=currentlyAddingScript||getInteractiveScript(),i&&(e||(e=i.getAttribute("data-requiremodule")),r=contexts[i.getAttribute("data-requirecontext")])),(r?r.defQueue:globalDefQueue).push([e,t,n])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)}}(this),function(e,t){function n(e){var t=e.length,n=ut.type(e);return ut.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===n||"function"!==n&&(0===t||"number"==typeof t&&t>0&&t-1 in e)}function i(e){var t=Et[e]={};return ut.each(e.match(ht)||[],function(e,n){t[n]=!0}),t}function r(e,n,i,r){if(ut.acceptData(e)){var o,a,s=ut.expando,l=e.nodeType,c=l?ut.cache:e,u=l?e[s]:e[s]&&s;if(u&&c[u]&&(r||c[u].data)||i!==t||"string"!=typeof n)return u||(u=l?e[s]=tt.pop()||ut.guid++:s),c[u]||(c[u]=l?{}:{toJSON:ut.noop}),("object"==typeof n||"function"==typeof n)&&(r?c[u]=ut.extend(c[u],n):c[u].data=ut.extend(c[u].data,n)),a=c[u],r||(a.data||(a.data={}),a=a.data),i!==t&&(a[ut.camelCase(n)]=i),"string"==typeof n?(o=a[n],null==o&&(o=a[ut.camelCase(n)])):o=a,o}}function o(e,t,n){if(ut.acceptData(e)){var i,r,o=e.nodeType,a=o?ut.cache:e,l=o?e[ut.expando]:ut.expando;if(a[l]){if(t&&(i=n?a[l]:a[l].data)){ut.isArray(t)?t=t.concat(ut.map(t,ut.camelCase)):t in i?t=[t]:(t=ut.camelCase(t),t=t in i?[t]:t.split(" ")),r=t.length;for(;r--;)delete i[t[r]];if(n?!s(i):!ut.isEmptyObject(i))return}(n||(delete a[l].data,s(a[l])))&&(o?ut.cleanData([e],!0):ut.support.deleteExpando||a!=a.window?delete a[l]:a[l]=null)}}}function a(e,n,i){if(i===t&&1===e.nodeType){var r="data-"+n.replace(Nt,"-$1").toLowerCase();if(i=e.getAttribute(r),"string"==typeof i){try{i="true"===i?!0:"false"===i?!1:"null"===i?null:+i+""===i?+i:Tt.test(i)?ut.parseJSON(i):i}catch(o){}ut.data(e,n,i)}else i=t}return i}function s(e){var t;for(t in e)if(("data"!==t||!ut.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function l(){return!0}function c(){return!1}function u(){try{return Q.activeElement}catch(e){}}function d(e,t){do e=e[t];while(e&&1!==e.nodeType);return e}function h(e,t,n){if(ut.isFunction(t))return ut.grep(e,function(e,i){return!!t.call(e,i,e)!==n});if(t.nodeType)return ut.grep(e,function(e){return e===t!==n});if("string"==typeof t){if(Lt.test(t))return ut.filter(t,e,n);t=ut.filter(t,e)}return ut.grep(e,function(e){return ut.inArray(e,t)>=0!==n})}function f(e){var t=Ut.split("|"),n=e.createDocumentFragment();if(n.createElement)for(;t.length;)n.createElement(t.pop());return n}function p(e,t){return ut.nodeName(e,"table")&&ut.nodeName(1===t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function g(e){return e.type=(null!==ut.find.attr(e,"type"))+"/"+e.type,e}function m(e){var t=on.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function v(e,t){for(var n,i=0;null!=(n=e[i]);i++)ut._data(n,"globalEval",!t||ut._data(t[i],"globalEval"))}function y(e,t){if(1===t.nodeType&&ut.hasData(e)){var n,i,r,o=ut._data(e),a=ut._data(t,o),s=o.events;if(s){delete a.handle,a.events={};for(n in s)for(i=0,r=s[n].length;r>i;i++)ut.event.add(t,n,s[n][i])}a.data&&(a.data=ut.extend({},a.data))}}function b(e,t){var n,i,r;if(1===t.nodeType){if(n=t.nodeName.toLowerCase(),!ut.support.noCloneEvent&&t[ut.expando]){r=ut._data(t);for(i in r.events)ut.removeEvent(t,i,r.handle);t.removeAttribute(ut.expando)}"script"===n&&t.text!==e.text?(g(t).text=e.text,m(t)):"object"===n?(t.parentNode&&(t.outerHTML=e.outerHTML),ut.support.html5Clone&&e.innerHTML&&!ut.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===n&&tn.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===n?t.defaultSelected=t.selected=e.defaultSelected:("input"===n||"textarea"===n)&&(t.defaultValue=e.defaultValue)}}function w(e,n){var i,r,o=0,a=typeof e.getElementsByTagName!==X?e.getElementsByTagName(n||"*"):typeof e.querySelectorAll!==X?e.querySelectorAll(n||"*"):t;if(!a)for(a=[],i=e.childNodes||e;null!=(r=i[o]);o++)!n||ut.nodeName(r,n)?a.push(r):ut.merge(a,w(r,n));return n===t||n&&ut.nodeName(e,n)?ut.merge([e],a):a}function x(e){tn.test(e.type)&&(e.defaultChecked=e.checked)}function C(e,t){if(t in e)return t;for(var n=t.charAt(0).toUpperCase()+t.slice(1),i=t,r=En.length;r--;)if(t=En[r]+n,t in e)return t;return i}function k(e,t){return e=t||e,"none"===ut.css(e,"display")||!ut.contains(e.ownerDocument,e)}function _(e,t){for(var n,i,r,o=[],a=0,s=e.length;s>a;a++)i=e[a],i.style&&(o[a]=ut._data(i,"olddisplay"),n=i.style.display,t?(o[a]||"none"!==n||(i.style.display=""),""===i.style.display&&k(i)&&(o[a]=ut._data(i,"olddisplay",S(i.nodeName)))):o[a]||(r=k(i),(n&&"none"!==n||!r)&&ut._data(i,"olddisplay",r?n:ut.css(i,"display"))));for(a=0;s>a;a++)i=e[a],i.style&&(t&&"none"!==i.style.display&&""!==i.style.display||(i.style.display=t?o[a]||"":"none"));return e}function E(e,t,n){var i=yn.exec(t);return i?Math.max(0,i[1]-(n||0))+(i[2]||"px"):t}function T(e,t,n,i,r){for(var o=n===(i?"border":"content")?4:"width"===t?1:0,a=0;4>o;o+=2)"margin"===n&&(a+=ut.css(e,n+_n[o],!0,r)),i?("content"===n&&(a-=ut.css(e,"padding"+_n[o],!0,r)),"margin"!==n&&(a-=ut.css(e,"border"+_n[o]+"Width",!0,r))):(a+=ut.css(e,"padding"+_n[o],!0,r),"padding"!==n&&(a+=ut.css(e,"border"+_n[o]+"Width",!0,r)));return a}function N(e,t,n){var i=!0,r="width"===t?e.offsetWidth:e.offsetHeight,o=dn(e),a=ut.support.boxSizing&&"border-box"===ut.css(e,"boxSizing",!1,o);if(0>=r||null==r){if(r=hn(e,t,o),(0>r||null==r)&&(r=e.style[t]),bn.test(r))return r;i=a&&(ut.support.boxSizingReliable||r===e.style[t]),r=parseFloat(r)||0}return r+T(e,t,n||(a?"border":"content"),i,o)+"px"}function S(e){var t=Q,n=xn[e];return n||(n=R(e,t),"none"!==n&&n||(un=(un||ut("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement),t=(un[0].contentWindow||un[0].contentDocument).document,t.write("<!doctype html><html><body>"),t.close(),n=R(e,t),un.detach()),xn[e]=n),n}function R(e,t){var n=ut(t.createElement(e)).appendTo(t.body),i=ut.css(n[0],"display");return n.remove(),i}function $(e,t,n,i){var r;if(ut.isArray(t))ut.each(t,function(t,r){n||Nn.test(e)?i(e,r):$(e+"["+("object"==typeof r?t:"")+"]",r,n,i)});else if(n||"object"!==ut.type(t))i(e,t);else for(r in t)$(e+"["+r+"]",t[r],n,i)}function A(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var i,r=0,o=t.toLowerCase().match(ht)||[];if(ut.isFunction(n))for(;i=o[r++];)"+"===i[0]?(i=i.slice(1)||"*",(e[i]=e[i]||[]).unshift(n)):(e[i]=e[i]||[]).push(n)}}function O(e,t,n,i){function r(s){var l;return o[s]=!0,ut.each(e[s]||[],function(e,s){var c=s(t,n,i);return"string"!=typeof c||a||o[c]?a?!(l=c):void 0:(t.dataTypes.unshift(c),r(c),!1)}),l}var o={},a=e===zn;return r(t.dataTypes[0])||!o["*"]&&r("*")}function D(e,n){var i,r,o=ut.ajaxSettings.flatOptions||{};for(r in n)n[r]!==t&&((o[r]?e:i||(i={}))[r]=n[r]);return i&&ut.extend(!0,e,i),e}function M(e,n,i){for(var r,o,a,s,l=e.contents,c=e.dataTypes;"*"===c[0];)c.shift(),o===t&&(o=e.mimeType||n.getResponseHeader("Content-Type"));if(o)for(s in l)if(l[s]&&l[s].test(o)){c.unshift(s);break}if(c[0]in i)a=c[0];else{for(s in i){if(!c[0]||e.converters[s+" "+c[0]]){a=s;break}r||(r=s)}a=a||r}return a?(a!==c[0]&&c.unshift(a),i[a]):void 0}function B(e,t,n,i){var r,o,a,s,l,c={},u=e.dataTypes.slice();if(u[1])for(a in e.converters)c[a.toLowerCase()]=e.converters[a];for(o=u.shift();o;)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!l&&i&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=o,o=u.shift())if("*"===o)o=l;else if("*"!==l&&l!==o){if(a=c[l+" "+o]||c["* "+o],!a)for(r in c)if(s=r.split(" "),s[1]===o&&(a=c[l+" "+s[0]]||c["* "+s[0]])){a===!0?a=c[r]:c[r]!==!0&&(o=s[0],u.unshift(s[1]));break}if(a!==!0)if(a&&e["throws"])t=a(t);else try{t=a(t)}catch(d){return{state:"parsererror",error:a?d:"No conversion from "+l+" to "+o}}}return{state:"success",data:t}}function j(){try{return new e.XMLHttpRequest}catch(t){}}function P(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function H(){return setTimeout(function(){Zn=t}),Zn=ut.now()}function I(e,t,n){for(var i,r=(oi[t]||[]).concat(oi["*"]),o=0,a=r.length;a>o;o++)if(i=r[o].call(n,t,e))return i}function q(e,t,n){var i,r,o=0,a=ri.length,s=ut.Deferred().always(function(){delete l.elem}),l=function(){if(r)return!1;for(var t=Zn||H(),n=Math.max(0,c.startTime+c.duration-t),i=n/c.duration||0,o=1-i,a=0,l=c.tweens.length;l>a;a++)c.tweens[a].run(o);return s.notifyWith(e,[c,o,n]),1>o&&l?n:(s.resolveWith(e,[c]),!1)},c=s.promise({elem:e,props:ut.extend({},t),opts:ut.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:Zn||H(),duration:n.duration,tweens:[],createTween:function(t,n){var i=ut.Tween(e,c.opts,t,n,c.opts.specialEasing[t]||c.opts.easing);return c.tweens.push(i),i},stop:function(t){var n=0,i=t?c.tweens.length:0;if(r)return this;for(r=!0;i>n;n++)c.tweens[n].run(1);return t?s.resolveWith(e,[c,t]):s.rejectWith(e,[c,t]),this}}),u=c.props;for(V(u,c.opts.specialEasing);a>o;o++)if(i=ri[o].call(c,e,u,c.opts))return i;return ut.map(u,I,c),ut.isFunction(c.opts.start)&&c.opts.start.call(e,c),ut.fx.timer(ut.extend(l,{elem:e,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}function V(e,t){var n,i,r,o,a;for(n in e)if(i=ut.camelCase(n),r=t[i],o=e[n],ut.isArray(o)&&(r=o[1],o=e[n]=o[0]),n!==i&&(e[i]=o,delete e[n]),a=ut.cssHooks[i],a&&"expand"in a){o=a.expand(o),delete e[i];for(n in o)n in e||(e[n]=o[n],t[n]=r)}else t[i]=r}function L(e,t,n){var i,r,o,a,s,l,c=this,u={},d=e.style,h=e.nodeType&&k(e),f=ut._data(e,"fxshow");n.queue||(s=ut._queueHooks(e,"fx"),null==s.unqueued&&(s.unqueued=0,l=s.empty.fire,s.empty.fire=function(){s.unqueued||l()}),s.unqueued++,c.always(function(){c.always(function(){s.unqueued--,ut.queue(e,"fx").length||s.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[d.overflow,d.overflowX,d.overflowY],"inline"===ut.css(e,"display")&&"none"===ut.css(e,"float")&&(ut.support.inlineBlockNeedsLayout&&"inline"!==S(e.nodeName)?d.zoom=1:d.display="inline-block")),n.overflow&&(d.overflow="hidden",ut.support.shrinkWrapBlocks||c.always(function(){d.overflow=n.overflow[0],d.overflowX=n.overflow[1],d.overflowY=n.overflow[2]}));for(i in t)if(r=t[i],ti.exec(r)){if(delete t[i],o=o||"toggle"===r,r===(h?"hide":"show"))continue;u[i]=f&&f[i]||ut.style(e,i)}if(!ut.isEmptyObject(u)){f?"hidden"in f&&(h=f.hidden):f=ut._data(e,"fxshow",{}),o&&(f.hidden=!h),h?ut(e).show():c.done(function(){ut(e).hide()}),c.done(function(){var t;ut._removeData(e,"fxshow");for(t in u)ut.style(e,t,u[t])});for(i in u)a=I(h?f[i]:0,i,c),i in f||(f[i]=a.start,h&&(a.end=a.start,a.start="width"===i||"height"===i?1:0))}}function F(e,t,n,i,r){return new F.prototype.init(e,t,n,i,r)}function z(e,t){var n,i={height:e},r=0;for(t=t?1:0;4>r;r+=2-t)n=_n[r],i["margin"+n]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function W(e){return ut.isWindow(e)?e:9===e.nodeType?e.defaultView||e.parentWindow:!1}var U,J,X=typeof t,K=e.location,Q=e.document,G=Q.documentElement,Y=e.jQuery,Z=e.$,et={},tt=[],nt="1.10.2",it=tt.concat,rt=tt.push,ot=tt.slice,at=tt.indexOf,st=et.toString,lt=et.hasOwnProperty,ct=nt.trim,ut=function(e,t){return new ut.fn.init(e,t,J)},dt=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ht=/\S+/g,ft=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,pt=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,gt=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,mt=/^[\],:{}\s]*$/,vt=/(?:^|:|,)(?:\s*\[)+/g,yt=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,bt=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,wt=/^-ms-/,xt=/-([\da-z])/gi,Ct=function(e,t){return t.toUpperCase()},kt=function(e){(Q.addEventListener||"load"===e.type||"complete"===Q.readyState)&&(_t(),ut.ready())},_t=function(){Q.addEventListener?(Q.removeEventListener("DOMContentLoaded",kt,!1),e.removeEventListener("load",kt,!1)):(Q.detachEvent("onreadystatechange",kt),e.detachEvent("onload",kt))};ut.fn=ut.prototype={jquery:nt,constructor:ut,init:function(e,n,i){var r,o;if(!e)return this;if("string"==typeof e){if(r="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:pt.exec(e),!r||!r[1]&&n)return!n||n.jquery?(n||i).find(e):this.constructor(n).find(e);if(r[1]){if(n=n instanceof ut?n[0]:n,ut.merge(this,ut.parseHTML(r[1],n&&n.nodeType?n.ownerDocument||n:Q,!0)),gt.test(r[1])&&ut.isPlainObject(n))for(r in n)ut.isFunction(this[r])?this[r](n[r]):this.attr(r,n[r]);return this}if(o=Q.getElementById(r[2]),o&&o.parentNode){if(o.id!==r[2])return i.find(e);this.length=1,this[0]=o}return this.context=Q,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):ut.isFunction(e)?i.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),ut.makeArray(e,this))},selector:"",length:0,toArray:function(){return ot.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e){var t=ut.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return ut.each(this,e,t)},ready:function(e){return ut.ready.promise().done(e),this},slice:function(){return this.pushStack(ot.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},map:function(e){return this.pushStack(ut.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:rt,sort:[].sort,splice:[].splice},ut.fn.init.prototype=ut.fn,ut.extend=ut.fn.extend=function(){var e,n,i,r,o,a,s=arguments[0]||{},l=1,c=arguments.length,u=!1;for("boolean"==typeof s&&(u=s,s=arguments[1]||{},l=2),"object"==typeof s||ut.isFunction(s)||(s={}),c===l&&(s=this,--l);c>l;l++)if(null!=(o=arguments[l]))for(r in o)e=s[r],i=o[r],s!==i&&(u&&i&&(ut.isPlainObject(i)||(n=ut.isArray(i)))?(n?(n=!1,a=e&&ut.isArray(e)?e:[]):a=e&&ut.isPlainObject(e)?e:{},s[r]=ut.extend(u,a,i)):i!==t&&(s[r]=i));return s},ut.extend({expando:"jQuery"+(nt+Math.random()).replace(/\D/g,""),noConflict:function(t){return e.$===ut&&(e.$=Z),t&&e.jQuery===ut&&(e.jQuery=Y),ut},isReady:!1,readyWait:1,holdReady:function(e){e?ut.readyWait++:ut.ready(!0)},ready:function(e){if(e===!0?!--ut.readyWait:!ut.isReady){if(!Q.body)return setTimeout(ut.ready);ut.isReady=!0,e!==!0&&--ut.readyWait>0||(U.resolveWith(Q,[ut]),ut.fn.trigger&&ut(Q).trigger("ready").off("ready"))}},isFunction:function(e){return"function"===ut.type(e)},isArray:Array.isArray||function(e){return"array"===ut.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?String(e):"object"==typeof e||"function"==typeof e?et[st.call(e)]||"object":typeof e},isPlainObject:function(e){var n;if(!e||"object"!==ut.type(e)||e.nodeType||ut.isWindow(e))return!1;try{if(e.constructor&&!lt.call(e,"constructor")&&!lt.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(i){return!1}if(ut.support.ownLast)for(n in e)return lt.call(e,n);for(n in e);return n===t||lt.call(e,n)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw new Error(e)},parseHTML:function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||Q;var i=gt.exec(e),r=!n&&[];return i?[t.createElement(i[1])]:(i=ut.buildFragment([e],t,r),r&&ut(r).remove(),ut.merge([],i.childNodes))},parseJSON:function(t){return e.JSON&&e.JSON.parse?e.JSON.parse(t):null===t?t:"string"==typeof t&&(t=ut.trim(t),t&&mt.test(t.replace(yt,"@").replace(bt,"]").replace(vt,"")))?new Function("return "+t)():(ut.error("Invalid JSON: "+t),void 0)},parseXML:function(n){var i,r;if(!n||"string"!=typeof n)return null;try{e.DOMParser?(r=new DOMParser,i=r.parseFromString(n,"text/xml")):(i=new ActiveXObject("Microsoft.XMLDOM"),i.async="false",i.loadXML(n))}catch(o){i=t}return i&&i.documentElement&&!i.getElementsByTagName("parsererror").length||ut.error("Invalid XML: "+n),i},noop:function(){},globalEval:function(t){t&&ut.trim(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(wt,"ms-").replace(xt,Ct)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,i){var r,o=0,a=e.length,s=n(e);if(i){if(s)for(;a>o&&(r=t.apply(e[o],i),r!==!1);o++);else for(o in e)if(r=t.apply(e[o],i),r===!1)break}else if(s)for(;a>o&&(r=t.call(e[o],o,e[o]),r!==!1);o++);else for(o in e)if(r=t.call(e[o],o,e[o]),r===!1)break;
return e},trim:ct&&!ct.call("﻿ ")?function(e){return null==e?"":ct.call(e)}:function(e){return null==e?"":(e+"").replace(ft,"")},makeArray:function(e,t){var i=t||[];return null!=e&&(n(Object(e))?ut.merge(i,"string"==typeof e?[e]:e):rt.call(i,e)),i},inArray:function(e,t,n){var i;if(t){if(at)return at.call(t,e,n);for(i=t.length,n=n?0>n?Math.max(0,i+n):n:0;i>n;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,n){var i=n.length,r=e.length,o=0;if("number"==typeof i)for(;i>o;o++)e[r++]=n[o];else for(;n[o]!==t;)e[r++]=n[o++];return e.length=r,e},grep:function(e,t,n){var i,r=[],o=0,a=e.length;for(n=!!n;a>o;o++)i=!!t(e[o],o),n!==i&&r.push(e[o]);return r},map:function(e,t,i){var r,o=0,a=e.length,s=n(e),l=[];if(s)for(;a>o;o++)r=t(e[o],o,i),null!=r&&(l[l.length]=r);else for(o in e)r=t(e[o],o,i),null!=r&&(l[l.length]=r);return it.apply([],l)},guid:1,proxy:function(e,n){var i,r,o;return"string"==typeof n&&(o=e[n],n=e,e=o),ut.isFunction(e)?(i=ot.call(arguments,2),r=function(){return e.apply(n||this,i.concat(ot.call(arguments)))},r.guid=e.guid=e.guid||ut.guid++,r):t},access:function(e,n,i,r,o,a,s){var l=0,c=e.length,u=null==i;if("object"===ut.type(i)){o=!0;for(l in i)ut.access(e,n,l,i[l],!0,a,s)}else if(r!==t&&(o=!0,ut.isFunction(r)||(s=!0),u&&(s?(n.call(e,r),n=null):(u=n,n=function(e,t,n){return u.call(ut(e),n)})),n))for(;c>l;l++)n(e[l],i,s?r:r.call(e[l],l,n(e[l],i)));return o?e:u?n.call(e):c?n(e[0],i):a},now:function(){return(new Date).getTime()},swap:function(e,t,n,i){var r,o,a={};for(o in t)a[o]=e.style[o],e.style[o]=t[o];r=n.apply(e,i||[]);for(o in t)e.style[o]=a[o];return r}}),ut.ready.promise=function(t){if(!U)if(U=ut.Deferred(),"complete"===Q.readyState)setTimeout(ut.ready);else if(Q.addEventListener)Q.addEventListener("DOMContentLoaded",kt,!1),e.addEventListener("load",kt,!1);else{Q.attachEvent("onreadystatechange",kt),e.attachEvent("onload",kt);var n=!1;try{n=null==e.frameElement&&Q.documentElement}catch(i){}n&&n.doScroll&&!function r(){if(!ut.isReady){try{n.doScroll("left")}catch(e){return setTimeout(r,50)}_t(),ut.ready()}}()}return U.promise(t)},ut.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){et["[object "+t+"]"]=t.toLowerCase()}),J=ut(Q),function(e,t){function n(e,t,n,i){var r,o,a,s,l,c,u,d,p,g;if((t?t.ownerDocument||t:q)!==O&&A(t),t=t||O,n=n||[],!e||"string"!=typeof e)return n;if(1!==(s=t.nodeType)&&9!==s)return[];if(M&&!i){if(r=bt.exec(e))if(a=r[1]){if(9===s){if(o=t.getElementById(a),!o||!o.parentNode)return n;if(o.id===a)return n.push(o),n}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(a))&&H(t,o)&&o.id===a)return n.push(o),n}else{if(r[2])return et.apply(n,t.getElementsByTagName(e)),n;if((a=r[3])&&k.getElementsByClassName&&t.getElementsByClassName)return et.apply(n,t.getElementsByClassName(a)),n}if(k.qsa&&(!B||!B.test(e))){if(d=u=I,p=t,g=9===s&&e,1===s&&"object"!==t.nodeName.toLowerCase()){for(c=h(e),(u=t.getAttribute("id"))?d=u.replace(Ct,"\\$&"):t.setAttribute("id",d),d="[id='"+d+"'] ",l=c.length;l--;)c[l]=d+f(c[l]);p=ft.test(e)&&t.parentNode||t,g=c.join(",")}if(g)try{return et.apply(n,p.querySelectorAll(g)),n}catch(m){}finally{u||t.removeAttribute("id")}}}return x(e.replace(ct,"$1"),t,n,i)}function i(){function e(n,i){return t.push(n+=" ")>E.cacheLength&&delete e[t.shift()],e[n]=i}var t=[];return e}function r(e){return e[I]=!0,e}function o(e){var t=O.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function a(e,t){for(var n=e.split("|"),i=e.length;i--;)E.attrHandle[n[i]]=t}function s(e,t){var n=t&&e,i=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||K)-(~e.sourceIndex||K);if(i)return i;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function l(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function c(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function u(e){return r(function(t){return t=+t,r(function(n,i){for(var r,o=e([],n.length,t),a=o.length;a--;)n[r=o[a]]&&(n[r]=!(i[r]=n[r]))})})}function d(){}function h(e,t){var i,r,o,a,s,l,c,u=z[e+" "];if(u)return t?0:u.slice(0);for(s=e,l=[],c=E.preFilter;s;){(!i||(r=dt.exec(s)))&&(r&&(s=s.slice(r[0].length)||s),l.push(o=[])),i=!1,(r=ht.exec(s))&&(i=r.shift(),o.push({value:i,type:r[0].replace(ct," ")}),s=s.slice(i.length));for(a in E.filter)!(r=vt[a].exec(s))||c[a]&&!(r=c[a](r))||(i=r.shift(),o.push({value:i,type:a,matches:r}),s=s.slice(i.length));if(!i)break}return t?s.length:s?n.error(e):z(e,l).slice(0)}function f(e){for(var t=0,n=e.length,i="";n>t;t++)i+=e[t].value;return i}function p(e,t,n){var i=t.dir,r=n&&"parentNode"===i,o=L++;return t.first?function(t,n,o){for(;t=t[i];)if(1===t.nodeType||r)return e(t,n,o)}:function(t,n,a){var s,l,c,u=V+" "+o;if(a){for(;t=t[i];)if((1===t.nodeType||r)&&e(t,n,a))return!0}else for(;t=t[i];)if(1===t.nodeType||r)if(c=t[I]||(t[I]={}),(l=c[i])&&l[0]===u){if((s=l[1])===!0||s===_)return s===!0}else if(l=c[i]=[u],l[1]=e(t,n,a)||_,l[1]===!0)return!0}}function g(e){return e.length>1?function(t,n,i){for(var r=e.length;r--;)if(!e[r](t,n,i))return!1;return!0}:e[0]}function m(e,t,n,i,r){for(var o,a=[],s=0,l=e.length,c=null!=t;l>s;s++)(o=e[s])&&(!n||n(o,i,r))&&(a.push(o),c&&t.push(s));return a}function v(e,t,n,i,o,a){return i&&!i[I]&&(i=v(i)),o&&!o[I]&&(o=v(o,a)),r(function(r,a,s,l){var c,u,d,h=[],f=[],p=a.length,g=r||w(t||"*",s.nodeType?[s]:s,[]),v=!e||!r&&t?g:m(g,h,e,s,l),y=n?o||(r?e:p||i)?[]:a:v;if(n&&n(v,y,s,l),i)for(c=m(y,f),i(c,[],s,l),u=c.length;u--;)(d=c[u])&&(y[f[u]]=!(v[f[u]]=d));if(r){if(o||e){if(o){for(c=[],u=y.length;u--;)(d=y[u])&&c.push(v[u]=d);o(null,y=[],c,l)}for(u=y.length;u--;)(d=y[u])&&(c=o?nt.call(r,d):h[u])>-1&&(r[c]=!(a[c]=d))}}else y=m(y===a?y.splice(p,y.length):y),o?o(null,a,y,l):et.apply(a,y)})}function y(e){for(var t,n,i,r=e.length,o=E.relative[e[0].type],a=o||E.relative[" "],s=o?1:0,l=p(function(e){return e===t},a,!0),c=p(function(e){return nt.call(t,e)>-1},a,!0),u=[function(e,n,i){return!o&&(i||n!==R)||((t=n).nodeType?l(e,n,i):c(e,n,i))}];r>s;s++)if(n=E.relative[e[s].type])u=[p(g(u),n)];else{if(n=E.filter[e[s].type].apply(null,e[s].matches),n[I]){for(i=++s;r>i&&!E.relative[e[i].type];i++);return v(s>1&&g(u),s>1&&f(e.slice(0,s-1).concat({value:" "===e[s-2].type?"*":""})).replace(ct,"$1"),n,i>s&&y(e.slice(s,i)),r>i&&y(e=e.slice(i)),r>i&&f(e))}u.push(n)}return g(u)}function b(e,t){var i=0,o=t.length>0,a=e.length>0,s=function(r,s,l,c,u){var d,h,f,p=[],g=0,v="0",y=r&&[],b=null!=u,w=R,x=r||a&&E.find.TAG("*",u&&s.parentNode||s),C=V+=null==w?1:Math.random()||.1;for(b&&(R=s!==O&&s,_=i);null!=(d=x[v]);v++){if(a&&d){for(h=0;f=e[h++];)if(f(d,s,l)){c.push(d);break}b&&(V=C,_=++i)}o&&((d=!f&&d)&&g--,r&&y.push(d))}if(g+=v,o&&v!==g){for(h=0;f=t[h++];)f(y,p,s,l);if(r){if(g>0)for(;v--;)y[v]||p[v]||(p[v]=Y.call(c));p=m(p)}et.apply(c,p),b&&!r&&p.length>0&&g+t.length>1&&n.uniqueSort(c)}return b&&(V=C,R=w),y};return o?r(s):s}function w(e,t,i){for(var r=0,o=t.length;o>r;r++)n(e,t[r],i);return i}function x(e,t,n,i){var r,o,a,s,l,c=h(e);if(!i&&1===c.length){if(o=c[0]=c[0].slice(0),o.length>2&&"ID"===(a=o[0]).type&&k.getById&&9===t.nodeType&&M&&E.relative[o[1].type]){if(t=(E.find.ID(a.matches[0].replace(kt,_t),t)||[])[0],!t)return n;e=e.slice(o.shift().value.length)}for(r=vt.needsContext.test(e)?0:o.length;r--&&(a=o[r],!E.relative[s=a.type]);)if((l=E.find[s])&&(i=l(a.matches[0].replace(kt,_t),ft.test(o[0].type)&&t.parentNode||t))){if(o.splice(r,1),e=i.length&&f(o),!e)return et.apply(n,i),n;break}}return S(e,c)(i,t,!M,n,ft.test(e)),n}var C,k,_,E,T,N,S,R,$,A,O,D,M,B,j,P,H,I="sizzle"+-new Date,q=e.document,V=0,L=0,F=i(),z=i(),W=i(),U=!1,J=function(e,t){return e===t?(U=!0,0):0},X=typeof t,K=1<<31,Q={}.hasOwnProperty,G=[],Y=G.pop,Z=G.push,et=G.push,tt=G.slice,nt=G.indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(this[t]===e)return t;return-1},it="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",rt="[\\x20\\t\\r\\n\\f]",ot="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",at=ot.replace("w","w#"),st="\\["+rt+"*("+ot+")"+rt+"*(?:([*^$|!~]?=)"+rt+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+at+")|)|)"+rt+"*\\]",lt=":("+ot+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+st.replace(3,8)+")*)|.*)\\)|)",ct=new RegExp("^"+rt+"+|((?:^|[^\\\\])(?:\\\\.)*)"+rt+"+$","g"),dt=new RegExp("^"+rt+"*,"+rt+"*"),ht=new RegExp("^"+rt+"*([>+~]|"+rt+")"+rt+"*"),ft=new RegExp(rt+"*[+~]"),pt=new RegExp("="+rt+"*([^\\]'\"]*)"+rt+"*\\]","g"),gt=new RegExp(lt),mt=new RegExp("^"+at+"$"),vt={ID:new RegExp("^#("+ot+")"),CLASS:new RegExp("^\\.("+ot+")"),TAG:new RegExp("^("+ot.replace("w","w*")+")"),ATTR:new RegExp("^"+st),PSEUDO:new RegExp("^"+lt),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+rt+"*(even|odd|(([+-]|)(\\d*)n|)"+rt+"*(?:([+-]|)"+rt+"*(\\d+)|))"+rt+"*\\)|)","i"),bool:new RegExp("^(?:"+it+")$","i"),needsContext:new RegExp("^"+rt+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+rt+"*((?:-\\d)?\\d*)"+rt+"*\\)|)(?=[^-]|$)","i")},yt=/^[^{]+\{\s*\[native \w/,bt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,wt=/^(?:input|select|textarea|button)$/i,xt=/^h\d$/i,Ct=/'|\\/g,kt=new RegExp("\\\\([\\da-f]{1,6}"+rt+"?|("+rt+")|.)","ig"),_t=function(e,t,n){var i="0x"+t-65536;return i!==i||n?t:0>i?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320)};try{et.apply(G=tt.call(q.childNodes),q.childNodes),G[q.childNodes.length].nodeType}catch(Et){et={apply:G.length?function(e,t){Z.apply(e,tt.call(t))}:function(e,t){for(var n=e.length,i=0;e[n++]=t[i++];);e.length=n-1}}}N=n.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},k=n.support={},A=n.setDocument=function(e){var t=e?e.ownerDocument||e:q,n=t.defaultView;return t!==O&&9===t.nodeType&&t.documentElement?(O=t,D=t.documentElement,M=!N(t),n&&n.attachEvent&&n!==n.top&&n.attachEvent("onbeforeunload",function(){A()}),k.attributes=o(function(e){return e.className="i",!e.getAttribute("className")}),k.getElementsByTagName=o(function(e){return e.appendChild(t.createComment("")),!e.getElementsByTagName("*").length}),k.getElementsByClassName=o(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",2===e.getElementsByClassName("i").length}),k.getById=o(function(e){return D.appendChild(e).id=I,!t.getElementsByName||!t.getElementsByName(I).length}),k.getById?(E.find.ID=function(e,t){if(typeof t.getElementById!==X&&M){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},E.filter.ID=function(e){var t=e.replace(kt,_t);return function(e){return e.getAttribute("id")===t}}):(delete E.find.ID,E.filter.ID=function(e){var t=e.replace(kt,_t);return function(e){var n=typeof e.getAttributeNode!==X&&e.getAttributeNode("id");return n&&n.value===t}}),E.find.TAG=k.getElementsByTagName?function(e,t){return typeof t.getElementsByTagName!==X?t.getElementsByTagName(e):void 0}:function(e,t){var n,i=[],r=0,o=t.getElementsByTagName(e);if("*"===e){for(;n=o[r++];)1===n.nodeType&&i.push(n);return i}return o},E.find.CLASS=k.getElementsByClassName&&function(e,t){return typeof t.getElementsByClassName!==X&&M?t.getElementsByClassName(e):void 0},j=[],B=[],(k.qsa=yt.test(t.querySelectorAll))&&(o(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||B.push("\\["+rt+"*(?:value|"+it+")"),e.querySelectorAll(":checked").length||B.push(":checked")}),o(function(e){var n=t.createElement("input");n.setAttribute("type","hidden"),e.appendChild(n).setAttribute("t",""),e.querySelectorAll("[t^='']").length&&B.push("[*^$]="+rt+"*(?:''|\"\")"),e.querySelectorAll(":enabled").length||B.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),B.push(",.*:")})),(k.matchesSelector=yt.test(P=D.webkitMatchesSelector||D.mozMatchesSelector||D.oMatchesSelector||D.msMatchesSelector))&&o(function(e){k.disconnectedMatch=P.call(e,"div"),P.call(e,"[s!='']:x"),j.push("!=",lt)}),B=B.length&&new RegExp(B.join("|")),j=j.length&&new RegExp(j.join("|")),H=yt.test(D.contains)||D.compareDocumentPosition?function(e,t){var n=9===e.nodeType?e.documentElement:e,i=t&&t.parentNode;return e===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):e.compareDocumentPosition&&16&e.compareDocumentPosition(i)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},J=D.compareDocumentPosition?function(e,n){if(e===n)return U=!0,0;var i=n.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(n);return i?1&i||!k.sortDetached&&n.compareDocumentPosition(e)===i?e===t||H(q,e)?-1:n===t||H(q,n)?1:$?nt.call($,e)-nt.call($,n):0:4&i?-1:1:e.compareDocumentPosition?-1:1}:function(e,n){var i,r=0,o=e.parentNode,a=n.parentNode,l=[e],c=[n];if(e===n)return U=!0,0;if(!o||!a)return e===t?-1:n===t?1:o?-1:a?1:$?nt.call($,e)-nt.call($,n):0;if(o===a)return s(e,n);for(i=e;i=i.parentNode;)l.unshift(i);for(i=n;i=i.parentNode;)c.unshift(i);for(;l[r]===c[r];)r++;return r?s(l[r],c[r]):l[r]===q?-1:c[r]===q?1:0},t):O},n.matches=function(e,t){return n(e,null,null,t)},n.matchesSelector=function(e,t){if((e.ownerDocument||e)!==O&&A(e),t=t.replace(pt,"='$1']"),!(!k.matchesSelector||!M||j&&j.test(t)||B&&B.test(t)))try{var i=P.call(e,t);if(i||k.disconnectedMatch||e.document&&11!==e.document.nodeType)return i}catch(r){}return n(t,O,null,[e]).length>0},n.contains=function(e,t){return(e.ownerDocument||e)!==O&&A(e),H(e,t)},n.attr=function(e,n){(e.ownerDocument||e)!==O&&A(e);var i=E.attrHandle[n.toLowerCase()],r=i&&Q.call(E.attrHandle,n.toLowerCase())?i(e,n,!M):t;return r===t?k.attributes||!M?e.getAttribute(n):(r=e.getAttributeNode(n))&&r.specified?r.value:null:r},n.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},n.uniqueSort=function(e){var t,n=[],i=0,r=0;if(U=!k.detectDuplicates,$=!k.sortStable&&e.slice(0),e.sort(J),U){for(;t=e[r++];)t===e[r]&&(i=n.push(r));for(;i--;)e.splice(n[i],1)}return e},T=n.getText=function(e){var t,n="",i=0,r=e.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=T(e)}else if(3===r||4===r)return e.nodeValue}else for(;t=e[i];i++)n+=T(t);return n},E=n.selectors={cacheLength:50,createPseudo:r,match:vt,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(kt,_t),e[3]=(e[4]||e[5]||"").replace(kt,_t),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||n.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&n.error(e[0]),e},PSEUDO:function(e){var n,i=!e[5]&&e[2];return vt.CHILD.test(e[0])?null:(e[3]&&e[4]!==t?e[2]=e[4]:i&&gt.test(i)&&(n=h(i,!0))&&(n=i.indexOf(")",i.length-n)-i.length)&&(e[0]=e[0].slice(0,n),e[2]=i.slice(0,n)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(kt,_t).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=F[e+" "];return t||(t=new RegExp("(^|"+rt+")"+e+"("+rt+"|$)"))&&F(e,function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!==X&&e.getAttribute("class")||"")})},ATTR:function(e,t,i){return function(r){var o=n.attr(r,e);return null==o?"!="===t:t?(o+="","="===t?o===i:"!="===t?o!==i:"^="===t?i&&0===o.indexOf(i):"*="===t?i&&o.indexOf(i)>-1:"$="===t?i&&o.slice(-i.length)===i:"~="===t?(" "+o+" ").indexOf(i)>-1:"|="===t?o===i||o.slice(0,i.length+1)===i+"-":!1):!0}},CHILD:function(e,t,n,i,r){var o="nth"!==e.slice(0,3),a="last"!==e.slice(-4),s="of-type"===t;return 1===i&&0===r?function(e){return!!e.parentNode}:function(t,n,l){var c,u,d,h,f,p,g=o!==a?"nextSibling":"previousSibling",m=t.parentNode,v=s&&t.nodeName.toLowerCase(),y=!l&&!s;if(m){if(o){for(;g;){for(d=t;d=d[g];)if(s?d.nodeName.toLowerCase()===v:1===d.nodeType)return!1;p=g="only"===e&&!p&&"nextSibling"}return!0}if(p=[a?m.firstChild:m.lastChild],a&&y){for(u=m[I]||(m[I]={}),c=u[e]||[],f=c[0]===V&&c[1],h=c[0]===V&&c[2],d=f&&m.childNodes[f];d=++f&&d&&d[g]||(h=f=0)||p.pop();)if(1===d.nodeType&&++h&&d===t){u[e]=[V,f,h];break}}else if(y&&(c=(t[I]||(t[I]={}))[e])&&c[0]===V)h=c[1];else for(;(d=++f&&d&&d[g]||(h=f=0)||p.pop())&&((s?d.nodeName.toLowerCase()!==v:1!==d.nodeType)||!++h||(y&&((d[I]||(d[I]={}))[e]=[V,h]),d!==t)););return h-=r,h===i||h%i===0&&h/i>=0}}},PSEUDO:function(e,t){var i,o=E.pseudos[e]||E.setFilters[e.toLowerCase()]||n.error("unsupported pseudo: "+e);return o[I]?o(t):o.length>1?(i=[e,e,"",t],E.setFilters.hasOwnProperty(e.toLowerCase())?r(function(e,n){for(var i,r=o(e,t),a=r.length;a--;)i=nt.call(e,r[a]),e[i]=!(n[i]=r[a])}):function(e){return o(e,0,i)}):o}},pseudos:{not:r(function(e){var t=[],n=[],i=S(e.replace(ct,"$1"));return i[I]?r(function(e,t,n,r){for(var o,a=i(e,null,r,[]),s=e.length;s--;)(o=a[s])&&(e[s]=!(t[s]=o))}):function(e,r,o){return t[0]=e,i(t,null,o,n),!n.pop()}}),has:r(function(e){return function(t){return n(e,t).length>0}}),contains:r(function(e){return function(t){return(t.textContent||t.innerText||T(t)).indexOf(e)>-1}}),lang:r(function(e){return mt.test(e||"")||n.error("unsupported lang: "+e),e=e.replace(kt,_t).toLowerCase(),function(t){var n;do if(n=M?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===D},focus:function(e){return e===O.activeElement&&(!O.hasFocus||O.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>"@"||3===e.nodeType||4===e.nodeType)return!1;return!0},parent:function(e){return!E.pseudos.empty(e)},header:function(e){return xt.test(e.nodeName)},input:function(e){return wt.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||t.toLowerCase()===e.type)},first:u(function(){return[0]}),last:u(function(e,t){return[t-1]}),eq:u(function(e,t,n){return[0>n?n+t:n]}),even:u(function(e,t){for(var n=0;t>n;n+=2)e.push(n);return e}),odd:u(function(e,t){for(var n=1;t>n;n+=2)e.push(n);return e}),lt:u(function(e,t,n){for(var i=0>n?n+t:n;--i>=0;)e.push(i);return e}),gt:u(function(e,t,n){for(var i=0>n?n+t:n;++i<t;)e.push(i);return e})}},E.pseudos.nth=E.pseudos.eq;for(C in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})E.pseudos[C]=l(C);for(C in{submit:!0,reset:!0})E.pseudos[C]=c(C);d.prototype=E.filters=E.pseudos,E.setFilters=new d,S=n.compile=function(e,t){var n,i=[],r=[],o=W[e+" "];if(!o){for(t||(t=h(e)),n=t.length;n--;)o=y(t[n]),o[I]?i.push(o):r.push(o);o=W(e,b(r,i))}return o},k.sortStable=I.split("").sort(J).join("")===I,k.detectDuplicates=U,A(),k.sortDetached=o(function(e){return 1&e.compareDocumentPosition(O.createElement("div"))}),o(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||a("type|href|height|width",function(e,t,n){return n?void 0:e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),k.attributes&&o(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||a("value",function(e,t,n){return n||"input"!==e.nodeName.toLowerCase()?void 0:e.defaultValue}),o(function(e){return null==e.getAttribute("disabled")})||a(it,function(e,t,n){var i;return n?void 0:(i=e.getAttributeNode(t))&&i.specified?i.value:e[t]===!0?t.toLowerCase():null}),ut.find=n,ut.expr=n.selectors,ut.expr[":"]=ut.expr.pseudos,ut.unique=n.uniqueSort,ut.text=n.getText,ut.isXMLDoc=n.isXML,ut.contains=n.contains}(e);var Et={};ut.Callbacks=function(e){e="string"==typeof e?Et[e]||i(e):ut.extend({},e);var n,r,o,a,s,l,c=[],u=!e.once&&[],d=function(t){for(r=e.memory&&t,o=!0,s=l||0,l=0,a=c.length,n=!0;c&&a>s;s++)if(c[s].apply(t[0],t[1])===!1&&e.stopOnFalse){r=!1;break}n=!1,c&&(u?u.length&&d(u.shift()):r?c=[]:h.disable())},h={add:function(){if(c){var t=c.length;!function i(t){ut.each(t,function(t,n){var r=ut.type(n);"function"===r?e.unique&&h.has(n)||c.push(n):n&&n.length&&"string"!==r&&i(n)})}(arguments),n?a=c.length:r&&(l=t,d(r))}return this},remove:function(){return c&&ut.each(arguments,function(e,t){for(var i;(i=ut.inArray(t,c,i))>-1;)c.splice(i,1),n&&(a>=i&&a--,s>=i&&s--)}),this},has:function(e){return e?ut.inArray(e,c)>-1:!(!c||!c.length)},empty:function(){return c=[],a=0,this},disable:function(){return c=u=r=t,this},disabled:function(){return!c},lock:function(){return u=t,r||h.disable(),this},locked:function(){return!u},fireWith:function(e,t){return!c||o&&!u||(t=t||[],t=[e,t.slice?t.slice():t],n?u.push(t):d(t)),this},fire:function(){return h.fireWith(this,arguments),this},fired:function(){return!!o}};return h},ut.extend({Deferred:function(e){var t=[["resolve","done",ut.Callbacks("once memory"),"resolved"],["reject","fail",ut.Callbacks("once memory"),"rejected"],["notify","progress",ut.Callbacks("memory")]],n="pending",i={state:function(){return n},always:function(){return r.done(arguments).fail(arguments),this},then:function(){var e=arguments;return ut.Deferred(function(n){ut.each(t,function(t,o){var a=o[0],s=ut.isFunction(e[t])&&e[t];r[o[1]](function(){var e=s&&s.apply(this,arguments);e&&ut.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[a+"With"](this===i?n.promise():this,s?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?ut.extend(e,i):i}},r={};return i.pipe=i.then,ut.each(t,function(e,o){var a=o[2],s=o[3];i[o[1]]=a.add,s&&a.add(function(){n=s},t[1^e][2].disable,t[2][2].lock),r[o[0]]=function(){return r[o[0]+"With"](this===r?i:this,arguments),this},r[o[0]+"With"]=a.fireWith}),i.promise(r),e&&e.call(r,r),r},when:function(e){var t,n,i,r=0,o=ot.call(arguments),a=o.length,s=1!==a||e&&ut.isFunction(e.promise)?a:0,l=1===s?e:ut.Deferred(),c=function(e,n,i){return function(r){n[e]=this,i[e]=arguments.length>1?ot.call(arguments):r,i===t?l.notifyWith(n,i):--s||l.resolveWith(n,i)}};if(a>1)for(t=new Array(a),n=new Array(a),i=new Array(a);a>r;r++)o[r]&&ut.isFunction(o[r].promise)?o[r].promise().done(c(r,i,o)).fail(l.reject).progress(c(r,n,t)):--s;return s||l.resolveWith(i,o),l.promise()}}),ut.support=function(t){var n,i,r,o,a,s,l,c,u,d=Q.createElement("div");if(d.setAttribute("className","t"),d.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",n=d.getElementsByTagName("*")||[],i=d.getElementsByTagName("a")[0],!i||!i.style||!n.length)return t;o=Q.createElement("select"),s=o.appendChild(Q.createElement("option")),r=d.getElementsByTagName("input")[0],i.style.cssText="top:1px;float:left;opacity:.5",t.getSetAttribute="t"!==d.className,t.leadingWhitespace=3===d.firstChild.nodeType,t.tbody=!d.getElementsByTagName("tbody").length,t.htmlSerialize=!!d.getElementsByTagName("link").length,t.style=/top/.test(i.getAttribute("style")),t.hrefNormalized="/a"===i.getAttribute("href"),t.opacity=/^0.5/.test(i.style.opacity),t.cssFloat=!!i.style.cssFloat,t.checkOn=!!r.value,t.optSelected=s.selected,t.enctype=!!Q.createElement("form").enctype,t.html5Clone="<:nav></:nav>"!==Q.createElement("nav").cloneNode(!0).outerHTML,t.inlineBlockNeedsLayout=!1,t.shrinkWrapBlocks=!1,t.pixelPosition=!1,t.deleteExpando=!0,t.noCloneEvent=!0,t.reliableMarginRight=!0,t.boxSizingReliable=!0,r.checked=!0,t.noCloneChecked=r.cloneNode(!0).checked,o.disabled=!0,t.optDisabled=!s.disabled;try{delete d.test}catch(h){t.deleteExpando=!1}r=Q.createElement("input"),r.setAttribute("value",""),t.input=""===r.getAttribute("value"),r.value="t",r.setAttribute("type","radio"),t.radioValue="t"===r.value,r.setAttribute("checked","t"),r.setAttribute("name","t"),a=Q.createDocumentFragment(),a.appendChild(r),t.appendChecked=r.checked,t.checkClone=a.cloneNode(!0).cloneNode(!0).lastChild.checked,d.attachEvent&&(d.attachEvent("onclick",function(){t.noCloneEvent=!1}),d.cloneNode(!0).click());for(u in{submit:!0,change:!0,focusin:!0})d.setAttribute(l="on"+u,"t"),t[u+"Bubbles"]=l in e||d.attributes[l].expando===!1;d.style.backgroundClip="content-box",d.cloneNode(!0).style.backgroundClip="",t.clearCloneStyle="content-box"===d.style.backgroundClip;for(u in ut(t))break;return t.ownLast="0"!==u,ut(function(){var n,i,r,o="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",a=Q.getElementsByTagName("body")[0];a&&(n=Q.createElement("div"),n.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",a.appendChild(n).appendChild(d),d.innerHTML="<table><tr><td></td><td>t</td></tr></table>",r=d.getElementsByTagName("td"),r[0].style.cssText="padding:0;margin:0;border:0;display:none",c=0===r[0].offsetHeight,r[0].style.display="",r[1].style.display="none",t.reliableHiddenOffsets=c&&0===r[0].offsetHeight,d.innerHTML="",d.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",ut.swap(a,null!=a.style.zoom?{zoom:1}:{},function(){t.boxSizing=4===d.offsetWidth}),e.getComputedStyle&&(t.pixelPosition="1%"!==(e.getComputedStyle(d,null)||{}).top,t.boxSizingReliable="4px"===(e.getComputedStyle(d,null)||{width:"4px"}).width,i=d.appendChild(Q.createElement("div")),i.style.cssText=d.style.cssText=o,i.style.marginRight=i.style.width="0",d.style.width="1px",t.reliableMarginRight=!parseFloat((e.getComputedStyle(i,null)||{}).marginRight)),typeof d.style.zoom!==X&&(d.innerHTML="",d.style.cssText=o+"width:1px;padding:1px;display:inline;zoom:1",t.inlineBlockNeedsLayout=3===d.offsetWidth,d.style.display="block",d.innerHTML="<div></div>",d.firstChild.style.width="5px",t.shrinkWrapBlocks=3!==d.offsetWidth,t.inlineBlockNeedsLayout&&(a.style.zoom=1)),a.removeChild(n),n=d=r=i=null)}),n=o=a=s=i=r=null,t}({});var Tt=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,Nt=/([A-Z])/g;ut.extend({cache:{},noData:{applet:!0,embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(e){return e=e.nodeType?ut.cache[e[ut.expando]]:e[ut.expando],!!e&&!s(e)},data:function(e,t,n){return r(e,t,n)},removeData:function(e,t){return o(e,t)},_data:function(e,t,n){return r(e,t,n,!0)},_removeData:function(e,t){return o(e,t,!0)},acceptData:function(e){if(e.nodeType&&1!==e.nodeType&&9!==e.nodeType)return!1;var t=e.nodeName&&ut.noData[e.nodeName.toLowerCase()];return!t||t!==!0&&e.getAttribute("classid")===t}}),ut.fn.extend({data:function(e,n){var i,r,o=null,s=0,l=this[0];if(e===t){if(this.length&&(o=ut.data(l),1===l.nodeType&&!ut._data(l,"parsedAttrs"))){for(i=l.attributes;s<i.length;s++)r=i[s].name,0===r.indexOf("data-")&&(r=ut.camelCase(r.slice(5)),a(l,r,o[r]));ut._data(l,"parsedAttrs",!0)}return o}return"object"==typeof e?this.each(function(){ut.data(this,e)}):arguments.length>1?this.each(function(){ut.data(this,e,n)}):l?a(l,e,ut.data(l,e)):null},removeData:function(e){return this.each(function(){ut.removeData(this,e)})}}),ut.extend({queue:function(e,t,n){var i;return e?(t=(t||"fx")+"queue",i=ut._data(e,t),n&&(!i||ut.isArray(n)?i=ut._data(e,t,ut.makeArray(n)):i.push(n)),i||[]):void 0},dequeue:function(e,t){t=t||"fx";var n=ut.queue(e,t),i=n.length,r=n.shift(),o=ut._queueHooks(e,t),a=function(){ut.dequeue(e,t)};"inprogress"===r&&(r=n.shift(),i--),r&&("fx"===t&&n.unshift("inprogress"),delete o.stop,r.call(e,a,o)),!i&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return ut._data(e,n)||ut._data(e,n,{empty:ut.Callbacks("once memory").add(function(){ut._removeData(e,t+"queue"),ut._removeData(e,n)})})}}),ut.fn.extend({queue:function(e,n){var i=2;return"string"!=typeof e&&(n=e,e="fx",i--),arguments.length<i?ut.queue(this[0],e):n===t?this:this.each(function(){var t=ut.queue(this,e,n);ut._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&ut.dequeue(this,e)})},dequeue:function(e){return this.each(function(){ut.dequeue(this,e)})},delay:function(e,t){return e=ut.fx?ut.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var i=setTimeout(t,e);n.stop=function(){clearTimeout(i)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,n){var i,r=1,o=ut.Deferred(),a=this,s=this.length,l=function(){--r||o.resolveWith(a,[a])};for("string"!=typeof e&&(n=e,e=t),e=e||"fx";s--;)i=ut._data(a[s],e+"queueHooks"),i&&i.empty&&(r++,i.empty.add(l));return l(),o.promise(n)}});var St,Rt,$t=/[\t\r\n\f]/g,At=/\r/g,Ot=/^(?:input|select|textarea|button|object)$/i,Dt=/^(?:a|area)$/i,Mt=/^(?:checked|selected)$/i,Bt=ut.support.getSetAttribute,jt=ut.support.input;ut.fn.extend({attr:function(e,t){return ut.access(this,ut.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){ut.removeAttr(this,e)})},prop:function(e,t){return ut.access(this,ut.prop,e,t,arguments.length>1)},removeProp:function(e){return e=ut.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(n){}})},addClass:function(e){var t,n,i,r,o,a=0,s=this.length,l="string"==typeof e&&e;if(ut.isFunction(e))return this.each(function(t){ut(this).addClass(e.call(this,t,this.className))});if(l)for(t=(e||"").match(ht)||[];s>a;a++)if(n=this[a],i=1===n.nodeType&&(n.className?(" "+n.className+" ").replace($t," "):" ")){for(o=0;r=t[o++];)i.indexOf(" "+r+" ")<0&&(i+=r+" ");n.className=ut.trim(i)}return this},removeClass:function(e){var t,n,i,r,o,a=0,s=this.length,l=0===arguments.length||"string"==typeof e&&e;if(ut.isFunction(e))return this.each(function(t){ut(this).removeClass(e.call(this,t,this.className))});if(l)for(t=(e||"").match(ht)||[];s>a;a++)if(n=this[a],i=1===n.nodeType&&(n.className?(" "+n.className+" ").replace($t," "):"")){for(o=0;r=t[o++];)for(;i.indexOf(" "+r+" ")>=0;)i=i.replace(" "+r+" "," ");n.className=e?ut.trim(i):""}return this},toggleClass:function(e,t){var n=typeof e;return"boolean"==typeof t&&"string"===n?t?this.addClass(e):this.removeClass(e):ut.isFunction(e)?this.each(function(n){ut(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if("string"===n)for(var t,i=0,r=ut(this),o=e.match(ht)||[];t=o[i++];)r.hasClass(t)?r.removeClass(t):r.addClass(t);else(n===X||"boolean"===n)&&(this.className&&ut._data(this,"__className__",this.className),this.className=this.className||e===!1?"":ut._data(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",n=0,i=this.length;i>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace($t," ").indexOf(t)>=0)return!0;return!1},val:function(e){var n,i,r,o=this[0];{if(arguments.length)return r=ut.isFunction(e),this.each(function(n){var o;1===this.nodeType&&(o=r?e.call(this,n,ut(this).val()):e,null==o?o="":"number"==typeof o?o+="":ut.isArray(o)&&(o=ut.map(o,function(e){return null==e?"":e+""})),i=ut.valHooks[this.type]||ut.valHooks[this.nodeName.toLowerCase()],i&&"set"in i&&i.set(this,o,"value")!==t||(this.value=o))});if(o)return i=ut.valHooks[o.type]||ut.valHooks[o.nodeName.toLowerCase()],i&&"get"in i&&(n=i.get(o,"value"))!==t?n:(n=o.value,"string"==typeof n?n.replace(At,""):null==n?"":n)}}}),ut.extend({valHooks:{option:{get:function(e){var t=ut.find.attr(e,"value");return null!=t?t:e.text}},select:{get:function(e){for(var t,n,i=e.options,r=e.selectedIndex,o="select-one"===e.type||0>r,a=o?null:[],s=o?r+1:i.length,l=0>r?s:o?r:0;s>l;l++)if(n=i[l],!(!n.selected&&l!==r||(ut.support.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&ut.nodeName(n.parentNode,"optgroup"))){if(t=ut(n).val(),o)return t;a.push(t)}return a},set:function(e,t){for(var n,i,r=e.options,o=ut.makeArray(t),a=r.length;a--;)i=r[a],(i.selected=ut.inArray(ut(i).val(),o)>=0)&&(n=!0);return n||(e.selectedIndex=-1),o}}},attr:function(e,n,i){var r,o,a=e.nodeType;if(e&&3!==a&&8!==a&&2!==a)return typeof e.getAttribute===X?ut.prop(e,n,i):(1===a&&ut.isXMLDoc(e)||(n=n.toLowerCase(),r=ut.attrHooks[n]||(ut.expr.match.bool.test(n)?Rt:St)),i===t?r&&"get"in r&&null!==(o=r.get(e,n))?o:(o=ut.find.attr(e,n),null==o?t:o):null!==i?r&&"set"in r&&(o=r.set(e,i,n))!==t?o:(e.setAttribute(n,i+""),i):(ut.removeAttr(e,n),void 0))},removeAttr:function(e,t){var n,i,r=0,o=t&&t.match(ht);if(o&&1===e.nodeType)for(;n=o[r++];)i=ut.propFix[n]||n,ut.expr.match.bool.test(n)?jt&&Bt||!Mt.test(n)?e[i]=!1:e[ut.camelCase("default-"+n)]=e[i]=!1:ut.attr(e,n,""),e.removeAttribute(Bt?n:i)
},attrHooks:{type:{set:function(e,t){if(!ut.support.radioValue&&"radio"===t&&ut.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(e,n,i){var r,o,a,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return a=1!==s||!ut.isXMLDoc(e),a&&(n=ut.propFix[n]||n,o=ut.propHooks[n]),i!==t?o&&"set"in o&&(r=o.set(e,i,n))!==t?r:e[n]=i:o&&"get"in o&&null!==(r=o.get(e,n))?r:e[n]},propHooks:{tabIndex:{get:function(e){var t=ut.find.attr(e,"tabindex");return t?parseInt(t,10):Ot.test(e.nodeName)||Dt.test(e.nodeName)&&e.href?0:-1}}}}),Rt={set:function(e,t,n){return t===!1?ut.removeAttr(e,n):jt&&Bt||!Mt.test(n)?e.setAttribute(!Bt&&ut.propFix[n]||n,n):e[ut.camelCase("default-"+n)]=e[n]=!0,n}},ut.each(ut.expr.match.bool.source.match(/\w+/g),function(e,n){var i=ut.expr.attrHandle[n]||ut.find.attr;ut.expr.attrHandle[n]=jt&&Bt||!Mt.test(n)?function(e,n,r){var o=ut.expr.attrHandle[n],a=r?t:(ut.expr.attrHandle[n]=t)!=i(e,n,r)?n.toLowerCase():null;return ut.expr.attrHandle[n]=o,a}:function(e,n,i){return i?t:e[ut.camelCase("default-"+n)]?n.toLowerCase():null}}),jt&&Bt||(ut.attrHooks.value={set:function(e,t,n){return ut.nodeName(e,"input")?(e.defaultValue=t,void 0):St&&St.set(e,t,n)}}),Bt||(St={set:function(e,n,i){var r=e.getAttributeNode(i);return r||e.setAttributeNode(r=e.ownerDocument.createAttribute(i)),r.value=n+="","value"===i||n===e.getAttribute(i)?n:t}},ut.expr.attrHandle.id=ut.expr.attrHandle.name=ut.expr.attrHandle.coords=function(e,n,i){var r;return i?t:(r=e.getAttributeNode(n))&&""!==r.value?r.value:null},ut.valHooks.button={get:function(e,n){var i=e.getAttributeNode(n);return i&&i.specified?i.value:t},set:St.set},ut.attrHooks.contenteditable={set:function(e,t,n){St.set(e,""===t?!1:t,n)}},ut.each(["width","height"],function(e,t){ut.attrHooks[t]={set:function(e,n){return""===n?(e.setAttribute(t,"auto"),n):void 0}}})),ut.support.hrefNormalized||ut.each(["href","src"],function(e,t){ut.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}}),ut.support.style||(ut.attrHooks.style={get:function(e){return e.style.cssText||t},set:function(e,t){return e.style.cssText=t+""}}),ut.support.optSelected||(ut.propHooks.selected={get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}}),ut.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){ut.propFix[this.toLowerCase()]=this}),ut.support.enctype||(ut.propFix.enctype="encoding"),ut.each(["radio","checkbox"],function(){ut.valHooks[this]={set:function(e,t){return ut.isArray(t)?e.checked=ut.inArray(ut(e).val(),t)>=0:void 0}},ut.support.checkOn||(ut.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var Pt=/^(?:input|select|textarea)$/i,Ht=/^key/,It=/^(?:mouse|contextmenu)|click/,qt=/^(?:focusinfocus|focusoutblur)$/,Vt=/^([^.]*)(?:\.(.+)|)$/;ut.event={global:{},add:function(e,n,i,r,o){var a,s,l,c,u,d,h,f,p,g,m,v=ut._data(e);if(v){for(i.handler&&(c=i,i=c.handler,o=c.selector),i.guid||(i.guid=ut.guid++),(s=v.events)||(s=v.events={}),(d=v.handle)||(d=v.handle=function(e){return typeof ut===X||e&&ut.event.triggered===e.type?t:ut.event.dispatch.apply(d.elem,arguments)},d.elem=e),n=(n||"").match(ht)||[""],l=n.length;l--;)a=Vt.exec(n[l])||[],p=m=a[1],g=(a[2]||"").split(".").sort(),p&&(u=ut.event.special[p]||{},p=(o?u.delegateType:u.bindType)||p,u=ut.event.special[p]||{},h=ut.extend({type:p,origType:m,data:r,handler:i,guid:i.guid,selector:o,needsContext:o&&ut.expr.match.needsContext.test(o),namespace:g.join(".")},c),(f=s[p])||(f=s[p]=[],f.delegateCount=0,u.setup&&u.setup.call(e,r,g,d)!==!1||(e.addEventListener?e.addEventListener(p,d,!1):e.attachEvent&&e.attachEvent("on"+p,d))),u.add&&(u.add.call(e,h),h.handler.guid||(h.handler.guid=i.guid)),o?f.splice(f.delegateCount++,0,h):f.push(h),ut.event.global[p]=!0);e=null}},remove:function(e,t,n,i,r){var o,a,s,l,c,u,d,h,f,p,g,m=ut.hasData(e)&&ut._data(e);if(m&&(u=m.events)){for(t=(t||"").match(ht)||[""],c=t.length;c--;)if(s=Vt.exec(t[c])||[],f=g=s[1],p=(s[2]||"").split(".").sort(),f){for(d=ut.event.special[f]||{},f=(i?d.delegateType:d.bindType)||f,h=u[f]||[],s=s[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=o=h.length;o--;)a=h[o],!r&&g!==a.origType||n&&n.guid!==a.guid||s&&!s.test(a.namespace)||i&&i!==a.selector&&("**"!==i||!a.selector)||(h.splice(o,1),a.selector&&h.delegateCount--,d.remove&&d.remove.call(e,a));l&&!h.length&&(d.teardown&&d.teardown.call(e,p,m.handle)!==!1||ut.removeEvent(e,f,m.handle),delete u[f])}else for(f in u)ut.event.remove(e,f+t[c],n,i,!0);ut.isEmptyObject(u)&&(delete m.handle,ut._removeData(e,"events"))}},trigger:function(n,i,r,o){var a,s,l,c,u,d,h,f=[r||Q],p=lt.call(n,"type")?n.type:n,g=lt.call(n,"namespace")?n.namespace.split("."):[];if(l=d=r=r||Q,3!==r.nodeType&&8!==r.nodeType&&!qt.test(p+ut.event.triggered)&&(p.indexOf(".")>=0&&(g=p.split("."),p=g.shift(),g.sort()),s=p.indexOf(":")<0&&"on"+p,n=n[ut.expando]?n:new ut.Event(p,"object"==typeof n&&n),n.isTrigger=o?2:3,n.namespace=g.join("."),n.namespace_re=n.namespace?new RegExp("(^|\\.)"+g.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,n.result=t,n.target||(n.target=r),i=null==i?[n]:ut.makeArray(i,[n]),u=ut.event.special[p]||{},o||!u.trigger||u.trigger.apply(r,i)!==!1)){if(!o&&!u.noBubble&&!ut.isWindow(r)){for(c=u.delegateType||p,qt.test(c+p)||(l=l.parentNode);l;l=l.parentNode)f.push(l),d=l;d===(r.ownerDocument||Q)&&f.push(d.defaultView||d.parentWindow||e)}for(h=0;(l=f[h++])&&!n.isPropagationStopped();)n.type=h>1?c:u.bindType||p,a=(ut._data(l,"events")||{})[n.type]&&ut._data(l,"handle"),a&&a.apply(l,i),a=s&&l[s],a&&ut.acceptData(l)&&a.apply&&a.apply(l,i)===!1&&n.preventDefault();if(n.type=p,!o&&!n.isDefaultPrevented()&&(!u._default||u._default.apply(f.pop(),i)===!1)&&ut.acceptData(r)&&s&&r[p]&&!ut.isWindow(r)){d=r[s],d&&(r[s]=null),ut.event.triggered=p;try{r[p]()}catch(m){}ut.event.triggered=t,d&&(r[s]=d)}return n.result}},dispatch:function(e){e=ut.event.fix(e);var n,i,r,o,a,s=[],l=ot.call(arguments),c=(ut._data(this,"events")||{})[e.type]||[],u=ut.event.special[e.type]||{};if(l[0]=e,e.delegateTarget=this,!u.preDispatch||u.preDispatch.call(this,e)!==!1){for(s=ut.event.handlers.call(this,e,c),n=0;(o=s[n++])&&!e.isPropagationStopped();)for(e.currentTarget=o.elem,a=0;(r=o.handlers[a++])&&!e.isImmediatePropagationStopped();)(!e.namespace_re||e.namespace_re.test(r.namespace))&&(e.handleObj=r,e.data=r.data,i=((ut.event.special[r.origType]||{}).handle||r.handler).apply(o.elem,l),i!==t&&(e.result=i)===!1&&(e.preventDefault(),e.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,e),e.result}},handlers:function(e,n){var i,r,o,a,s=[],l=n.delegateCount,c=e.target;if(l&&c.nodeType&&(!e.button||"click"!==e.type))for(;c!=this;c=c.parentNode||this)if(1===c.nodeType&&(c.disabled!==!0||"click"!==e.type)){for(o=[],a=0;l>a;a++)r=n[a],i=r.selector+" ",o[i]===t&&(o[i]=r.needsContext?ut(i,this).index(c)>=0:ut.find(i,this,null,[c]).length),o[i]&&o.push(r);o.length&&s.push({elem:c,handlers:o})}return l<n.length&&s.push({elem:this,handlers:n.slice(l)}),s},fix:function(e){if(e[ut.expando])return e;var t,n,i,r=e.type,o=e,a=this.fixHooks[r];for(a||(this.fixHooks[r]=a=It.test(r)?this.mouseHooks:Ht.test(r)?this.keyHooks:{}),i=a.props?this.props.concat(a.props):this.props,e=new ut.Event(o),t=i.length;t--;)n=i[t],e[n]=o[n];return e.target||(e.target=o.srcElement||Q),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,a.filter?a.filter(e,o):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,n){var i,r,o,a=n.button,s=n.fromElement;return null==e.pageX&&null!=n.clientX&&(r=e.target.ownerDocument||Q,o=r.documentElement,i=r.body,e.pageX=n.clientX+(o&&o.scrollLeft||i&&i.scrollLeft||0)-(o&&o.clientLeft||i&&i.clientLeft||0),e.pageY=n.clientY+(o&&o.scrollTop||i&&i.scrollTop||0)-(o&&o.clientTop||i&&i.clientTop||0)),!e.relatedTarget&&s&&(e.relatedTarget=s===e.target?n.toElement:s),e.which||a===t||(e.which=1&a?1:2&a?3:4&a?2:0),e}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==u()&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){return this===u()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return ut.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(e){return ut.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){e.result!==t&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,i){var r=ut.extend(new ut.Event,n,{type:e,isSimulated:!0,originalEvent:{}});i?ut.event.trigger(r,null,t):ut.event.dispatch.call(t,r),r.isDefaultPrevented()&&n.preventDefault()}},ut.removeEvent=Q.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){var i="on"+t;e.detachEvent&&(typeof e[i]===X&&(e[i]=null),e.detachEvent(i,n))},ut.Event=function(e,t){return this instanceof ut.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?l:c):this.type=e,t&&ut.extend(this,t),this.timeStamp=e&&e.timeStamp||ut.now(),this[ut.expando]=!0,void 0):new ut.Event(e,t)},ut.Event.prototype={isDefaultPrevented:c,isPropagationStopped:c,isImmediatePropagationStopped:c,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=l,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=l,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=l,this.stopPropagation()}},ut.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){ut.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,i=this,r=e.relatedTarget,o=e.handleObj;return(!r||r!==i&&!ut.contains(i,r))&&(e.type=o.origType,n=o.handler.apply(this,arguments),e.type=t),n}}}),ut.support.submitBubbles||(ut.event.special.submit={setup:function(){return ut.nodeName(this,"form")?!1:(ut.event.add(this,"click._submit keypress._submit",function(e){var n=e.target,i=ut.nodeName(n,"input")||ut.nodeName(n,"button")?n.form:t;i&&!ut._data(i,"submitBubbles")&&(ut.event.add(i,"submit._submit",function(e){e._submit_bubble=!0}),ut._data(i,"submitBubbles",!0))}),void 0)},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&ut.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){return ut.nodeName(this,"form")?!1:(ut.event.remove(this,"._submit"),void 0)}}),ut.support.changeBubbles||(ut.event.special.change={setup:function(){return Pt.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(ut.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),ut.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),ut.event.simulate("change",this,e,!0)})),!1):(ut.event.add(this,"beforeactivate._change",function(e){var t=e.target;Pt.test(t.nodeName)&&!ut._data(t,"changeBubbles")&&(ut.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||ut.event.simulate("change",this.parentNode,e,!0)}),ut._data(t,"changeBubbles",!0))}),void 0)},handle:function(e){var t=e.target;return this!==t||e.isSimulated||e.isTrigger||"radio"!==t.type&&"checkbox"!==t.type?e.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return ut.event.remove(this,"._change"),!Pt.test(this.nodeName)}}),ut.support.focusinBubbles||ut.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,i=function(e){ut.event.simulate(t,e.target,ut.event.fix(e),!0)};ut.event.special[t]={setup:function(){0===n++&&Q.addEventListener(e,i,!0)},teardown:function(){0===--n&&Q.removeEventListener(e,i,!0)}}}),ut.fn.extend({on:function(e,n,i,r,o){var a,s;if("object"==typeof e){"string"!=typeof n&&(i=i||n,n=t);for(a in e)this.on(a,n,i,e[a],o);return this}if(null==i&&null==r?(r=n,i=n=t):null==r&&("string"==typeof n?(r=i,i=t):(r=i,i=n,n=t)),r===!1)r=c;else if(!r)return this;return 1===o&&(s=r,r=function(e){return ut().off(e),s.apply(this,arguments)},r.guid=s.guid||(s.guid=ut.guid++)),this.each(function(){ut.event.add(this,e,r,i,n)})},one:function(e,t,n,i){return this.on(e,t,n,i,1)},off:function(e,n,i){var r,o;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,ut(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(o in e)this.off(o,n,e[o]);return this}return(n===!1||"function"==typeof n)&&(i=n,n=t),i===!1&&(i=c),this.each(function(){ut.event.remove(this,e,i,n)})},trigger:function(e,t){return this.each(function(){ut.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];return n?ut.event.trigger(e,t,n,!0):void 0}});var Lt=/^.[^:#\[\.,]*$/,Ft=/^(?:parents|prev(?:Until|All))/,zt=ut.expr.match.needsContext,Wt={children:!0,contents:!0,next:!0,prev:!0};ut.fn.extend({find:function(e){var t,n=[],i=this,r=i.length;if("string"!=typeof e)return this.pushStack(ut(e).filter(function(){for(t=0;r>t;t++)if(ut.contains(i[t],this))return!0}));for(t=0;r>t;t++)ut.find(e,i[t],n);return n=this.pushStack(r>1?ut.unique(n):n),n.selector=this.selector?this.selector+" "+e:e,n},has:function(e){var t,n=ut(e,this),i=n.length;return this.filter(function(){for(t=0;i>t;t++)if(ut.contains(this,n[t]))return!0})},not:function(e){return this.pushStack(h(this,e||[],!0))},filter:function(e){return this.pushStack(h(this,e||[],!1))},is:function(e){return!!h(this,"string"==typeof e&&zt.test(e)?ut(e):e||[],!1).length},closest:function(e,t){for(var n,i=0,r=this.length,o=[],a=zt.test(e)||"string"!=typeof e?ut(e,t||this.context):0;r>i;i++)for(n=this[i];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(a?a.index(n)>-1:1===n.nodeType&&ut.find.matchesSelector(n,e))){n=o.push(n);break}return this.pushStack(o.length>1?ut.unique(o):o)},index:function(e){return e?"string"==typeof e?ut.inArray(this[0],ut(e)):ut.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var n="string"==typeof e?ut(e,t):ut.makeArray(e&&e.nodeType?[e]:e),i=ut.merge(this.get(),n);return this.pushStack(ut.unique(i))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),ut.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return ut.dir(e,"parentNode")},parentsUntil:function(e,t,n){return ut.dir(e,"parentNode",n)},next:function(e){return d(e,"nextSibling")},prev:function(e){return d(e,"previousSibling")},nextAll:function(e){return ut.dir(e,"nextSibling")},prevAll:function(e){return ut.dir(e,"previousSibling")},nextUntil:function(e,t,n){return ut.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return ut.dir(e,"previousSibling",n)},siblings:function(e){return ut.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return ut.sibling(e.firstChild)},contents:function(e){return ut.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:ut.merge([],e.childNodes)}},function(e,t){ut.fn[e]=function(n,i){var r=ut.map(this,t,n);return"Until"!==e.slice(-5)&&(i=n),i&&"string"==typeof i&&(r=ut.filter(i,r)),this.length>1&&(Wt[e]||(r=ut.unique(r)),Ft.test(e)&&(r=r.reverse())),this.pushStack(r)}}),ut.extend({filter:function(e,t,n){var i=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===i.nodeType?ut.find.matchesSelector(i,e)?[i]:[]:ut.find.matches(e,ut.grep(t,function(e){return 1===e.nodeType}))},dir:function(e,n,i){for(var r=[],o=e[n];o&&9!==o.nodeType&&(i===t||1!==o.nodeType||!ut(o).is(i));)1===o.nodeType&&r.push(o),o=o[n];return r},sibling:function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}});var Ut="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",Jt=/ jQuery\d+="(?:null|\d+)"/g,Xt=new RegExp("<(?:"+Ut+")[\\s/>]","i"),Kt=/^\s+/,Qt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Gt=/<([\w:]+)/,Yt=/<tbody/i,Zt=/<|&#?\w+;/,en=/<(?:script|style|link)/i,tn=/^(?:checkbox|radio)$/i,nn=/checked\s*(?:[^=]|=\s*.checked.)/i,rn=/^$|\/(?:java|ecma)script/i,on=/^true\/(.*)/,an=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,sn={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:ut.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},ln=f(Q),cn=ln.appendChild(Q.createElement("div"));sn.optgroup=sn.option,sn.tbody=sn.tfoot=sn.colgroup=sn.caption=sn.thead,sn.th=sn.td,ut.fn.extend({text:function(e){return ut.access(this,function(e){return e===t?ut.text(this):this.empty().append((this[0]&&this[0].ownerDocument||Q).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=p(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=p(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var n,i=e?ut.filter(e,this):this,r=0;null!=(n=i[r]);r++)t||1!==n.nodeType||ut.cleanData(w(n)),n.parentNode&&(t&&ut.contains(n.ownerDocument,n)&&v(w(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++){for(1===e.nodeType&&ut.cleanData(w(e,!1));e.firstChild;)e.removeChild(e.firstChild);e.options&&ut.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return ut.clone(this,e,t)})},html:function(e){return ut.access(this,function(e){var n=this[0]||{},i=0,r=this.length;if(e===t)return 1===n.nodeType?n.innerHTML.replace(Jt,""):t;if(!("string"!=typeof e||en.test(e)||!ut.support.htmlSerialize&&Xt.test(e)||!ut.support.leadingWhitespace&&Kt.test(e)||sn[(Gt.exec(e)||["",""])[1].toLowerCase()])){e=e.replace(Qt,"<$1></$2>");try{for(;r>i;i++)n=this[i]||{},1===n.nodeType&&(ut.cleanData(w(n,!1)),n.innerHTML=e);n=0}catch(o){}}n&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=ut.map(this,function(e){return[e.nextSibling,e.parentNode]}),t=0;return this.domManip(arguments,function(n){var i=e[t++],r=e[t++];r&&(i&&i.parentNode!==r&&(i=this.nextSibling),ut(this).remove(),r.insertBefore(n,i))},!0),t?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t,n){e=it.apply([],e);var i,r,o,a,s,l,c=0,u=this.length,d=this,h=u-1,f=e[0],p=ut.isFunction(f);if(p||!(1>=u||"string"!=typeof f||ut.support.checkClone)&&nn.test(f))return this.each(function(i){var r=d.eq(i);p&&(e[0]=f.call(this,i,r.html())),r.domManip(e,t,n)});if(u&&(l=ut.buildFragment(e,this[0].ownerDocument,!1,!n&&this),i=l.firstChild,1===l.childNodes.length&&(l=i),i)){for(a=ut.map(w(l,"script"),g),o=a.length;u>c;c++)r=l,c!==h&&(r=ut.clone(r,!0,!0),o&&ut.merge(a,w(r,"script"))),t.call(this[c],r,c);if(o)for(s=a[a.length-1].ownerDocument,ut.map(a,m),c=0;o>c;c++)r=a[c],rn.test(r.type||"")&&!ut._data(r,"globalEval")&&ut.contains(s,r)&&(r.src?ut._evalUrl(r.src):ut.globalEval((r.text||r.textContent||r.innerHTML||"").replace(an,"")));l=i=null}return this}}),ut.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){ut.fn[e]=function(e){for(var n,i=0,r=[],o=ut(e),a=o.length-1;a>=i;i++)n=i===a?this:this.clone(!0),ut(o[i])[t](n),rt.apply(r,n.get());return this.pushStack(r)}}),ut.extend({clone:function(e,t,n){var i,r,o,a,s,l=ut.contains(e.ownerDocument,e);if(ut.support.html5Clone||ut.isXMLDoc(e)||!Xt.test("<"+e.nodeName+">")?o=e.cloneNode(!0):(cn.innerHTML=e.outerHTML,cn.removeChild(o=cn.firstChild)),!(ut.support.noCloneEvent&&ut.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||ut.isXMLDoc(e)))for(i=w(o),s=w(e),a=0;null!=(r=s[a]);++a)i[a]&&b(r,i[a]);if(t)if(n)for(s=s||w(e),i=i||w(o),a=0;null!=(r=s[a]);a++)y(r,i[a]);else y(e,o);return i=w(o,"script"),i.length>0&&v(i,!l&&w(e,"script")),i=s=r=null,o},buildFragment:function(e,t,n,i){for(var r,o,a,s,l,c,u,d=e.length,h=f(t),p=[],g=0;d>g;g++)if(o=e[g],o||0===o)if("object"===ut.type(o))ut.merge(p,o.nodeType?[o]:o);else if(Zt.test(o)){for(s=s||h.appendChild(t.createElement("div")),l=(Gt.exec(o)||["",""])[1].toLowerCase(),u=sn[l]||sn._default,s.innerHTML=u[1]+o.replace(Qt,"<$1></$2>")+u[2],r=u[0];r--;)s=s.lastChild;if(!ut.support.leadingWhitespace&&Kt.test(o)&&p.push(t.createTextNode(Kt.exec(o)[0])),!ut.support.tbody)for(o="table"!==l||Yt.test(o)?"<table>"!==u[1]||Yt.test(o)?0:s:s.firstChild,r=o&&o.childNodes.length;r--;)ut.nodeName(c=o.childNodes[r],"tbody")&&!c.childNodes.length&&o.removeChild(c);for(ut.merge(p,s.childNodes),s.textContent="";s.firstChild;)s.removeChild(s.firstChild);s=h.lastChild}else p.push(t.createTextNode(o));for(s&&h.removeChild(s),ut.support.appendChecked||ut.grep(w(p,"input"),x),g=0;o=p[g++];)if((!i||-1===ut.inArray(o,i))&&(a=ut.contains(o.ownerDocument,o),s=w(h.appendChild(o),"script"),a&&v(s),n))for(r=0;o=s[r++];)rn.test(o.type||"")&&n.push(o);return s=null,h},cleanData:function(e,t){for(var n,i,r,o,a=0,s=ut.expando,l=ut.cache,c=ut.support.deleteExpando,u=ut.event.special;null!=(n=e[a]);a++)if((t||ut.acceptData(n))&&(r=n[s],o=r&&l[r])){if(o.events)for(i in o.events)u[i]?ut.event.remove(n,i):ut.removeEvent(n,i,o.handle);l[r]&&(delete l[r],c?delete n[s]:typeof n.removeAttribute!==X?n.removeAttribute(s):n[s]=null,tt.push(r))}},_evalUrl:function(e){return ut.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})}}),ut.fn.extend({wrapAll:function(e){if(ut.isFunction(e))return this.each(function(t){ut(this).wrapAll(e.call(this,t))});if(this[0]){var t=ut(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstChild&&1===e.firstChild.nodeType;)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return ut.isFunction(e)?this.each(function(t){ut(this).wrapInner(e.call(this,t))}):this.each(function(){var t=ut(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=ut.isFunction(e);return this.each(function(n){ut(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){ut.nodeName(this,"body")||ut(this).replaceWith(this.childNodes)}).end()}});var un,dn,hn,fn=/alpha\([^)]*\)/i,pn=/opacity\s*=\s*([^)]*)/,gn=/^(top|right|bottom|left)$/,mn=/^(none|table(?!-c[ea]).+)/,vn=/^margin/,yn=new RegExp("^("+dt+")(.*)$","i"),bn=new RegExp("^("+dt+")(?!px)[a-z%]+$","i"),wn=new RegExp("^([+-])=("+dt+")","i"),xn={BODY:"block"},Cn={position:"absolute",visibility:"hidden",display:"block"},kn={letterSpacing:0,fontWeight:400},_n=["Top","Right","Bottom","Left"],En=["Webkit","O","Moz","ms"];ut.fn.extend({css:function(e,n){return ut.access(this,function(e,n,i){var r,o,a={},s=0;if(ut.isArray(n)){for(o=dn(e),r=n.length;r>s;s++)a[n[s]]=ut.css(e,n[s],!1,o);return a}return i!==t?ut.style(e,n,i):ut.css(e,n)},e,n,arguments.length>1)},show:function(){return _(this,!0)},hide:function(){return _(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){k(this)?ut(this).show():ut(this).hide()})}}),ut.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=hn(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":ut.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,n,i,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var o,a,s,l=ut.camelCase(n),c=e.style;if(n=ut.cssProps[l]||(ut.cssProps[l]=C(c,l)),s=ut.cssHooks[n]||ut.cssHooks[l],i===t)return s&&"get"in s&&(o=s.get(e,!1,r))!==t?o:c[n];if(a=typeof i,"string"===a&&(o=wn.exec(i))&&(i=(o[1]+1)*o[2]+parseFloat(ut.css(e,n)),a="number"),!(null==i||"number"===a&&isNaN(i)||("number"!==a||ut.cssNumber[l]||(i+="px"),ut.support.clearCloneStyle||""!==i||0!==n.indexOf("background")||(c[n]="inherit"),s&&"set"in s&&(i=s.set(e,i,r))===t)))try{c[n]=i}catch(u){}}},css:function(e,n,i,r){var o,a,s,l=ut.camelCase(n);return n=ut.cssProps[l]||(ut.cssProps[l]=C(e.style,l)),s=ut.cssHooks[n]||ut.cssHooks[l],s&&"get"in s&&(a=s.get(e,!0,i)),a===t&&(a=hn(e,n,r)),"normal"===a&&n in kn&&(a=kn[n]),""===i||i?(o=parseFloat(a),i===!0||ut.isNumeric(o)?o||0:a):a}}),e.getComputedStyle?(dn=function(t){return e.getComputedStyle(t,null)},hn=function(e,n,i){var r,o,a,s=i||dn(e),l=s?s.getPropertyValue(n)||s[n]:t,c=e.style;return s&&(""!==l||ut.contains(e.ownerDocument,e)||(l=ut.style(e,n)),bn.test(l)&&vn.test(n)&&(r=c.width,o=c.minWidth,a=c.maxWidth,c.minWidth=c.maxWidth=c.width=l,l=s.width,c.width=r,c.minWidth=o,c.maxWidth=a)),l}):Q.documentElement.currentStyle&&(dn=function(e){return e.currentStyle},hn=function(e,n,i){var r,o,a,s=i||dn(e),l=s?s[n]:t,c=e.style;return null==l&&c&&c[n]&&(l=c[n]),bn.test(l)&&!gn.test(n)&&(r=c.left,o=e.runtimeStyle,a=o&&o.left,a&&(o.left=e.currentStyle.left),c.left="fontSize"===n?"1em":l,l=c.pixelLeft+"px",c.left=r,a&&(o.left=a)),""===l?"auto":l}),ut.each(["height","width"],function(e,t){ut.cssHooks[t]={get:function(e,n,i){return n?0===e.offsetWidth&&mn.test(ut.css(e,"display"))?ut.swap(e,Cn,function(){return N(e,t,i)}):N(e,t,i):void 0},set:function(e,n,i){var r=i&&dn(e);return E(e,n,i?T(e,t,i,ut.support.boxSizing&&"border-box"===ut.css(e,"boxSizing",!1,r),r):0)}}}),ut.support.opacity||(ut.cssHooks.opacity={get:function(e,t){return pn.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,i=e.currentStyle,r=ut.isNumeric(t)?"alpha(opacity="+100*t+")":"",o=i&&i.filter||n.filter||"";n.zoom=1,(t>=1||""===t)&&""===ut.trim(o.replace(fn,""))&&n.removeAttribute&&(n.removeAttribute("filter"),""===t||i&&!i.filter)||(n.filter=fn.test(o)?o.replace(fn,r):o+" "+r)}}),ut(function(){ut.support.reliableMarginRight||(ut.cssHooks.marginRight={get:function(e,t){return t?ut.swap(e,{display:"inline-block"},hn,[e,"marginRight"]):void 0}}),!ut.support.pixelPosition&&ut.fn.position&&ut.each(["top","left"],function(e,t){ut.cssHooks[t]={get:function(e,n){return n?(n=hn(e,t),bn.test(n)?ut(e).position()[t]+"px":n):void 0}}})}),ut.expr&&ut.expr.filters&&(ut.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0||!ut.support.reliableHiddenOffsets&&"none"===(e.style&&e.style.display||ut.css(e,"display"))},ut.expr.filters.visible=function(e){return!ut.expr.filters.hidden(e)}),ut.each({margin:"",padding:"",border:"Width"},function(e,t){ut.cssHooks[e+t]={expand:function(n){for(var i=0,r={},o="string"==typeof n?n.split(" "):[n];4>i;i++)r[e+_n[i]+t]=o[i]||o[i-2]||o[0];return r}},vn.test(e)||(ut.cssHooks[e+t].set=E)});var Tn=/%20/g,Nn=/\[\]$/,Sn=/\r?\n/g,Rn=/^(?:submit|button|image|reset|file)$/i,$n=/^(?:input|select|textarea|keygen)/i;ut.fn.extend({serialize:function(){return ut.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=ut.prop(this,"elements");return e?ut.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!ut(this).is(":disabled")&&$n.test(this.nodeName)&&!Rn.test(e)&&(this.checked||!tn.test(e))}).map(function(e,t){var n=ut(this).val();return null==n?null:ut.isArray(n)?ut.map(n,function(e){return{name:t.name,value:e.replace(Sn,"\r\n")}}):{name:t.name,value:n.replace(Sn,"\r\n")}}).get()}}),ut.param=function(e,n){var i,r=[],o=function(e,t){t=ut.isFunction(t)?t():null==t?"":t,r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(n===t&&(n=ut.ajaxSettings&&ut.ajaxSettings.traditional),ut.isArray(e)||e.jquery&&!ut.isPlainObject(e))ut.each(e,function(){o(this.name,this.value)});else for(i in e)$(i,e[i],n,o);return r.join("&").replace(Tn,"+")},ut.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){ut.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),ut.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,i){return this.on(t,e,n,i)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}});var An,On,Dn=ut.now(),Mn=/\?/,Bn=/#.*$/,jn=/([?&])_=[^&]*/,Pn=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Hn=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,In=/^(?:GET|HEAD)$/,qn=/^\/\//,Vn=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,Ln=ut.fn.load,Fn={},zn={},Wn="*/".concat("*");try{On=K.href}catch(Un){On=Q.createElement("a"),On.href="",On=On.href}An=Vn.exec(On.toLowerCase())||[],ut.fn.load=function(e,n,i){if("string"!=typeof e&&Ln)return Ln.apply(this,arguments);var r,o,a,s=this,l=e.indexOf(" ");return l>=0&&(r=e.slice(l,e.length),e=e.slice(0,l)),ut.isFunction(n)?(i=n,n=t):n&&"object"==typeof n&&(a="POST"),s.length>0&&ut.ajax({url:e,type:a,dataType:"html",data:n}).done(function(e){o=arguments,s.html(r?ut("<div>").append(ut.parseHTML(e)).find(r):e)}).complete(i&&function(e,t){s.each(i,o||[e.responseText,t,e])}),this},ut.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){ut.fn[t]=function(e){return this.on(t,e)}}),ut.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:On,type:"GET",isLocal:Hn.test(An[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Wn,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":ut.parseJSON,"text xml":ut.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?D(D(e,ut.ajaxSettings),t):D(ut.ajaxSettings,e)},ajaxPrefilter:A(Fn),ajaxTransport:A(zn),ajax:function(e,n){function i(e,n,i,r){var o,d,y,b,x,k=n;2!==w&&(w=2,l&&clearTimeout(l),u=t,s=r||"",C.readyState=e>0?4:0,o=e>=200&&300>e||304===e,i&&(b=M(h,C,i)),b=B(h,b,C,o),o?(h.ifModified&&(x=C.getResponseHeader("Last-Modified"),x&&(ut.lastModified[a]=x),x=C.getResponseHeader("etag"),x&&(ut.etag[a]=x)),204===e||"HEAD"===h.type?k="nocontent":304===e?k="notmodified":(k=b.state,d=b.data,y=b.error,o=!y)):(y=k,(e||!k)&&(k="error",0>e&&(e=0))),C.status=e,C.statusText=(n||k)+"",o?g.resolveWith(f,[d,k,C]):g.rejectWith(f,[C,k,y]),C.statusCode(v),v=t,c&&p.trigger(o?"ajaxSuccess":"ajaxError",[C,h,o?d:y]),m.fireWith(f,[C,k]),c&&(p.trigger("ajaxComplete",[C,h]),--ut.active||ut.event.trigger("ajaxStop")))}"object"==typeof e&&(n=e,e=t),n=n||{};var r,o,a,s,l,c,u,d,h=ut.ajaxSetup({},n),f=h.context||h,p=h.context&&(f.nodeType||f.jquery)?ut(f):ut.event,g=ut.Deferred(),m=ut.Callbacks("once memory"),v=h.statusCode||{},y={},b={},w=0,x="canceled",C={readyState:0,getResponseHeader:function(e){var t;if(2===w){if(!d)for(d={};t=Pn.exec(s);)d[t[1].toLowerCase()]=t[2];t=d[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===w?s:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return w||(e=b[n]=b[n]||e,y[e]=t),this},overrideMimeType:function(e){return w||(h.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>w)for(t in e)v[t]=[v[t],e[t]];else C.always(e[C.status]);return this},abort:function(e){var t=e||x;return u&&u.abort(t),i(0,t),this}};if(g.promise(C).complete=m.add,C.success=C.done,C.error=C.fail,h.url=((e||h.url||On)+"").replace(Bn,"").replace(qn,An[1]+"//"),h.type=n.method||n.type||h.method||h.type,h.dataTypes=ut.trim(h.dataType||"*").toLowerCase().match(ht)||[""],null==h.crossDomain&&(r=Vn.exec(h.url.toLowerCase()),h.crossDomain=!(!r||r[1]===An[1]&&r[2]===An[2]&&(r[3]||("http:"===r[1]?"80":"443"))===(An[3]||("http:"===An[1]?"80":"443")))),h.data&&h.processData&&"string"!=typeof h.data&&(h.data=ut.param(h.data,h.traditional)),O(Fn,h,n,C),2===w)return C;
c=h.global,c&&0===ut.active++&&ut.event.trigger("ajaxStart"),h.type=h.type.toUpperCase(),h.hasContent=!In.test(h.type),a=h.url,h.hasContent||(h.data&&(a=h.url+=(Mn.test(a)?"&":"?")+h.data,delete h.data),h.cache===!1&&(h.url=jn.test(a)?a.replace(jn,"$1_="+Dn++):a+(Mn.test(a)?"&":"?")+"_="+Dn++)),h.ifModified&&(ut.lastModified[a]&&C.setRequestHeader("If-Modified-Since",ut.lastModified[a]),ut.etag[a]&&C.setRequestHeader("If-None-Match",ut.etag[a])),(h.data&&h.hasContent&&h.contentType!==!1||n.contentType)&&C.setRequestHeader("Content-Type",h.contentType),C.setRequestHeader("Accept",h.dataTypes[0]&&h.accepts[h.dataTypes[0]]?h.accepts[h.dataTypes[0]]+("*"!==h.dataTypes[0]?", "+Wn+"; q=0.01":""):h.accepts["*"]);for(o in h.headers)C.setRequestHeader(o,h.headers[o]);if(h.beforeSend&&(h.beforeSend.call(f,C,h)===!1||2===w))return C.abort();x="abort";for(o in{success:1,error:1,complete:1})C[o](h[o]);if(u=O(zn,h,n,C)){C.readyState=1,c&&p.trigger("ajaxSend",[C,h]),h.async&&h.timeout>0&&(l=setTimeout(function(){C.abort("timeout")},h.timeout));try{w=1,u.send(y,i)}catch(k){if(!(2>w))throw k;i(-1,k)}}else i(-1,"No Transport");return C},getJSON:function(e,t,n){return ut.get(e,t,n,"json")},getScript:function(e,n){return ut.get(e,t,n,"script")}}),ut.each(["get","post"],function(e,n){ut[n]=function(e,i,r,o){return ut.isFunction(i)&&(o=o||r,r=i,i=t),ut.ajax({url:e,type:n,dataType:o,data:i,success:r})}}),ut.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return ut.globalEval(e),e}}}),ut.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),ut.ajaxTransport("script",function(e){if(e.crossDomain){var n,i=Q.head||ut("head")[0]||Q.documentElement;return{send:function(t,r){n=Q.createElement("script"),n.async=!0,e.scriptCharset&&(n.charset=e.scriptCharset),n.src=e.url,n.onload=n.onreadystatechange=function(e,t){(t||!n.readyState||/loaded|complete/.test(n.readyState))&&(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),n=null,t||r(200,"success"))},i.insertBefore(n,i.firstChild)},abort:function(){n&&n.onload(t,!0)}}}});var Jn=[],Xn=/(=)\?(?=&|$)|\?\?/;ut.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Jn.pop()||ut.expando+"_"+Dn++;return this[e]=!0,e}}),ut.ajaxPrefilter("json jsonp",function(n,i,r){var o,a,s,l=n.jsonp!==!1&&(Xn.test(n.url)?"url":"string"==typeof n.data&&!(n.contentType||"").indexOf("application/x-www-form-urlencoded")&&Xn.test(n.data)&&"data");return l||"jsonp"===n.dataTypes[0]?(o=n.jsonpCallback=ut.isFunction(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,l?n[l]=n[l].replace(Xn,"$1"+o):n.jsonp!==!1&&(n.url+=(Mn.test(n.url)?"&":"?")+n.jsonp+"="+o),n.converters["script json"]=function(){return s||ut.error(o+" was not called"),s[0]},n.dataTypes[0]="json",a=e[o],e[o]=function(){s=arguments},r.always(function(){e[o]=a,n[o]&&(n.jsonpCallback=i.jsonpCallback,Jn.push(o)),s&&ut.isFunction(a)&&a(s[0]),s=a=t}),"script"):void 0});var Kn,Qn,Gn=0,Yn=e.ActiveXObject&&function(){var e;for(e in Kn)Kn[e](t,!0)};ut.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&j()||P()}:j,Qn=ut.ajaxSettings.xhr(),ut.support.cors=!!Qn&&"withCredentials"in Qn,Qn=ut.support.ajax=!!Qn,Qn&&ut.ajaxTransport(function(n){if(!n.crossDomain||ut.support.cors){var i;return{send:function(r,o){var a,s,l=n.xhr();if(n.username?l.open(n.type,n.url,n.async,n.username,n.password):l.open(n.type,n.url,n.async),n.xhrFields)for(s in n.xhrFields)l[s]=n.xhrFields[s];n.mimeType&&l.overrideMimeType&&l.overrideMimeType(n.mimeType),n.crossDomain||r["X-Requested-With"]||(r["X-Requested-With"]="XMLHttpRequest");try{for(s in r)l.setRequestHeader(s,r[s])}catch(c){}l.send(n.hasContent&&n.data||null),i=function(e,r){var s,c,u,d;try{if(i&&(r||4===l.readyState))if(i=t,a&&(l.onreadystatechange=ut.noop,Yn&&delete Kn[a]),r)4!==l.readyState&&l.abort();else{d={},s=l.status,c=l.getAllResponseHeaders(),"string"==typeof l.responseText&&(d.text=l.responseText);try{u=l.statusText}catch(h){u=""}s||!n.isLocal||n.crossDomain?1223===s&&(s=204):s=d.text?200:404}}catch(f){r||o(-1,f)}d&&o(s,u,d,c)},n.async?4===l.readyState?setTimeout(i):(a=++Gn,Yn&&(Kn||(Kn={},ut(e).unload(Yn)),Kn[a]=i),l.onreadystatechange=i):i()},abort:function(){i&&i(t,!0)}}}});var Zn,ei,ti=/^(?:toggle|show|hide)$/,ni=new RegExp("^(?:([+-])=|)("+dt+")([a-z%]*)$","i"),ii=/queueHooks$/,ri=[L],oi={"*":[function(e,t){var n=this.createTween(e,t),i=n.cur(),r=ni.exec(t),o=r&&r[3]||(ut.cssNumber[e]?"":"px"),a=(ut.cssNumber[e]||"px"!==o&&+i)&&ni.exec(ut.css(n.elem,e)),s=1,l=20;if(a&&a[3]!==o){o=o||a[3],r=r||[],a=+i||1;do s=s||".5",a/=s,ut.style(n.elem,e,a+o);while(s!==(s=n.cur()/i)&&1!==s&&--l)}return r&&(a=n.start=+a||+i||0,n.unit=o,n.end=r[1]?a+(r[1]+1)*r[2]:+r[2]),n}]};ut.Animation=ut.extend(q,{tweener:function(e,t){ut.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var n,i=0,r=e.length;r>i;i++)n=e[i],oi[n]=oi[n]||[],oi[n].unshift(t)},prefilter:function(e,t){t?ri.unshift(e):ri.push(e)}}),ut.Tween=F,F.prototype={constructor:F,init:function(e,t,n,i,r,o){this.elem=e,this.prop=n,this.easing=r||"swing",this.options=t,this.start=this.now=this.cur(),this.end=i,this.unit=o||(ut.cssNumber[n]?"":"px")},cur:function(){var e=F.propHooks[this.prop];return e&&e.get?e.get(this):F.propHooks._default.get(this)},run:function(e){var t,n=F.propHooks[this.prop];return this.pos=t=this.options.duration?ut.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):F.propHooks._default.set(this),this}},F.prototype.init.prototype=F.prototype,F.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=ut.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){ut.fx.step[e.prop]?ut.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[ut.cssProps[e.prop]]||ut.cssHooks[e.prop])?ut.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},F.propHooks.scrollTop=F.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},ut.each(["toggle","show","hide"],function(e,t){var n=ut.fn[t];ut.fn[t]=function(e,i,r){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(z(t,!0),e,i,r)}}),ut.fn.extend({fadeTo:function(e,t,n,i){return this.filter(k).css("opacity",0).show().end().animate({opacity:t},e,n,i)},animate:function(e,t,n,i){var r=ut.isEmptyObject(e),o=ut.speed(t,n,i),a=function(){var t=q(this,ut.extend({},e),o);(r||ut._data(this,"finish"))&&t.stop(!0)};return a.finish=a,r||o.queue===!1?this.each(a):this.queue(o.queue,a)},stop:function(e,n,i){var r=function(e){var t=e.stop;delete e.stop,t(i)};return"string"!=typeof e&&(i=n,n=e,e=t),n&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,n=null!=e&&e+"queueHooks",o=ut.timers,a=ut._data(this);if(n)a[n]&&a[n].stop&&r(a[n]);else for(n in a)a[n]&&a[n].stop&&ii.test(n)&&r(a[n]);for(n=o.length;n--;)o[n].elem!==this||null!=e&&o[n].queue!==e||(o[n].anim.stop(i),t=!1,o.splice(n,1));(t||!i)&&ut.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=ut._data(this),i=n[e+"queue"],r=n[e+"queueHooks"],o=ut.timers,a=i?i.length:0;for(n.finish=!0,ut.queue(this,e,[]),r&&r.stop&&r.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;a>t;t++)i[t]&&i[t].finish&&i[t].finish.call(this);delete n.finish})}}),ut.each({slideDown:z("show"),slideUp:z("hide"),slideToggle:z("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){ut.fn[e]=function(e,n,i){return this.animate(t,e,n,i)}}),ut.speed=function(e,t,n){var i=e&&"object"==typeof e?ut.extend({},e):{complete:n||!n&&t||ut.isFunction(e)&&e,duration:e,easing:n&&t||t&&!ut.isFunction(t)&&t};return i.duration=ut.fx.off?0:"number"==typeof i.duration?i.duration:i.duration in ut.fx.speeds?ut.fx.speeds[i.duration]:ut.fx.speeds._default,(null==i.queue||i.queue===!0)&&(i.queue="fx"),i.old=i.complete,i.complete=function(){ut.isFunction(i.old)&&i.old.call(this),i.queue&&ut.dequeue(this,i.queue)},i},ut.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},ut.timers=[],ut.fx=F.prototype.init,ut.fx.tick=function(){var e,n=ut.timers,i=0;for(Zn=ut.now();i<n.length;i++)e=n[i],e()||n[i]!==e||n.splice(i--,1);n.length||ut.fx.stop(),Zn=t},ut.fx.timer=function(e){e()&&ut.timers.push(e)&&ut.fx.start()},ut.fx.interval=13,ut.fx.start=function(){ei||(ei=setInterval(ut.fx.tick,ut.fx.interval))},ut.fx.stop=function(){clearInterval(ei),ei=null},ut.fx.speeds={slow:600,fast:200,_default:400},ut.fx.step={},ut.expr&&ut.expr.filters&&(ut.expr.filters.animated=function(e){return ut.grep(ut.timers,function(t){return e===t.elem}).length}),ut.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){ut.offset.setOffset(this,e,t)});var n,i,r={top:0,left:0},o=this[0],a=o&&o.ownerDocument;if(a)return n=a.documentElement,ut.contains(n,o)?(typeof o.getBoundingClientRect!==X&&(r=o.getBoundingClientRect()),i=W(a),{top:r.top+(i.pageYOffset||n.scrollTop)-(n.clientTop||0),left:r.left+(i.pageXOffset||n.scrollLeft)-(n.clientLeft||0)}):r},ut.offset={setOffset:function(e,t,n){var i=ut.css(e,"position");"static"===i&&(e.style.position="relative");var r,o,a=ut(e),s=a.offset(),l=ut.css(e,"top"),c=ut.css(e,"left"),u=("absolute"===i||"fixed"===i)&&ut.inArray("auto",[l,c])>-1,d={},h={};u?(h=a.position(),r=h.top,o=h.left):(r=parseFloat(l)||0,o=parseFloat(c)||0),ut.isFunction(t)&&(t=t.call(e,n,s)),null!=t.top&&(d.top=t.top-s.top+r),null!=t.left&&(d.left=t.left-s.left+o),"using"in t?t.using.call(e,d):a.css(d)}},ut.fn.extend({position:function(){if(this[0]){var e,t,n={top:0,left:0},i=this[0];return"fixed"===ut.css(i,"position")?t=i.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),ut.nodeName(e[0],"html")||(n=e.offset()),n.top+=ut.css(e[0],"borderTopWidth",!0),n.left+=ut.css(e[0],"borderLeftWidth",!0)),{top:t.top-n.top-ut.css(i,"marginTop",!0),left:t.left-n.left-ut.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||G;e&&!ut.nodeName(e,"html")&&"static"===ut.css(e,"position");)e=e.offsetParent;return e||G})}}),ut.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,n){var i=/Y/.test(n);ut.fn[e]=function(r){return ut.access(this,function(e,r,o){var a=W(e);return o===t?a?n in a?a[n]:a.document.documentElement[r]:e[r]:(a?a.scrollTo(i?ut(a).scrollLeft():o,i?o:ut(a).scrollTop()):e[r]=o,void 0)},e,r,arguments.length,null)}}),ut.each({Height:"height",Width:"width"},function(e,n){ut.each({padding:"inner"+e,content:n,"":"outer"+e},function(i,r){ut.fn[r]=function(r,o){var a=arguments.length&&(i||"boolean"!=typeof r),s=i||(r===!0||o===!0?"margin":"border");return ut.access(this,function(n,i,r){var o;return ut.isWindow(n)?n.document.documentElement["client"+e]:9===n.nodeType?(o=n.documentElement,Math.max(n.body["scroll"+e],o["scroll"+e],n.body["offset"+e],o["offset"+e],o["client"+e])):r===t?ut.css(n,i,s):ut.style(n,i,r,s)},n,a?r:t,a,null)}})}),ut.fn.size=function(){return this.length},ut.fn.andSelf=ut.fn.addBack,"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=ut:(e.jQuery=e.$=ut,"function"==typeof define&&define.amd&&define("jquery",[],function(){return ut}))}(window),function(e,t){e.rails!==t&&e.error("jquery-ujs has already been loaded!");var n,i=e(document);e.rails=n={linkClickSelector:"a[data-confirm], a[data-method], a[data-remote], a[data-disable-with]",buttonClickSelector:"button[data-remote]",inputChangeSelector:"select[data-remote], input[data-remote], textarea[data-remote]",formSubmitSelector:"form",formInputClickSelector:"form input[type=submit], form input[type=image], form button[type=submit], form button:not([type])",disableSelector:"input[data-disable-with], button[data-disable-with], textarea[data-disable-with]",enableSelector:"input[data-disable-with]:disabled, button[data-disable-with]:disabled, textarea[data-disable-with]:disabled",requiredInputSelector:"input[name][required]:not([disabled]),textarea[name][required]:not([disabled])",fileInputSelector:"input[type=file]",linkDisableSelector:"a[data-disable-with]",CSRFProtection:function(t){var n=e('meta[name="csrf-token"]').attr("content");n&&t.setRequestHeader("X-CSRF-Token",n)},fire:function(t,n,i){var r=e.Event(n);return t.trigger(r,i),r.result!==!1},confirm:function(e){return confirm(e)},ajax:function(t){return e.ajax(t)},href:function(e){return e.attr("href")},handleRemote:function(i){var r,o,a,s,l,c,u,d;if(n.fire(i,"ajax:before")){if(s=i.data("cross-domain"),l=s===t?null:s,c=i.data("with-credentials")||null,u=i.data("type")||e.ajaxSettings&&e.ajaxSettings.dataType,i.is("form")){r=i.attr("method"),o=i.attr("action"),a=i.serializeArray();var h=i.data("ujs:submit-button");h&&(a.push(h),i.data("ujs:submit-button",null))}else i.is(n.inputChangeSelector)?(r=i.data("method"),o=i.data("url"),a=i.serialize(),i.data("params")&&(a=a+"&"+i.data("params"))):i.is(n.buttonClickSelector)?(r=i.data("method")||"get",o=i.data("url"),a=i.serialize(),i.data("params")&&(a=a+"&"+i.data("params"))):(r=i.data("method"),o=n.href(i),a=i.data("params")||null);d={type:r||"GET",data:a,dataType:u,beforeSend:function(e,r){return r.dataType===t&&e.setRequestHeader("accept","*/*;q=0.5, "+r.accepts.script),n.fire(i,"ajax:beforeSend",[e,r])},success:function(e,t,n){i.trigger("ajax:success",[e,t,n])},complete:function(e,t){i.trigger("ajax:complete",[e,t])},error:function(e,t,n){i.trigger("ajax:error",[e,t,n])},crossDomain:l},c&&(d.xhrFields={withCredentials:c}),o&&(d.url=o);var f=n.ajax(d);return i.trigger("ajax:send",f),f}return!1},handleMethod:function(i){var r=n.href(i),o=i.data("method"),a=i.attr("target"),s=e("meta[name=csrf-token]").attr("content"),l=e("meta[name=csrf-param]").attr("content"),c=e('<form method="post" action="'+r+'"></form>'),u='<input name="_method" value="'+o+'" type="hidden" />';l!==t&&s!==t&&(u+='<input name="'+l+'" value="'+s+'" type="hidden" />'),a&&c.attr("target",a),c.hide().append(u).appendTo("body"),c.submit()},disableFormElements:function(t){t.find(n.disableSelector).each(function(){var t=e(this),n=t.is("button")?"html":"val";t.data("ujs:enable-with",t[n]()),t[n](t.data("disable-with")),t.prop("disabled",!0)})},enableFormElements:function(t){t.find(n.enableSelector).each(function(){var t=e(this),n=t.is("button")?"html":"val";t.data("ujs:enable-with")&&t[n](t.data("ujs:enable-with")),t.prop("disabled",!1)})},allowAction:function(e){var t,i=e.data("confirm"),r=!1;return i?(n.fire(e,"confirm")&&(r=n.confirm(i),t=n.fire(e,"confirm:complete",[r])),r&&t):!0},blankInputs:function(t,n,i){var r,o,a=e(),s=n||"input,textarea",l=t.find(s);return l.each(function(){if(r=e(this),o=r.is("input[type=checkbox],input[type=radio]")?r.is(":checked"):r.val(),!o==!i){if(r.is("input[type=radio]")&&l.filter('input[type=radio]:checked[name="'+r.attr("name")+'"]').length)return!0;a=a.add(r)}}),a.length?a:!1},nonBlankInputs:function(e,t){return n.blankInputs(e,t,!0)},stopEverything:function(t){return e(t.target).trigger("ujs:everythingStopped"),t.stopImmediatePropagation(),!1},disableElement:function(e){e.data("ujs:enable-with",e.html()),e.html(e.data("disable-with")),e.bind("click.railsDisable",function(e){return n.stopEverything(e)})},enableElement:function(e){e.data("ujs:enable-with")!==t&&(e.html(e.data("ujs:enable-with")),e.removeData("ujs:enable-with")),e.unbind("click.railsDisable")}},n.fire(i,"rails:attachBindings")&&(e.ajaxPrefilter(function(e,t,i){e.crossDomain||n.CSRFProtection(i)}),i.delegate(n.linkDisableSelector,"ajax:complete",function(){n.enableElement(e(this))}),i.delegate(n.linkClickSelector,"click.rails",function(i){var r=e(this),o=r.data("method"),a=r.data("params");if(!n.allowAction(r))return n.stopEverything(i);if(r.is(n.linkDisableSelector)&&n.disableElement(r),r.data("remote")!==t){if(!(!i.metaKey&&!i.ctrlKey||o&&"GET"!==o||a))return!0;var s=n.handleRemote(r);return s===!1?n.enableElement(r):s.error(function(){n.enableElement(r)}),!1}return r.data("method")?(n.handleMethod(r),!1):void 0}),i.delegate(n.buttonClickSelector,"click.rails",function(t){var i=e(this);return n.allowAction(i)?(n.handleRemote(i),!1):n.stopEverything(t)}),i.delegate(n.inputChangeSelector,"change.rails",function(t){var i=e(this);return n.allowAction(i)?(n.handleRemote(i),!1):n.stopEverything(t)}),i.delegate(n.formSubmitSelector,"submit.rails",function(i){var r=e(this),o=r.data("remote")!==t,a=n.blankInputs(r,n.requiredInputSelector),s=n.nonBlankInputs(r,n.fileInputSelector);if(!n.allowAction(r))return n.stopEverything(i);if(a&&r.attr("novalidate")==t&&n.fire(r,"ajax:aborted:required",[a]))return n.stopEverything(i);if(o){if(s){setTimeout(function(){n.disableFormElements(r)},13);var l=n.fire(r,"ajax:aborted:file",[s]);return l||setTimeout(function(){n.enableFormElements(r)},13),l}return n.handleRemote(r),!1}setTimeout(function(){n.disableFormElements(r)},13)}),i.delegate(n.formInputClickSelector,"click.rails",function(t){var i=e(this);if(!n.allowAction(i))return n.stopEverything(t);var r=i.attr("name"),o=r?{name:r,value:i.val()}:null;i.closest("form").data("ujs:submit-button",o)}),i.delegate(n.formSubmitSelector,"ajax:beforeSend.rails",function(t){this==t.target&&n.disableFormElements(e(this))}),i.delegate(n.formSubmitSelector,"ajax:complete.rails",function(t){this==t.target&&n.enableFormElements(e(this))}),e(function(){var t=e("meta[name=csrf-token]").attr("content"),n=e("meta[name=csrf-param]").attr("content");e('form input[name="'+n+'"]').val(t)}))}(jQuery),function(){var e,t,n,i,r,o,a,s,l,c,u,d,h,f,p,g,m,v,y,b,w,x,C,k,_,E,T,N,S,R,$,A,O,D,M,B,j,P,H,I,q,V,L,F,z,W={}.hasOwnProperty,U=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};a=10,d=null,$=null,x=null,E={},c=null,P=(null!=(z=document.cookie.match(/request_method=(\w+)/))?z[1].toUpperCase():void 0)||"",F=null,m=function(e){var t;return V("page:fetch"),t=B(e),null!=F&&F.abort(),F=new XMLHttpRequest,F.open("GET",t,!0),F.setRequestHeader("Accept","text/html, application/xhtml+xml, application/xml"),F.setRequestHeader("X-XHR-Referer",$),F.onload=function(){var t;return V("page:receive"),(t=S())?(A(e),s.apply(null,p(t)),O(),document.location.hash?document.location.href=document.location.href:I(),V("page:load")):document.location.href=e},F.onloadend=function(){return F=null},F.onabort=function(){return M()},F.onerror=function(){return document.location.href=e},F.send()},g=function(e){var t;return o(),t=E[e],null!=F&&F.abort(),s(t.title,t.body),R(t),V("page:restore")},o=function(){return E[d.position]={url:document.location.href,body:document.body,title:document.title,positionY:window.pageYOffset,positionX:window.pageXOffset},l(a)},N=function(e){return null==e&&(e=a),/^[\d]+$/.test(e)?a=parseInt(e):void 0},l=function(e){var t,n;for(t in E)W.call(E,t)&&(n=E[t],t<=d.position-e&&(E[t]=null))},s=function(t,n,i,r){return document.title=t,document.documentElement.replaceChild(n,document.body),null!=i&&e.update(i),j(),r&&h(),d=window.history.state,V("page:change")},h=function(){var e,t,n,i,r,o,a,s,l,c,u,d;for(o=Array.prototype.slice.call(document.body.querySelectorAll('script:not([data-turbolinks-eval="false"])')),a=0,l=o.length;l>a;a++)if(r=o[a],""===(u=r.type)||"text/javascript"===u){for(t=document.createElement("script"),d=r.attributes,s=0,c=d.length;c>s;s++)e=d[s],t.setAttribute(e.name,e.value);t.appendChild(document.createTextNode(r.innerHTML)),i=r.parentNode,n=r.nextSibling,i.removeChild(r),i.insertBefore(t,n)}},j=function(){var e,t,n,i;for(t=Array.prototype.slice.call(document.body.getElementsByTagName("noscript")),n=0,i=t.length;i>n;n++)e=t[n],e.parentNode.removeChild(e)},A=function(e){return e!==$?window.history.pushState({turbolinks:!0,position:d.position+1},"",e):void 0},O=function(){var e,t;return(e=F.getResponseHeader("X-XHR-Redirected-To"))?(t=B(e)===e?document.location.hash:"",window.history.replaceState(d,"",e+t)):void 0},M=function(){return window.history.replaceState({turbolinks:!0,position:Date.now()},"",document.location.href)},D=function(){return d=window.history.state},R=function(e){return window.scrollTo(e.positionX,e.positionY)},I=function(){return window.scrollTo(0,0)},B=function(e){var t;return t=e,null==e.href&&(t=document.createElement("A"),t.href=e),t.href.replace(t.hash,"")},V=function(e){var t;return t=document.createEvent("Events"),t.initEvent(e,!0,!0),document.dispatchEvent(t)},T=function(){return!V("page:before-change")},S=function(){var e,t,n,i,r,o;return t=function(){var e;return 400<=(e=F.status)&&600>e},o=function(){return F.getResponseHeader("Content-Type").match(/^(?:text\/html|application\/xhtml\+xml|application\/xml)(?:;|$)/)},i=function(e){var t,n,i,r,o;for(r=e.head.childNodes,o=[],n=0,i=r.length;i>n;n++)t=r[n],null!=("function"==typeof t.getAttribute?t.getAttribute("data-turbolinks-track"):void 0)&&o.push(t.src||t.href);return o},e=function(e){var t;return x||(x=i(document)),t=i(e),t.length!==x.length||r(t,x).length!==x.length},r=function(e,t){var n,i,r,o,a;for(e.length>t.length&&(o=[t,e],e=o[0],t=o[1]),a=[],i=0,r=e.length;r>i;i++)n=e[i],U.call(t,n)>=0&&a.push(n);return a},!t()&&o()&&(n=c(F.responseText),n&&!e(n))?n:void 0},p=function(t){var n;return n=t.querySelector("title"),[null!=n?n.textContent:void 0,t.body,e.get(t).token,"runScripts"]},e={get:function(e){var t;return null==e&&(e=document),{node:t=e.querySelector('meta[name="csrf-token"]'),token:null!=t?"function"==typeof t.getAttribute?t.getAttribute("content"):void 0:void 0}},update:function(e){var t;return t=this.get(),null!=t.token&&null!=e&&t.token!==e?t.node.setAttribute("content",e):void 0}},n=function(){var e,t,n,i,r,o;t=function(e){return(new DOMParser).parseFromString(e,"text/html")},e=function(e){var t;return t=document.implementation.createHTMLDocument(""),t.documentElement.innerHTML=e,t},n=function(e){var t;return t=document.implementation.createHTMLDocument(""),t.open("replace"),t.write(e),t.close(),t};try{if(window.DOMParser)return r=t("<html><body><p>test"),t}catch(a){return i=a,r=e("<html><body><p>test"),e}finally{if(1!==(null!=r?null!=(o=r.body)?o.childNodes.length:void 0:void 0))return n}},w=function(e){return e.defaultPrevented?void 0:(document.removeEventListener("click",v,!1),document.addEventListener("click",v,!1))},v=function(e){var t;return e.defaultPrevented||(t=f(e),"A"!==t.nodeName||y(e,t))?void 0:(T()||L(t.href),e.preventDefault())},f=function(e){var t;for(t=e.target;t.parentNode&&"A"!==t.nodeName;)t=t.parentNode;return t},u=function(e){return location.protocol!==e.protocol||location.host!==e.host},t=function(e){return(e.hash&&B(e))===B(location)||e.href===location.href+"#"},k=function(e){var t;return t=B(e),t.match(/\.[a-z]+(\?.*)?$/g)&&!t.match(/\.html?(\?.*)?$/g)},C=function(e){for(var t;!t&&e!==document;)t=null!=e.getAttribute("data-no-turbolink"),e=e.parentNode;return t},q=function(e){return 0!==e.target.length},_=function(e){return e.which>1||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey},y=function(e,n){return u(n)||t(n)||k(n)||C(n)||q(n)||_(e)},b=function(){return M(),D(),c=n(),document.addEventListener("click",w,!0),window.addEventListener("popstate",function(e){var t;return t=e.state,(null!=t?t.turbolinks:void 0)?E[t.position]?g(t.position):L(e.target.location.href):void 0},!1)},r=window.history&&window.history.pushState&&window.history.replaceState&&void 0!==window.history.state,i=!navigator.userAgent.match(/CriOS\//),H="GET"===P||""===P,r&&i&&H?(L=function(e){return $=document.location.href,o(),m(e)},b()):L=function(e){return document.location.href=e},this.Turbolinks={visit:L,pagesCached:N}}.call(this),"undefined"==typeof jQuery)throw new Error("Bootstrap requires jQuery");+function(e){"use strict";function t(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var n in t)if(void 0!==e.style[n])return{end:t[n]}}e.fn.emulateTransitionEnd=function(t){var n=!1,i=this;e(this).one(e.support.transition.end,function(){n=!0});var r=function(){n||e(i).trigger(e.support.transition.end)};return setTimeout(r,t),this},e(function(){e.support.transition=t()})}(jQuery),+function(e){"use strict";var t='[data-dismiss="alert"]',n=function(n){e(n).on("click",t,this.close)};n.prototype.close=function(t){function n(){o.trigger("closed.bs.alert").remove()}var i=e(this),r=i.attr("data-target");r||(r=i.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,""));var o=e(r);t&&t.preventDefault(),o.length||(o=i.hasClass("alert")?i:i.parent()),o.trigger(t=e.Event("close.bs.alert")),t.isDefaultPrevented()||(o.removeClass("in"),e.support.transition&&o.hasClass("fade")?o.one(e.support.transition.end,n).emulateTransitionEnd(150):n())};var i=e.fn.alert;e.fn.alert=function(t){return this.each(function(){var i=e(this),r=i.data("bs.alert");r||i.data("bs.alert",r=new n(this)),"string"==typeof t&&r[t].call(i)})},e.fn.alert.Constructor=n,e.fn.alert.noConflict=function(){return e.fn.alert=i,this},e(document).on("click.bs.alert.data-api",t,n.prototype.close)}(jQuery),+function(e){"use strict";var t=function(n,i){this.$element=e(n),this.options=e.extend({},t.DEFAULTS,i)};t.DEFAULTS={loadingText:"loading..."},t.prototype.setState=function(e){var t="disabled",n=this.$element,i=n.is("input")?"val":"html",r=n.data();e+="Text",r.resetText||n.data("resetText",n[i]()),n[i](r[e]||this.options[e]),setTimeout(function(){"loadingText"==e?n.addClass(t).attr(t,t):n.removeClass(t).removeAttr(t)},0)},t.prototype.toggle=function(){var e=this.$element.closest('[data-toggle="buttons"]');if(e.length){var t=this.$element.find("input").prop("checked",!this.$element.hasClass("active")).trigger("change");"radio"===t.prop("type")&&e.find(".active").removeClass("active")}this.$element.toggleClass("active")};var n=e.fn.button;e.fn.button=function(n){return this.each(function(){var i=e(this),r=i.data("bs.button"),o="object"==typeof n&&n;r||i.data("bs.button",r=new t(this,o)),"toggle"==n?r.toggle():n&&r.setState(n)})},e.fn.button.Constructor=t,e.fn.button.noConflict=function(){return e.fn.button=n,this},e(document).on("click.bs.button.data-api","[data-toggle^=button]",function(t){var n=e(t.target);n.hasClass("btn")||(n=n.closest(".btn")),n.button("toggle"),t.preventDefault()})}(jQuery),+function(e){"use strict";var t=function(t,n){this.$element=e(t),this.$indicators=this.$element.find(".carousel-indicators"),this.options=n,this.paused=this.sliding=this.interval=this.$active=this.$items=null,"hover"==this.options.pause&&this.$element.on("mouseenter",e.proxy(this.pause,this)).on("mouseleave",e.proxy(this.cycle,this))};t.DEFAULTS={interval:5e3,pause:"hover",wrap:!0},t.prototype.cycle=function(t){return t||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(e.proxy(this.next,this),this.options.interval)),this},t.prototype.getActiveIndex=function(){return this.$active=this.$element.find(".item.active"),this.$items=this.$active.parent().children(),this.$items.index(this.$active)},t.prototype.to=function(t){var n=this,i=this.getActiveIndex();return t>this.$items.length-1||0>t?void 0:this.sliding?this.$element.one("slid",function(){n.to(t)}):i==t?this.pause().cycle():this.slide(t>i?"next":"prev",e(this.$items[t]))},t.prototype.pause=function(t){return t||(this.paused=!0),this.$element.find(".next, .prev").length&&e.support.transition.end&&(this.$element.trigger(e.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},t.prototype.next=function(){return this.sliding?void 0:this.slide("next")},t.prototype.prev=function(){return this.sliding?void 0:this.slide("prev")},t.prototype.slide=function(t,n){var i=this.$element.find(".item.active"),r=n||i[t](),o=this.interval,a="next"==t?"left":"right",s="next"==t?"first":"last",l=this;if(!r.length){if(!this.options.wrap)return;r=this.$element.find(".item")[s]()}this.sliding=!0,o&&this.pause();var c=e.Event("slide.bs.carousel",{relatedTarget:r[0],direction:a});if(!r.hasClass("active")){if(this.$indicators.length&&(this.$indicators.find(".active").removeClass("active"),this.$element.one("slid",function(){var t=e(l.$indicators.children()[l.getActiveIndex()]);t&&t.addClass("active")})),e.support.transition&&this.$element.hasClass("slide")){if(this.$element.trigger(c),c.isDefaultPrevented())return;r.addClass(t),r[0].offsetWidth,i.addClass(a),r.addClass(a),i.one(e.support.transition.end,function(){r.removeClass([t,a].join(" ")).addClass("active"),i.removeClass(["active",a].join(" ")),l.sliding=!1,setTimeout(function(){l.$element.trigger("slid")},0)}).emulateTransitionEnd(600)}else{if(this.$element.trigger(c),c.isDefaultPrevented())return;i.removeClass("active"),r.addClass("active"),this.sliding=!1,this.$element.trigger("slid")}return o&&this.cycle(),this}};var n=e.fn.carousel;e.fn.carousel=function(n){return this.each(function(){var i=e(this),r=i.data("bs.carousel"),o=e.extend({},t.DEFAULTS,i.data(),"object"==typeof n&&n),a="string"==typeof n?n:o.slide;r||i.data("bs.carousel",r=new t(this,o)),"number"==typeof n?r.to(n):a?r[a]():o.interval&&r.pause().cycle()})},e.fn.carousel.Constructor=t,e.fn.carousel.noConflict=function(){return e.fn.carousel=n,this},e(document).on("click.bs.carousel.data-api","[data-slide], [data-slide-to]",function(t){var n,i=e(this),r=e(i.attr("data-target")||(n=i.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,"")),o=e.extend({},r.data(),i.data()),a=i.attr("data-slide-to");a&&(o.interval=!1),r.carousel(o),(a=i.attr("data-slide-to"))&&r.data("bs.carousel").to(a),t.preventDefault()}),e(window).on("load",function(){e('[data-ride="carousel"]').each(function(){var t=e(this);t.carousel(t.data())})})}(jQuery),+function(e){"use strict";var t=function(n,i){this.$element=e(n),this.options=e.extend({},t.DEFAULTS,i),this.transitioning=null,this.options.parent&&(this.$parent=e(this.options.parent)),this.options.toggle&&this.toggle()};t.DEFAULTS={toggle:!0},t.prototype.dimension=function(){var e=this.$element.hasClass("width");return e?"width":"height"},t.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var t=e.Event("show.bs.collapse");if(this.$element.trigger(t),!t.isDefaultPrevented()){var n=this.$parent&&this.$parent.find("> .panel > .in");if(n&&n.length){var i=n.data("bs.collapse");if(i&&i.transitioning)return;n.collapse("hide"),i||n.data("bs.collapse",null)}var r=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[r](0),this.transitioning=1;var o=function(){this.$element.removeClass("collapsing").addClass("in")[r]("auto"),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!e.support.transition)return o.call(this);var a=e.camelCase(["scroll",r].join("-"));this.$element.one(e.support.transition.end,e.proxy(o,this)).emulateTransitionEnd(350)[r](this.$element[0][a])}}},t.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var t=e.Event("hide.bs.collapse");if(this.$element.trigger(t),!t.isDefaultPrevented()){var n=this.dimension();this.$element[n](this.$element[n]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse").removeClass("in"),this.transitioning=1;var i=function(){this.transitioning=0,this.$element.trigger("hidden.bs.collapse").removeClass("collapsing").addClass("collapse")};return e.support.transition?(this.$element[n](0).one(e.support.transition.end,e.proxy(i,this)).emulateTransitionEnd(350),void 0):i.call(this)}}},t.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()};var n=e.fn.collapse;e.fn.collapse=function(n){return this.each(function(){var i=e(this),r=i.data("bs.collapse"),o=e.extend({},t.DEFAULTS,i.data(),"object"==typeof n&&n);r||i.data("bs.collapse",r=new t(this,o)),"string"==typeof n&&r[n]()})},e.fn.collapse.Constructor=t,e.fn.collapse.noConflict=function(){return e.fn.collapse=n,this},e(document).on("click.bs.collapse.data-api","[data-toggle=collapse]",function(t){var n,i=e(this),r=i.attr("data-target")||t.preventDefault()||(n=i.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,""),o=e(r),a=o.data("bs.collapse"),s=a?"toggle":i.data(),l=i.attr("data-parent"),c=l&&e(l);a&&a.transitioning||(c&&c.find('[data-toggle=collapse][data-parent="'+l+'"]').not(i).addClass("collapsed"),i[o.hasClass("in")?"addClass":"removeClass"]("collapsed")),o.collapse(s)})}(jQuery),+function(e){"use strict";function t(){e(i).remove(),e(r).each(function(t){var i=n(e(this));
i.hasClass("open")&&(i.trigger(t=e.Event("hide.bs.dropdown")),t.isDefaultPrevented()||i.removeClass("open").trigger("hidden.bs.dropdown"))})}function n(t){var n=t.attr("data-target");n||(n=t.attr("href"),n=n&&/#/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,""));var i=n&&e(n);return i&&i.length?i:t.parent()}var i=".dropdown-backdrop",r="[data-toggle=dropdown]",o=function(t){e(t).on("click.bs.dropdown",this.toggle)};o.prototype.toggle=function(i){var r=e(this);if(!r.is(".disabled, :disabled")){var o=n(r),a=o.hasClass("open");if(t(),!a){if("ontouchstart"in document.documentElement&&!o.closest(".navbar-nav").length&&e('<div class="dropdown-backdrop"/>').insertAfter(e(this)).on("click",t),o.trigger(i=e.Event("show.bs.dropdown")),i.isDefaultPrevented())return;o.toggleClass("open").trigger("shown.bs.dropdown"),r.focus()}return!1}},o.prototype.keydown=function(t){if(/(38|40|27)/.test(t.keyCode)){var i=e(this);if(t.preventDefault(),t.stopPropagation(),!i.is(".disabled, :disabled")){var o=n(i),a=o.hasClass("open");if(!a||a&&27==t.keyCode)return 27==t.which&&o.find(r).focus(),i.click();var s=e("[role=menu] li:not(.divider):visible a",o);if(s.length){var l=s.index(s.filter(":focus"));38==t.keyCode&&l>0&&l--,40==t.keyCode&&l<s.length-1&&l++,~l||(l=0),s.eq(l).focus()}}}};var a=e.fn.dropdown;e.fn.dropdown=function(t){return this.each(function(){var n=e(this),i=n.data("dropdown");i||n.data("dropdown",i=new o(this)),"string"==typeof t&&i[t].call(n)})},e.fn.dropdown.Constructor=o,e.fn.dropdown.noConflict=function(){return e.fn.dropdown=a,this},e(document).on("click.bs.dropdown.data-api",t).on("click.bs.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",r,o.prototype.toggle).on("keydown.bs.dropdown.data-api",r+", [role=menu]",o.prototype.keydown)}(jQuery),+function(e){"use strict";var t=function(t,n){this.options=n,this.$element=e(t),this.$backdrop=this.isShown=null,this.options.remote&&this.$element.load(this.options.remote)};t.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},t.prototype.toggle=function(e){return this[this.isShown?"hide":"show"](e)},t.prototype.show=function(t){var n=this,i=e.Event("show.bs.modal",{relatedTarget:t});this.$element.trigger(i),this.isShown||i.isDefaultPrevented()||(this.isShown=!0,this.escape(),this.$element.on("click.dismiss.modal",'[data-dismiss="modal"]',e.proxy(this.hide,this)),this.backdrop(function(){var i=e.support.transition&&n.$element.hasClass("fade");n.$element.parent().length||n.$element.appendTo(document.body),n.$element.show(),i&&n.$element[0].offsetWidth,n.$element.addClass("in").attr("aria-hidden",!1),n.enforceFocus();var r=e.Event("shown.bs.modal",{relatedTarget:t});i?n.$element.find(".modal-dialog").one(e.support.transition.end,function(){n.$element.focus().trigger(r)}).emulateTransitionEnd(300):n.$element.focus().trigger(r)}))},t.prototype.hide=function(t){t&&t.preventDefault(),t=e.Event("hide.bs.modal"),this.$element.trigger(t),this.isShown&&!t.isDefaultPrevented()&&(this.isShown=!1,this.escape(),e(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.modal"),e.support.transition&&this.$element.hasClass("fade")?this.$element.one(e.support.transition.end,e.proxy(this.hideModal,this)).emulateTransitionEnd(300):this.hideModal())},t.prototype.enforceFocus=function(){e(document).off("focusin.bs.modal").on("focusin.bs.modal",e.proxy(function(e){this.$element[0]===e.target||this.$element.has(e.target).length||this.$element.focus()},this))},t.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.bs.modal",e.proxy(function(e){27==e.which&&this.hide()},this)):this.isShown||this.$element.off("keyup.dismiss.bs.modal")},t.prototype.hideModal=function(){var e=this;this.$element.hide(),this.backdrop(function(){e.removeBackdrop(),e.$element.trigger("hidden.bs.modal")})},t.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},t.prototype.backdrop=function(t){var n=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var i=e.support.transition&&n;if(this.$backdrop=e('<div class="modal-backdrop '+n+'" />').appendTo(document.body),this.$element.on("click.dismiss.modal",e.proxy(function(e){e.target===e.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus.call(this.$element[0]):this.hide.call(this))},this)),i&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!t)return;i?this.$backdrop.one(e.support.transition.end,t).emulateTransitionEnd(150):t()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(e.support.transition.end,t).emulateTransitionEnd(150):t()):t&&t()};var n=e.fn.modal;e.fn.modal=function(n,i){return this.each(function(){var r=e(this),o=r.data("bs.modal"),a=e.extend({},t.DEFAULTS,r.data(),"object"==typeof n&&n);o||r.data("bs.modal",o=new t(this,a)),"string"==typeof n?o[n](i):a.show&&o.show(i)})},e.fn.modal.Constructor=t,e.fn.modal.noConflict=function(){return e.fn.modal=n,this},e(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(t){var n=e(this),i=n.attr("href"),r=e(n.attr("data-target")||i&&i.replace(/.*(?=#[^\s]+$)/,"")),o=r.data("modal")?"toggle":e.extend({remote:!/#/.test(i)&&i},r.data(),n.data());t.preventDefault(),r.modal(o,this).one("hide",function(){n.is(":visible")&&n.focus()})}),e(document).on("show.bs.modal",".modal",function(){e(document.body).addClass("modal-open")}).on("hidden.bs.modal",".modal",function(){e(document.body).removeClass("modal-open")})}(jQuery),+function(e){"use strict";var t=function(e,t){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",e,t)};t.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},t.prototype.init=function(t,n,i){this.enabled=!0,this.type=t,this.$element=e(n),this.options=this.getOptions(i);for(var r=this.options.trigger.split(" "),o=r.length;o--;){var a=r[o];if("click"==a)this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this));else if("manual"!=a){var s="hover"==a?"mouseenter":"focus",l="hover"==a?"mouseleave":"blur";this.$element.on(s+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(l+"."+this.type,this.options.selector,e.proxy(this.leave,this))}}this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.getOptions=function(t){return t=e.extend({},this.getDefaults(),this.$element.data(),t),t.delay&&"number"==typeof t.delay&&(t.delay={show:t.delay,hide:t.delay}),t},t.prototype.getDelegateOptions=function(){var t={},n=this.getDefaults();return this._options&&e.each(this._options,function(e,i){n[e]!=i&&(t[e]=i)}),t},t.prototype.enter=function(t){var n=t instanceof this.constructor?t:e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);return clearTimeout(n.timeout),n.hoverState="in",n.options.delay&&n.options.delay.show?(n.timeout=setTimeout(function(){"in"==n.hoverState&&n.show()},n.options.delay.show),void 0):n.show()},t.prototype.leave=function(t){var n=t instanceof this.constructor?t:e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);return clearTimeout(n.timeout),n.hoverState="out",n.options.delay&&n.options.delay.hide?(n.timeout=setTimeout(function(){"out"==n.hoverState&&n.hide()},n.options.delay.hide),void 0):n.hide()},t.prototype.show=function(){var t=e.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){if(this.$element.trigger(t),t.isDefaultPrevented())return;var n=this.tip();this.setContent(),this.options.animation&&n.addClass("fade");var i="function"==typeof this.options.placement?this.options.placement.call(this,n[0],this.$element[0]):this.options.placement,r=/\s?auto?\s?/i,o=r.test(i);o&&(i=i.replace(r,"")||"top"),n.detach().css({top:0,left:0,display:"block"}).addClass(i),this.options.container?n.appendTo(this.options.container):n.insertAfter(this.$element);var a=this.getPosition(),s=n[0].offsetWidth,l=n[0].offsetHeight;if(o){var c=this.$element.parent(),u=i,d=document.documentElement.scrollTop||document.body.scrollTop,h="body"==this.options.container?window.innerWidth:c.outerWidth(),f="body"==this.options.container?window.innerHeight:c.outerHeight(),p="body"==this.options.container?0:c.offset().left;i="bottom"==i&&a.top+a.height+l-d>f?"top":"top"==i&&a.top-d-l<0?"bottom":"right"==i&&a.right+s>h?"left":"left"==i&&a.left-s<p?"right":i,n.removeClass(u).addClass(i)}var g=this.getCalculatedOffset(i,a,s,l);this.applyPlacement(g,i),this.$element.trigger("shown.bs."+this.type)}},t.prototype.applyPlacement=function(e,t){var n,i=this.tip(),r=i[0].offsetWidth,o=i[0].offsetHeight,a=parseInt(i.css("margin-top"),10),s=parseInt(i.css("margin-left"),10);isNaN(a)&&(a=0),isNaN(s)&&(s=0),e.top=e.top+a,e.left=e.left+s,i.offset(e).addClass("in");var l=i[0].offsetWidth,c=i[0].offsetHeight;if("top"==t&&c!=o&&(n=!0,e.top=e.top+o-c),/bottom|top/.test(t)){var u=0;e.left<0&&(u=-2*e.left,e.left=0,i.offset(e),l=i[0].offsetWidth,c=i[0].offsetHeight),this.replaceArrow(u-r+l,l,"left")}else this.replaceArrow(c-o,c,"top");n&&i.offset(e)},t.prototype.replaceArrow=function(e,t,n){this.arrow().css(n,e?50*(1-e/t)+"%":"")},t.prototype.setContent=function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("fade in top bottom left right")},t.prototype.hide=function(){function t(){"in"!=n.hoverState&&i.detach()}var n=this,i=this.tip(),r=e.Event("hide.bs."+this.type);return this.$element.trigger(r),r.isDefaultPrevented()?void 0:(i.removeClass("in"),e.support.transition&&this.$tip.hasClass("fade")?i.one(e.support.transition.end,t).emulateTransitionEnd(150):t(),this.$element.trigger("hidden.bs."+this.type),this)},t.prototype.fixTitle=function(){var e=this.$element;(e.attr("title")||"string"!=typeof e.attr("data-original-title"))&&e.attr("data-original-title",e.attr("title")||"").attr("title","")},t.prototype.hasContent=function(){return this.getTitle()},t.prototype.getPosition=function(){var t=this.$element[0];return e.extend({},"function"==typeof t.getBoundingClientRect?t.getBoundingClientRect():{width:t.offsetWidth,height:t.offsetHeight},this.$element.offset())},t.prototype.getCalculatedOffset=function(e,t,n,i){return"bottom"==e?{top:t.top+t.height,left:t.left+t.width/2-n/2}:"top"==e?{top:t.top-i,left:t.left+t.width/2-n/2}:"left"==e?{top:t.top+t.height/2-i/2,left:t.left-n}:{top:t.top+t.height/2-i/2,left:t.left+t.width}},t.prototype.getTitle=function(){var e,t=this.$element,n=this.options;return e=t.attr("data-original-title")||("function"==typeof n.title?n.title.call(t[0]):n.title)},t.prototype.tip=function(){return this.$tip=this.$tip||e(this.options.template)},t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},t.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},t.prototype.enable=function(){this.enabled=!0},t.prototype.disable=function(){this.enabled=!1},t.prototype.toggleEnabled=function(){this.enabled=!this.enabled},t.prototype.toggle=function(t){var n=t?e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type):this;n.tip().hasClass("in")?n.leave(n):n.enter(n)},t.prototype.destroy=function(){this.hide().$element.off("."+this.type).removeData("bs."+this.type)};var n=e.fn.tooltip;e.fn.tooltip=function(n){return this.each(function(){var i=e(this),r=i.data("bs.tooltip"),o="object"==typeof n&&n;r||i.data("bs.tooltip",r=new t(this,o)),"string"==typeof n&&r[n]()})},e.fn.tooltip.Constructor=t,e.fn.tooltip.noConflict=function(){return e.fn.tooltip=n,this}}(jQuery),+function(e){"use strict";var t=function(e,t){this.init("popover",e,t)};if(!e.fn.tooltip)throw new Error("Popover requires tooltip.js");t.DEFAULTS=e.extend({},e.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),t.prototype=e.extend({},e.fn.tooltip.Constructor.prototype),t.prototype.constructor=t,t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.setContent=function(){var e=this.tip(),t=this.getTitle(),n=this.getContent();e.find(".popover-title")[this.options.html?"html":"text"](t),e.find(".popover-content")[this.options.html?"html":"text"](n),e.removeClass("fade top bottom left right in"),e.find(".popover-title").html()||e.find(".popover-title").hide()},t.prototype.hasContent=function(){return this.getTitle()||this.getContent()},t.prototype.getContent=function(){var e=this.$element,t=this.options;return e.attr("data-content")||("function"==typeof t.content?t.content.call(e[0]):t.content)},t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")},t.prototype.tip=function(){return this.$tip||(this.$tip=e(this.options.template)),this.$tip};var n=e.fn.popover;e.fn.popover=function(n){return this.each(function(){var i=e(this),r=i.data("bs.popover"),o="object"==typeof n&&n;r||i.data("bs.popover",r=new t(this,o)),"string"==typeof n&&r[n]()})},e.fn.popover.Constructor=t,e.fn.popover.noConflict=function(){return e.fn.popover=n,this}}(jQuery),+function(e){"use strict";function t(n,i){var r,o=e.proxy(this.process,this);this.$element=e(n).is("body")?e(window):e(n),this.$body=e("body"),this.$scrollElement=this.$element.on("scroll.bs.scroll-spy.data-api",o),this.options=e.extend({},t.DEFAULTS,i),this.selector=(this.options.target||(r=e(n).attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,"")||"")+" .nav li > a",this.offsets=e([]),this.targets=e([]),this.activeTarget=null,this.refresh(),this.process()}t.DEFAULTS={offset:10},t.prototype.refresh=function(){var t=this.$element[0]==window?"offset":"position";this.offsets=e([]),this.targets=e([]);var n=this;this.$body.find(this.selector).map(function(){var i=e(this),r=i.data("target")||i.attr("href"),o=/^#\w/.test(r)&&e(r);return o&&o.length&&[[o[t]().top+(!e.isWindow(n.$scrollElement.get(0))&&n.$scrollElement.scrollTop()),r]]||null}).sort(function(e,t){return e[0]-t[0]}).each(function(){n.offsets.push(this[0]),n.targets.push(this[1])})},t.prototype.process=function(){var e,t=this.$scrollElement.scrollTop()+this.options.offset,n=this.$scrollElement[0].scrollHeight||this.$body[0].scrollHeight,i=n-this.$scrollElement.height(),r=this.offsets,o=this.targets,a=this.activeTarget;if(t>=i)return a!=(e=o.last()[0])&&this.activate(e);for(e=r.length;e--;)a!=o[e]&&t>=r[e]&&(!r[e+1]||t<=r[e+1])&&this.activate(o[e])},t.prototype.activate=function(t){this.activeTarget=t,e(this.selector).parents(".active").removeClass("active");var n=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',i=e(n).parents("li").addClass("active");i.parent(".dropdown-menu").length&&(i=i.closest("li.dropdown").addClass("active")),i.trigger("activate")};var n=e.fn.scrollspy;e.fn.scrollspy=function(n){return this.each(function(){var i=e(this),r=i.data("bs.scrollspy"),o="object"==typeof n&&n;r||i.data("bs.scrollspy",r=new t(this,o)),"string"==typeof n&&r[n]()})},e.fn.scrollspy.Constructor=t,e.fn.scrollspy.noConflict=function(){return e.fn.scrollspy=n,this},e(window).on("load",function(){e('[data-spy="scroll"]').each(function(){var t=e(this);t.scrollspy(t.data())})})}(jQuery),+function(e){"use strict";var t=function(t){this.element=e(t)};t.prototype.show=function(){var t=this.element,n=t.closest("ul:not(.dropdown-menu)"),i=t.data("target");if(i||(i=t.attr("href"),i=i&&i.replace(/.*(?=#[^\s]*$)/,"")),!t.parent("li").hasClass("active")){var r=n.find(".active:last a")[0],o=e.Event("show.bs.tab",{relatedTarget:r});if(t.trigger(o),!o.isDefaultPrevented()){var a=e(i);this.activate(t.parent("li"),n),this.activate(a,a.parent(),function(){t.trigger({type:"shown.bs.tab",relatedTarget:r})})}}},t.prototype.activate=function(t,n,i){function r(){o.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),t.addClass("active"),a?(t[0].offsetWidth,t.addClass("in")):t.removeClass("fade"),t.parent(".dropdown-menu")&&t.closest("li.dropdown").addClass("active"),i&&i()}var o=n.find("> .active"),a=i&&e.support.transition&&o.hasClass("fade");a?o.one(e.support.transition.end,r).emulateTransitionEnd(150):r(),o.removeClass("in")};var n=e.fn.tab;e.fn.tab=function(n){return this.each(function(){var i=e(this),r=i.data("bs.tab");r||i.data("bs.tab",r=new t(this)),"string"==typeof n&&r[n]()})},e.fn.tab.Constructor=t,e.fn.tab.noConflict=function(){return e.fn.tab=n,this},e(document).on("click.bs.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(t){t.preventDefault(),e(this).tab("show")})}(jQuery),+function(e){"use strict";var t=function(n,i){this.options=e.extend({},t.DEFAULTS,i),this.$window=e(window).on("scroll.bs.affix.data-api",e.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",e.proxy(this.checkPositionWithEventLoop,this)),this.$element=e(n),this.affixed=this.unpin=null,this.checkPosition()};t.RESET="affix affix-top affix-bottom",t.DEFAULTS={offset:0},t.prototype.checkPositionWithEventLoop=function(){setTimeout(e.proxy(this.checkPosition,this),1)},t.prototype.checkPosition=function(){if(this.$element.is(":visible")){var n=e(document).height(),i=this.$window.scrollTop(),r=this.$element.offset(),o=this.options.offset,a=o.top,s=o.bottom;"object"!=typeof o&&(s=a=o),"function"==typeof a&&(a=o.top()),"function"==typeof s&&(s=o.bottom());var l=null!=this.unpin&&i+this.unpin<=r.top?!1:null!=s&&r.top+this.$element.height()>=n-s?"bottom":null!=a&&a>=i?"top":!1;this.affixed!==l&&(this.unpin&&this.$element.css("top",""),this.affixed=l,this.unpin="bottom"==l?r.top-i:null,this.$element.removeClass(t.RESET).addClass("affix"+(l?"-"+l:"")),"bottom"==l&&this.$element.offset({top:document.body.offsetHeight-s-this.$element.height()}))}};var n=e.fn.affix;e.fn.affix=function(n){return this.each(function(){var i=e(this),r=i.data("bs.affix"),o="object"==typeof n&&n;r||i.data("bs.affix",r=new t(this,o)),"string"==typeof n&&r[n]()})},e.fn.affix.Constructor=t,e.fn.affix.noConflict=function(){return e.fn.affix=n,this},e(window).on("load",function(){e('[data-spy="affix"]').each(function(){var t=e(this),n=t.data();n.offset=n.offset||{},n.offsetBottom&&(n.offset.bottom=n.offsetBottom),n.offsetTop&&(n.offset.top=n.offsetTop),t.affix(n)})})}(jQuery),function(){var e=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1},t=[].slice;!function(e,t){return"function"==typeof define&&define.amd?define("waypoints",["jquery"],function(n){return t(n,e)}):t(e.jQuery,e)}(this,function(n,i){var r,o,a,s,l,c,u,d,h,f,p,g,m,v,y,b;return r=n(i),d=e.call(i,"ontouchstart")>=0,s={horizontal:{},vertical:{}},l=1,u={},c="waypoints-context-id",p="resize.waypoints",g="scroll.waypoints",m=1,v="waypoints-waypoint-ids",y="waypoint",b="waypoints",o=function(){function e(e){var t=this;this.$element=e,this.element=e[0],this.didResize=!1,this.didScroll=!1,this.id="context"+l++,this.oldScroll={x:e.scrollLeft(),y:e.scrollTop()},this.waypoints={horizontal:{},vertical:{}},e.data(c,this.id),u[this.id]=this,e.bind(g,function(){var e;return t.didScroll||d?void 0:(t.didScroll=!0,e=function(){return t.doScroll(),t.didScroll=!1},i.setTimeout(e,n[b].settings.scrollThrottle))}),e.bind(p,function(){var e;return t.didResize?void 0:(t.didResize=!0,e=function(){return n[b]("refresh"),t.didResize=!1},i.setTimeout(e,n[b].settings.resizeThrottle))})}return e.prototype.doScroll=function(){var e,t=this;return e={horizontal:{newScroll:this.$element.scrollLeft(),oldScroll:this.oldScroll.x,forward:"right",backward:"left"},vertical:{newScroll:this.$element.scrollTop(),oldScroll:this.oldScroll.y,forward:"down",backward:"up"}},!d||e.vertical.oldScroll&&e.vertical.newScroll||n[b]("refresh"),n.each(e,function(e,i){var r,o,a;return a=[],o=i.newScroll>i.oldScroll,r=o?i.forward:i.backward,n.each(t.waypoints[e],function(e,t){var n,r;return i.oldScroll<(n=t.offset)&&n<=i.newScroll?a.push(t):i.newScroll<(r=t.offset)&&r<=i.oldScroll?a.push(t):void 0}),a.sort(function(e,t){return e.offset-t.offset}),o||a.reverse(),n.each(a,function(e,t){return t.options.continuous||e===a.length-1?t.trigger([r]):void 0})}),this.oldScroll={x:e.horizontal.newScroll,y:e.vertical.newScroll}},e.prototype.refresh=function(){var e,t,i,r=this;return i=n.isWindow(this.element),t=this.$element.offset(),this.doScroll(),e={horizontal:{contextOffset:i?0:t.left,contextScroll:i?0:this.oldScroll.x,contextDimension:this.$element.width(),oldScroll:this.oldScroll.x,forward:"right",backward:"left",offsetProp:"left"},vertical:{contextOffset:i?0:t.top,contextScroll:i?0:this.oldScroll.y,contextDimension:i?n[b]("viewportHeight"):this.$element.height(),oldScroll:this.oldScroll.y,forward:"down",backward:"up",offsetProp:"top"}},n.each(e,function(e,t){return n.each(r.waypoints[e],function(e,i){var r,o,a,s,l;return r=i.options.offset,a=i.offset,o=n.isWindow(i.element)?0:i.$element.offset()[t.offsetProp],n.isFunction(r)?r=r.apply(i.element):"string"==typeof r&&(r=parseFloat(r),i.options.offset.indexOf("%")>-1&&(r=Math.ceil(t.contextDimension*r/100))),i.offset=o-t.contextOffset+t.contextScroll-r,i.options.onlyOnScroll&&null!=a||!i.enabled?void 0:null!==a&&a<(s=t.oldScroll)&&s<=i.offset?i.trigger([t.backward]):null!==a&&a>(l=t.oldScroll)&&l>=i.offset?i.trigger([t.forward]):null===a&&t.oldScroll>=i.offset?i.trigger([t.forward]):void 0})})},e.prototype.checkEmpty=function(){return n.isEmptyObject(this.waypoints.horizontal)&&n.isEmptyObject(this.waypoints.vertical)?(this.$element.unbind([p,g].join(" ")),delete u[this.id]):void 0},e}(),a=function(){function e(e,t,i){var r,o;i=n.extend({},n.fn[y].defaults,i),"bottom-in-view"===i.offset&&(i.offset=function(){var e;return e=n[b]("viewportHeight"),n.isWindow(t.element)||(e=t.$element.height()),e-n(this).outerHeight()}),this.$element=e,this.element=e[0],this.axis=i.horizontal?"horizontal":"vertical",this.callback=i.handler,this.context=t,this.enabled=i.enabled,this.id="waypoints"+m++,this.offset=null,this.options=i,t.waypoints[this.axis][this.id]=this,s[this.axis][this.id]=this,r=null!=(o=e.data(v))?o:[],r.push(this.id),e.data(v,r)}return e.prototype.trigger=function(e){return this.enabled?(null!=this.callback&&this.callback.apply(this.element,e),this.options.triggerOnce?this.destroy():void 0):void 0},e.prototype.disable=function(){return this.enabled=!1},e.prototype.enable=function(){return this.context.refresh(),this.enabled=!0},e.prototype.destroy=function(){return delete s[this.axis][this.id],delete this.context.waypoints[this.axis][this.id],this.context.checkEmpty()},e.getWaypointsByElement=function(e){var t,i;return(i=n(e).data(v))?(t=n.extend({},s.horizontal,s.vertical),n.map(i,function(e){return t[e]})):[]},e}(),f={init:function(e,t){var i;return null==t&&(t={}),null==(i=t.handler)&&(t.handler=e),this.each(function(){var e,i,r,s;return e=n(this),r=null!=(s=t.context)?s:n.fn[y].defaults.context,n.isWindow(r)||(r=e.closest(r)),r=n(r),i=u[r.data(c)],i||(i=new o(r)),new a(e,i,t)}),n[b]("refresh"),this},disable:function(){return f._invoke(this,"disable")},enable:function(){return f._invoke(this,"enable")},destroy:function(){return f._invoke(this,"destroy")},prev:function(e,t){return f._traverse.call(this,e,t,function(e,t,n){return t>0?e.push(n[t-1]):void 0})},next:function(e,t){return f._traverse.call(this,e,t,function(e,t,n){return t<n.length-1?e.push(n[t+1]):void 0})},_traverse:function(e,t,r){var o,a;return null==e&&(e="vertical"),null==t&&(t=i),a=h.aggregate(t),o=[],this.each(function(){var t;return t=n.inArray(this,a[e]),r(o,t,a[e])}),this.pushStack(o)},_invoke:function(e,t){return e.each(function(){var e;return e=a.getWaypointsByElement(this),n.each(e,function(e,n){return n[t](),!0})}),this}},n.fn[y]=function(){var e,i;return i=arguments[0],e=2<=arguments.length?t.call(arguments,1):[],f[i]?f[i].apply(this,e):n.isFunction(i)?f.init.apply(this,arguments):n.isPlainObject(i)?f.init.apply(this,[null,i]):i?n.error("The "+i+" method does not exist in jQuery Waypoints."):n.error("jQuery Waypoints needs a callback function or handler option.")},n.fn[y].defaults={context:i,continuous:!0,enabled:!0,horizontal:!1,offset:0,triggerOnce:!1},h={refresh:function(){return n.each(u,function(e,t){return t.refresh()})},viewportHeight:function(){var e;return null!=(e=i.innerHeight)?e:r.height()},aggregate:function(e){var t,i,r;return t=s,e&&(t=null!=(r=u[n(e).data(c)])?r.waypoints:void 0),t?(i={horizontal:[],vertical:[]},n.each(i,function(e,r){return n.each(t[e],function(e,t){return r.push(t)}),r.sort(function(e,t){return e.offset-t.offset}),i[e]=n.map(r,function(e){return e.element}),i[e]=n.unique(i[e])}),i):[]},above:function(e){return null==e&&(e=i),h._filter(e,"vertical",function(e,t){return t.offset<=e.oldScroll.y})},below:function(e){return null==e&&(e=i),h._filter(e,"vertical",function(e,t){return t.offset>e.oldScroll.y})},left:function(e){return null==e&&(e=i),h._filter(e,"horizontal",function(e,t){return t.offset<=e.oldScroll.x})},right:function(e){return null==e&&(e=i),h._filter(e,"horizontal",function(e,t){return t.offset>e.oldScroll.x})},enable:function(){return h._invoke("enable")},disable:function(){return h._invoke("disable")},destroy:function(){return h._invoke("destroy")},extendFn:function(e,t){return f[e]=t},_invoke:function(e){var t;return t=n.extend({},s.vertical,s.horizontal),n.each(t,function(t,n){return n[e](),!0})},_filter:function(e,t,i){var r,o;return(r=u[n(e).data(c)])?(o=[],n.each(r.waypoints[t],function(e,t){return i(r,t)?o.push(t):void 0}),o.sort(function(e,t){return e.offset-t.offset}),n.map(o,function(e){return e.element})):[]}},n[b]=function(){var e,n;return n=arguments[0],e=2<=arguments.length?t.call(arguments,1):[],h[n]?h[n].apply(null,e):h.aggregate.call(null,n)},n[b].settings={resizeThrottle:100,scrollThrottle:30},r.load(function(){return n[b]("refresh")})})}.call(this),function(){}.call(this),function(e,t){if(!t.__SV){var n,i,r,o;window.mixpanel=t,n=e.createElement("script"),n.type="text/javascript",n.async=!0,n.src=("https:"===e.location.protocol?"https:":"http:")+"//cdn.mxpnl.com/libs/mixpanel-2.2.min.js",i=e.getElementsByTagName("script")[0],i.parentNode.insertBefore(n,i),t._i=[],t.init=function(e,n,i){function a(e,t){var n=t.split(".");2==n.length&&(e=e[n[0]],t=n[1]),e[t]=function(){e.push([t].concat(Array.prototype.slice.call(arguments,0)))}}var s=t;for("undefined"!=typeof i?s=t[i]=[]:i="mixpanel",s.people=s.people||[],s.toString=function(e){var t="mixpanel";return"mixpanel"!==i&&(t+="."+i),e||(t+=" (stub)"),t},s.people.toString=function(){return s.toString(1)+".people (stub)"},r="disable track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config people.set people.set_once people.increment people.append people.track_charge people.clear_charges people.delete_user".split(" "),o=0;o<r.length;o++)a(s,r[o]);t._i.push([e,n,i])},t.__SV=1.2}}(document,window.mixpanel||[]),mixpanel.init("c78dda04a0094aef88741c7f5b8473d2"),function(){}.call(this),function(){}.call(this),require.config({baseUrl:"/js",paths:{filepicker:"//api.filepicker.io/v1/filepicker"},shim:{filepicker:{deps:[],exports:"filepicker",init:function(){filepicker.setKey("AiMRzNsV1SqKjcZIzLB6mz")}}}}),define("app/collections/bulletcollection",["backbone"],function(e){e.Collection.extend({comparator:"order",initialize:function(){this.on("enter",function(e){this.add({content:"",order:e.get("order")+1,children:[]})})}})}),define("app/collections/undoredo",["jquery","underscore","backbone","selection"],function(e,t,n,i){var r=n.Model.extend({defaults:function(){return{json:{},charBounds:{}}}}),o=n.Collection.extend({model:r,cursor:-1,maxLen:150,wait:1e3,lastAdd:0,constructor:function(e,t){return this.trackModel=e,this.$rangeEl=t,n.Collection.prototype.constructor.apply(this)},initialize:function(){this.listenTo(this.trackModel,"changepoint",function(e){var n=i.getRange();charBounds={left:0,right:0},n&&(charBounds=i.getCharBounds(i.getRange(),this.$rangeEl,".bullet-view"));var r=this.smartAdd({json:this.trackModel.toJSON().page,charBounds:charBounds});e&&r&&this.at(this.length-2).set("charBounds",t.clone(e))}),this.listenTo(this.trackModel,"undo",function(){this.undo()}),this.listenTo(this.trackModel,"redo",function(){this.redo()})},smartAdd:function(e,n){var i,r,o=Date.now(),a=o-this.lastAdd,s=a<=this.wait||n;if(a>this.wait||n){if(i=e.json,r=this.last()?this.last().get("json"):{},!t.isEqual(i,r)){for(this.cursor+1<this.length&&this.remove(this.slice(this.cursor+1,this.length)),s&&this.remove(this.last()),this.add(e),this.lastAdd=Date.now(),this.updateCursor(1);this.length>this.maxLen;)this.shift();return this.cursor=this.length-1,!0}}else i=e.json,r=this.last()?this.last().get("json"):{},t.isEqual(i,r)||this.last().set(e);return!1},undo:function(){if(this.cursor>0){if(this.cursor===this.length-1){var t=i.getRange(),n={left:0,right:0};t&&(n=i.getCharBounds(i.getRange(),this.$rangeEl,".bullet-view")),this.smartAdd({json:this.trackModel.toJSON().page,charBounds:n},!0)}var r=this.at(this.cursor-1);this.trackModel.set(r.get("json")),this.trackModel.trigger("childupdate"),this.updateCursor(-1);var t=i.charBoundsToRange(r.get("charBounds"),this.$rangeEl),o=e(t.startContainer);(o.is(".bullet-view")||o.parents(".bullet-view").length>0)&&i.restoreRange(t)}},redo:function(){if(this.cursor<this.length-1){var t=this.at(this.cursor+1);this.trackModel.set(t.get("json")),this.trackModel.trigger("childupdate"),this.updateCursor(1);var n=i.charBoundsToRange(t.get("charBounds"),this.$rangeEl),r=e(n.startContainer);(r.is(".bullet-view")||r.parents(".bullet-view").length>0)&&i.restoreRange(n)}},updateCursor:function(e){this.cursor+=e},softClose:function(){this.stopListening(),this.reset()}});return o}),define("app/edit",["jquery","underscore","backbone","marionette","app/models/bullet","app/edit_app","app/models/page","app/views/pageview","app/views/textmenu","app/collections/undoredo","app/models/notebook","app/views/pagelistview","app/views/childpagelinks"],function(e,t,n,i,r,o,a,s,l,c,u,d,h){var f=n.Model.prototype.toJSON;n.Model.prototype.toJSON=function(){var e={};return e[this.name]=f.apply(this),e};n.Model.prototype.toJSON;n.Model.prototype.parse=function(e){return e?e[this.name]:{}};var p=n.Model.prototype.destroy;n.Model.prototype.destroy=function(){this.stopListening(),p.apply(this)},window.editor=o,require(["selection"],function(e){window.sel=e}),o.notebook=new u,Router=n.Router.extend({routes:{},edit:function(n,i){o.notebook.id?(o.page.lastCursor=o.pageView.lastCharBounds,o.page=o.notebook.pageCollection.get(i),o.pageView.softClose(),e(".page-view .body").empty(),o.pageView=new s({model:o.page}),o.pageView.setElement(".page-view"),o.pageView.render(),o.pageView.renderModel(),o.undoRedo.softClose(),o.undoRedo=new c(o.page,o.pageView.$el),o.page.lastCursor?(o.pageView.lastCharBounds=o.page.lastCursor,o.pageView.restoreCursor()):(o.pageView.ensureCursor(),o.pageView.updateCharBounds(),""===o.page.get("name")&&o.page.trigger("focus",o.page)),o.page.trigger("changepoint"),o.childPageLinksView.setAncestry(o.page),window.scrollTo(0,o.page.scrollPosition),o.pageListView.$(".page-list-item").removeClass("active"),o.pageListView.children.findByModel(o.page).ui.$item.addClass("active")):(o.notebook.set("id",n),o.notebook.fetch({cache:!1}),o.notebook.pageCollection.once("reset",function(){o.page=o.notebook.pageCollection.get(i),o.pageView=new s({model:o.page}),o.pageListView=new d({model:o.notebook,collection:o.notebook.pageCollection}),o.childPageLinksView=new h({collection:o.notebook.pageCollection}),e(window).on("scroll",t.debounce(function(){o.page.scrollPosition=window.scrollY},200)),e(document).ready(function(){o.pageView.setElement(".page-view"),o.pageView.render(),o.pageListView.$el.appendTo(".directory"),o.pageListView.render(),o.undoRedo=new c(o.page,o.pageView.$el),o.pageView.ensureCursor(),o.pageView.updateCharBounds(),o.page.trigger("changepoint"),o.childPageLinksView.setAncestry(o.page),o.childPageLinksView.render(),o.childPageLinksView.$el.appendTo(".edit-container"),o.pageListView.children.findByModel(o.page).ui.$item.addClass("active")})}))}}),o.router=new Router,o.listenTo(o.notebook.pageCollection,"active",function(e){var t=e.id,n=e.get("friendly_id");if(n&&""!==n||(n=t),o.page&&o.page!==e){if(t)o.router.navigate(o.notebook.get("friendly_id")+"/"+n+"/edit",{trigger:!1});else{var t=e.cid;
this.listenToOnce(e,"change:id",function(){o.router.navigate(o.notebook.get("friendly_id")+"/"+e.id+"/edit",{trigger:!1})})}o.router.edit(window.notebookId,t)}}),o.tm=new l,e(window).on("unload",function(){o.page.save(),o.page.bulletCollection.cleanOrder()}),n.history.start({pushState:!0}),o.router.edit(window.notebookId,window.pageId),e(document).ready(function(){function t(){}e(".page-view .body").empty(),t(),o.tm.setElement(".text-menu"),o.tm.render(),setInterval(t,3e4)})}),define("app/edit_app",["marionette"],function(e){var t=new e.Application;return t}),define("app/models/bullet",["backbone","orderedcollection"],function(e,t){var n,i=e.Model.extend({name:"bullet",deletable:!0,defaults:function(){return{bulletable_type:"Text",position:1}},urlRoot:"/api/bullets",initialize:function(){},save:function(){var t={success:function(e){e.collection||e.destroy()}};return e.Model.prototype.save.call(this,{},t)}});return n=t.extend({comparator:"position",model:i,url:"api/bullets",updating:!1,initialize:function(){this.on("remove",function(e){this.updating&&e.destroy()}),this.on("add",function(){this.updating})},cleanOrder:function(){this.sort();var e=!1,t=this;this.each(function(n,i){n.get("position")!==i&&(e||(e=!0,t.debug()),n.set("position",i))})},saveChanged:function(){var e=this.filter(function(e){return!_.isEmpty(e.changed)});_.each(e,function(){})},debug:function(){var e=this.reduce(function(e,t){return e+=t.get("id")+": ",e+=t.get("position")+": ",e+=t.get("content")+"\n"},"");console.log(e)}}),{Model:i,Collection:n}}),define("app/models/feedback",["backbone"],function(e){var t=/.+@.+\./,n=/\[(\d+),(\d+)\]$/,i=e.Model.extend({name:"feedback",defaults:{page_id:null,mood:"",message:"",context:"",email:"",name:"John Smith"},urlRoot:"/api/feedbacks",validate:function(e){var n=e.email;return t.test(n)||""===e.message?void 0:{email:!1}},offset:function(){var e=this.get("context").match(n);return e?[e[1],e[2]]:void 0}}),r=e.Collection.extend({url:"/api/feedbacks",model:i,name:"feedbacks",checkDupe:function(){},destroyAll:function(){var e=this.models;_.each(e,function(e){e.destroy()})}});return{Model:i,Collection:r}}),define("app/models/image",["backbone"],function(e){var t=e.Model.extend({name:"image",defaults:{s3_url:"",filepicker_url:"",position:0,bulletable_type:"Image"},urlRoot:"/api/images",parentAttr:"album_id",parentType:"Album"});return t}),define("app/models/notebook",["underscore","backbone","app/models/page"],function(e,t,n){var i=t.Model.extend({urlRoot:"/api/notebooks",name:"notebook",defaults:{name:"Notebook",subdomain:"",pages:[]},initialize:function(){this.pageCollection=new n.Collection,this.listenTo(this.pageCollection,"add",function(e){e.set("notebook_id",this.get("id"))}),this.on("change:pages",function(){this.pageCollection.orderedSet(this.get("pages"))})}});return i}),define("app/models/page",["jquery","underscore","backbone","app/models/pagecore","app/models/bullet","app/models/typebullet","pagedown","tomarkdown"],function(e,t,n,i,r,o,a){var s=new a.Converter,l=i.extend({pauseUndo:!1,scrollPosition:0,lastCursor:!1,initialize:function(){var e,n=this.get("content");if(null===n)var e=this.prepBullets(this.get("bullets"));else e=this.prepBullets(this.parseMarkdown(n));this.bulletCollection=new r.Collection,this.listenTo(this.bulletCollection,"add",function(e){"Page"!==e.get("bulletable_type")&&e.set("page_id",this.id)});var i=this.get("name");if(this.setType(i),this.bulletCollection.set(e),this.bulletCollection.cleanOrder(),this.set("children",[]),0===this.bulletCollection.length){var a=new o.Text({position:0,bulletable_type:"Text",content:"Write your content here    "});this.bulletCollection.add(a)}this.on("change",t.debounce(function(){this.collection&&this.save()},1e3)),this.on("childupdate",function(){this.pauseUndo=!0;var e=this.prepBullets(this.get("bullets"));this.bulletCollection.updating=!0,this.bulletCollection.reset();this.bulletCollection.set(e);this.bulletCollection.cleanOrder(),this.bulletCollection.updating=!1,this.trigger("syncup"),this.bulletCollection.each(function(e){e.trigger("childupdate"),e.trigger("syncup")}),this.pauseUndo=!1}),this.on("change:id",function(e,t){e.bulletCollection.each(function(e){e.set("page_id",t)})}),this.on("change:name",function(e,t){this.setType(t)}),this.listenTo(this.bulletCollection,"changepoint",function(e){this.trigger("changepoint",e)}),this.listenTo(this.bulletCollection,"change:position",function(){this.trigger("changepoint")}),this.on("changepoint",t.debounce(function(){this.collection&&this.id&&this.save()},1e3))},setType:function(e){var t=this.get("page_type");e.match(/^:/)?"Label"!==t&&this.set("page_type","Label"):"Page"!==t&&this.set("page_type","Page")},prepBullets:function(e){var n=["Text","Album","Page","List"],i=e,r=[],a=[];t.each(i,function(e){t.contains(n,e.bulletable_type)?r.push(e):a.push(e)});var s=t.pluck(r,"position"),l=0,c=t.map(this.get("children"),function(e){return e.bulletable_type="Page",(!e.position||t.contains(s,e.position))&&(e.position=i.length+l,l++),e});r=r.concat(c);var u=t.map(r,function(e){var t=e.bulletable_type;return new o[t](e)});return u},parseMarkdown:function(n){var i=n.split(/\n\n/g),r=[],o=[{re:/^\*\s/,bulletable_type:"Text",tag:"li",html_class:"level-1",clean:function(e){return e.replace(/^\*/,"")}},{re:/^\s{4}\*/,bulletable_type:"Text",tag:"li",html_class:"level-2",clean:function(e){return e.replace(/^\s*\*/,"")}},{re:/^\s{8}\*/,bulletable_type:"Text",tag:"li",html_class:"level-3",clean:function(e){return e.replace(/^\s*\*/,"")}},{re:/^\s{4}/,bulletable_type:"Text",tag:"pre",clean:function(e){return e=e.replace(/^\s{4}/g,""),e.replace(/\n\s{4}/g,"\n")}},{re:/^!/,bulletable_type:"Album",clean:function(e){return e},custom:function(e){for(var t=/\[([^\]]*)\]\(([^\)]*)\)/g,n=t.exec(e),i=[];n;)i.push({id:n[1],s3_url:n[2]}),n=t.exec(e);return{bulletable_type:"Album",images:i}}},{re:/^>/,bulletable_type:"Text",tag:"blockquote",clean:function(e){return e.replace(/^>\s/,"")}},{re:/^#{3}/,bulletable_type:"Text",tag:"h3",clean:function(e){return e}},{re:/^#{2}/,bulletable_type:"Text",tag:"h2",clean:function(e){return e}},{re:/.*/,bulletable_type:"Text",tag:"p",clean:function(e){return e}}];return t.each(i,function(n,i){var a,l=t.findWhere(o,function(e){return e.re.test(n)});if(l.custom)a=l.custom(n);else{var c=l.clean(n);a=t.omit(l,"re","clean");var u=e(s.makeHtml(c));a.html_class||(a.html_class=u.attr("class")),a.content=u.html()}a.position=i,r.push(a)}),r},toJSON:function(){var e=n.Model.prototype.toJSON.apply(this);return e.page.bullets=this.bulletCollection.map(function(e){return e.toJSON()[e.name]}),e.page.content=t.map(this.bulletCollection.filter(function(e){return e.toMarkdown}),function(e){return e.toMarkdown()}).join("\n\n"),e},getParentID:function(){var e=this.get("ancestry");return e?t.last(e.split("/")):!1},getDepth:function(){var e=this.get("ancestry");return e?e.split("/").length:0},splitAncestry:function(){var e=this.get("ancestry");return e?t.map(e.split("/"),function(e){return Number(e)}):[]},getIndex:function(){return this.collection.getRelativeIndex(this)}}),c=n.Collection.extend({model:l,orderedSet:function(e){for(var n=t(e).pluck("position").max().value(),i=100;n>i;)i=10*i;var r=t.sortBy(e,function(e){var t=e.ancestry;if(!t)return e.position;var n=t.split("/").length*i+e.position;return n});return this.reset(r)},comparator:function(e){var n=e.splitAncestry();n.push(e.cid);for(var i=this.maxDepth(),r=this,o=100,a=t.map(n,function(e){var t=r.get(e);return t.get("position")+1});a.length<i+1;)a.push(0);a.reverse();var s=t.reduce(a,function(e,t,n){return e+t*Math.pow(o,n)},0);return s},maxDepth:function(){return this.reduce(function(e,t){var n=t.getDepth();return n>e?n:e},0)},cleanOrder:function(){console.log("cleaning")},reorder:function(e){e.get("ancestry"),e.get("position"),this.findPeers(e);this.trigger("reorder:all")},getPageBullet:function(e){var t=e.cid;return this.pageBullets[t]||(this.pageBullets[t]=new o.Page(e)),this.pageBullets[t]},getRelativeIndex:function(e){var n=t.sortBy(this.findPeers(e),function(e){return e.get("position")});return t.indexOf(n,e)},findPeers:function(e){var t=e.get("ancestry");return this.where({ancestry:t})},findChildren:function(e){return this.filter(function(n){var i=n.get("ancestry");if(!i)return!1;var r=i.split("/");return t.contains(r,String(e))})},findImmediateChildren:function(e){return this.filter(function(t){return Number(t.getParentID())===Number(e)})},getParent:function(e){return this.get(e.getParentID())},findParents:function(e){var n=e.get("ancestry");if(!n)return[];var i=n.split("/");return this.filter(function(e){return t.contains(i,String(e.get("id")))}).reverse()},updateAncestry:function(e){var n=e.get("ancestry")||"",i=e.id,r=this.findChildren(i),o=""===n?"":"/";t.each(r,function(e){e.set("ancestry",n+o+i)})},initialize:function(){this.pageBullets={},this.on("enter",function(e){var t=[];e.id&&(t=this.findChildren(e.id));var n=e.get("position")+1,i=e.get("ancestry");t.length>0&&(n=0,i=i?i+"/":"",i+=e.get("id"));var r=new l({position:n,ancestry:i,name:""});this.addAndOrder(r),r.trigger("focus",r)}),this.on("tab",function(e){var t=this.priorWhere(e,{ancestry:e.get("ancestry")});if(t&&t.id){var n=this.findImmediateChildren(t.id),i=n.length,r=t.get("ancestry");r=r?r+"/":"",this.updatePosition(e.get("ancestry"),e.get("position"),!1,e),e.set({ancestry:r+t.id,position:i}),this.updatePosition(e.get("ancestry"),e.get("position"),!0,e),e.trigger("focus",e)}}),this.on("tabout",function(e){var t=e.splitAncestry();if(0!==t.length){var n=t.pop(),i=t.join("/"),r=this.get(n),o=r.get("position")+1;this.updatePosition(e.get("ancestry"),e.get("position"),!1,e),i=""===i?null:i,e.set({ancestry:i,position:o}),this.updatePosition(e.get("ancestry"),e.get("position"),!0,e),this.updateAncestry(e),e.trigger("focus",e)}}),this.on("remove",function(e){delete this.pageBullets[e.cid],this.updatePosition(e.get("ancestry"),e.get("position"),!1,e)}),this.on("change:position",function(){this.sort()}),this.on("change:ancestry",function(){this.sort()})},reorder:function(e,t){var n;n=t?this.next(t):this.first();var i,r;this.updatePosition(e.get("ancestry"),e.get("position"),!1,e),n?(i=n.get("position"),r=n.get("ancestry")):(i=t.get("position")+1,r=t.get("ancestry")),e.set({ancestry:r,position:i}),this.updatePosition(e.get("ancestry"),e.get("position"),!0,e),this.updateAncestry(e)},addAndOrder:function(e){var t=e.get("ancestry"),n=e.get("position");this.add(e),this.updatePosition(t,n,!0,e)},updatePosition:function(e,n,i,r){r=r||!1;var o=this.filter(function(t){return t.get("ancestry")===e&&t.get("position")>=n&&t!==r}),a=i?1:-1;t.each(o,function(e){var t=e.get("position");e.set("position",t+a)})},next:function(e){return this.sort(),this.at(this.indexOf(e)+1)},prior:function(e){return this.sort(),this.at(this.indexOf(e)-1)},priorWhere:function(e,n){this.sort();for(var i,r=this.where(n),o=this.indexOf(e)-1,a=!1;o>=0;o--)if(i=this.at(o),t.contains(r,i)){a=i;break}return a},nextWhere:function(e,n){this.sort();for(var i,r=this.where(n),o=this.indexOf(e)+1,a=!1;o>=0;o++)if(i=this.at(o),t.contains(r,i)){a=i;break}return a}});return{Model:l,Collection:c}}),define("app/models/pagecore",["backbone"],function(e){var t=e.Model.extend({name:"page",defaults:function(){return{name:"Page",bullets:[],page_type:"Page",content:null}},urlRoot:"/api/pages"});return t}),define("app/models/typebullet",["jquery","backbone","app/models/bullet","proxymodel","tomarkdown","app/models/image","htmlclean"],function(e,t,n,i,r,o){var a={};a.Text=n.Model.extend({defaults:{content:"",tag:"p"},cleanHtml:function(t){var n="ul"===this.get("tag")?["em","strong","b","i","li"]:["em","strong","b","i","a"];"pre"!==this.get("tag")?(t=t.replace(/\s(&nbsp;)+/g," "),t=t.replace(/(&nbsp;)+\s/g," "),t=t.replace(/&nbsp;(&nbsp;)+/g," "),this.set("content",e.htmlClean(t,{allowedTags:n,allowedAttributes:["href"],removeAttrs:["class"]}))):this.set("content",t)},toMarkdown:function(){var e=this.get("content"),t=this.get("tag"),n=this.get("html_class"),i="",o="",a=!0,s="";switch(t){case"h2":i="## ";break;case"h3":i="### ";break;case"pre":i="",e=_.map(e.split("\n"),function(e){return"    "+e}).join("\n");break;case"p":switch(n){case"concept":i='<p class="concept">',o="</p>",a=!1;break;case"example":i='<p class="example">',o="</p>",a=!1;break;default:i=""}break;case"blockquote":i="> ";break;case"li":switch(n){case"level-1":i="* ";break;case"level-2":i="    * ";break;case"level-3":i="        * "}}return s=a?r(e):e,i+s+o}}),a.Page=n.Model.extend(i.prototype).extend({deletable:!1,name:"page",defaults:{},proxyDefaults:{bulletable_type:"Page",page_id:0}}),a.ImageModel=o;var s=t.Collection.extend({model:o,comparator:"position",initialize:function(){this.on("remove",function(e){var t=e.get(this.comparator);this.forEach(function(e,n){n>=t&&e.set(this.comparator,n)})})},addAndOrder:function(e){var t=e.get(this.comparator);this.forEach(function(e,n){n>=t&&e.set(this.comparator,n+1)}),this.add(e,{at:t})}});a.Album=n.Model.extend({childType:"Image",childAttr:"images",initialize:function(){return this.imageCollection=new s,this.listenTo(this.imageCollection,"add",function(e){e.set("album_id",this.get("bulletable_id")),e.set("page_id",this.get("page_id"))}),this.listenTo(this.imageCollection,"image:blank",function(){1===this.imageCollection.length&&this.destroy()}),this.on("change:page_id",function(){var e=this.get("page_id");this.imageCollection.each(function(t){t.set("page_id",e)})}),this.on("change:bulletable_id",function(){var e=this.get("bulletable_id");this.imageCollection.each(function(t){t.set("album_id",e)})}),this.imageCollection.set(this.get("images")),this.on("childupdate",function(){this.imageCollection.set(this.get("images"))}),this.listenTo(this.imageCollection,"changepoint",function(){this.trigger("changepoint")}),n.Model.prototype.initialize.apply(this)},toJSON:function(){var e=t.Model.prototype.toJSON.apply(this);return e.bullet.images=this.imageCollection.map(function(e){return e.toJSON().image}),e},toMarkdown:function(){var e="";return this.imageCollection.each(function(t){e+="!["+t.id+"]("+t.get("s3_url")+")"}),e}});var l=t.Model.extend({defaults:{title:"",position:0}}),c=t.Collection.extend({model:l,comparator:"position",initialize:function(){this.on("remove",function(e){var t=e.get(this.comparator);this.forEach(function(e,n){n>=t&&e.set(this.comparator,n)})})},addAndOrder:function(e){var t=e.get(this.comparator);this.forEach(function(e,n){n>=t&&e.set(this.comparator,n+1)}),this.add(e,{at:t})}});return a.List=n.Model.extend({initialize:function(){this.listCollection=new c(this.get("listContent")),this.on("childupdate",function(){this.listCollection.set(this.get("listContent"))})},toJSON:function(){var e=t.Model.prototype.toJSON.apply(this);return e.listContent=this.listCollection.toJSON(),e}}),a}),define("app/show",["jquery","underscore","backbone","marionette","app/models/page","app/models/feedback","app/views/feedbackview","app/views/showpageview","selection"],function($,_,Backbone,Marionette,Page,Feedback,FeedbackView,PageView,sel){var oldToJSON=Backbone.Model.prototype.toJSON;Backbone.Model.prototype.toJSON=function(){var e={};return e[this.name]=oldToJSON.apply(this),e};var oldParse=Backbone.Model.prototype.toJSON;Backbone.Model.prototype.parse=function(e){return e?e[this.name]?e[this.name]:e:{}};var oldCollectionParse=Backbone.Collection.prototype.toJSON;Backbone.Collection.prototype.parse=function(e){return e?e[this.name]:{}};var oldDestroy=Backbone.Model.prototype.destroy;Backbone.Model.prototype.destroy=function(){this.stopListening(),oldDestroy.apply(this)};var shower=new Marionette.Application,AppView=Marionette.ItemView.extend({template:function(){return""},ui:{$post:".post",$titles:".page-titles",$nextPost:".next-post",$rightSide:".right-side"},events:{"click @ui.$nextPost":function(){}},replaceContent:function(e){var t=this.ui.$titles.add(this.ui.$post).add(this.ui.$rightSide).add(this.ui.$nextPost),n=this;t.animate({opacity:0},function(){n.immediateReplace(e)}),t.animate({opacity:1}),$("html, body").animate({scrollTop:this.ui.$titles.offset().top})},immediateReplace:function(e){this.ui.$titles.html(e.find(".page-titles").html()),this.ui.$post.html(e.find(".post").html()),this.ui.$rightSide.html(e.find(".right-side").html());var t=e.find(".next-post");t.length>0?(this.ui.$nextPost.attr("href",t.attr("href")).html(t.html()),this.ui.$nextPost.show()):this.ui.$nextPost.hide(),shower.pageView.parseChildren()},render:function(){return this.isClosed=!1,this.triggerMethod("before:render",this),this.triggerMethod("item:before:render",this),this.bindUIElements(),this.triggerMethod("render",this),this.triggerMethod("item:rendered",this),this}});shower.view=new AppView,shower.postCache={},shower.feedbackCollection=new Feedback.Collection;var domReady=!1,Router=Backbone.Router.extend({first:!0,routes:{},show:function(notebook_slug,page_slug){var nextUrl=!1,page_id,notebook_id;if(this.first?this.first=!1:shower.postCache[page_slug]?(shower.view.replaceContent(shower.postCache[page_slug]),nextUrl=shower.postCache[page_slug].find("a.next-post").attr("href"),eval(shower.postCache[page_slug].find("#server-data").html())):window.location="/"+notebook_slug+"/"+page_slug,page_id=window.pageId,notebook_id=window.notebook_id,shower.page=new Page.Model({id:page_id}),shower.notebook_id=notebook_id,mixpanel.track("On Show",{page_id:page_id}),shower.page.fetch({cache:!1}),shower.page.once("sync",function(e){shower.feedbackCollection.reset(),shower.feedbackCollection.set(e.get("feedbacks")),$(document).ready(function(){shower.feedbackContainerView.updateMore(),shower.feedbackContainerView.doCounts()})}),nextUrl||(nextUrl=$("a.next-post").attr("href")),nextUrl){var nextSlug=nextUrl.match(/([^\/]+)\/*$/)[1];shower.postCache[nextSlug]||($.get(nextUrl,function(e){shower.postCache[nextSlug]=$(e)}),delete shower.postCache[page_slug])}}});shower.router=new Router,shower.addInitializer(function(){shower.router.show(window.notebookId,window.pageId)}),window.shower=shower,window.Feedback=Feedback;var FV=FeedbackView.FeedbackView.extend({childSel:".post .bullet-inner,.post.bullet-inner,.post blockquote.bullet-inner,.post p.bullet-inner, .post .bullet-inner, .post .bullet-inner"});return shower.pageView=new PageView,shower.feedbackCollection.on("add",function(e){shower.page.id&&!e.get("page_id")&&e.set("page_id",shower.page.id)}),shower.feedbackView=new FV(shower.pageView,shower.feedbackCollection),shower.feedbackContainerView=new FeedbackView.FeedbackContainerView({pageView:shower.pageView,feedbackCollection:shower.feedbackCollection,collection:shower.pageView.collection}),shower.start(),$(document).ready(function(){var e=$(".show-page-view");shower.pageView.setElement(e[0]),shower.pageView.render(),shower.feedbackView.render(),e.append(shower.feedbackView.el),shower.view.setElement(e[0]),shower.view.render()}),window.sel=sel,shower}),define("app/views/albumview",["jquery","underscore","marionette","filepicker"],function(e,t,n,i){var r,o,a=e('<div class="add-bullet-under"><div class="add-bullet-inner"></div></div>'),s=e('<div class="drag-handle"><span class="glyphicon glyphicon-move"> </span></div>'),l=e('<div class="delete-handle"><span class="glyphicon glyphicon-remove"> </span></div>'),c=n.ItemView.extend({tagName:"div",className:"image-view",template:t.template('<img class="image-img" src="<%= image.s3_url %>" /><div class="image-view-text"><h2 class="click-text"></h2><h2 class="drop-text"></h2><div class="progress progress-striped active"><div class="progress-bar progress-bar-info" style="width:0%;"></div></div></div>'),events:{click:"fpPrompt"},initialize:function(){var e=this;r=function(t){var n="http://uploads.webcake.com/"+window.encodeURIComponent(t[0].key);e.model.set("s3_url",n),e.model.set("filepicker_url",t[0].url),e.model.save(),e.model.trigger("changepoint"),e.$el.removeClass("drop").removeClass("upload"),e.$el.removeAttr("disabled")},o=function(){""===e.model.get("s3_url")&&(e.model.trigger("image:blank"),e.model.destroy())}},onRender:function(){var e=this;return i.makeDropPane(this.el,{mimetype:"image/*",multiple:!1,location:"S3",access:"public",onSuccess:r,onStart:function(){e.$el.removeClass("drop").addClass("upload"),e.$(".progress-bar").css({width:"0%"})},dragEnter:function(){e.$el.addClass("drop")},dragLeave:function(){e.$el.removeClass("drop")},onError:function(){e.$el.removeClass("drop").removeClass("upload")},onProgress:function(t){e.$(".progress-bar").css({width:t+"%"})}}),this.$el.html()},updateImage:function(){var e=this.model.get("s3_url");this.$(".image-img").attr({src:e})},modelEvents:{"change:s3_url":"updateImage",prompt:"fpPrompt"},fpPrompt:function(){i.pickAndStore({mimetype:"image/*",multiple:!1},{location:"S3",access:"public"},r,o)}}),u=n.CompositeView.extend({tagName:"div",className:"bullet-view album-view",itemView:c,template:t.template(""),events:{"click .add-bullet-under":function(){this.model.trigger("addbullet",this)},"click .delete-handle":function(){var e=this.model.collection;this.model.destroy(),e.trigger("changepoint")}},swallow:function(e){e.stopPropagation()},initialize:function(){this.collection=this.model.imageCollection},onRender:function(){return this.$el.attr("contenteditable","false"),this.updateLayout(),this.$el.append(s.clone()),this.$el.append(l.clone()),this.$el.append(a.clone()),this.$el.html()},updateLayout:function(){this.$el.removeClass("layout-1 layout-2 layout-3 layout-4").addClass(this.model.get("layout"))},modelEvents:{"change:layout":"updateLayout"},appendHtml:function(e,t,n){0===n?e.$el.prepend(t.el):e.$el.find(".image-view").eq(n-1).after(t.el)},isEmpty:function(){return!1}});return u}),define("app/views/bulletlistview",["jquery","underscore","marionette","autosize"],function(e,t,n){var i=n.CompositeView.extend({tagName:"div",className:"bullet",template:t.template('<div class="bullet-casing"><a href="#" class="bullet-expand"><span class="glyphicon glyphicon-minus"></span></a><a class="bullet-icon" href="#"><span class="glyphicon glyphicon-record"></span></a><textarea class="bullet-content"><%= content %></textarea></div><div class="bullet-children"></div>'),events:{keydown:function(e){if(13===e.which){e.preventDefault(),e.stopPropagation(),this.$(".bullet-expand span").eq(0).hasClass("glyphicon-plus")&&this.toggleExpand();var t=this.$content.val(),n=this.$content[0].selectionStart,i=t.substr(0,n),r=t.substr(n);this.model.trigger("enter",this.model,i,r)}else if(9===e.which)e.preventDefault(),e.stopPropagation(),this.updateModel(),e.shiftKey?this.model.trigger("tabout",this.model):this.model.trigger("tab",this.model);else if(8===e.which)e.stopPropagation(),0===this.$content[0].selectionStart&&0===this.$content[0].selectionEnd&&(e.preventDefault(),this.updateModel(),this.model.trigger("backspace",this.model));else if(38===e.which){e.stopPropagation(),e.preventDefault();var o=this.model.collection.prior(this.model);o&&o.trigger("focus",-1)}else if(40===e.which){e.stopPropagation(),e.preventDefault();var a=this.model.collection.next(this.model);a&&a.trigger("focus",-1)}},"keyup .bullet-content":function(e){e.stopPropagation(),this.updateModelThrottle()},"click .bullet-expand":function(e){e.preventDefault(),e.stopPropagation(),this.toggleExpand()}},toggleExpand:function(){var e=this.$(".bullet-expand span").eq(0);e.hasClass("glyphicon-minus")?this.model.trigger("children:hide"):this.model.trigger("children:show")},collectionEvents:{add:function(){this.$(".bullet-icon").eq(0).addClass("parent"),this.$(".bullet-expand").eq(0).css("visibility","visible")},remove:function(){0===this.collection.length&&(this.$(".bullet-icon").eq(0).removeClass("parent"),this.$(".bullet-expand").eq(0).css("visibility","hidden"))}},modelEvents:{syncup:function(){this.render()},"children:hide":function(){var e=this.$(".bullet-expand span").eq(0);e.addClass("glyphicon-plus"),e.removeClass("glyphicon-minus"),this.$(".bullet-children").eq(0).slideUp()},"children:show":function(){var e=this.$(".bullet-expand span").eq(0);e.addClass("glyphicon-minus"),e.removeClass("glyphicon-plus"),this.$(".bullet-children").eq(0).slideDown()},"children:toggle":"toggleExpand"},initialize:function(){var e=this;this.collection=this.model.children,this.listenTo(this.model,"focus",function(e){e=e||0,-1===e&&(e=this.$content.val().length),this.$content.focus()[0].setSelectionRange(e,e)}),this.updateModel=function(){e.model.set("content",e.$content.val())},this.updateModelThrottle=t.throttle(function(){t.delay(this.updateModel,1)},50)},appendHtml:function(e,t,n){0===n?e.$(".bullet-children").eq(0).prepend(t.el):e.$(".bullet-children").eq(0).find(">.bullet").eq(n-1).after(t.el)},onRender:function(){this.$content=this.$(".bullet-content").eq(0);this.$content;t.delay(function(){this.$("textarea").eq(0).autosize()},0),0===this.collection.length?(this.$(".bullet-icon").eq(0).removeClass("parent"),this.$(".bullet-expand").eq(0).css("visibility","hidden")):(this.$(".bullet-icon").eq(0).addClass("parent"),this.$(".bullet-expand").eq(0).css("visibility","visible"))}});return i}),define("app/views/bulletview",["jquery","underscore","marionette"],function(e,t,n){var i=e('<div class="add-bullet-under"><div class="add-bullet-inner"></div></div>'),r=n.ItemView.extend({tagName:"div",className:"bullet-view",events:{"click .add-bullet-under":function(){this.model.trigger("addbullet",this)}},onRender:function(){this.$el.attr("contenteditable","false"),this.$el.prepend(i.clone())},isEmpty:function(){return!1}});return r}),define("app/views/childpagelinks",["jquery","marionette"],function(e,t){var n=t.ItemView.extend({tagName:"li",template:_.template('<a class="child-page-link" href="#"> <div class="narrow"><%= page.name %></div> </a>'),ui:{$link:".child-page-link"},events:{"click @ui.$link":function(e){e.preventDefault(),this.model.trigger("active",this.model)}}}),i=t.CollectionView.extend({tagName:"ul",className:"page-links",itemView:n,ancestry:null,appendHtml:function(e,t){var n=t.model.getIndex,i=t.model.get("ancestry");if(i===this.ancestry){var r=this.$el.find("li");0===n?this.$el.prepend(t.el):r.length>=n-1?this.$el.find("li").eq(n-1).after(t.el):this.$el.append(t.el)}},collectionEvents:{"change:position":"updateNesting","change:ancestry":"updateNesting"},updateNesting:function(e){var t=this.children.findByModel(e);this.appendHtml(this,t,e.get("position"))},setAncestry:function(e){var t;t=e.get("ancestry"),t=t?t+"/":"",t+=e.get("id"),this.ancestry=t,this.render()}});return i}),define("app/views/feedbackview",["jquery","underscore","backbone","marionette","app/models/feedback","selection","rangycss"],function(e,t,n,i,r,o,a){var s=(a.createCssClassApplier("fake-selection"),i.ItemView.extend({template:"#feedback-item-view",className:"feedback"})),l=i.ItemView.extend({className:"feedback-container meta node-exclude",oldHeight:0,open:!1,lastAdded:!1,ui:{$inner:".feedback-container-inner",$more:".feedback-more",$moods:".feedback-mood",$addComment:".feedback-add-comment",$commentForm:".feedback-comment-form"},events:{"click @ui.$more":"toggle","click @ui.$moods":function(t){t.preventDefault();var n=e(t.currentTarget).data("mood");this.createFeedback(n)},"click @ui.$addComment":function(){this.showForm()},"click .feedback-cancel":function(e){e.preventDefault(),this.closeForm()},"click .feedback-submit":function(e){e.preventDefault(),this.updateFeedback()},"keydown textarea":function(e){13===e.which&&(e.preventDefault(),this.updateFeedback())}},modelEvents:{"add:feedback":function(e){var t=e.get("mood"),n=e.get("context");if(this.lastAdded){var i=this.lastAdded.get("mood");this.lastAdded.set({mood:t,context:n}),this.updateCount(i,-1),this.updateCount(t,1)}else this.setLastAdded(e),this.model.trigger("feedback:create",e),e.save()}},template:"#feedback-container-template",createFeedback:function(e){if(this.lastAdded){var t=this.lastAdded.get("mood");t===e?(this.lastAdded.destroy(),this.lastAdded=!1,this.ui.$addComment.hide()):(this.lastAdded.set({mood:e}),this.lastAdded.save(),this.updateCount(t,-1),this.updateCount(e,1))}else this.setLastAdded(new r.Model({context:"["+this.model.get("start")+","+this.model.get("end")+"]",mood:e})),this.model.trigger("feedback:create",this.lastAdded),this.lastAdded.save()},toggle:function(){this.open?(this.open=!1,this.ui.$more.find("span").text(this.$(".feedback").length+" Comments"),this.ui.$inner.slideUp()):(this.open=!0,this.ui.$more.find("span").text("Hide Comments"),this.ui.$inner.slideDown())},hasMore:function(){return this.$(".feedback").length>0},updateFeedback:function(){if(this.lastAdded){var t=this.ui.$commentForm.find("textarea").val(),n=this.ui.$commentForm.find(".feedback-email").val();this.lastAdded.set({message:t,email:n}),this.lastAdded.isValid()?(mixpanel.track("Update feedback",this.lastAdded.toJSON().feedback),e(".feedback-email").val(n),this.lastAdded.save(),this.ui.$commentForm.find(".email-error").hide(),this.closeForm(),this.ui.$more.show().find("span").text(this.$(".feedback").length+" Comments")):this.lastAdded.validationError.email||this.ui.$commentForm.find(".email-error").show()}},closeForm:function(){this.ui.$commentForm.slideUp()},showForm:function(){this.ui.$commentForm.slideDown()},setCounts:function(t){this.open||this.ui.$more.find("span").text(this.$(".feedback").length+" Comments"),this.counts=t;var n,i,r=this.ui.$moods;r.each(function(){n=e(this);var r=n.data("mood");i=t[r]||0,n.find(".mood-count").text(i).removeClass("mood-zero"),0===i&&n.addClass("mood-zero")})},updateCount:function(e,t){this.open||this.ui.$more.find("span").text(this.$(".feedback").length+" Comments"),this.counts[e]+=t,t=this.counts[e];var n=this.ui.$moods.filter("[data-mood="+e+"]");n.find(".mood-count").text(t),0===t?n.addClass("mood-zero"):n.removeClass("mood-zero")},setLastAdded:function(e){this.lastAdded=e}}),c=i.CollectionView.extend({itemView:s,appendHtml:function(e,t){if(""!==t.model.get("message")){var n=t.model.offset(),i=this.pageView.withinBounds(n[0],n[1]);if(i.models[0]){var r=this.containerView.children.findByModel(i.models[0]);if(r){var o=r.ui.$inner;o.append(t.el)}}}},collectionEvents:{"change:message":function(e){var t=this.children.findByModel(e);t.render(),this.appendHtml(this,t,0)}},initialize:function(e){this.pageView=e.pageView,this.containerView=e.containerView}}),u=i.CollectionView.extend({itemView:l,className:"right-int meta",readyForFeedback:!1,collectionEvents:{"feedback:create":function(e){this.feedbackCollection.add(e),mixpanel.track("Feedback created",e.toJSON().feedback)}},appendHtml:function(){},initialize:function(e){this.pageView=e.pageView,this.feedbackCollection=e.feedbackCollection,this.listView=new c({pageView:this.pageView,collection:e.feedbackCollection,containerView:this}),this.listenTo(this.pageView,"item:elset",function(e){var t=e.model,n=this.children.findByModel(t);e.$(".feedback-outer").append(n.el),n.$el.css({"margin-top":e.$(".bullet-inner").css("margin-top")}),e.$el.find(".bullet-inner").is("h2,h3")&&n.$el.hide()}),this.listenTo(this.feedbackCollection,"add",function(e){if(this.readyForFeedback){var t=e.get("mood"),n=e.offset(),i=this.pageView.withinBounds(n[0],n[1]),r=i.models[0],o=this.children.findByModel(r);o.updateCount(t,1),this.updateMore()}}),this.listenTo(this.feedbackCollection,"remove",function(e){if(this.readyForFeedback){var t=e.get("mood"),n=e.offset(),i=this.pageView.withinBounds(n[0],n[1]),r=i.models[0];this.children.findByModel(r).updateCount(t,-1),this.updateMore()}}),this.listenTo(this.feedbackCollection,"reset",function(){this.readyForFeedback=!1})},updateMore:function(){this.children.each(function(e){e.hasMore()?e.ui.$more.show():e.ui.$more.hide()})},doCounts:function(){var e,t,n,i,r=this.feedbackCollection,o=this.pageView,a={};this.collection.each(function(e){a[e.cid]={yup:0,huh:0,meh:0}}),r.each(function(r){e=r.get("mood"),t=r.offset(),n=o.withinBounds(t[0],t[1]),i=n.models[0],a[i.cid][e]++}),this.children.each(function(e){e.setCounts(a[e.model.cid])}),this.readyForFeedback=!0},setElement:function(){i.CollectionView.prototype.setElement.apply(this,arguments),this.listView&&this.listView.setElement.apply(this.listView,arguments)}}),d=i.ItemView.extend({template:"#feedback-view-template",className:"feedback-view",childSel:".bullet-view",lock:!1,range:!1,bullet:!1,menuOpen:!1,mouseIn:!1,ui:{$pointer:".feedback-pointer",$buttons:".feedback-pointer a",$pointerButtons:".feedback-pointer a"},events:{"click @ui.$pointerButtons":function(t){t.preventDefault();var n=e(t.currentTarget).data("mood"),i=o.getCharBounds(this.range,this.pageView.$el,this.childSel),a=new r.Model({context:"["+i.left+","+i.right+"]",mood:n});this.bullet.trigger("add:feedback",a)}},constructor:function(e,t){this.pageView=e,this.feedbackCollection=t,i.ItemView.prototype.constructor.call(this)
},initialize:function(){this.$target=e(),this.listenTo(this.pageView,"selection:change",function(e){if(!e)return this.ui.$pointer.hide(),void 0;var t=e.range;if(!t)return this.ui.$pointer.hide(),void 0;if(this.range=t,this.bullet=e.start.model,t.collapsed)this.ui.$pointer.hide();else{var n=e.range.getBoundingClientRect(),i={top:n.top-30+window.scrollY,left:Math.round(n.left+n.width/2-78,0)};this.ui.$pointer.css(i),this.ui.$pointer.show()}});this.tempFeedback=new r.Model({})},createFeedback:function(){mixpanel.track("Create feedback",this.tempFeedback.toJSON().feedback),this.feedbackCollection.add(this.tempFeedback),this.tempFeedback.save(),this.tempFeedback=new r.Model}});return{FeedbackView:d,FeedbackContainerView:u}}),define("app/views/pagebulletview",["jquery","underscore","app/views/bulletview"],function(e,t,n){var i=(e('<div class="add-bullet-under"><div class="add-bullet-inner"></div></div>'),n.extend({template:t.template('<a href="<%= page.url %>"><div class="narrow no-remove"><p><%= page.name %></p></div></a>'),tagName:"div",className:"bullet-view page-bullet-view",modelEvents:{syncup:function(){this.render()},"change:html_class":function(){this.render()}}}));return i}),define("app/views/pagelistview",["jquery","underscore","marionette","autosize"],function(e,t,n){var i=n.ItemView.extend({tagName:"li",className:"page-list-node",waitingForPaste:!1,template:t.template('<div class="page-list-item"><div class="drop-top"></div><div class="drop-bottom"></div><div class="drag-handle"><span class="glyphicon glyphicon-move"> </span></div><textarea class="page-list-name"><%= page.name %></textarea></div><ul class="page-list-children"></ul>'),ui:{$name:">.page-list-item>.page-list-name",$children:".page-list-children",$item:">.page-list-item",$drag:">.page-list-item>.drag-handle"},events:{"focus @ui.$name":function(){this.model.trigger("active",this.model)},"keyup @ui.$name":function(){this.clean(this.ui.$name.val())},"paste @ui.$name":function(){this.waitingForPaste=!0},input:function(){this.waitingForPaste&&(this.waitingForPaste=!1,this.clean(this.ui.$name.val()))},"keydown @ui.$name":function(e){if(13===e.which)e.preventDefault(),e.stopPropagation(),this.model.trigger("enter",this.model);else if(9===e.which)e.preventDefault(),e.stopPropagation(),e.shiftKey?this.model.trigger("tabout",this.model):this.model.trigger("tab",this.model);else if(8===e.which||46===e.which){e.stopPropagation();var t=this.ui.$name;if(0===t[0].selectionStart&&0===t[0].selectionEnd&&this.isEmpty()){e.preventDefault();var n;n=8===e.which?this.model.collection.prior(this.model):this.model.collection.next(this.model),this.model.destroy(),n.trigger("focus",n)}}else if(38===e.which){e.stopPropagation(),e.preventDefault();var i=this.model.collection.prior(this.model);i&&i.trigger("focus",i,-1)}else if(40===e.which){e.stopPropagation(),e.preventDefault();var n=this.model.collection.next(this.model);n&&n.trigger("focus",n,-1)}else if(32===e.which){var r=this.ui.$name.val(),o=this.ui.$name[0],a=o.selectionStart,s=a-1>=0?r.substr(a-1,1):"",l=o.selectionEnd,c=r.substr(l,1),u=a===l,d=" "===s||" "===c||0===a;if(!d)return;e.preventDefault(),u||(document.execCommand("delete"),a=o.selectionStart,s=a-1>=0?r.substr(a-1,1):"",l=o.selectionEnd,c=r.substr(l,1))," "===s&&" "===c&&document.execCommand("delete")," "===c&&o.setSelectionRange(a+1,a+1)}}},clean:function(e){var t,n,i=this.ui.$name[0],r=e.replace(/\n/g," ").replace(/\s\s+/g," ").replace(/^\s*/,""),o=(i.selectionStart,i.selectionEnd,e.split("")),a=r.split(""),s=0,l=o.length;do t=o[s],n=a[s],s++;while(t===n&&l>s);r!==e&&(this.ui.$name.val(r),i.setSelectionRange(s-1,s-1)),this.model.set("name",r)},isEmpty:function(){return!!this.ui.$name.val().match(/^\s*$/)},modelEvents:{"change:name":function(){this.ui.$name.val(this.model.get("name"))},"change:page_type":"updateDisplayType"},onRender:function(){this.updateDisplayType()},updateDisplayType:function(){var e=this.model.get("page_type");"Label"===e?this.$el.addClass("page-list-label"):this.$el.removeClass("page-list-label")}}),r=n.CompositeView.extend({tagName:"div",className:"page-list-view",template:t.template('<div class="page-list-item beginning-of-pages"></div><ul class="page-list-children toc"></ul>'),itemView:i,afterDOMflag:!1,ui:{$childrenOuter:".page-list-children"},dragging:!1,initialize:function(){var t=this;e(window).on("mouseup",function(){t.cancelDrag()})},appendHtml:function(t,n){var i=t.collection.getParent(n.model),r=n.model.getIndex(),o=t.ui.$childrenOuter,a=!1;e.contains(t.el,n.el)?n.$el.detach():a=!0,i&&(o=t.children.findByModel(i).ui.$children);var s=o.find(">.page-list-node");0===r?o.prepend(n.el):s.length>=r-1?s.eq(r-1).after(n.el):o.append(n.el),a&&this.afterDOM&&n.ui.$name.autosize()},afterDOM:function(){this.afterDOMflag=!0,this.children.each(function(e){e.ui.$name.autosize()})},onAfterItemAdded:function(e){e.ui.$name.autosize()},cancelDrag:function(){this.dragging=!1,this.$el.removeClass("droppable"),this.$(".page-list-item").removeClass("drop")},events:{"mousedown .drag-handle":function(e){e.preventDefault(),this.dragging=this.children.find(function(t){return t.ui.$drag.is(e.currentTarget)}),this.$el.addClass("droppable")},"mouseup .page-list-item":function(t){if(this.dragging){var n=this.dragging;this.cancelDrag(),t.stopPropagation();var i=e(t.currentTarget),r=!1;if(r=i.hasClass("beginning-of-pages")?!1:this.children.find(function(e){return e.ui.$item.is(t.currentTarget)}).model,e.contains(n.el,t.currentTarget))return;if(n.model===r)return;if(!this.collection.prior(n.model)&&!r)return;this.collection.reorder(n.model,r)}},"mouseenter .page-list-item":function(t){if(this.dragging){var n=!1;if(n=null===this.dragging.model.get("ancestry"),n=0===this.dragging.model.get("position"),n&&e(t.currentTarget).hasClass("beginning-of-pages"))return;e.contains(this.dragging.el,t.currentTarget)||(this.$(".page-list-item").removeClass("drop"),e(t.currentTarget).addClass("drop"))}},"mouseleave .page-list-item":function(t){this.dragging&&e(t.currentTarget).removeClass("drop")}},collectionEvents:{"change:ancestry":function(e){var t=this.children.findByModel(e);this.appendHtml(this,t,e.get("position")),t.ui.$name.trigger("autosize.resize")},"change:position":function(e){this.appendHtml(this,this.children.findByModel(e),e.get("position"))},focus:function(e){this.children.findByModel(e).ui.$name.focus()}}});return r}),define("app/views/pageview",["jquery","underscore","marionette","app/views/typeview","app/models/typebullet","selection","app/edit_app","richeditorview","hotkeys"],function(e,t,n,i,r,o,a,s){var l={allowedTags:["em","strong","b","i","a"],allowedAttributes:["href"],removeAttrs:["class"]},c=(e('<button class="add-content" contenteditable="false">Add Image +</button>'),e('<div class="narrow"></div>')),u=e("<ul></ul>"),d=s.extend({className:"page-view",tagName:"div",itemView:i.Text,dragLastView:!1,dragAbove:!1,dragging:!1,dragView:!1,ui:{$body:".body",$title:".title h1"},editRegion:".body",childSel:".bullet-view",richEvents:{"all:mouseup":function(){this.onMouseUp()},"all:mousedown .body":function(){this.awaitingMouseUp=!0},"all:keypress":function(e){e.editEvt.start.view||this.ensureCursor()},"multi:keypress":function(e){if(!e.metaKey&&!e.ctrlKey){if("Text"!==e.editEvt.start.model.get("bulletable_type"))return;this.deleteBetween(e.editEvt.range,e.editEvt.bounds)}},"single:keydown:enter":function(e){e.preventDefault();var n=e.editEvt.start.model.get("tag"),i=e.editEvt.range;if("pre"===n){var r=!0;if(!e.shiftKey&&(e.editEvt.start.atBeginning&&(r=!1),e.editEvt.start.atEnd)){var a=e.editEvt.start.view.$el.text(),s=a.split("\n");""===t.last(s)&&(r=!1,document.execCommand("delete"),i=o.getRange())}if(r){var l=document.createTextNode("\n ");return i.insertNode(l),i.setEndAfter(l),i.setStartAfter(l),o.restoreRange(i),document.execCommand("delete"),void 0}}return"li"===n&&"level-1"!==e.editEvt.start.model.get("html_class")&&e.editEvt.start.empty?(this.tab(i,bounds,!0),void 0):(e.editEvt.start.atBeginning?this.addBulletAbove(i,e.editEvt.start.view):this.addBullet(i,e.editEvt.start.view),this.model.trigger("changepoint",this.lastCharBounds),void 0)},"single:keydown:spacebar":function(e){var t=e.editEvt.bounds,n=e.editEvt.range;if("pre"!==t.startView.model.get("tag")){var i=t.startView.$el.text(),r=e.editEvt.start.bounds,a=!1,s=!1;if(i.substr(r.left-1,1).match(/\s/)&&(a=!0),i.substr(r.right,1).match(/\s/)&&(s=!0),a||s){if(e.preventDefault(),s){var l=o.newRange(n.startContainer,n.startOffset+1);o.restoreRange(l)}}else;}},"single:keydown:tab":function(e){if(e.preventDefault(),"pre"===e.editEvt.start.model.get("tag")){var t=document.createTextNode("    "),n=document.createRange();return e.editEvt.range.insertNode(t),n.setEndAfter(t),n.setStartAfter(t),o.restoreRange(n),void 0}this.tab(e.editEvt.range,e.editEvt.bounds,e.shiftKey)},"single:keydown:backspace":function(n){if(n.editEvt.start.atBeginning&&n.editEvt.range.collapsed){n.preventDefault();var i=n.editEvt.bounds,r=n.editEvt.range,s=n.editEvt.start.empty,c=n.editEvt.start.leftNode,u=(n.editEvt.start.rightNode,i.startView.model.get("position")-1),d=this.children.length,h=i.startView.model.get("tag");if(u>=0||d>1){if("li"===h)return this.tab(r,i,!0),void 0;var f=this.children.find(function(e){return e.model.get("position")===u});if(f){if("Text"!==f.model.get("bulletable_type")&&f.model.deletable){f.model.destroy(),this.model.trigger("changepoint",this.lastCharBounds);var p=c||i.startView.el,g=o.newRange(p,0);return o.restoreRange(g),void 0}if(!f.model.deletable)return s&&(i.startView.model.destroy(),this.model.trigger("changepoint",this.lastCharBounds)),void 0;var m=t.last(f.$el.allNodes())||f.el;if(f.isEmpty()){f.model.destroy(),this.model.trigger("changepoint",this.lastCharBounds);var p=c||i.startView.el,g=o.newRange(p,0);o.restoreRange(g)}else{f.model.cleanHtml(f.$el.html()+i.startView.$el.html()),f.$el.find("br").remove(),f.$el.append(e.htmlClean(i.startView.$el.html(),l)),""===f.$el.html()&&f.$el.html("<br>"),i.startView.model.destroy();var v=m.data?m.data.length:0,g=o.newRange(m,v);o.restoreRange(g),a.vent.trigger("select:bullet",f),this.model.trigger("changepoint",this.lastCharBounds)}}else{if(!s)return;i.startView.model.destroy(),this.model.trigger("changepoint",this.lastCharBounds);var y=this.model.bulletCollection.findWhere({bulletable_type:"Text"});if(y){var b=this.children.findByModel(y),p=t.last(b.$el.allNodes())||b.el,g=o.newRange(p,0);o.restoreRange(g)}}}}},"single:keydown:delete":function(n){if(n.editEvt.start.atEnd&&n.editEvt.range.collapsed){n.preventDefault();var i=n.editEvt.bounds,r=(n.editEvt.range,n.editEvt.start.empty),s=(n.editEvt.start.leftNode,n.editEvt.start.rightNode),c=i.startView.model.get("position")+1;if(c<this.children.length){var u=this.children.find(function(e){return e.model.get("position")===c});if(!u)return;if("Text"!==u.model.get("bulletable_type")&&u.model.deletable){u.model.destroy();var d=s||i.startView.el,h=d.data?d.data.length:0,f=o.newRange(d,h);return o.restoreRange(f),this.model.trigger("changepoint",this.lastCharBounds),void 0}if(!u.model.deletable)return r&&(i.startView.model.destroy(),this.model.trigger("changepoint",this.lastCharBounds)),void 0;if(r){i.startView.model.destroy();var d=t.last(u.$el.allNodes())||u.el,f=o.newRange(d,0);o.restoreRange(f),a.vent.trigger("select:bullet",u),this.model.trigger("changepoint",this.lastCharBounds)}else{i.startView.model.cleanHtml(i.startView.$el.html()+u.$el.html());var d=t.last(i.startView.$el.allNodes())||i.startView.el;i.startView.$el.append(e.htmlClean(u.$el.html(),l)),u.model.destroy();var p=d.data?d.data.length:0,f=o.newRange(d,p);o.restoreRange(f),a.vent.trigger("select:bullet",i.startView),this.model.trigger("changepoint",this.lastCharBounds)}}}},"multi:keydown:enter":function(e){var t=e.editEvt.range,n=e.editEvt.bounds;e.preventDefault(),this.deleteBetween(t,n);var i=o.getRange();this.addBullet(i,e.editEvt.start.view),this.model.trigger("changepoint",this.lastCharBounds)},"multi:keydown:backspace multi:keydown:delete":function(e){var t=e.editEvt.range,n=e.editEvt.bounds;e.preventDefault(),this.deleteBetween(t,n),this.model.trigger("changepoint",this.lastCharBounds)},"multi:keydown:tab":function(e){e.preventDefault();var n=this;t.each(e.editEvt.models,function(t){n.simpleTab(t,e.shiftKey)});var i=o.charBoundsToRange(e.editEvt.charBounds,this.ui.$body);o.restoreRange(i)},"all:keyup":function(e){var n=e.editEvt.start.view;if(n){var i=n.$el.allNodes(),r=t.pluck(i,"data").join("");if("pre"!==n.model.get("tag")&&r.match(/\s\s/g)){var s=!0,l=!1,c=/\s$/,u=/^\s/,d=/\s\s+/g;t.each(i,function(e){d.test(e.data)&&(e.data=e.data.replace(d," ")),l=u.test(e.data),l&&s&&(e.data=e.data.replace(u,"")),s=c.test(e.data)});var h=o.charBoundsToRange(e.editEvt.start.bounds,n.$el);o.restoreRange(h)}}var f=this.sanitize();if(f&&this.model.trigger("changepoint",this.lastCharBounds),e.which>=37&&e.which<=40||91===e.which){var p=(e.editEvt.range,e.editEvt.bounds);if(!p.startView)return a.vent.trigger("select:bullet",!1),void 0;if("Text"!==p.startView.model.get("bulletable_type"))return;p.single?a.vent.trigger("select:bullet",p.startView):a.vent.trigger("select:bullet",!1)}},"all:paste":function(n){n.stopPropagation();var i,r=n.editEvt.range,a=(n.editEvt.bounds,e("#paste-box").html("").show().focus()),s=this,c=!0;t.delay(function(){o.restoreRange(r);var n=a.children();0===n.length||n.is("b,i,strong,em,a,span")?i=[c?e.htmlClean(a.html(),l):a.html()]:n.is(".bullet-view")||n.has(".bullet-view").length>0?(n=n.find(".bullet-view").addBack().filter(".bullet-view").filter("li,p,h2,h3,pre,blockquote"),i=t.map(n,function(t){var n=t.tagName.toLowerCase(),i=t.innerHTML,r=e(t),o="";return r.hasClass("level-1")?o="level-1":r.hasClass("level-2")?o="level-2":r.hasClass("level-3")&&(o="level-3"),r.hasClass("concept")?o="concept":r.hasClass("example")&&(o="example"),{tag:n,html:e.htmlClean(i,l),htmlClass:o}})):i=n.is("br")?t.map(a.html().split(/<br{^>}*>+/i),function(t){return c?e.htmlClean(t,l):t}):t.map(n,function(t){return c?e.htmlClean(t.innerHTML,l):t.innerHTML}),s.insertText(i),a.hide(),s.model.trigger("changepoint")},100)},"multi:cut":function(n){n.stopPropagation();var i="",r=n.editEvt.range,a=e("#paste-box").html("").show(),s=this,l=n.editEvt.bounds;if(!l||!l.startView)return n.preventDefault(),void 0;var c=n.editEvt.viewsBetween;i+=o.split(r,l.startView.$el,!0).$right[0].outerHTML,t.each(c,function(e){i+=e.el.outerHTML}),i+=o.splitEnd(r,l.endView.$el,!0).$left[0].outerHTML,a.html(i);var u=o.rangeAll(a);o.restoreRange(u),t.delay(function(){s.deleteBetween(r,l)},100)}},events:{"mouseenter .bullet-view,.end-of-bullets":function(t){if(this.dragView){var n=e(t.currentTarget);n.is(this.dragView.el)||(this.$(".bullet-view,.end-of-bullets").removeClass("drop"),n.addClass("drop"))}},"mouseleave .bullet-view,.end-of-bullets":function(t){if(this.dragView){var n=e(t.currentTarget);n.is(this.dragView.el)||n.removeClass("drop")}},"mousedown .bullet-view .drag-handle":function(t){t.preventDefault();var n=this.children.find(function(n){return e.contains(n.el,t.currentTarget)});n&&(this.dragView=n,this.$(".end-of-bullets").addClass("droppable"))},"mouseup .bullet-view":function(e){if(this.dragView){this.$(".bullet-view,.end-of-bullets").removeClass("drop droppable");var t=this.children.find(function(t){return t.$el.is(e.currentTarget)}),n=t.model,i=this.dragView.model;if(n){if(n===i)return this.dragView=!1,void 0;this.collection.reorder(i,n,!0),this.dragView=!1}}},"mouseup .end-of-bullets":function(){if(this.dragView){this.$(".bullet-view,.end-of-bullets").removeClass("drop droppable");var e=this.collection.last(),t=this.dragView.model;if(e){if(e===t)return this.dragView=!1,void 0;this.collection.reorder(t,e,!1),this.dragView=!1}}},"focusout .body":function(){a.vent.trigger("select:bullet",!1)},"keyup .title h1":function(){var e=this.$(".title h1").text(),n=e.replace(/\n/g," ").replace(/\s\s+/g," ").replace(/^\s*/,"");this.model.set("name",n),t.isEmpty(this.model.changed)||this.model.trigger("changepoint",this.lastCharBounds)},"keydown .title h1":function(e){if(t.contains([13,9],e.which)){if(e.preventDefault(),13===e.which){var n=t.first(this.$(".subhead h2").allNodes())||this.$(".subhead h2")[0],i=o.newRange(n,0);o.restoreRange(i)}}else if(32===e.which){var r=this.$(".title h1"),a=r.text(),s=o.getRange(),l=o.getCharBounds(s,r),c=!1,u=!1,d=0===s.startOffset;if(a.substr(l.left-1,1).match(/\s/)&&(c=!0),a.substr(l.right,1).match(/\s/)&&(u=!0),c||u||d){if(e.preventDefault(),u){var i=o.newRange(s.startContainer,s.startOffset+1);o.restoreRange(i)}return}}},"keyup .subhead h2":function(){var e=this.$(".subhead h2").text(),n=e.replace(/\n/g," ").replace(/\s\s+/g," ").replace(/^\s*/,"");this.model.set("subhead",n),t.isEmpty(this.model.changed)||this.model.trigger("changepoint",this.lastCharBounds)},"keydown .subhead h2":function(e){if(t.contains([13,9],e.which)){if(e.preventDefault(),13===e.which){var n=this.collection.findWhere({bulletable_type:"Text"}),i=this.children.findByModel(n);if(!i)return;var r=t.last(i.$el.allNodes())||i.el,a=o.newRange(r,0);o.restoreRange(a)}}else if(32===e.which){var s=this.$(".subhead h2"),l=s.text(),c=o.getRange(),u=o.getCharBounds(c,s),d=!1,h=!1,f=0===c.startOffset;if(l.substr(u.left-1,1).match(/\s/)&&(d=!0),l.substr(u.right,1).match(/\s/)&&(h=!0),d||h||f){if(e.preventDefault(),h){var a=o.newRange(c.startContainer,c.startOffset+1);o.restoreRange(a)}return}}}},otherInit:function(){this.otherEvents=[];var e=this;this.addOtherEvent(window,"mouseup",function(){e.dragView=!1,e.dragging=!1,e.$(".bullet-view,.end-of-bullets").removeClass("drop droppable")}),this.collection=this.model.bulletCollection,this.listenTo(a.vent,"image:add",function(e){var t=e.model.get("position")+1,n=new r.Album({bulletable_type:"Album",layout:"layout-1",position:t,images:[{url:"",position:0}]});this.model.bulletCollection.add(n),n.imageCollection.first().trigger("prompt")}),this.awaitingMouseUp=!1},simpleTab:function(e,t){var n,i=e.get("tag"),r=e.get("html_class")||"",o="li";if(t){switch(r){case"":n="";break;case"level-1":n="";break;case"level-2":n="level-1";break;case"level-3":n="level-2"}o=""===n?"p":"li",e.set("tag",o),e.set("html_class",n)}else{switch(r){case"":n="level-1";break;case"level-1":n="level-2";break;case"level-2":n="level-3";break;default:n="level-3"}"li"!==i&&e.set("tag",o),e.set("html_class",n)}},tab:function(e,t,n){var i=o.getCharBounds(e,t.startView.$el);this.simpleTab(t.startView.model,n);var r=o.charBoundsToRange(i,t.startView.$el);o.restoreRange(r),this.model.trigger("changepoint",this.lastCharBounds)},addOtherEvent:function(t,n,i){this.otherEvents.push({selector:t,evtType:n,func:i}),e(t).on(n,i)},addSimpleEvent:function(e,t,n){this.otherEvents.push({selector:e,evtType:t,func:n})},removeOtherEvents:function(){t.each(this.otherEvents,function(t){e(t.selector).off(t.evtType,t.func)})},sanitize:function(){var e=!1;return this.children.each(function(n){if("Text"===n.model.get("bulletable_type")){if("pre"!==n.model.get("tag")){var i=n.$el.allNodes();t.each(i,function(e){e.data.match(/\s\s+/g)&&(e.data=e.data.replace(/\s\s+/g," "))})}n.model.cleanHtml(n.$el.html()),e||t.has(n.model.changed,"content")&&(e=!0)}}),e},onMouseUp:function(){this.awaitingMouseUp=!1;var e=this;t.delay(function(){var t=o.getRange(),n=e.getBoundingBullets(t);return n.startView?("Text"===n.startView.model.get("bulletable_type")&&(n.single?(a.vent.trigger("select:bullet",n.startView),"Write your content here    "===n.startView.$el.text()&&(n.startView.model.set({content:""}),n.startView.model.trigger("syncup"))):a.vent.trigger("select:bullet",!1)),void 0):(a.vent.trigger("select:bullet",!1),void 0)},1)},addBulletAbove:function(e,n){if("li"===n.model.get("tag"))return this.addBullet(e,n),void 0;e.collapsed||(document.execCommand("delete"),e=o.getRange());var i=new r.Text({bulletable_type:"Text",position:n.model.get("position"),tag:"p",html_class:""});this.model.bulletCollection.add(i);var a=t.last(n.$el.allNodes())||n.el,s=o.newRange(a,0);o.restoreRange(s)},addBullet:function(e,n){var i=n.$el.clone(),s=n.$el.allNodes(),l=i.allNodes(),c=e.startOffset,u=n.model.get("tag"),d=n.isEmpty(),h=n.model.get("html_class");e.collapsed||(document.execCommand("delete"),e=o.getRange());var f=-1;t.each(s,function(t,n){t===e.startContainer&&(f=n)}),f>=0&&(s[f].data=s[f].data.substr(0,c),l[f].data=l[f].data.substr(c),t.each(s,function(e,t){t>f&&o.removeNode(e)}),n.model.cleanHtml(n.$el.html()),n.model.trigger("syncup"),t.each(l,function(e,t){f>t&&o.removeNode(e)}));var p=n.isEmpty(),g=this.collection.findWhere({position:n.model.get("position")-1}),m=!1;if(g){var v=this.children.findByModel(g);m=v.isEmpty()}var y="p",b="";"li"!==u||d||p&&m||(y="li",b=h);var w=new r.Text({bulletable_type:"Text",position:n.model.get("position")+1,tag:y,html_class:b});this.model.bulletCollection.add(w),"li"===u&&d?n.model.destroy():"li"===u&&p&&m&&(n.model.destroy(),v.model.destroy());var x=i.html();w.cleanHtml(x),w.trigger("syncup");var C=this.children.findByModel(w),k=t.first(C.$el.allNodes());k||(k=C.el),o.setCursor(k,0),a.vent.trigger("select:bullet",C)},insertText:function(e){var n=!1,i=[];e[0]&&"object"==typeof e[0]&&(n=!0,i=e,e=t.pluck(e,"html"));var a=this.constructEvent(),s=a.range,l=a.bounds;if(l.startView){s.collapsed||(l.single?document.execCommand("delete"):this.deleteBetween(s,l)),s=o.getRange();var c=o.split(s,l.startView.$el),u=l.startView.model,d=l.startView,h="pre"===u.get("tag"),f=this.model.bulletCollection,p=l.startView.model.get("position");if(h)u.cleanHtml(d.$el.html()+e.join("\n")),u.trigger("syncup");else if(n){var g=i.shift();a.start.atBeginning?(u.set("tag",g.tag),u.cleanHtml(g.html),u.set("html_class",g.htmlClass)):u.cleanHtml(d.$el.html()+g.html),u.trigger("syncup"),t.each(i,function(e){p++,u=new r.Text({position:p,bulletable_type:"Text",tag:e.tag,html_class:e.htmlClass}),u.cleanHtml(e.html),f.add(u)}),d=this.children.findByModel(u)}else u.cleanHtml(d.$el.html()+e.shift()),u.trigger("syncup"),t.each(e,function(e){""!==e&&(p++,u=new r.Text({position:p,bulletable_type:"Text"}),u.cleanHtml(e),f.add(u))}),d=this.children.findByModel(u);var m=t.last(d.$el.allNodes()),v=0;m?v=m.length:m=d.el,d.$el.append(c.$right.html()),o.setCursor(m,v)}},getBoundingBullets:function(e){if(!e)return{startView:!1,endView:!1,single:!1};var t={},n=this.children.find(function(t){return t.$el.has(e.startContainer).length>0||t.$el.is(e.startContainer)}),i=this.children.find(function(t){return t.$el.has(e.endContainer).length>0||t.$el.is(e.endContainer)});return t.startView=n,t.endView=i,t.single=n===i,t},deleteBetween:function(e,n){var i=e,r=n.startView,a=n.endView;if(3===i.startContainer.nodeType){i.startContainer.data=i.startContainer.data.substr(0,i.startOffset);var s=r.$el.allNodes(),l=!1;t.each(s,function(e){l?o.removeNode(e):e===i.startContainer&&(l=!0)})}3===i.endContainer.nodeType&&(i.endContainer.data=i.endContainer.data.substr(i.endOffset),s=a.$el.allNodes(),l=!1,t.each(s,function(e){e===i.endContainer?l=!0:l||o.removeNode(e)}));var c=r.model;c.cleanHtml(r.$el.html()+a.$el.html());var u=i.startContainer.length,d=i.startContainer;r.$el.find("br").remove(),r.$el.append(a.$el.html()),""===r.$el.text()&&r.$el.append("<br>");var h=c.get("position"),f=a.model.get("position"),p=this.children.filter(function(e){var t=e.model.get("position");return t>h&&f>=t?!0:!1});t.each(p,function(e){e.model.deletable&&e.model.destroy()});var g=o.newRange(d,u);o.restoreRange(g)},bulletsBetween:function(e){var t=e.startView.model.get("position"),n=e.endView.model.get("position");return this.children.filter(function(e){var i=e.model.get("position");return i>=t&&n>=i?!0:!1})},onRender:function(){var n=this,i=function(i){i.stopPropagation();var r=o.getRange(),a=e("#plain-paste-box").val("").show().focus();t.delay(function(){o.restoreRange(r);var e=a.val().replace(/\n/g,"");document.execCommand("insertText",!1,e),a.hide(),n.model.trigger("changepoint")},100)};this.addSimpleEvent(this.$(".title h1, .subhead h2"),"keydown",i),this.$(".title h1, .subhead h2").on("keydown",null,"ctrl+v meta+v",i);var r=function(){var e=o.getRange(),t=n.getBoundingBullets(e);t.startView&&t.single&&(document.execCommand("bold"),a.vent.trigger("format:update"),t.startView.model.cleanHtml(t.startView.$el.html()),n.model.trigger("changepoint"))};this.addSimpleEvent(this.ui.$body,"keydown",r),this.ui.$body.on("keydown",null,"ctrl+b meta+b",r);var s=function(){var e=o.getRange(),t=n.getBoundingBullets(e);t.startView&&t.single&&(document.execCommand("italic"),a.vent.trigger("format:update"),t.startView.model.cleanHtml(t.startView.$el.html()),n.model.trigger("changepoint"))};this.addSimpleEvent(this.ui.$body,"keydown",s),this.ui.$body.on("keydown",null,"ctrl+i meta+i",s),this.addOtherEvent(document,"mouseup",function(e){n.awaitingMouseUp&&n.onMouseUp(e)});var l=function(e){e.preventDefault(),n.model.trigger("undo")},c=function(e){e.preventDefault(),n.model.trigger("redo")};this.addSimpleEvent(document,"keydown",l),this.addSimpleEvent(document,"keydown",c),e(document).on("keydown",null,"ctrl+z meta+z",l).on("keydown",null,"ctrl+y meta+y meta+shift+z",c),this.ui.$body.append('<div class="end-of-bullets" contenteditable="false"></div>')},renderModel:function(){return this.$(".title h1").text(this.model.get("name")),this.$(".subhead h2").text(this.model.get("subhead")||""),this.$el.html()},modelEvents:{syncup:function(){this.$(".title h1").text(this.model.get("name")),this.$(".subhead h2").text(this.model.get("subhead")||"")},"change:name":function(){var e=this.$(".title h1").text(),t=this.model.get("name");e!==t&&this.$(".title h1").text(t)}},collectionEvents:{"change:tag":"wrapUl",addbullet:function(e){var n=e.model,i=n.get("position")+1,a=this.collection.findWhere({position:i});if(a&&"Text"===a.get("bulletable_type")){var s=this.children.findByModel(a);if(s){var l=t.last(s.$el.allNodes())||s.el,c=l.data?l.data.length:0,u=o.newRange(l,c);o.restoreRange(u)}}else{var d=new r.Text({bulletable_type:"Text",position:n.get("position")+1,tag:"p",html_class:"",content:""});this.collection.add(d);var h=this.children.findByModel(d);if(h){var u=o.newRange(h.el,0);o.restoreRange(u)}this.model.trigger("changepoint",this.lastCharBounds)}},reorder:function(e,t){var n=this.children.findByModel(e);this.appendHtml(this,n,t),this.ensureTrail(),this.wrapNarrow(),this.wrapUl()}},onAfterItemAdded:function(){this.ensureTrail(),this.wrapNarrow(),this.wrapUl()},onItemRemoved:function(){this.ensureTrail(),this.wrapNarrow(),this.wrapUl(),this.ensureCursor()},ensureCursor:function(){var e=o.getRange(),t=this.getBoundingBullets(e);if(!t.startView){var n=this.collection.findWhere({bulletable_type:"Text"});if(!n)return o.clear(),void 0;var i=this.children.findByModel(n),r=o.newRange(i.el,0);o.restoreRange(r)}},wrapNarrow:function(){this.$(".body .narrow>*").not(".no-remove *").unwrap();var t,n=e(),i=this;this.collection.each(function(r){t=i.children.findByModel(r),t&&("Text"===t.model.get("bulletable_type")?n=n.add(t.$el):(n.wrapAll(c.clone()),n=e()))}),n.wrapAll(c.clone())},wrapUl:function(){this.$(".body ul>*").not(".no-remove *").unwrap(),this.$(".body>ul").remove();var t,n=e(),i=this;this.collection.each(function(r){t=i.children.findByModel(r),t&&("li"===r.get("tag")?n=n.add(t.$el):(n.wrapAll(u.clone()),n=e()))}),n.wrapAll(u.clone())},ensureTrail:function(){0!==this.collection.length||this.collection.updating||(newBullet=new r.Text({bulletable_type:"Text",position:0,tag:"p"}),this.collection.add(newBullet))},appendHtml:function(t,n,i){e.contains(t.el,n.el)&&n.$el.detach(),$children=t.$el.find(".body .bullet-view"),0===i?t.ui.$body.prepend(n.el):$children.length>=i-1?$children.eq(i-1).after(n.el):t.ui.$body.append(n.el)},buildItemView:function(e){return new(i[e.get("bulletable_type")])({model:e})},softClose:function(){this.undelegateEvents(),this.stopListening(),this.children.call("remove"),this.removeOtherEvents()}});return d}),define("app/views/showpageview",["jquery","underscore","marionette","richeditorview"],function(e,t,n,i){var r=n.ItemView.extend({template:"#bullet-template",className:"bullet row"}),o=i.extend({itemView:r,editRegion:".post",childSel:"ul,p,blockquote,pre,h2,h3",calculateChildren:!0,ui:{$content:".content"},events:{},renderModel:function(){return this.$el.html()}});return o}),define("app/views/textmenu",["jquery","underscore","backbone","app/edit_app","selection"],function(e,t,n,i,r){var o=n.View.extend({events:{"click .menu-btn":function(t){this.bulletView&&!e(t.currentTarget).attr("disabled")&&this.clickButton(t),t.preventDefault(),t.stopPropagation()},"mousedown button":function(e){e.stopPropagation(),e.preventDefault()},"mouseup button":function(e){e.stopPropagation(),e.preventDefault()}},buttons:[{sel:"#text-bold",action:function(e){document.execCommand("bold"),e.model.cleanHtml(e.$el.html())},activeCheck:function(){return document.queryCommandState("bold")},enableCheck:function(e,t){return!t.collapsed&&!e.$el.is("h2")}},{sel:"#text-italic",action:function(e){document.execCommand("italic"),e.model.cleanHtml(e.$el.html())},activeCheck:function(){return document.queryCommandState("italic")},enableCheck:function(e,t){return!t.collapsed&&!e.$el.is("blockquote")}},{sel:"#text-heading",action:function(e){var t=e.model.get("tag");"h2"===t?(e.model.set("tag","h3"),e.model.cleanHtml(e.model.get("content"))):"h3"===t?(e.model.set("tag","p"),e.model.cleanHtml(e.model.get("content"))):(e.model.set("tag","h2"),e.model.cleanHtml(e.model.get("content")))},activeCheck:function(e){return"h2"===e.model.get("tag")||"h3"===e.model.get("tag")},enableCheck:function(){return!0},restoreRange:!0},{sel:"#text-list",action:function(e){var t=e.model.get("tag");"li"===t?(e.model.set("tag","p"),e.model.set("html_class",""),e.model.cleanHtml(e.model.get("content"))):(e.model.set("tag","li"),e.model.set("html_class","level-1"),e.model.cleanHtml(e.model.get("content")))},activeCheck:function(e){return"li"===e.model.get("tag")},enableCheck:function(){return!0},restoreRange:!0},{sel:"#text-quote",action:function(e){var t=e.model.get("tag");"blockquote"===t?(e.model.set("tag","p"),e.model.cleanHtml(e.model.get("content"))):(e.model.set("tag","blockquote"),e.model.cleanHtml(e.model.get("content")))},activeCheck:function(e){return"blockquote"===e.model.get("tag")},enableCheck:function(){return!0},restoreRange:!0},{sel:"#text-concept",action:function(e){var t=e.model.get("tag"),n=e.model.get("html_class");"p"===t&&"concept"===n?(e.model.set("html_class",""),e.model.cleanHtml(e.model.get("content"))):(e.model.set("tag","p"),e.model.set("html_class","concept"),e.model.cleanHtml(e.model.get("content")))},activeCheck:function(e){return"p"===e.model.get("tag")&&"concept"===e.model.get("html_class")},enableCheck:function(){return!0},restoreRange:!0},{sel:"#text-example",action:function(e){var t=e.model.get("tag"),n=e.model.get("html_class");"p"===t&&"example"===n?(e.model.set("html_class",""),e.model.cleanHtml(e.model.get("content"))):(e.model.set("tag","p"),e.model.set("html_class","example"),e.model.cleanHtml(e.model.get("content")))},activeCheck:function(e){return"p"===e.model.get("tag")&&"example"===e.model.get("html_class")},enableCheck:function(){return!0},restoreRange:!0},{sel:"#text-code",action:function(e){var t=e.model.get("tag");"pre"===t?(e.model.set("tag","p"),e.model.cleanHtml(e.model.get("content"))):(e.model.set("tag","pre"),e.model.cleanHtml(e.model.get("content")))},activeCheck:function(e){return"pre"===e.model.get("tag")},enableCheck:function(){return!0},restoreRange:!0},{sel:"#text-link",action:function(t,n){var i=r.getRange(),o=r.getCharBounds(i,t.$el);e(".text-menu").css("overflow","visible"),e("#text-link-box").slideDown(),e("#text-link-input").val(e(i.commonAncestorContainer).parents().addBack().filter("a").attr("href")||"");var a=function(){var o=e("#text-link-input").val();e("#text-link-box").slideUp(function(){e(".text-menu").css("overflow","")}),e("#text-link-confirm").off("click"),e("#text-link-input").off("keyup"),e("#text-link-cancel").off("click"),r.restoreRange(i),document.execCommand("createLink",!1,o),n.checkButtons(),t.model.cleanHtml(t.$el.html())};e("#text-link-confirm").on("click",a),e("#text-link-input").on("keyup",function(e){13===e.which&&a(e)}),e("#text-link-cancel").on("click",function(i){i.stopPropagation(),i.preventDefault(),document.execCommand("unlink"),e("#text-link-box").slideUp(function(){e(".text-menu").css("overflow","")}),e("#text-link-confirm").off("click"),e("#text-link-input").off("keyup"),e("#text-link-cancel").off("click");var a=r.charBoundsToRange(o,t.$el);r.restoreRange(a),n.checkButtons(),t.model.cleanHtml(t.$el.html())})},activeCheck:function(t,n){return e(n.commonAncestorContainer).parents().addBack().filter("a").length>0
},enableCheck:function(e,t){return!t.collapsed}},{sel:"#text-link-remove",action:function(){document.execCommand("unlink")},activeCheck:function(){return!1},enableCheck:function(t,n){return e(n.commonAncestorContainer).parents().addBack().filter("a").length>0&&!n.collapsed}},{sel:"#add-image",action:function(e){i.vent.trigger("image:add",e)},activeCheck:function(){return!1},enableCheck:function(){return!0}}],initialize:function(){this.bulletView=!1,this.listenTo(i.vent,"select:bullet",function(e){e?(this.bulletView=e,this.checkButtons()):this.disable()}),this.listenTo(i.vent,"format:update",function(){this.checkButtons()})},onRender:function(){var e=this.$el;t.each(this.buttons,function(t){t.$el=e.find(t.sel)})},render:function(){return this.onRender(),this},checkButtons:function(){var e=this.bulletView,n=r.getRange();t.each(this.buttons,function(t){t.enableCheck(e,n)?t.$el.removeAttr("disabled"):t.$el.attr("disabled","disabled"),t.activeCheck(e,n)?t.$el.addClass("active"):t.$el.removeClass("active")})},clickButton:function(e){var n,i,o,a,s=t.find(this.buttons,function(t){return t.$el.is(e.currentTarget)});n=r.getRange(),n&&(o=r.getCharBounds(n,this.bulletView.$el),a=r.getCharBounds(n,this.bulletView.$el.parents(".page-view"),".bullet-view")),s.action(this.bulletView,this),s.restoreRange&&(i=r.charBoundsToRange(o,this.bulletView.$el),r.restoreRange(i)),this.checkButtons(),this.bulletView.model.trigger("changepoint",a)},disable:function(){t.each(this.buttons,function(e){e.$el.removeClass("active").attr("disabled","disabled")})}});return o}),define("app/views/textview",["jquery","underscore","marionette","tomarkdown"],function(e,t,n,i){var r=n.ItemView.extend({template:t.template('<%= bullet.content || "<br>" %>'),tagName:"p",className:"bullet-view text-view",initialize:function(){this.updateTag()},updateTag:function(){var t=this.model.get("tag"),n=this.model.get("html_class")||"",i="",r="";"pre"===t&&(i="<code>",r="</code>");var o=e("<"+t+">"+i+this.template(this.model.toJSON())+r+"</"+t+">").addClass(this.className).addClass(n).replaceAll(this.$el);this.setElement(o)},modelEvents:{"change:tag":function(){this.updateTag()},syncup:function(){this.render()},"change:html_class":function(){this.updateTag()}},isEmpty:function(){return!!this.$el.text().match(/^\s*$/)},toMarkdown:function(){var e=this.model.get("tag");if("li"===e){var t=this.model.get("html_class"),n="";switch(t){case"level-1":n="";break;case"level-2":n="    ";break;case"level-3":n="        "}return n+i("<ul>"+this.el.outerHTML+"</ul>")}return i(this.el.outerHTML)}});return r}),define("app/views/typeview",["app/views/textview","app/views/albumview","app/views/pagebulletview"],function(e,t,n){return{Text:e,Album:t,Page:n}});var Markdown;Markdown="object"==typeof exports&&"function"==typeof require?exports:{},define("pagedown",[],function(){return Markdown}),function(){function e(e){return e}function t(){return!1}function n(){}function i(){}n.prototype={chain:function(t,n){var i=this[t];if(!i)throw new Error("unknown hook "+t);this[t]=i===e?n:function(){var e=Array.prototype.slice.call(arguments,0);return e[0]=i.apply(null,e),n.apply(null,e)}},set:function(e,t){if(!this[e])throw new Error("unknown hook "+e);this[e]=t},addNoop:function(t){this[t]=e},addFalse:function(e){this[e]=t}},Markdown.HookCollection=n,i.prototype={set:function(e,t){this["s_"+e]=t},get:function(e){return this["s_"+e]}},Markdown.Converter=function(){function e(e){return e=e.replace(/^[ ]{0,3}\[(.+)\]:[ \t]*\n?[ \t]*<?(\S+?)>?(?=\s|$)[ \t]*\n?[ \t]*((\n*)["(](.+?)[")][ \t]*)?(?:\n+)/gm,function(e,t,n,i,r,o){return t=t.toLowerCase(),M.set(t,k(n)),r?i:(o&&B.set(t,o.replace(/"/g,"&quot;")),"")})}function t(e){return e=e.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|ins|del)\b[^\r]*?\n<\/\2>[ \t]*(?=\n+))/gm,r),e=e.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math)\b[^\r]*?.*<\/\2>[ \t]*(?=\n+)\n)/gm,r),e=e.replace(/\n[ ]{0,3}((<(hr)\b([^<>])*?\/?>)[ \t]*(?=\n{2,}))/g,r),e=e.replace(/\n\n[ ]{0,3}(<!(--(?:|(?:[^>-]|-[^>])(?:[^-]|-[^-])*)--)>[ \t]*(?=\n{2,}))/g,r),e=e.replace(/(?:\n\n)([ ]{0,3}(?:<([?%])[^\r]*?\2>)[ \t]*(?=\n{2,}))/g,r)}function r(e,t){var n=t;return n=n.replace(/^\n+/,""),n=n.replace(/\n+$/g,""),n="\n\n~K"+(j.push(n)-1)+"K\n\n"}function o(e,n){e=D.preBlockGamut(e,H),e=f(e);var i="<hr />\n";return e=e.replace(/^[ ]{0,2}([ ]?\*[ ]?){3,}[ \t]*$/gm,i),e=e.replace(/^[ ]{0,2}([ ]?-[ ]?){3,}[ \t]*$/gm,i),e=e.replace(/^[ ]{0,2}([ ]?_[ ]?){3,}[ \t]*$/gm,i),e=p(e),e=m(e),e=x(e),e=D.postBlockGamut(e,H),e=t(e),e=C(e,n)}function a(e){return e=D.preSpanGamut(e),e=y(e),e=s(e),e=_(e),e=u(e),e=l(e),e=T(e),e=e.replace(/~P/g,"://"),e=k(e),e=w(e),e=e.replace(/  +\n/g," <br>\n"),e=D.postSpanGamut(e)}function s(e){var t=/(<[a-z\/!$]("[^"]*"|'[^']*'|[^'">])*>|<!(--(?:|(?:[^>-]|-[^>])(?:[^-]|-[^-])*)--)>)/gi;return e=e.replace(t,function(e){var t=e.replace(/(.)<\/?code>(?=.)/g,"$1`");return t=A(t,"!"==e.charAt(1)?"\\`*_/":"\\`*_")})}function l(e){return e=e.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,c),e=e.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\]\([ \t]*()<?((?:\([^)]*\)|[^()\s])*?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,c),e=e.replace(/(\[([^\[\]]+)\])()()()()()/g,c)}function c(e,t,n,i,r,o,a,s){void 0==s&&(s="");var l=t,c=n.replace(/:\/\//g,"~P"),u=i.toLowerCase(),h=r,f=s;if(""==h)if(""==u&&(u=c.toLowerCase().replace(/ ?\n/g," ")),h="#"+u,void 0!=M.get(u))h=M.get(u),void 0!=B.get(u)&&(f=B.get(u));else{if(!(l.search(/\(\s*\)$/m)>-1))return l;h=""}h=$(h),h=A(h,"*_");var p='<a href="'+h+'"';return""!=f&&(f=d(f),f=A(f,"*_"),p+=' title="'+f+'"'),p+=">"+c+"</a>"}function u(e){return e=e.replace(/(!\[(.*?)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,h),e=e.replace(/(!\[(.*?)\]\s?\([ \t]*()<?(\S+?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,h)}function d(e){return e.replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;")}function h(e,t,n,i,r,o,a,s){var l=t,c=n,u=i.toLowerCase(),h=r,f=s;if(f||(f=""),""==h){if(""==u&&(u=c.toLowerCase().replace(/ ?\n/g," ")),h="#"+u,void 0==M.get(u))return l;h=M.get(u),void 0!=B.get(u)&&(f=B.get(u))}c=A(d(c),"*_[]()"),h=A(h,"*_");var p='<img src="'+h+'" alt="'+c+'"';return f=d(f),f=A(f,"*_"),p+=' title="'+f+'"',p+=" />"}function f(e){return e=e.replace(/^(.+)[ \t]*\n=+[ \t]*\n+/gm,function(e,t){return"<h1>"+a(t)+"</h1>\n\n"}),e=e.replace(/^(.+)[ \t]*\n-+[ \t]*\n+/gm,function(e,t){return"<h2>"+a(t)+"</h2>\n\n"}),e=e.replace(/^(\#{1,6})[ \t]*(.+?)[ \t]*\#*\n+/gm,function(e,t,n){var i=t.length;return"<h"+i+">"+a(n)+"</h"+i+">\n\n"})}function p(e,t){e+="~0";var n=/^(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm;return P?e=e.replace(n,function(e,n,i){var r=n,o=i.search(/[*+-]/g)>-1?"ul":"ol",a=g(r,o,t);return a=a.replace(/\s+$/,""),a="<"+o+">"+a+"</"+o+">\n"}):(n=/(\n\n|^\n?)(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/g,e=e.replace(n,function(e,t,n,i){var r=t,o=n,a=i.search(/[*+-]/g)>-1?"ul":"ol",s=g(o,a);return s=r+"<"+a+">\n"+s+"</"+a+">\n"})),e=e.replace(/~0/,"")}function g(e,t,n){P++,e=e.replace(/\n{2,}$/,"\n"),e+="~0";var i=I[t],r=new RegExp("(^[ \\t]*)("+i+")[ \\t]+([^\\r]+?(\\n+))(?=(~0|\\1("+i+")[ \\t]+))","gm"),s=!1;return e=e.replace(r,function(e,t,i,r){var l=r,c=/\n\n$/.test(l),u=c||l.search(/\n{2,}/)>-1;return u||s?l=o(S(l),!0):(l=p(S(l),!0),l=l.replace(/\n$/,""),n||(l=a(l))),s=c,"<li>"+l+"</li>\n"}),e=e.replace(/~0/g,""),P--,e}function m(e){return e+="~0",e=e.replace(/(?:\n\n|^\n?)((?:(?:[ ]{4}|\t).*\n+)+)(\n*[ ]{0,3}[^ \t\n]|(?=~0))/g,function(e,t,n){var i=t,r=n;return i=b(S(i)),i=R(i),i=i.replace(/^\n+/g,""),i=i.replace(/\n+$/g,""),i="<pre><code>"+i+"\n</code></pre>","\n\n"+i+"\n\n"+r}),e=e.replace(/~0/,"")}function v(e){return e=e.replace(/(^\n+|\n+$)/g,""),"\n\n~K"+(j.push(e)-1)+"K\n\n"}function y(e){return e=e.replace(/(^|[^\\])(`+)([^\r]*?[^`])\2(?!`)/gm,function(e,t,n,i){var r=i;return r=r.replace(/^([ \t]*)/g,""),r=r.replace(/[ \t]*$/g,""),r=b(r),r=r.replace(/:\/\//g,"~P"),t+"<code>"+r+"</code>"})}function b(e){return e=e.replace(/&/g,"&amp;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=A(e,"*_{}[]\\",!1)}function w(e){return e=e.replace(/([\W_]|^)(\*\*|__)(?=\S)([^\r]*?\S[\*_]*)\2([\W_]|$)/g,"$1<strong>$3</strong>$4"),e=e.replace(/([\W_]|^)(\*|_)(?=\S)([^\r\*_]*?\S)\2([\W_]|$)/g,"$1<em>$3</em>$4")}function x(e){return e=e.replace(/((^[ \t]*>[ \t]?.+\n(.+\n)*\n*)+)/gm,function(e,t){var n=t;return n=n.replace(/^[ \t]*>[ \t]?/gm,"~0"),n=n.replace(/~0/g,""),n=n.replace(/^[ \t]+$/gm,""),n=o(n),n=n.replace(/(^|\n)/g,"$1  "),n=n.replace(/(\s*<pre>[^\r]+?<\/pre>)/gm,function(e,t){var n=t;return n=n.replace(/^  /gm,"~0"),n=n.replace(/~0/g,"")}),v("<blockquote>\n"+n+"\n</blockquote>")})}function C(e,t){e=e.replace(/^\n+/g,""),e=e.replace(/\n+$/g,"");for(var n=e.split(/\n{2,}/g),i=[],r=/~K(\d+)K/,o=n.length,s=0;o>s;s++){var l=n[s];r.test(l)?i.push(l):/\S/.test(l)&&(l=a(l),l=l.replace(/^([ \t]*)/g,"<p>"),l+="</p>",i.push(l))}if(!t){o=i.length;for(var s=0;o>s;s++)for(var c=!0;c;)c=!1,i[s]=i[s].replace(/~K(\d+)K/g,function(e,t){return c=!0,j[t]})}return i.join("\n\n")}function k(e){return e=e.replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\w+);)/g,"&amp;"),e=e.replace(/<(?![a-z\/?!]|~D)/gi,"&lt;")}function _(e){return e=e.replace(/\\(\\)/g,O),e=e.replace(/\\([`*_{}\[\]()>#+-.!])/g,O)}function E(e,t,n,i){if(t)return e;if(")"!==i.charAt(i.length-1))return"<"+n+i+">";for(var r=i.match(/[()]/g),o=0,a=0;a<r.length;a++)"("===r[a]?0>=o?o=1:o++:o--;var s="";if(0>o){var l=new RegExp("\\){1,"+-o+"}$");i=i.replace(l,function(e){return s=e,""})}if(s){var c=i.charAt(i.length-1);F.test(c)||(s=c+s,i=i.substr(0,i.length-1))}return"<"+n+i+">"+s}function T(e){e=e.replace(L,E);var t=function(e,t){return'<a href="'+t+'">'+D.plainLinkText(t)+"</a>"};return e=e.replace(/<((https?|ftp):[^'">\s]+)>/gi,t)}function N(e){return e=e.replace(/~E(\d+)E/g,function(e,t){var n=parseInt(t);return String.fromCharCode(n)})}function S(e){return e=e.replace(/^(\t|[ ]{1,4})/gm,"~0"),e=e.replace(/~0/g,"")}function R(e){if(!/\t/.test(e))return e;var t,n=["    ","   ","  "," "],i=0;return e.replace(/[\n\t]/g,function(e,r){return"\n"===e?(i=r+1,e):(t=(r-i)%4,i=r+1,n[t])})}function $(e){if(!e)return"";var t=e.length;return e.replace(z,function(n,i){return"~D"==n?"%24":":"!=n||i!=t-1&&!/[0-9\/]/.test(e.charAt(i+1))?"%"+n.charCodeAt(0).toString(16):":"})}function A(e,t,n){var i="(["+t.replace(/([\[\]\\])/g,"\\$1")+"])";n&&(i="\\\\"+i);var r=new RegExp(i,"g");return e=e.replace(r,O)}function O(e,t){var n=t.charCodeAt(0);return"~E"+n+"E"}var D=this.hooks=new n;D.addNoop("plainLinkText"),D.addNoop("preConversion"),D.addNoop("postNormalization"),D.addNoop("preBlockGamut"),D.addNoop("postBlockGamut"),D.addNoop("preSpanGamut"),D.addNoop("postSpanGamut"),D.addNoop("postConversion");var M,B,j,P;this.makeHtml=function(n){if(M)throw new Error("Recursive call to converter.makeHtml");return M=new i,B=new i,j=[],P=0,n=D.preConversion(n),n=n.replace(/~/g,"~T"),n=n.replace(/\$/g,"~D"),n=n.replace(/\r\n/g,"\n"),n=n.replace(/\r/g,"\n"),n="\n\n"+n+"\n\n",n=R(n),n=n.replace(/^[ \t]+$/gm,""),n=D.postNormalization(n),n=t(n),n=e(n),n=o(n),n=N(n),n=n.replace(/~D/g,"$$"),n=n.replace(/~T/g,"~"),n=D.postConversion(n),j=B=M=null,n};var H=function(e){return o(e)},I={ol:"\\d+[.]",ul:"[*+-]"},q="[-A-Z0-9+&@#/%?=~_|[\\]()!:,.;]",V="[-A-Z0-9+&@#/%=~_|[\\])]",L=new RegExp('(="|<)?\\b(https?|ftp)(://'+q+"*"+V+")(?=$|\\W)","gi"),F=new RegExp(V,"i"),z=/(?:["'*()[\]:]|~D)/g}}(),function(e,t){"undefined"!=typeof exports?t(e,exports,require("underscore")):"function"==typeof define&&define.amd?define("backbone",["underscore","jquery","exports"],function(n,i,r){e.Backbone=t(e,r,n,i)}):e.Backbone=t(e,{},e._,e.jQuery||e.Zepto||e.ender||e.$)}(this,function(e,t,n,i){{var r=e.Backbone,o=[],a=(o.push,o.slice);o.splice}t.VERSION="1.1.0",t.$=i,t.noConflict=function(){return e.Backbone=r,this},t.emulateHTTP=!1,t.emulateJSON=!1;var s=t.Events={on:function(e,t,n){if(!c(this,"on",e,[t,n])||!t)return this;this._events||(this._events={});var i=this._events[e]||(this._events[e]=[]);return i.push({callback:t,context:n,ctx:n||this}),this},once:function(e,t,i){if(!c(this,"once",e,[t,i])||!t)return this;var r=this,o=n.once(function(){r.off(e,o),t.apply(this,arguments)});return o._callback=t,this.on(e,o,i)},off:function(e,t,i){var r,o,a,s,l,u,d,h;if(!this._events||!c(this,"off",e,[t,i]))return this;if(!e&&!t&&!i)return this._events={},this;for(s=e?[e]:n.keys(this._events),l=0,u=s.length;u>l;l++)if(e=s[l],a=this._events[e]){if(this._events[e]=r=[],t||i)for(d=0,h=a.length;h>d;d++)o=a[d],(t&&t!==o.callback&&t!==o.callback._callback||i&&i!==o.context)&&r.push(o);r.length||delete this._events[e]}return this},trigger:function(e){if(!this._events)return this;var t=a.call(arguments,1);if(!c(this,"trigger",e,t))return this;var n=this._events[e],i=this._events.all;return n&&u(n,t),i&&u(i,arguments),this},stopListening:function(e,t,i){var r=this._listeningTo;if(!r)return this;var o=!t&&!i;i||"object"!=typeof t||(i=this),e&&((r={})[e._listenId]=e);for(var a in r)e=r[a],e.off(t,i,this),(o||n.isEmpty(e._events))&&delete this._listeningTo[a];return this}},l=/\s+/,c=function(e,t,n,i){if(!n)return!0;if("object"==typeof n){for(var r in n)e[t].apply(e,[r,n[r]].concat(i));return!1}if(l.test(n)){for(var o=n.split(l),a=0,s=o.length;s>a;a++)e[t].apply(e,[o[a]].concat(i));return!1}return!0},u=function(e,t){var n,i=-1,r=e.length,o=t[0],a=t[1],s=t[2];switch(t.length){case 0:for(;++i<r;)(n=e[i]).callback.call(n.ctx);return;case 1:for(;++i<r;)(n=e[i]).callback.call(n.ctx,o);return;case 2:for(;++i<r;)(n=e[i]).callback.call(n.ctx,o,a);return;case 3:for(;++i<r;)(n=e[i]).callback.call(n.ctx,o,a,s);return;default:for(;++i<r;)(n=e[i]).callback.apply(n.ctx,t)}},d={listenTo:"on",listenToOnce:"once"};n.each(d,function(e,t){s[t]=function(t,i,r){var o=this._listeningTo||(this._listeningTo={}),a=t._listenId||(t._listenId=n.uniqueId("l"));return o[a]=t,r||"object"!=typeof i||(r=this),t[e](i,r,this),this}}),s.bind=s.on,s.unbind=s.off,n.extend(t,s);var h=t.Model=function(e,t){var i=e||{};t||(t={}),this.cid=n.uniqueId("c"),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(i=this.parse(i,t)||{}),i=n.defaults({},i,n.result(this,"defaults")),this.set(i,t),this.changed={},this.initialize.apply(this,arguments)};n.extend(h.prototype,s,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return n.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return n.escape(this.get(e))},has:function(e){return null!=this.get(e)},set:function(e,t,i){var r,o,a,s,l,c,u,d;if(null==e)return this;if("object"==typeof e?(o=e,i=t):(o={})[e]=t,i||(i={}),!this._validate(o,i))return!1;a=i.unset,l=i.silent,s=[],c=this._changing,this._changing=!0,c||(this._previousAttributes=n.clone(this.attributes),this.changed={}),d=this.attributes,u=this._previousAttributes,this.idAttribute in o&&(this.id=o[this.idAttribute]);for(r in o)t=o[r],n.isEqual(d[r],t)||s.push(r),n.isEqual(u[r],t)?delete this.changed[r]:this.changed[r]=t,a?delete d[r]:d[r]=t;if(!l){s.length&&(this._pending=!0);for(var h=0,f=s.length;f>h;h++)this.trigger("change:"+s[h],this,d[s[h]],i)}if(c)return this;if(!l)for(;this._pending;)this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,n.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var i in this.attributes)t[i]=void 0;return this.set(t,n.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!n.isEmpty(this.changed):n.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?n.clone(this.changed):!1;var t,i=!1,r=this._changing?this._previousAttributes:this.attributes;for(var o in e)n.isEqual(r[o],t=e[o])||((i||(i={}))[o]=t);return i},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return n.clone(this._previousAttributes)},fetch:function(e){e=e?n.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=this,i=e.success;return e.success=function(n){return t.set(t.parse(n,e),e)?(i&&i(t,n,e),t.trigger("sync",t,n,e),void 0):!1},P(this,e),this.sync("read",this,e)},save:function(e,t,i){var r,o,a,s=this.attributes;if(null==e||"object"==typeof e?(r=e,i=t):(r={})[e]=t,i=n.extend({validate:!0},i),r&&!i.wait){if(!this.set(r,i))return!1}else if(!this._validate(r,i))return!1;r&&i.wait&&(this.attributes=n.extend({},s,r)),void 0===i.parse&&(i.parse=!0);var l=this,c=i.success;return i.success=function(e){l.attributes=s;var t=l.parse(e,i);return i.wait&&(t=n.extend(r||{},t)),n.isObject(t)&&!l.set(t,i)?!1:(c&&c(l,e,i),l.trigger("sync",l,e,i),void 0)},P(this,i),o=this.isNew()?"create":i.patch?"patch":"update","patch"===o&&(i.attrs=r),a=this.sync(o,this,i),r&&i.wait&&(this.attributes=s),a},destroy:function(e){e=e?n.clone(e):{};var t=this,i=e.success,r=function(){t.trigger("destroy",t,t.collection,e)};if(e.success=function(n){(e.wait||t.isNew())&&r(),i&&i(t,n,e),t.isNew()||t.trigger("sync",t,n,e)},this.isNew())return e.success(),!1;P(this,e);var o=this.sync("delete",this,e);return e.wait||r(),o},url:function(){var e=n.result(this,"urlRoot")||n.result(this.collection,"url")||j();return this.isNew()?e:e+("/"===e.charAt(e.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(e){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(e){return this._validate({},n.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=n.extend({},this.attributes,e);var i=this.validationError=this.validate(e,t)||null;return i?(this.trigger("invalid",this,i,n.extend(t,{validationError:i})),!1):!0}});var f=["keys","values","pairs","invert","pick","omit"];n.each(f,function(e){h.prototype[e]=function(){var t=a.call(arguments);return t.unshift(this.attributes),n[e].apply(n,t)}});var p=t.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,n.extend({silent:!0},t))},g={add:!0,remove:!0,merge:!0},m={add:!0,remove:!1};n.extend(p.prototype,s,{model:h,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,n.extend({merge:!1},t,m))},remove:function(e,t){var i=!n.isArray(e);e=i?[e]:n.clone(e),t||(t={});var r,o,a,s;for(r=0,o=e.length;o>r;r++)s=e[r]=this.get(e[r]),s&&(delete this._byId[s.id],delete this._byId[s.cid],a=this.indexOf(s),this.models.splice(a,1),this.length--,t.silent||(t.index=a,s.trigger("remove",s,this,t)),this._removeReference(s));return i?e[0]:e},set:function(e,t){t=n.defaults({},t,g),t.parse&&(e=this.parse(e,t));var i=!n.isArray(e);e=i?e?[e]:[]:n.clone(e);var r,o,a,s,l,c,u,d=t.at,f=this.model,p=this.comparator&&null==d&&t.sort!==!1,m=n.isString(this.comparator)?this.comparator:null,v=[],y=[],b={},w=t.add,x=t.merge,C=t.remove,k=!p&&w&&C?[]:!1;for(r=0,o=e.length;o>r;r++){if(l=e[r],a=l instanceof h?s=l:l[f.prototype.idAttribute],c=this.get(a))C&&(b[c.cid]=!0),x&&(l=l===s?s.attributes:l,t.parse&&(l=c.parse(l,t)),c.set(l,t),p&&!u&&c.hasChanged(m)&&(u=!0)),e[r]=c;else if(w){if(s=e[r]=this._prepareModel(l,t),!s)continue;v.push(s),s.on("all",this._onModelEvent,this),this._byId[s.cid]=s,null!=s.id&&(this._byId[s.id]=s)}k&&k.push(c||s)}if(C){for(r=0,o=this.length;o>r;++r)b[(s=this.models[r]).cid]||y.push(s);y.length&&this.remove(y,t)}if(v.length||k&&k.length)if(p&&(u=!0),this.length+=v.length,null!=d)for(r=0,o=v.length;o>r;r++)this.models.splice(d+r,0,v[r]);else{k&&(this.models.length=0);var _=k||v;for(r=0,o=_.length;o>r;r++)this.models.push(_[r])}if(u&&this.sort({silent:!0}),!t.silent){for(r=0,o=v.length;o>r;r++)(s=v[r]).trigger("add",s,this,t);(u||k&&k.length)&&this.trigger("sort",this,t)}return i?e[0]:e},reset:function(e,t){t||(t={});for(var i=0,r=this.models.length;r>i;i++)this._removeReference(this.models[i]);return t.previousModels=this.models,this._reset(),e=this.add(e,n.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,n.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return this.add(e,n.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(){return a.apply(this.models,arguments)},get:function(e){return null==e?void 0:this._byId[e.id]||this._byId[e.cid]||this._byId[e]},at:function(e){return this.models[e]},where:function(e,t){return n.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),n.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(n.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return n.invoke(this.models,"get",e)},fetch:function(e){e=e?n.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=e.success,i=this;return e.success=function(n){var r=e.reset?"reset":"set";i[r](n,e),t&&t(i,n,e),i.trigger("sync",i,n,e)},P(this,e),this.sync("read",this,e)},create:function(e,t){if(t=t?n.clone(t):{},!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var i=this,r=t.success;return t.success=function(e,t,n){n.wait&&i.add(e,n),r&&r(e,t,n)},e.save(null,t),e},parse:function(e){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof h)return e.collection||(e.collection=this),e;t=t?n.clone(t):{},t.collection=this;var i=new this.model(e,t);return i.validationError?(this.trigger("invalid",this,i.validationError,t),!1):i},_removeReference:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,i){("add"!==e&&"remove"!==e||n===this)&&("destroy"===e&&this.remove(t,i),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],null!=t.id&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments))}});var v=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain"];n.each(v,function(e){p.prototype[e]=function(){var t=a.call(arguments);return t.unshift(this.models),n[e].apply(n,t)}});var y=["groupBy","countBy","sortBy"];n.each(y,function(e){p.prototype[e]=function(t,i){var r=n.isFunction(t)?t:function(e){return e.get(t)};return n[e](this.models,r,i)}});var b=t.View=function(e){this.cid=n.uniqueId("view"),e||(e={}),n.extend(this,n.pick(e,x)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},w=/^(\S+)\s*(.*)$/,x=["model","collection","el","id","attributes","className","tagName","events"];n.extend(b.prototype,s,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,n){return this.$el&&this.undelegateEvents(),this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0],n!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=n.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var i=e[t];if(n.isFunction(i)||(i=this[e[t]]),i){var r=t.match(w),o=r[1],a=r[2];i=n.bind(i,this),o+=".delegateEvents"+this.cid,""===a?this.$el.on(o,i):this.$el.on(o,a,i)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(n.result(this,"el"),!1);else{var e=n.extend({},n.result(this,"attributes"));this.id&&(e.id=n.result(this,"id")),this.className&&(e["class"]=n.result(this,"className"));var i=t.$("<"+n.result(this,"tagName")+">").attr(e);this.setElement(i,!1)}}}),t.sync=function(e,i,r){var o=k[e];n.defaults(r||(r={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var a={type:o,dataType:"json"};if(r.url||(a.url=n.result(i,"url")||j()),null!=r.data||!i||"create"!==e&&"update"!==e&&"patch"!==e||(a.contentType="application/json",a.data=JSON.stringify(r.attrs||i.toJSON(r))),r.emulateJSON&&(a.contentType="application/x-www-form-urlencoded",a.data=a.data?{model:a.data}:{}),r.emulateHTTP&&("PUT"===o||"DELETE"===o||"PATCH"===o)){a.type="POST",r.emulateJSON&&(a.data._method=o);var s=r.beforeSend;r.beforeSend=function(e){return e.setRequestHeader("X-HTTP-Method-Override",o),s?s.apply(this,arguments):void 0}}"GET"===a.type||r.emulateJSON||(a.processData=!1),"PATCH"===a.type&&C&&(a.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var l=r.xhr=t.ajax(n.extend(a,r));return i.trigger("request",i,l,r),l};var C=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),k={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var _=t.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},E=/\((.*?)\)/g,T=/(\(\?)?:\w+/g,N=/\*\w+/g,S=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend(_.prototype,s,{initialize:function(){},route:function(e,i,r){n.isRegExp(e)||(e=this._routeToRegExp(e)),n.isFunction(i)&&(r=i,i=""),r||(r=this[i]);var o=this;return t.history.route(e,function(n){var a=o._extractParameters(e,n);r&&r.apply(o,a),o.trigger.apply(o,["route:"+i].concat(a)),o.trigger("route",i,a),t.history.trigger("route",o,i,a)}),this},navigate:function(e,n){return t.history.navigate(e,n),this},_bindRoutes:function(){if(this.routes){this.routes=n.result(this,"routes");for(var e,t=n.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(S,"\\$&").replace(E,"(?:$1)?").replace(T,function(e,t){return t?e:"([^/]+)"}).replace(N,"(.*?)"),new RegExp("^"+e+"$")},_extractParameters:function(e,t){var i=e.exec(t).slice(1);return n.map(i,function(e){return e?decodeURIComponent(e):null})}});var R=t.History=function(){this.handlers=[],n.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},$=/^[#\/]|\s+$/g,A=/^\/+|\/+$/g,O=/msie [\w.]+/,D=/\/$/,M=/[?#].*$/;R.started=!1,n.extend(R.prototype,s,{interval:50,getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(null==e)if(this._hasPushState||!this._wantsHashChange||t){e=this.location.pathname;var n=this.root.replace(D,"");e.indexOf(n)||(e=e.slice(n.length))}else e=this.getHash();return e.replace($,"")},start:function(e){if(R.started)throw new Error("Backbone.history has already been started");R.started=!0,this.options=n.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var i=this.getFragment(),r=document.documentMode,o=O.exec(navigator.userAgent.toLowerCase())&&(!r||7>=r);this.root=("/"+this.root+"/").replace(A,"/"),o&&this._wantsHashChange&&(this.iframe=t.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(i)),this._hasPushState?t.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!o?t.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=i;var a=this.location,s=a.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!s)return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0;this._hasPushState&&s&&a.hash&&(this.fragment=this.getHash().replace($,""),this.history.replaceState({},document.title,this.root+this.fragment+a.search))}return this.options.silent?void 0:this.loadUrl()},stop:function(){t.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),R.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(){var e=this.getFragment();return e===this.fragment&&this.iframe&&(e=this.getFragment(this.getHash(this.iframe))),e===this.fragment?!1:(this.iframe&&this.navigate(e),this.loadUrl(),void 0)},loadUrl:function(e){return e=this.fragment=this.getFragment(e),n.any(this.handlers,function(t){return t.route.test(e)?(t.callback(e),!0):void 0})},navigate:function(e,t){if(!R.started)return!1;t&&t!==!0||(t={trigger:!!t});var n=this.root+(e=this.getFragment(e||""));if(e=e.replace(M,""),this.fragment!==e){if(this.fragment=e,""===e&&"/"!==n&&(n=n.slice(0,-1)),this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}return t.trigger?this.loadUrl(e):void 0}},_updateHash:function(e,t,n){if(n){var i=e.href.replace(/(javascript:|#).*$/,"");e.replace(i+"#"+t)}else e.hash="#"+t}}),t.history=new R;var B=function(e,t){var i,r=this;i=e&&n.has(e,"constructor")?e.constructor:function(){return r.apply(this,arguments)},n.extend(i,r,t);var o=function(){this.constructor=i};return o.prototype=r.prototype,i.prototype=new o,e&&n.extend(i.prototype,e),i.__super__=r.prototype,i};h.extend=p.extend=_.extend=b.extend=R.extend=B;var j=function(){throw new Error('A "url" property or function must be specified')},P=function(e,t){var n=t.error;t.error=function(i){n&&n(e,i,t),e.trigger("error",e,i,t)}};return t}),define("marionette",["backbone","underscore","jquery"],function(e,t){e.ChildViewContainer=function(e,t){var n=function(e){this._views={},this._indexByModel={},this._indexByCustom={},this._updateLength(),t.each(e,this.add,this)};t.extend(n.prototype,{add:function(e,t){var n=e.cid;this._views[n]=e,e.model&&(this._indexByModel[e.model.cid]=n),t&&(this._indexByCustom[t]=n),this._updateLength()},findByModel:function(e){return this.findByModelCid(e.cid)},findByModelCid:function(e){var t=this._indexByModel[e];return this.findByCid(t)},findByCustom:function(e){var t=this._indexByCustom[e];return this.findByCid(t)},findByIndex:function(e){return t.values(this._views)[e]},findByCid:function(e){return this._views[e]},remove:function(e){var n=e.cid;e.model&&delete this._indexByModel[e.model.cid],t.any(this._indexByCustom,function(e,t){return e===n?(delete this._indexByCustom[t],!0):void 0},this),delete this._views[n],this._updateLength()},call:function(e){this.apply(e,t.tail(arguments))},apply:function(e,n){t.each(this._views,function(i){t.isFunction(i[e])&&i[e].apply(i,n||[])})},_updateLength:function(){this.length=t.size(this._views)}});var i=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];return t.each(i,function(e){n.prototype[e]=function(){var n=t.values(this._views),i=[n].concat(t.toArray(arguments));return t[e].apply(t,i)}}),n}(e,t),e.Wreqr=function(e,t,n){"use strict";var i={};return i.Handlers=function(e,t){var n=function(e){this.options=e,this._wreqrHandlers={},t.isFunction(this.initialize)&&this.initialize(e)};return n.extend=e.Model.extend,t.extend(n.prototype,e.Events,{setHandlers:function(e){t.each(e,function(e,n){var i=null;t.isObject(e)&&!t.isFunction(e)&&(i=e.context,e=e.callback),this.setHandler(n,e,i)},this)},setHandler:function(e,t,n){var i={callback:t,context:n};this._wreqrHandlers[e]=i,this.trigger("handler:add",e,t,n)},hasHandler:function(e){return!!this._wreqrHandlers[e]},getHandler:function(e){var t=this._wreqrHandlers[e];if(!t)throw new Error("Handler not found for '"+e+"'");return function(){var e=Array.prototype.slice.apply(arguments);return t.callback.apply(t.context,e)}},removeHandler:function(e){delete this._wreqrHandlers[e]
},removeAllHandlers:function(){this._wreqrHandlers={}}}),n}(e,n),i.CommandStorage=function(){var t=function(e){this.options=e,this._commands={},n.isFunction(this.initialize)&&this.initialize(e)};return n.extend(t.prototype,e.Events,{getCommands:function(e){var t=this._commands[e];return t||(t={command:e,instances:[]},this._commands[e]=t),t},addCommand:function(e,t){var n=this.getCommands(e);n.instances.push(t)},clearCommands:function(e){var t=this.getCommands(e);t.instances=[]}}),t}(),i.Commands=function(e){return e.Handlers.extend({storageType:e.CommandStorage,constructor:function(t){this.options=t||{},this._initializeStorage(this.options),this.on("handler:add",this._executeCommands,this);var n=Array.prototype.slice.call(arguments);e.Handlers.prototype.constructor.apply(this,n)},execute:function(e,t){e=arguments[0],t=Array.prototype.slice.call(arguments,1),this.hasHandler(e)?this.getHandler(e).apply(this,t):this.storage.addCommand(e,t)},_executeCommands:function(e,t,i){var r=this.storage.getCommands(e);n.each(r.instances,function(e){t.apply(i,e)}),this.storage.clearCommands(e)},_initializeStorage:function(e){var t,i=e.storageType||this.storageType;t=n.isFunction(i)?new i:i,this.storage=t}})}(i),i.RequestResponse=function(e){return e.Handlers.extend({request:function(){var e=arguments[0],t=Array.prototype.slice.call(arguments,1);return this.getHandler(e).apply(this,t)}})}(i),i.EventAggregator=function(e,t){var n=function(){};return n.extend=e.Model.extend,t.extend(n.prototype,e.Events),n}(e,n),i}(e,e.Marionette,t);var n=function(e,t,n){"use strict";function i(e){return a.call(e)}function r(e,t){var n=new Error(e);throw n.name=t||"Error",n}var o={};t.Marionette=o,o.$=t.$;var a=Array.prototype.slice;return o.extend=t.Model.extend,o.getOption=function(e,t){if(e&&t){var n;return n=e.options&&t in e.options&&void 0!==e.options[t]?e.options[t]:e[t]}},o.triggerMethod=function(){function e(e,t,n){return n.toUpperCase()}var t=/(^|:)(\w)/gi,i=function(i){var r="on"+i.replace(t,e),o=this[r];return n.isFunction(this.trigger)&&this.trigger.apply(this,arguments),n.isFunction(o)?o.apply(this,n.tail(arguments)):void 0};return i}(),o.MonitorDOMRefresh=function(){function e(e){e._isShown=!0,i(e)}function t(e){e._isRendered=!0,i(e)}function i(e){e._isShown&&e._isRendered&&n.isFunction(e.triggerMethod)&&e.triggerMethod("dom:refresh")}return function(n){n.listenTo(n,"show",function(){e(n)}),n.listenTo(n,"render",function(){t(n)})}}(),function(e){function t(e,t,i,o){var a=o.split(/\s+/);n.each(a,function(n){var o=e[n];o||r("Method '"+n+"' was configured as an event handler, but does not exist."),e.listenTo(t,i,o,e)})}function i(e,t,n,i){e.listenTo(t,n,i,e)}function o(e,t,i,r){var o=r.split(/\s+/);n.each(o,function(n){var r=e[n];e.stopListening(t,i,r,e)})}function a(e,t,n,i){e.stopListening(t,n,i,e)}function s(e,t,i,r,o){t&&i&&(n.isFunction(i)&&(i=i.call(e)),n.each(i,function(i,a){n.isFunction(i)?r(e,t,a,i):o(e,t,a,i)}))}e.bindEntityEvents=function(e,n,r){s(e,n,r,i,t)},e.unbindEntityEvents=function(e,t,n){s(e,t,n,a,o)}}(o),o.Callbacks=function(){this._deferred=o.$.Deferred(),this._callbacks=[]},n.extend(o.Callbacks.prototype,{add:function(e,t){this._callbacks.push({cb:e,ctx:t}),this._deferred.done(function(n,i){t&&(n=t),e.call(n,i)})},run:function(e,t){this._deferred.resolve(t,e)},reset:function(){var e=this._callbacks;this._deferred=o.$.Deferred(),this._callbacks=[],n.each(e,function(e){this.add(e.cb,e.ctx)},this)}}),o.Controller=function(e){this.triggerMethod=o.triggerMethod,this.options=e||{},n.isFunction(this.initialize)&&this.initialize(this.options)},o.Controller.extend=o.extend,n.extend(o.Controller.prototype,t.Events,{close:function(){this.stopListening(),this.triggerMethod("close"),this.unbind()}}),o.Region=function(e){if(this.options=e||{},this.el=o.getOption(this,"el"),!this.el){var t=new Error("An 'el' must be specified for a region.");throw t.name="NoElError",t}if(this.initialize){var n=Array.prototype.slice.apply(arguments);this.initialize.apply(this,n)}},n.extend(o.Region,{buildRegion:function(e,t){var i="string"==typeof e,r="string"==typeof e.selector,o="undefined"==typeof e.regionType,a="function"==typeof e;if(!a&&!i&&!r)throw new Error("Region must be specified as a Region type, a selector string or an object with selector property");var s,l;i&&(s=e),e.selector&&(s=e.selector),a&&(l=e),!a&&o&&(l=t),e.regionType&&(l=e.regionType);var c=new l({el:s});return e.parentEl&&(c.getEl=function(t){var i=e.parentEl;return n.isFunction(i)&&(i=i()),i.find(t)}),c}}),n.extend(o.Region.prototype,t.Events,{show:function(e){this.ensureEl();var t=e.isClosed||n.isUndefined(e.$el),i=e!==this.currentView;i&&this.close(),e.render(),(i||t)&&this.open(e),this.currentView=e,o.triggerMethod.call(this,"show",e),o.triggerMethod.call(e,"show")},ensureEl:function(){this.$el&&0!==this.$el.length||(this.$el=this.getEl(this.el))},getEl:function(e){return o.$(e)},open:function(e){this.$el.empty().append(e.el)},close:function(){var e=this.currentView;e&&!e.isClosed&&(e.close?e.close():e.remove&&e.remove(),o.triggerMethod.call(this,"close"),delete this.currentView)},attachView:function(e){this.currentView=e},reset:function(){this.close(),delete this.$el}}),o.Region.extend=o.extend,o.RegionManager=function(e){var t=e.Controller.extend({constructor:function(t){this._regions={},e.Controller.prototype.constructor.call(this,t)},addRegions:function(e,t){var i={};return n.each(e,function(e,r){"string"==typeof e&&(e={selector:e}),e.selector&&(e=n.defaults({},e,t));var o=this.addRegion(r,e);i[r]=o},this),i},addRegion:function(t,i){var r,o=n.isObject(i),a=n.isString(i),s=!!i.selector;return r=a||o&&s?e.Region.buildRegion(i,e.Region):n.isFunction(i)?e.Region.buildRegion(i,e.Region):i,this._store(t,r),this.triggerMethod("region:add",t,r),r},get:function(e){return this._regions[e]},removeRegion:function(e){var t=this._regions[e];this._remove(e,t)},removeRegions:function(){n.each(this._regions,function(e,t){this._remove(t,e)},this)},closeRegions:function(){n.each(this._regions,function(e){e.close()},this)},close:function(){this.removeRegions();var t=Array.prototype.slice.call(arguments);e.Controller.prototype.close.apply(this,t)},_store:function(e,t){this._regions[e]=t,this._setLength()},_remove:function(e,t){t.close(),delete this._regions[e],this._setLength(),this.triggerMethod("region:remove",e,t)},_setLength:function(){this.length=n.size(this._regions)}}),i=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];return n.each(i,function(e){t.prototype[e]=function(){var t=n.values(this._regions),i=[t].concat(n.toArray(arguments));return n[e].apply(n,i)}}),t}(o),o.TemplateCache=function(e){this.templateId=e},n.extend(o.TemplateCache,{templateCaches:{},get:function(e){var t=this.templateCaches[e];return t||(t=new o.TemplateCache(e),this.templateCaches[e]=t),t.load()},clear:function(){var e,t=i(arguments),n=t.length;if(n>0)for(e=0;n>e;e++)delete this.templateCaches[t[e]];else this.templateCaches={}}}),n.extend(o.TemplateCache.prototype,{load:function(){if(this.compiledTemplate)return this.compiledTemplate;var e=this.loadTemplate(this.templateId);return this.compiledTemplate=this.compileTemplate(e),this.compiledTemplate},loadTemplate:function(e){var t=o.$(e).html();return t&&0!==t.length||r("Could not find template: '"+e+"'","NoTemplateError"),t},compileTemplate:function(e){return n.template(e)}}),o.Renderer={render:function(e,t){if(!e){var n=new Error("Cannot render the template since it's false, null or undefined.");throw n.name="TemplateNotFoundError",n}var i;return i="function"==typeof e?e:o.TemplateCache.get(e),i(t)}},o.View=t.View.extend({constructor:function(e){n.bindAll(this,"render");var i=Array.prototype.slice.apply(arguments);this.options=n.extend({},this.options,e),this.events=this.normalizeUIKeys(n.result(this,"events")),t.View.prototype.constructor.apply(this,i),o.MonitorDOMRefresh(this),this.listenTo(this,"show",this.onShowCalled,this)},triggerMethod:o.triggerMethod,getTemplate:function(){return o.getOption(this,"template")},mixinTemplateHelpers:function(e){e=e||{};var t=o.getOption(this,"templateHelpers");return n.isFunction(t)&&(t=t.call(this)),n.extend(e,t)},normalizeUIKeys:function(e){return"undefined"!=typeof e?(n.each(n.keys(e),function(t){var n=t.split("@ui.");2===n.length&&(e[n[0]+this.ui[n[1]]]=e[t],delete e[t])},this),e):void 0},configureTriggers:function(){if(this.triggers){var e={},t=this.normalizeUIKeys(n.result(this,"triggers"));return n.each(t,function(t,i){var r=n.isObject(t),o=r?t.event:t;e[i]=function(e){if(e){var n=e.preventDefault,i=e.stopPropagation,a=r?t.preventDefault:n,s=r?t.stopPropagation:i;a&&n&&n.apply(e),s&&i&&i.apply(e)}var l={view:this,model:this.model,collection:this.collection};this.triggerMethod(o,l)}},this),e}},delegateEvents:function(e){this._delegateDOMEvents(e),o.bindEntityEvents(this,this.model,o.getOption(this,"modelEvents")),o.bindEntityEvents(this,this.collection,o.getOption(this,"collectionEvents"))},_delegateDOMEvents:function(e){e=e||this.events,n.isFunction(e)&&(e=e.call(this));var i={},r=this.configureTriggers();n.extend(i,e,r),t.View.prototype.delegateEvents.call(this,i)},undelegateEvents:function(){var e=Array.prototype.slice.call(arguments);t.View.prototype.undelegateEvents.apply(this,e),o.unbindEntityEvents(this,this.model,o.getOption(this,"modelEvents")),o.unbindEntityEvents(this,this.collection,o.getOption(this,"collectionEvents"))},onShowCalled:function(){},close:function(){if(!this.isClosed){var e=this.triggerMethod("before:close");e!==!1&&(this.isClosed=!0,this.triggerMethod("close"),this.unbindUIElements(),this.remove())}},bindUIElements:function(){if(this.ui){this._uiBindings||(this._uiBindings=this.ui);var e=n.result(this,"_uiBindings");this.ui={},n.each(n.keys(e),function(t){var n=e[t];this.ui[t]=this.$(n)},this)}},unbindUIElements:function(){this.ui&&this._uiBindings&&(n.each(this.ui,function(e,t){delete this.ui[t]},this),this.ui=this._uiBindings,delete this._uiBindings)}}),o.ItemView=o.View.extend({constructor:function(){o.View.prototype.constructor.apply(this,i(arguments))},serializeData:function(){var e={};return this.model?e=this.model.toJSON():this.collection&&(e={items:this.collection.toJSON()}),e},render:function(){this.isClosed=!1,this.triggerMethod("before:render",this),this.triggerMethod("item:before:render",this);var e=this.serializeData();e=this.mixinTemplateHelpers(e);var t=this.getTemplate(),n=o.Renderer.render(t,e);return this.$el.html(n),this.bindUIElements(),this.triggerMethod("render",this),this.triggerMethod("item:rendered",this),this},close:function(){this.isClosed||(this.triggerMethod("item:before:close"),o.View.prototype.close.apply(this,i(arguments)),this.triggerMethod("item:closed"))}}),o.CollectionView=o.View.extend({itemViewEventPrefix:"itemview",constructor:function(){this._initChildViewStorage(),o.View.prototype.constructor.apply(this,i(arguments)),this._initialEvents(),this.initRenderBuffer()},initRenderBuffer:function(){this.elBuffer=document.createDocumentFragment()},startBuffering:function(){this.initRenderBuffer(),this.isBuffering=!0},endBuffering:function(){this.appendBuffer(this,this.elBuffer),this.initRenderBuffer(),this.isBuffering=!1},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this.addChildView,this),this.listenTo(this.collection,"remove",this.removeItemView,this),this.listenTo(this.collection,"reset",this.render,this))},addChildView:function(e){this.closeEmptyView();var t=this.getItemView(e),n=this.collection.indexOf(e);this.addItemView(e,t,n)},onShowCalled:function(){this.children.each(function(e){o.triggerMethod.call(e,"show")})},triggerBeforeRender:function(){this.triggerMethod("before:render",this),this.triggerMethod("collection:before:render",this)},triggerRendered:function(){this.triggerMethod("render",this),this.triggerMethod("collection:rendered",this)},render:function(){return this.isClosed=!1,this.triggerBeforeRender(),this._renderChildren(),this.triggerRendered(),this},_renderChildren:function(){this.startBuffering(),this.closeEmptyView(),this.closeChildren(),this.collection&&this.collection.length>0?this.showCollection():this.showEmptyView(),this.endBuffering()},showCollection:function(){var e;this.collection.each(function(t,n){e=this.getItemView(t),this.addItemView(t,e,n)},this)},showEmptyView:function(){var e=this.getEmptyView();if(e&&!this._showingEmptyView){this._showingEmptyView=!0;var n=new t.Model;this.addItemView(n,e,0)}},closeEmptyView:function(){this._showingEmptyView&&(this.closeChildren(),delete this._showingEmptyView)},getEmptyView:function(){return o.getOption(this,"emptyView")},getItemView:function(){var e=o.getOption(this,"itemView");return e||r("An `itemView` must be specified","NoItemViewError"),e},addItemView:function(e,t,i){var r=o.getOption(this,"itemViewOptions");n.isFunction(r)&&(r=r.call(this,e,i));var a=this.buildItemView(e,t,r);this.addChildViewEventForwarding(a),this.triggerMethod("before:item:added",a),this.children.add(a),this.renderItemView(a,i),this._isShown&&o.triggerMethod.call(a,"show"),this.triggerMethod("after:item:added",a)},addChildViewEventForwarding:function(e){var t=o.getOption(this,"itemViewEventPrefix");this.listenTo(e,"all",function(){var n=i(arguments);n[0]=t+":"+n[0],n.splice(1,0,e),o.triggerMethod.apply(this,n)},this)},renderItemView:function(e,t){e.render(),this.appendHtml(this,e,t)},buildItemView:function(e,t,i){var r=n.extend({model:e},i);return new t(r)},removeItemView:function(e){var t=this.children.findByModel(e);this.removeChildView(t),this.checkEmpty()},removeChildView:function(e){e&&(this.stopListening(e),e.close?e.close():e.remove&&e.remove(),this.children.remove(e)),this.triggerMethod("item:removed",e)},checkEmpty:function(){this.collection&&0!==this.collection.length||this.showEmptyView()},appendBuffer:function(e,t){e.$el.append(t)},appendHtml:function(e,t){e.isBuffering?e.elBuffer.appendChild(t.el):e.$el.append(t.el)},_initChildViewStorage:function(){this.children=new t.ChildViewContainer},close:function(){this.isClosed||(this.triggerMethod("collection:before:close"),this.closeChildren(),this.triggerMethod("collection:closed"),o.View.prototype.close.apply(this,i(arguments)))},closeChildren:function(){this.children.each(function(e){this.removeChildView(e)},this),this.checkEmpty()}}),o.CompositeView=o.CollectionView.extend({constructor:function(){o.CollectionView.prototype.constructor.apply(this,i(arguments))},_initialEvents:function(){this.once("render",function(){this.collection&&(this.listenTo(this.collection,"add",this.addChildView,this),this.listenTo(this.collection,"remove",this.removeItemView,this),this.listenTo(this.collection,"reset",this._renderChildren,this))})},getItemView:function(){var e=o.getOption(this,"itemView")||this.constructor;return e||r("An `itemView` must be specified","NoItemViewError"),e},serializeData:function(){var e={};return this.model&&(e=this.model.toJSON()),e},render:function(){this.isRendered=!0,this.isClosed=!1,this.resetItemViewContainer(),this.triggerBeforeRender();var e=this.renderModel();return this.$el.html(e),this.bindUIElements(),this.triggerMethod("composite:model:rendered"),this._renderChildren(),this.triggerMethod("composite:rendered"),this.triggerRendered(),this},_renderChildren:function(){this.isRendered&&(o.CollectionView.prototype._renderChildren.call(this),this.triggerMethod("composite:collection:rendered"))},renderModel:function(){var e={};e=this.serializeData(),e=this.mixinTemplateHelpers(e);var t=this.getTemplate();return o.Renderer.render(t,e)},appendBuffer:function(e,t){var n=this.getItemViewContainer(e);n.append(t)},appendHtml:function(e,t){if(e.isBuffering)e.elBuffer.appendChild(t.el);else{var n=this.getItemViewContainer(e);n.append(t.el)}},getItemViewContainer:function(e){if("$itemViewContainer"in e)return e.$itemViewContainer;var t,i=o.getOption(e,"itemViewContainer");if(i){var a=n.isFunction(i)?i():i;t=e.$(a),t.length<=0&&r("The specified `itemViewContainer` was not found: "+e.itemViewContainer,"ItemViewContainerMissingError")}else t=e.$el;return e.$itemViewContainer=t,t},resetItemViewContainer:function(){this.$itemViewContainer&&delete this.$itemViewContainer}}),o.Layout=o.ItemView.extend({regionType:o.Region,constructor:function(e){e=e||{},this._firstRender=!0,this._initializeRegions(e),o.ItemView.prototype.constructor.call(this,e)},render:function(){this.isClosed&&this._initializeRegions(),this._firstRender?this._firstRender=!1:this.isClosed||this._reInitializeRegions();var e=Array.prototype.slice.apply(arguments),t=o.ItemView.prototype.render.apply(this,e);return t},close:function(){if(!this.isClosed){this.regionManager.close();var e=Array.prototype.slice.apply(arguments);o.ItemView.prototype.close.apply(this,e)}},addRegion:function(e,t){var n={};return n[e]=t,this._buildRegions(n)[e]},addRegions:function(e){return this.regions=n.extend({},this.regions,e),this._buildRegions(e)},removeRegion:function(e){return delete this.regions[e],this.regionManager.removeRegion(e)},_buildRegions:function(e){var t=this,n={regionType:o.getOption(this,"regionType"),parentEl:function(){return t.$el}};return this.regionManager.addRegions(e,n)},_initializeRegions:function(e){var t;this._initRegionManager(),t=n.isFunction(this.regions)?this.regions(e):this.regions||{},this.addRegions(t)},_reInitializeRegions:function(){this.regionManager.closeRegions(),this.regionManager.each(function(e){e.reset()})},_initRegionManager:function(){this.regionManager=new o.RegionManager,this.listenTo(this.regionManager,"region:add",function(e,t){this[e]=t,this.trigger("region:add",e,t)}),this.listenTo(this.regionManager,"region:remove",function(e,t){delete this[e],this.trigger("region:remove",e,t)})}}),o.AppRouter=t.Router.extend({constructor:function(e){t.Router.prototype.constructor.apply(this,i(arguments)),this.options=e||{};var n=o.getOption(this,"appRoutes"),r=this._getController();this.processAppRoutes(r,n)},appRoute:function(e,t){var n=this._getController();this._addAppRoute(n,e,t)},processAppRoutes:function(e,t){if(t){var i=n.keys(t).reverse();n.each(i,function(n){this._addAppRoute(e,n,t[n])},this)}},_getController:function(){return o.getOption(this,"controller")},_addAppRoute:function(e,t,i){var r=e[i];if(!r)throw new Error("Method '"+i+"' was not found on the controller");this.route(t,i,n.bind(r,e))}}),o.Application=function(e){this._initRegionManager(),this._initCallbacks=new o.Callbacks,this.vent=new t.Wreqr.EventAggregator,this.commands=new t.Wreqr.Commands,this.reqres=new t.Wreqr.RequestResponse,this.submodules={},n.extend(this,e),this.triggerMethod=o.triggerMethod},n.extend(o.Application.prototype,t.Events,{execute:function(){var e=Array.prototype.slice.apply(arguments);this.commands.execute.apply(this.commands,e)},request:function(){var e=Array.prototype.slice.apply(arguments);return this.reqres.request.apply(this.reqres,e)},addInitializer:function(e){this._initCallbacks.add(e)},start:function(e){this.triggerMethod("initialize:before",e),this._initCallbacks.run(e,this),this.triggerMethod("initialize:after",e),this.triggerMethod("start",e)},addRegions:function(e){return this._regionManager.addRegions(e)},closeRegions:function(){this._regionManager.closeRegions()},removeRegion:function(e){this._regionManager.removeRegion(e)},getRegion:function(e){return this._regionManager.get(e)},module:function(){var e=i(arguments);return e.unshift(this),o.Module.create.apply(o.Module,e)},_initRegionManager:function(){this._regionManager=new o.RegionManager,this.listenTo(this._regionManager,"region:add",function(e,t){this[e]=t}),this.listenTo(this._regionManager,"region:remove",function(e){delete this[e]})}}),o.Application.extend=o.extend,o.Module=function(e,t){this.moduleName=e,this.submodules={},this._setupInitializersAndFinalizers(),this.app=t,this.startWithParent=!0,this.triggerMethod=o.triggerMethod},n.extend(o.Module.prototype,t.Events,{addInitializer:function(e){this._initializerCallbacks.add(e)},addFinalizer:function(e){this._finalizerCallbacks.add(e)},start:function(e){this._isInitialized||(n.each(this.submodules,function(t){t.startWithParent&&t.start(e)}),this.triggerMethod("before:start",e),this._initializerCallbacks.run(e,this),this._isInitialized=!0,this.triggerMethod("start",e))},stop:function(){this._isInitialized&&(this._isInitialized=!1,o.triggerMethod.call(this,"before:stop"),n.each(this.submodules,function(e){e.stop()}),this._finalizerCallbacks.run(void 0,this),this._initializerCallbacks.reset(),this._finalizerCallbacks.reset(),o.triggerMethod.call(this,"stop"))},addDefinition:function(e,t){this._runModuleDefinition(e,t)},_runModuleDefinition:function(e,i){if(e){var r=n.flatten([this,this.app,t,o,o.$,n,i]);e.apply(this,r)}},_setupInitializersAndFinalizers:function(){this._initializerCallbacks=new o.Callbacks,this._finalizerCallbacks=new o.Callbacks}}),n.extend(o.Module,{create:function(e,t,r){var o=e,a=i(arguments);a.splice(0,3),t=t.split(".");var s=t.length,l=[];return l[s-1]=r,n.each(t,function(t,n){var i=o;o=this._getModule(i,t,e),this._addModuleDefinition(i,o,l[n],a)},this),o},_getModule:function(e,t,n){var i=e[t];return i||(i=new o.Module(t,n),e[t]=i,e.submodules[t]=i),i},_addModuleDefinition:function(e,t,i,r){var o,a;n.isFunction(i)?(o=i,a=!0):n.isObject(i)?(o=i.define,a=i.startWithParent):a=!0,o&&t.addDefinition(o,r),t.startWithParent=t.startWithParent&&a,t.startWithParent&&!t.startWithParentIsConfigured&&(t.startWithParentIsConfigured=!0,e.addInitializer(function(e){t.startWithParent&&t.start(e)}))}}),o}(this,e,t);return n}),function(e){"function"==typeof define&&define.amd?define("autosize",["jquery"],e):e(window.jQuery||window.$)}(function(e){var t,n={className:"autosizejs",append:"",callback:!1,resizeDelay:10},i='<textarea tabindex="-1" style="position:absolute; top:-999px; left:0; right:auto; bottom:auto; border:0; padding: 0; -moz-box-sizing:content-box; -webkit-box-sizing:content-box; box-sizing:content-box; word-wrap:break-word; height:0 !important; min-height:0 !important; overflow:hidden; transition:none; -webkit-transition:none; -moz-transition:none;"/>',r=["fontFamily","fontSize","fontWeight","fontStyle","letterSpacing","textTransform","wordSpacing","textIndent"],o=e(i).data("autosize",!0)[0];o.style.lineHeight="99px","99px"===e(o).css("lineHeight")&&r.push("lineHeight"),o.style.lineHeight="",e.fn.autosize=function(i){return this.length?(i=e.extend({},n,i||{}),o.parentNode!==document.body&&e(document.body).append(o),this.each(function(){function n(){var t,n;"getComputedStyle"in window?(t=window.getComputedStyle(h,null),n=h.getBoundingClientRect().width,e.each(["paddingLeft","paddingRight","borderLeftWidth","borderRightWidth"],function(e,i){n-=parseInt(t[i],10)}),o.style.width=n+"px"):o.style.width=Math.max(f.width(),0)+"px"}function a(){var a={};if(t=h,o.className=i.className,c=parseInt(f.css("maxHeight"),10),e.each(r,function(e,t){a[t]=f.css(t)}),e(o).css(a),n(),window.chrome){var s=h.style.width;h.style.width="0px";{h.offsetWidth}h.style.width=s}}function s(){var e,r;t!==h?a():n(),o.value=h.value+i.append,o.style.overflowY=h.style.overflowY,r=parseInt(h.style.height,10),o.scrollTop=0,o.scrollTop=9e4,e=o.scrollTop,c&&e>c?(h.style.overflowY="scroll",e=c):(h.style.overflowY="hidden",u>e&&(e=u)),e+=p,r!==e&&(h.style.height=e+"px",g&&i.callback.call(h,h))}function l(){clearTimeout(d),d=setTimeout(function(){var e=f.width();e!==v&&(v=e,s())},parseInt(i.resizeDelay,10))}var c,u,d,h=this,f=e(h),p=0,g=e.isFunction(i.callback),m={height:h.style.height,overflow:h.style.overflow,overflowY:h.style.overflowY,wordWrap:h.style.wordWrap,resize:h.style.resize},v=f.width();f.data("autosize")||(f.data("autosize",!0),("border-box"===f.css("box-sizing")||"border-box"===f.css("-moz-box-sizing")||"border-box"===f.css("-webkit-box-sizing"))&&(p=f.outerHeight()-f.height()),u=Math.max(parseInt(f.css("minHeight"),10)-p||0,f.height()),f.css({overflow:"hidden",overflowY:"hidden",wordWrap:"break-word",resize:"none"===f.css("resize")||"vertical"===f.css("resize")?"none":"horizontal"}),"onpropertychange"in h?"oninput"in h?f.on("input.autosize keyup.autosize",s):f.on("propertychange.autosize",function(){"value"===event.propertyName&&s()}):f.on("input.autosize",s),i.resizeDelay!==!1&&e(window).on("resize.autosize",l),f.on("autosize.resize",s),f.on("autosize.resizeIncludeStyle",function(){t=null,s()}),f.on("autosize.destroy",function(){t=null,clearTimeout(d),e(window).off("resize",l),f.off("autosize").off(".autosize").css(m).removeData("autosize")}),s())})):this}}),define("hotkeys",["jquery"],function(e){!function(e){function t(t){if("string"==typeof t.data&&(t.data={keys:t.data}),t.data&&t.data.keys&&"string"==typeof t.data.keys){var n=t.handler,i=t.data.keys.toLowerCase().split(" "),r=["text","password","number","email","url","range","date","month","week","time","datetime","datetime-local","search","color"];t.handler=function(t){if(this===t.target||!(/textarea|select/i.test(t.target.nodeName)||e.inArray(t.target.type,r)>-1)){var o="keypress"!==t.type&&e.hotkeys.specialKeys[t.which],a=String.fromCharCode(t.which).toLowerCase(),s="",l={};t.altKey&&"alt"!==o&&(s+="alt+"),t.ctrlKey&&"ctrl"!==o&&(s+="ctrl+"),t.metaKey&&!t.ctrlKey&&"meta"!==o&&(s+="meta+"),t.shiftKey&&"shift"!==o&&(s+="shift+"),o?l[s+o]=!0:(l[s+a]=!0,l[s+e.hotkeys.shiftNums[a]]=!0,"shift+"===s&&(l[e.hotkeys.shiftNums[a]]=!0));for(var c=0,u=i.length;u>c;c++)if(l[i[c]])return n.apply(this,arguments)}}}}e.hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",186:";",191:"/",220:"\\",222:"'",224:"meta"},shiftNums:{"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"}},e.each(["keydown","keyup","keypress"],function(){e.event.special[this]={add:t}})}(e)}),define("htmlclean",["jquery"],function(e){!function(e){function t(e,t,n,i){if(e.tag.format&&n.length>0){n.push("\n");for(var r=0;i>r;r++)n.push("	")}}function n(i,r){var o=[],a=!0,s=0;if(i.tag.isComment)r.allowComments&&(o.push("<!--"),o.push(i.tag.rawAttributes),o.push(">"),r.format&&t(i,r,o,s-1));else{var l=i.tag.render&&(0==r.allowedTags.length||e.inArray(i.tag.name,r.allowedTags)>-1)&&(0==r.removeTags.length||-1==e.inArray(i.tag.name,r.removeTags));if(!i.isRoot&&l&&(o.push("<"),o.push(i.tag.name),e.each(i.attributes,function(){if(-1==e.inArray(this.name,r.removeAttrs)){var t=RegExp(/^(['"]?)(.*?)['"]?$/).exec(this.value),n=t[2],a=t[1]||"'";"class"==this.name&&r.allowedClasses.length>0&&(n=e.grep(n.split(" "),function(t){return e.grep(r.allowedClasses,function(n){return n==t||n[0]==t&&(1==n.length||e.inArray(i.tag.name,n[1])>-1)}).length>0}).join(" ")),null!=n&&(n.length>0||e.inArray(this.name,i.tag.requiredAttributes)>-1)&&(o.push(" "),o.push(this.name),o.push("="),o.push(a),o.push(n),o.push(a))}})),i.tag.isSelfClosing)l&&o.push(" />"),a=!1;else if(i.tag.isNonClosing)a=!1;else{if(!i.isRoot&&l&&o.push(">"),s=r.formatIndent++,i.tag.toProtect)f=e.htmlClean.trim(i.children.join("")).replace(/<br>/gi,"\n"),o.push(f),a=0==f.length;else{for(var f=[],g=0;g<i.children.length;g++){var m=i.children[g],v=e.htmlClean.trim(p(d(m)?m:m.childrenToString()));h(m)&&g>0&&v.length>0&&(c(m)||u(i.children[g-1]))&&f.push(" "),d(m)?v.length>0&&f.push(v):(g!=i.children.length-1||"br"!=m.tag.name)&&(r.format&&t(m,r,f,s),f=f.concat(n(m,r)))}r.formatIndent--,f.length>0&&(r.format&&"\n"!=f[0]&&t(i,r,o,s),o=o.concat(f),a=!1)}!i.isRoot&&l&&(r.format&&t(i,r,o,s-1),o.push("</"),o.push(i.tag.name),o.push(">"))}if(!i.tag.allowEmpty&&a)return[]}return o}function i(t,n){return o(t,function(t){return e.inArray(t.tag.nameOriginal,n)>-1})}function r(e){return o(e,function(e){return e.isRoot||!e.tag.isInline})}function o(e,t,n){n=n||1;var i=e[e.length-n];return t(i)?!0:e.length-n>0&&o(e,t,n+1)?(e.pop(),!0):!1}function a(e){return e?(this.tag=e,this.isRoot=!1):(this.tag=new l("root"),this.isRoot=!0),this.attributes=[],this.children=[],this.hasAttribute=function(e){for(var t=0;t<this.attributes.length;t++)if(this.attributes[t].name==e)return!0;return!1},this.childrenToString=function(){return this.children.join("")},this}function s(e,t){return this.name=e,this.value=t,this}function l(t,n,i,r){return this.name=t.toLowerCase(),this.nameOriginal=this.name,this.render=!0,this.init=function(){if("--"==this.name?(this.isComment=!0,this.isSelfClosing=!0,this.format=!0):(this.isComment=!1,this.isSelfClosing=e.inArray(this.name,x)>-1,this.isNonClosing=e.inArray(this.name,C)>-1,this.isClosing=void 0!=n&&n.length>0,this.isInline=e.inArray(this.name,g)>-1,this.disallowNest=e.inArray(this.name,v)>-1,this.requiredParent=b[e.inArray(this.name,b)+1],this.allowEmpty=r&&e.inArray(this.name,r.allowEmpty)>-1,this.toProtect=e.inArray(this.name,w)>-1,this.format=e.inArray(this.name,m)>-1||!this.isInline),this.rawAttributes=i,this.requiredAttributes=_[e.inArray(this.name,_)+1],r){if(r.tagAttributesCache||(r.tagAttributesCache=[]),-1==e.inArray(this.name,r.tagAttributesCache)){for(var t=k[e.inArray(this.name,k)+1].slice(0),o=0;o<r.allowedAttributes.length;o++){var a=r.allowedAttributes[o][0];(1==r.allowedAttributes[o].length||e.inArray(this.name,r.allowedAttributes[o][1])>-1)&&-1==e.inArray(a,t)&&t.push(a)}r.tagAttributesCache.push(this.name),r.tagAttributesCache.push(t)}this.allowedAttributes=r.tagAttributesCache[e.inArray(this.name,r.tagAttributesCache)+1]}},this.init(),this.rename=function(e){this.name=e,this.init()},this}function c(t){for(;f(t)&&t.children.length>0;)t=t.children[0];if(!d(t))return!1;var n=p(t);return n.length>0&&e.htmlClean.isWhitespace(n.charAt(0))}function u(t){for(;f(t)&&t.children.length>0;)t=t.children[t.children.length-1];if(!d(t))return!1;var n=p(t);return n.length>0&&e.htmlClean.isWhitespace(n.charAt(n.length-1))}function d(e){return e.constructor==String}function h(e){return d(e)||e.tag.isInline}function f(e){return e.constructor==a}function p(e){return e.replace(/&nbsp;|\n/g," ").replace(/\s\s+/g," ")}e.fn.htmlClean=function(t){return this.each(function(){this.value?this.value=e.htmlClean(this.value,t):this.innerHTML=e.htmlClean(this.innerHTML,t)})},e.htmlClean=function(t,o){o=e.extend({},e.htmlClean.defaults,o),o.allowEmpty=y.concat(o.allowEmpty);var c,u=/(<(\/)?(\w+:)?([\w]+)([^>]*)>)|<!--(.*?--)>/gi,h=/([\w\-]+)\s*=\s*(".*?"|'.*?'|[^\s>\/]*)/gi,f=new a,p=[f],g=f;o.bodyOnly&&(c=/<body[^>]*>((\n|.)*)<\/body>/i.exec(t))&&(t=c[1]),t=t.concat("<xxx>");for(var m;c=u.exec(t);){var v=c[6]?new l("--",null,c[6],o):new l(c[4],c[2],c[5],o),b=t.substring(m,c.index);if(b.length>0){var w=g.children[g.children.length-1];g.children.length>0&&d(w=g.children[g.children.length-1])?g.children[g.children.length-1]=w.concat(b):g.children.push(b)}if(m=u.lastIndex,v.isClosing)i(p,[v.name])&&(p.pop(),g=p[p.length-1]);else{for(var x,C=new a(v);x=h.exec(v.rawAttributes);){if("style"==x[1].toLowerCase()&&o.replaceStyles)for(var k=!v.isInline,_=0;_<o.replaceStyles.length;_++)o.replaceStyles[_][0].test(x[2])&&(k||(v.render=!1,k=!0),g.children.push(C),p.push(C),g=C,v=new l(o.replaceStyles[_][1],"","",o),C=new a(v));null!=v.allowedAttributes&&(0==v.allowedAttributes.length||e.inArray(x[1],v.allowedAttributes)>-1)&&C.attributes.push(new s(x[1],x[2]))}e.each(v.requiredAttributes,function(){var e=this.toString();C.hasAttribute(e)||C.attributes.push(new s(e,""))});for(var E=0;E<o.replace.length;E++)for(var T=0;T<o.replace[E][0].length;T++){var N="string"==typeof o.replace[E][0][T];if(N&&o.replace[E][0][T]==v.name||!N&&o.replace[E][0][T].test(c)){v.rename(o.replace[E][1]),E=o.replace.length;break}}var S=!0;if(g.isRoot||(g.tag.isInline&&!v.isInline?(S=r(p))&&(g=p[p.length-1]):g.tag.disallowNest&&v.disallowNest&&!v.requiredParent?S=!1:v.requiredParent&&(S=i(p,v.requiredParent))&&(g=p[p.length-1])),S)if(g.children.push(C),v.toProtect)for(var R;R=u.exec(t);){var $=new l(R[4],R[1],R[5],o);if($.isClosing&&$.name==v.name){C.children.push(RegExp.leftContext.substring(m)),m=u.lastIndex;break}}else v.isSelfClosing||v.isNonClosing||(p.push(C),g=C)}}return e.htmlClean.trim(n(f,o).join(""))},e.htmlClean.defaults={bodyOnly:!0,allowedTags:[],removeTags:["basefont","center","dir","font","frame","frameset","iframe","isindex","menu","noframes","s","strike","u"],allowedAttributes:[],removeAttrs:[],allowedClasses:[],format:!1,formatIndent:0,replace:[[["b","big"],"strong"],[["i"],"em"]],replaceStyles:[[/font-weight:\s*bold/i,"strong"],[/font-style:\s*italic/i,"em"],[/vertical-align:\s*super/i,"sup"],[/vertical-align:\s*sub/i,"sub"]],allowComments:!1,allowEmpty:[]},e.htmlClean.trim=function(t){return e.htmlClean.trimStart(e.htmlClean.trimEnd(t))
},e.htmlClean.trimStart=function(t){return t.substring(e.htmlClean.trimStartIndex(t))},e.htmlClean.trimStartIndex=function(t){for(var n=0;n<t.length-1&&e.htmlClean.isWhitespace(t.charAt(n));n++);return n},e.htmlClean.trimEnd=function(t){return t.substring(0,e.htmlClean.trimEndIndex(t))},e.htmlClean.trimEndIndex=function(t){for(var n=t.length-1;n>=0&&e.htmlClean.isWhitespace(t.charAt(n));n--);return n+1},e.htmlClean.isWhitespace=function(t){return-1!=e.inArray(t,E)};var g=["a","abbr","acronym","address","b","big","br","button","caption","cite","code","del","em","font","hr","i","input","img","ins","label","legend","map","q","s","samp","select","option","param","small","span","strike","strong","sub","sup","tt","u","var"],m=["address","button","caption","code","input","label","legend","select","option","param"],v=["h1","h2","h3","h4","h5","h6","p","th","td","object"],y=["th","td"],b=[null,"li",["ul","ol"],"dt",["dl"],"dd",["dl"],"td",["tr"],"th",["tr"],"tr",["table","thead","tbody","tfoot"],"thead",["table"],"tbody",["table"],"tfoot",["table"],"param",["object"]],w=["script","style","pre","code"],x=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],C=["!doctype","?xml"],k=[["class"],"?xml",[],"!doctype",[],"a",["accesskey","class","href","name","title","rel","rev","type","tabindex"],"abbr",["class","title"],"acronym",["class","title"],"blockquote",["cite","class"],"button",["class","disabled","name","type","value"],"del",["cite","class","datetime"],"form",["accept","action","class","enctype","method","name"],"iframe",["class","height","name","sandbox","seamless","src","srcdoc","width"],"input",["accept","accesskey","alt","checked","class","disabled","ismap","maxlength","name","size","readonly","src","tabindex","type","usemap","value"],"img",["alt","class","height","src","width"],"ins",["cite","class","datetime"],"label",["accesskey","class","for"],"legend",["accesskey","class"],"link",["href","rel","type"],"meta",["content","http-equiv","name","scheme","charset"],"map",["name"],"optgroup",["class","disabled","label"],"option",["class","disabled","label","selected","value"],"q",["class","cite"],"script",["src","type"],"select",["class","disabled","multiple","name","size","tabindex"],"style",["type"],"table",["class","summary"],"th",["class","colspan","rowspan"],"td",["class","colspan","rowspan"],"textarea",["accesskey","class","cols","disabled","name","readonly","rows","tabindex"],"param",["name","value"],"embed",["height","src","type","width"]],_=[[],"img",["alt"]],E=[" "," ","	","\n","\r","\f"]}(e)}),function(){function e(e,t,n){for(var i=(n||0)-1,r=e?e.length:0;++i<r;)if(e[i]===t)return i;return-1}function t(t,n){var i=typeof n;if(t=t.cache,"boolean"==i||null==n)return t[n]?0:-1;"number"!=i&&"string"!=i&&(i="object");var r="number"==i?n:v+n;return t=(t=t[i])&&t[r],"object"==i?t&&e(t,n)>-1?0:-1:t?0:-1}function n(e){var t=this.cache,n=typeof e;if("boolean"==n||null==e)t[e]=!0;else{"number"!=n&&"string"!=n&&(n="object");var i="number"==n?e:v+e,r=t[n]||(t[n]={});"object"==n?(r[i]||(r[i]=[])).push(e):r[i]=!0}}function i(e){return e.charCodeAt(0)}function r(e,t){var n=e.criteria,i=t.criteria;if(n!==i){if(n>i||"undefined"==typeof n)return 1;if(i>n||"undefined"==typeof i)return-1}return e.index-t.index}function o(e){var t=-1,i=e.length,r=e[0],o=e[i/2|0],a=e[i-1];if(r&&"object"==typeof r&&o&&"object"==typeof o&&a&&"object"==typeof a)return!1;var s=l();s["false"]=s["null"]=s["true"]=s.undefined=!1;var c=l();for(c.array=e,c.cache=s,c.push=n;++t<i;)c.push(e[t]);return c}function a(e){return"\\"+J[e]}function s(){return p.pop()||[]}function l(){return g.pop()||{array:null,cache:null,criteria:null,"false":!1,index:0,"null":!1,number:null,object:null,push:null,string:null,"true":!1,undefined:!1,value:null}}function c(e){e.length=0,p.length<b&&p.push(e)}function u(e){var t=e.cache;t&&u(t),e.array=e.cache=e.criteria=e.object=e.number=e.string=e.value=null,g.length<b&&g.push(e)}function d(e,t,n){t||(t=0),"undefined"==typeof n&&(n=e?e.length:0);for(var i=-1,r=n-t||0,o=Array(0>r?0:r);++i<r;)o[i]=e[t+i];return o}function h(n){function p(e){return e&&"object"==typeof e&&!Gi(e)&&Oi.call(e,"__wrapped__")?e:new g(e)}function g(e,t){this.__chain__=!!t,this.__wrapped__=e}function b(e){function t(){if(i){var e=i.slice();Mi.apply(e,arguments)}if(this instanceof t){var o=K(n.prototype),a=n.apply(o,e||arguments);return At(a)?a:o}return n.apply(r,e||arguments)}var n=e[0],i=e[2],r=e[4];return Qi(t,e),t}function J(e,t,n,i,r){if(n){var o=n(e);if("undefined"!=typeof o)return o}var a=At(e);if(!a)return e;var l=Ei.call(e);if(!F[l])return e;var u=Xi[l];switch(l){case j:case P:return new u(+e);case I:case L:return new u(e);case V:return o=u(e.source,E.exec(e)),o.lastIndex=e.lastIndex,o}var h=Gi(e);if(t){var f=!i;i||(i=s()),r||(r=s());for(var p=i.length;p--;)if(i[p]==e)return r[p];o=h?u(e.length):{}}else o=h?d(e):rr({},e);return h&&(Oi.call(e,"index")&&(o.index=e.index),Oi.call(e,"input")&&(o.input=e.input)),t?(i.push(e),r.push(o),(h?Qt:sr)(e,function(e,a){o[a]=J(e,t,n,i,r)}),f&&(c(i),c(r)),o):o}function K(e){return At(e)?Ii(e):{}}function Q(e,t,n){if("function"!=typeof e)return Gn;if("undefined"==typeof t||!("prototype"in e))return e;var i=e.__bindData__;if("undefined"==typeof i&&(Ki.funcNames&&(i=!e.name),i=i||!Ki.funcDecomp,!i)){var r=$i.call(e);Ki.funcNames||(i=!T.test(r)),i||(i=$.test(r),Qi(e,i))}if(i===!1||i!==!0&&1&i[1])return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,i){return e.call(t,n,i)};case 3:return function(n,i,r){return e.call(t,n,i,r)};case 4:return function(n,i,r,o){return e.call(t,n,i,r,o)}}return Bn(e,t)}function et(e){function t(){var e=l?a:this;if(r){var p=r.slice();Mi.apply(p,arguments)}if((o||u)&&(p||(p=d(arguments)),o&&Mi.apply(p,o),u&&p.length<s))return i|=16,et([n,h?i:-4&i,p,null,a,s]);if(p||(p=arguments),c&&(n=e[f]),this instanceof t){e=K(n.prototype);var g=n.apply(e,p);return At(g)?g:e}return n.apply(e,p)}var n=e[0],i=e[1],r=e[2],o=e[3],a=e[4],s=e[5],l=1&i,c=2&i,u=4&i,h=8&i,f=n;return Qi(t,e),t}function tt(n,i){var r=-1,a=ut(),s=n?n.length:0,l=s>=y&&a===e,c=[];if(l){var d=o(i);d?(a=t,i=d):l=!1}for(;++r<s;){var h=n[r];a(i,h)<0&&c.push(h)}return l&&u(i),c}function nt(e,t,n,i){for(var r=(i||0)-1,o=e?e.length:0,a=[];++r<o;){var s=e[r];if(s&&"object"==typeof s&&"number"==typeof s.length&&(Gi(s)||ft(s))){t||(s=nt(s,t,n));var l=-1,c=s.length,u=a.length;for(a.length+=c;++l<c;)a[u++]=s[l]}else n||a.push(s)}return a}function it(e,t,n,i,r,o){if(n){var a=n(e,t);if("undefined"!=typeof a)return!!a}if(e===t)return 0!==e||1/e==1/t;var l=typeof e,u=typeof t;if(!(e!==e||e&&U[l]||t&&U[u]))return!1;if(null==e||null==t)return e===t;var d=Ei.call(e),h=Ei.call(t);if(d==M&&(d=q),h==M&&(h=q),d!=h)return!1;switch(d){case j:case P:return+e==+t;case I:return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case V:case L:return e==wi(t)}var f=d==B;if(!f){var p=Oi.call(e,"__wrapped__"),g=Oi.call(t,"__wrapped__");if(p||g)return it(p?e.__wrapped__:e,g?t.__wrapped__:t,n,i,r,o);if(d!=q)return!1;var m=e.constructor,v=t.constructor;if(m!=v&&!($t(m)&&m instanceof m&&$t(v)&&v instanceof v)&&"constructor"in e&&"constructor"in t)return!1}var y=!r;r||(r=s()),o||(o=s());for(var b=r.length;b--;)if(r[b]==e)return o[b]==t;var w=0;if(a=!0,r.push(e),o.push(t),f){if(b=e.length,w=t.length,a=w==e.length,!a&&!i)return a;for(;w--;){var x=b,C=t[w];if(i)for(;x--&&!(a=it(e[x],C,n,i,r,o)););else if(!(a=it(e[w],C,n,i,r,o)))break}return a}return ar(t,function(t,s,l){return Oi.call(l,s)?(w++,a=Oi.call(e,s)&&it(e[s],t,n,i,r,o)):void 0}),a&&!i&&ar(e,function(e,t,n){return Oi.call(n,t)?a=--w>-1:void 0}),y&&(c(r),c(o)),a}function rt(e,t,n,i,r){(Gi(t)?Qt:sr)(t,function(t,o){var a,s,l=t,c=e[o];if(t&&((s=Gi(t))||lr(t))){for(var u=i.length;u--;)if(a=i[u]==t){c=r[u];break}if(!a){var d;n&&(l=n(c,t),(d="undefined"!=typeof l)&&(c=l)),d||(c=s?Gi(c)?c:[]:lr(c)?c:{}),i.push(t),r.push(c),d||rt(c,t,n,i,r)}}else n&&(l=n(c,t),"undefined"==typeof l&&(l=t)),"undefined"!=typeof l&&(c=l);e[o]=c})}function ot(e,t){return e+Ri(Ji()*(t-e+1))}function at(n,i,r){var a=-1,l=ut(),d=n?n.length:0,h=[],f=!i&&d>=y&&l===e,p=r||f?s():h;if(f){var g=o(p);g?(l=t,p=g):(f=!1,p=r?p:(c(p),h))}for(;++a<d;){var m=n[a],v=r?r(m,a,n):m;(i?!a||p[p.length-1]!==v:l(p,v)<0)&&((r||f)&&p.push(v),h.push(m))}return f?(c(p.array),u(p)):r&&c(p),h}function st(e){return function(t,n,i){var r={};n=p.createCallback(n,i,3);var o=-1,a=t?t.length:0;if("number"==typeof a)for(;++o<a;){var s=t[o];e(r,s,n(s,o,t),t)}else sr(t,function(t,i,o){e(r,t,n(t,i,o),o)});return r}}function lt(e,t,n,i,r,o){var a=1&t,s=2&t,l=4&t,c=16&t,u=32&t;if(!s&&!$t(e))throw new xi;c&&!n.length&&(t&=-17,c=n=!1),u&&!i.length&&(t&=-33,u=i=!1);var d=e&&e.__bindData__;if(d&&d!==!0)return d=d.slice(),!a||1&d[1]||(d[4]=r),!a&&1&d[1]&&(t|=8),!l||4&d[1]||(d[5]=o),c&&Mi.apply(d[2]||(d[2]=[]),n),u&&Mi.apply(d[3]||(d[3]=[]),i),d[1]|=t,lt.apply(null,d);var h=1==t||17===t?b:et;return h([e,t,n,i,r,o])}function ct(e){return er[e]}function ut(){var t=(t=p.indexOf)===bn?e:t;return t}function dt(e){var t,n;return e&&Ei.call(e)==q&&(t=e.constructor,!$t(t)||t instanceof t)?(ar(e,function(e,t){n=t}),"undefined"==typeof n||Oi.call(e,n)):!1}function ht(e){return tr[e]}function ft(e){return e&&"object"==typeof e&&"number"==typeof e.length&&Ei.call(e)==M||!1}function pt(e,t,n,i){return"boolean"!=typeof t&&null!=t&&(i=n,n=t,t=!1),J(e,t,"function"==typeof n&&Q(n,i,1))}function gt(e,t,n){return J(e,!0,"function"==typeof t&&Q(t,n,1))}function mt(e,t){var n=K(e);return t?rr(n,t):n}function vt(e,t,n){var i;return t=p.createCallback(t,n,3),sr(e,function(e,n,r){return t(e,n,r)?(i=n,!1):void 0}),i}function yt(e,t,n){var i;return t=p.createCallback(t,n,3),wt(e,function(e,n,r){return t(e,n,r)?(i=n,!1):void 0}),i}function bt(e,t,n){var i=[];ar(e,function(e,t){i.push(t,e)});var r=i.length;for(t=Q(t,n,3);r--&&t(i[r--],i[r],e)!==!1;);return e}function wt(e,t,n){var i=Zi(e),r=i.length;for(t=Q(t,n,3);r--;){var o=i[r];if(t(e[o],o,e)===!1)break}return e}function xt(e){var t=[];return ar(e,function(e,n){$t(e)&&t.push(n)}),t.sort()}function Ct(e,t){return e?Oi.call(e,t):!1}function kt(e){for(var t=-1,n=Zi(e),i=n.length,r={};++t<i;){var o=n[t];r[e[o]]=o}return r}function _t(e){return e===!0||e===!1||e&&"object"==typeof e&&Ei.call(e)==j||!1}function Et(e){return e&&"object"==typeof e&&Ei.call(e)==P||!1}function Tt(e){return e&&1===e.nodeType||!1}function Nt(e){var t=!0;if(!e)return t;var n=Ei.call(e),i=e.length;return n==B||n==L||n==M||n==q&&"number"==typeof i&&$t(e.splice)?!i:(sr(e,function(){return t=!1}),t)}function St(e,t,n,i){return it(e,t,"function"==typeof n&&Q(n,i,2))}function Rt(e){return Vi(e)&&!Li(parseFloat(e))}function $t(e){return"function"==typeof e}function At(e){return!(!e||!U[typeof e])}function Ot(e){return Mt(e)&&e!=+e}function Dt(e){return null===e}function Mt(e){return"number"==typeof e||e&&"object"==typeof e&&Ei.call(e)==I||!1}function Bt(e){return e&&"object"==typeof e&&Ei.call(e)==V||!1}function jt(e){return"string"==typeof e||e&&"object"==typeof e&&Ei.call(e)==L||!1}function Pt(e){return"undefined"==typeof e}function Ht(e){var t=arguments,n=2;if(!At(e))return e;if("number"!=typeof t[2]&&(n=t.length),n>3&&"function"==typeof t[n-2])var i=Q(t[--n-1],t[n--],2);else n>2&&"function"==typeof t[n-1]&&(i=t[--n]);for(var r=d(arguments,1,n),o=-1,a=s(),l=s();++o<n;)rt(e,r[o],i,a,l);return c(a),c(l),e}function It(e,t,n){var i={};if("function"!=typeof t){var r=[];ar(e,function(e,t){r.push(t)}),r=tt(r,nt(arguments,!0,!1,1));for(var o=-1,a=r.length;++o<a;){var s=r[o];i[s]=e[s]}}else t=p.createCallback(t,n,3),ar(e,function(e,n,r){t(e,n,r)||(i[n]=e)});return i}function qt(e){for(var t=-1,n=Zi(e),i=n.length,r=hi(i);++t<i;){var o=n[t];r[t]=[o,e[o]]}return r}function Vt(e,t,n){var i={};if("function"!=typeof t)for(var r=-1,o=nt(arguments,!0,!1,1),a=At(e)?o.length:0;++r<a;){var s=o[r];s in e&&(i[s]=e[s])}else t=p.createCallback(t,n,3),ar(e,function(e,n,r){t(e,n,r)&&(i[n]=e)});return i}function Lt(e,t,n,i){var r=Gi(e);if(null==n)if(r)n=[];else{var o=e&&e.constructor,a=o&&o.prototype;n=K(a)}return t&&(t=p.createCallback(t,i,4),(r?Qt:sr)(e,function(e,i,r){return t(n,e,i,r)})),n}function Ft(e){for(var t=-1,n=Zi(e),i=n.length,r=hi(i);++t<i;)r[t]=e[n[t]];return r}function zt(e){for(var t=arguments,n=-1,i=nt(t,!0,!1,1),r=t[2]&&t[2][t[1]]===e?1:i.length,o=hi(r);++n<r;)o[n]=e[i[n]];return o}function Wt(e,t,n){var i=-1,r=ut(),o=e?e.length:0,a=!1;return n=(0>n?zi(0,o+n):n)||0,Gi(e)?a=r(e,t,n)>-1:"number"==typeof o?a=(jt(e)?e.indexOf(t,n):r(e,t,n))>-1:sr(e,function(e){return++i>=n?!(a=e===t):void 0}),a}function Ut(e,t,n){var i=!0;t=p.createCallback(t,n,3);var r=-1,o=e?e.length:0;if("number"==typeof o)for(;++r<o&&(i=!!t(e[r],r,e)););else sr(e,function(e,n,r){return i=!!t(e,n,r)});return i}function Jt(e,t,n){var i=[];t=p.createCallback(t,n,3);var r=-1,o=e?e.length:0;if("number"==typeof o)for(;++r<o;){var a=e[r];t(a,r,e)&&i.push(a)}else sr(e,function(e,n,r){t(e,n,r)&&i.push(e)});return i}function Xt(e,t,n){t=p.createCallback(t,n,3);var i=-1,r=e?e.length:0;if("number"!=typeof r){var o;return sr(e,function(e,n,i){return t(e,n,i)?(o=e,!1):void 0}),o}for(;++i<r;){var a=e[i];if(t(a,i,e))return a}}function Kt(e,t,n){var i;return t=p.createCallback(t,n,3),Gt(e,function(e,n,r){return t(e,n,r)?(i=e,!1):void 0}),i}function Qt(e,t,n){var i=-1,r=e?e.length:0;if(t=t&&"undefined"==typeof n?t:Q(t,n,3),"number"==typeof r)for(;++i<r&&t(e[i],i,e)!==!1;);else sr(e,t);return e}function Gt(e,t,n){var i=e?e.length:0;if(t=t&&"undefined"==typeof n?t:Q(t,n,3),"number"==typeof i)for(;i--&&t(e[i],i,e)!==!1;);else{var r=Zi(e);i=r.length,sr(e,function(e,n,o){return n=r?r[--i]:--i,t(o[n],n,o)})}return e}function Yt(e,t){var n=d(arguments,2),i=-1,r="function"==typeof t,o=e?e.length:0,a=hi("number"==typeof o?o:0);return Qt(e,function(e){a[++i]=(r?t:e[t]).apply(e,n)}),a}function Zt(e,t,n){var i=-1,r=e?e.length:0;if(t=p.createCallback(t,n,3),"number"==typeof r)for(var o=hi(r);++i<r;)o[i]=t(e[i],i,e);else o=[],sr(e,function(e,n,r){o[++i]=t(e,n,r)});return o}function en(e,t,n){var r=-1/0,o=r;if("function"!=typeof t&&n&&n[t]===e&&(t=null),null==t&&Gi(e))for(var a=-1,s=e.length;++a<s;){var l=e[a];l>o&&(o=l)}else t=null==t&&jt(e)?i:p.createCallback(t,n,3),Qt(e,function(e,n,i){var a=t(e,n,i);a>r&&(r=a,o=e)});return o}function tn(e,t,n){var r=1/0,o=r;if("function"!=typeof t&&n&&n[t]===e&&(t=null),null==t&&Gi(e))for(var a=-1,s=e.length;++a<s;){var l=e[a];o>l&&(o=l)}else t=null==t&&jt(e)?i:p.createCallback(t,n,3),Qt(e,function(e,n,i){var a=t(e,n,i);r>a&&(r=a,o=e)});return o}function nn(e,t){var n=-1,i=e?e.length:0;if("number"==typeof i)for(var r=hi(i);++n<i;)r[n]=e[n][t];return r||Zt(e,t)}function rn(e,t,n,i){if(!e)return n;var r=arguments.length<3;t=p.createCallback(t,i,4);var o=-1,a=e.length;if("number"==typeof a)for(r&&(n=e[++o]);++o<a;)n=t(n,e[o],o,e);else sr(e,function(e,i,o){n=r?(r=!1,e):t(n,e,i,o)});return n}function on(e,t,n,i){var r=arguments.length<3;return t=p.createCallback(t,i,4),Gt(e,function(e,i,o){n=r?(r=!1,e):t(n,e,i,o)}),n}function an(e,t,n){return t=p.createCallback(t,n,3),Jt(e,function(e,n,i){return!t(e,n,i)})}function sn(e,t,n){if(e&&"number"!=typeof e.length&&(e=Ft(e)),null==t||n)return e?e[ot(0,e.length-1)]:f;var i=ln(e);return i.length=Wi(zi(0,t),i.length),i}function ln(e){var t=-1,n=e?e.length:0,i=hi("number"==typeof n?n:0);return Qt(e,function(e){var n=ot(0,++t);i[t]=i[n],i[n]=e}),i}function cn(e){var t=e?e.length:0;return"number"==typeof t?t:Zi(e).length}function un(e,t,n){var i;t=p.createCallback(t,n,3);var r=-1,o=e?e.length:0;if("number"==typeof o)for(;++r<o&&!(i=t(e[r],r,e)););else sr(e,function(e,n,r){return!(i=t(e,n,r))});return!!i}function dn(e,t,n){var i=-1,o=e?e.length:0,a=hi("number"==typeof o?o:0);for(t=p.createCallback(t,n,3),Qt(e,function(e,n,r){var o=a[++i]=l();o.criteria=t(e,n,r),o.index=i,o.value=e}),o=a.length,a.sort(r);o--;){var s=a[o];a[o]=s.value,u(s)}return a}function hn(e){return e&&"number"==typeof e.length?d(e):Ft(e)}function fn(e){for(var t=-1,n=e?e.length:0,i=[];++t<n;){var r=e[t];r&&i.push(r)}return i}function pn(e){return tt(e,nt(arguments,!0,!0,1))}function gn(e,t,n){var i=-1,r=e?e.length:0;for(t=p.createCallback(t,n,3);++i<r;)if(t(e[i],i,e))return i;return-1}function mn(e,t,n){var i=e?e.length:0;for(t=p.createCallback(t,n,3);i--;)if(t(e[i],i,e))return i;return-1}function vn(e,t,n){var i=0,r=e?e.length:0;if("number"!=typeof t&&null!=t){var o=-1;for(t=p.createCallback(t,n,3);++o<r&&t(e[o],o,e);)i++}else if(i=t,null==i||n)return e?e[0]:f;return d(e,0,Wi(zi(0,i),r))}function yn(e,t,n,i){return"boolean"!=typeof t&&null!=t&&(i=n,n="function"!=typeof t&&i&&i[t]===e?null:t,t=!1),null!=n&&(e=Zt(e,n,i)),nt(e,t)}function bn(t,n,i){if("number"==typeof i){var r=t?t.length:0;i=0>i?zi(0,r+i):i||0}else if(i){var o=Sn(t,n);return t[o]===n?o:-1}return e(t,n,i)}function wn(e,t,n){var i=0,r=e?e.length:0;if("number"!=typeof t&&null!=t){var o=r;for(t=p.createCallback(t,n,3);o--&&t(e[o],o,e);)i++}else i=null==t||n?1:t||i;return d(e,0,Wi(zi(0,r-i),r))}function xn(n){for(var i=arguments,r=i.length,a=-1,l=s(),d=-1,h=ut(),f=n?n.length:0,p=[],g=s();++a<r;){var m=i[a];l[a]=h===e&&(m?m.length:0)>=y&&o(a?i[a]:g)}e:for(;++d<f;){var v=l[0];if(m=n[d],(v?t(v,m):h(g,m))<0){for(a=r,(v||g).push(m);--a;)if(v=l[a],(v?t(v,m):h(i[a],m))<0)continue e;p.push(m)}}for(;r--;)v=l[r],v&&u(v);return c(l),c(g),p}function Cn(e,t,n){var i=0,r=e?e.length:0;if("number"!=typeof t&&null!=t){var o=r;for(t=p.createCallback(t,n,3);o--&&t(e[o],o,e);)i++}else if(i=t,null==i||n)return e?e[r-1]:f;return d(e,zi(0,r-i))}function kn(e,t,n){var i=e?e.length:0;for("number"==typeof n&&(i=(0>n?zi(0,i+n):Wi(n,i-1))+1);i--;)if(e[i]===t)return i;return-1}function _n(e){for(var t=arguments,n=0,i=t.length,r=e?e.length:0;++n<i;)for(var o=-1,a=t[n];++o<r;)e[o]===a&&(ji.call(e,o--,1),r--);return e}function En(e,t,n){e=+e||0,n="number"==typeof n?n:+n||1,null==t&&(t=e,e=0);for(var i=-1,r=zi(0,Ni((t-e)/(n||1))),o=hi(r);++i<r;)o[i]=e,e+=n;return o}function Tn(e,t,n){var i=-1,r=e?e.length:0,o=[];for(t=p.createCallback(t,n,3);++i<r;){var a=e[i];t(a,i,e)&&(o.push(a),ji.call(e,i--,1),r--)}return o}function Nn(e,t,n){if("number"!=typeof t&&null!=t){var i=0,r=-1,o=e?e.length:0;for(t=p.createCallback(t,n,3);++r<o&&t(e[r],r,e);)i++}else i=null==t||n?1:zi(0,t);return d(e,i)}function Sn(e,t,n,i){var r=0,o=e?e.length:r;for(n=n?p.createCallback(n,i,1):Gn,t=n(t);o>r;){var a=r+o>>>1;n(e[a])<t?r=a+1:o=a}return r}function Rn(){return at(nt(arguments,!0,!0))}function $n(e,t,n,i){return"boolean"!=typeof t&&null!=t&&(i=n,n="function"!=typeof t&&i&&i[t]===e?null:t,t=!1),null!=n&&(n=p.createCallback(n,i,3)),at(e,t,n)}function An(e){return tt(e,d(arguments,1))}function On(){for(var e=arguments.length>1?arguments:arguments[0],t=-1,n=e?en(nn(e,"length")):0,i=hi(0>n?0:n);++t<n;)i[t]=nn(e,t);return i}function Dn(e,t){for(var n=-1,i=e?e.length:0,r={};++n<i;){var o=e[n];t?r[o]=t[n]:o&&(r[o[0]]=o[1])}return r}function Mn(e,t){if(!$t(t))throw new xi;return function(){return--e<1?t.apply(this,arguments):void 0}}function Bn(e,t){return arguments.length>2?lt(e,17,d(arguments,2),null,t):lt(e,1,null,null,t)}function jn(e){for(var t=arguments.length>1?nt(arguments,!0,!1,1):xt(e),n=-1,i=t.length;++n<i;){var r=t[n];e[r]=lt(e[r],1,null,null,e)}return e}function Pn(e,t){return arguments.length>2?lt(t,19,d(arguments,2),null,e):lt(t,3,null,null,e)}function Hn(){for(var e=arguments,t=e.length;t--;)if(!$t(e[t]))throw new xi;return function(){for(var t=arguments,n=e.length;n--;)t=[e[n].apply(this,t)];return t[0]}}function In(e,t,n){var i=typeof e;if(null==e||"function"==i)return Q(e,t,n);if("object"!=i)return function(t){return t[e]};var r=Zi(e),o=r[0],a=e[o];return 1!=r.length||a!==a||At(a)?function(t){for(var n=r.length,i=!1;n--&&(i=it(t[r[n]],e[r[n]],null,!0)););return i}:function(e){var t=e[o];return a===t&&(0!==a||1/a==1/t)}}function qn(e,t){return t="number"==typeof t?t:+t||e.length,lt(e,4,null,null,null,t)}function Vn(e,t,n){var i,r,o,a,s,l,c,u=0,d=!1,h=!0;if(!$t(e))throw new xi;if(t=zi(0,t)||0,n===!0){var p=!0;h=!1}else At(n)&&(p=n.leading,d="maxWait"in n&&(zi(t,n.maxWait)||0),h="trailing"in n?n.trailing:h);var g=function(){var n=t-(Di()-a);if(0>=n){r&&Si(r);var d=c;r=l=c=f,d&&(u=Di(),o=e.apply(s,i),l||r||(i=s=null))}else l=Bi(g,n)},m=function(){l&&Si(l),r=l=c=f,(h||d!==t)&&(u=Di(),o=e.apply(s,i),l||r||(i=s=null))};return function(){if(i=arguments,a=Di(),s=this,c=h&&(l||!p),d===!1)var n=p&&!l;else{r||p||(u=a);var f=d-(a-u),v=0>=f;v?(r&&(r=Si(r)),u=a,o=e.apply(s,i)):r||(r=Bi(m,f))}return v&&l?l=Si(l):l||t===d||(l=Bi(g,t)),n&&(v=!0,o=e.apply(s,i)),!v||l||r||(i=s=null),o}}function Ln(e){if(!$t(e))throw new xi;var t=d(arguments,1);return Bi(function(){e.apply(f,t)},1)}function Fn(e,t){if(!$t(e))throw new xi;var n=d(arguments,2);return Bi(function(){e.apply(f,n)},t)}function zn(e,t){if(!$t(e))throw new xi;var n=function(){var i=n.cache,r=t?t.apply(this,arguments):v+arguments[0];return Oi.call(i,r)?i[r]:i[r]=e.apply(this,arguments)};return n.cache={},n}function Wn(e){var t,n;if(!$t(e))throw new xi;return function(){return t?n:(t=!0,n=e.apply(this,arguments),e=null,n)}}function Un(e){return lt(e,16,d(arguments,1))}function Jn(e){return lt(e,32,null,d(arguments,1))}function Xn(e,t,n){var i=!0,r=!0;if(!$t(e))throw new xi;return n===!1?i=!1:At(n)&&(i="leading"in n?n.leading:i,r="trailing"in n?n.trailing:r),z.leading=i,z.maxWait=t,z.trailing=r,Vn(e,t,z)}function Kn(e,t){return lt(t,16,[e])}function Qn(e){return null==e?"":wi(e).replace(ir,ct)}function Gn(e){return e}function Yn(e,t){var n=e,i=!t||$t(n);t||(n=g,t=e,e=p),Qt(xt(t),function(r){var o=e[r]=t[r];i&&(n.prototype[r]=function(){var t=this.__wrapped__,i=[t];Mi.apply(i,arguments);var r=o.apply(e,i);return t&&"object"==typeof t&&t===r?this:(r=new n(r),r.__chain__=this.__chain__,r)})})}function Zn(){return n._=_i,this}function ei(){}function ti(e,t,n){var i=null==e,r=null==t;if(null==n&&("boolean"==typeof e&&r?(n=e,e=1):r||"boolean"!=typeof t||(n=t,r=!0)),i&&r&&(t=1),e=+e||0,r?(t=e,e=0):t=+t||0,n||e%1||t%1){var o=Ji();return Wi(e+o*(t-e+parseFloat("1e-"+((o+"").length-1))),t)}return ot(e,t)}function ni(e,t){if(e){var n=e[t];return $t(n)?e[t]():n}}function ii(e,t,n){var i=p.templateSettings;e=wi(e||""),n=or({},n,i);var r,o=or({},n.imports,i.imports),s=Zi(o),l=Ft(o),c=0,u=n.interpolate||R,d="__p += '",h=bi((n.escape||R).source+"|"+u.source+"|"+(u===N?_:R).source+"|"+(n.evaluate||R).source+"|$","g");e.replace(h,function(t,n,i,o,s,l){return i||(i=o),d+=e.slice(c,l).replace(A,a),n&&(d+="' +\n__e("+n+") +\n'"),s&&(r=!0,d+="';\n"+s+";\n__p += '"),i&&(d+="' +\n((__t = ("+i+")) == null ? '' : __t) +\n'"),c=l+t.length,t}),d+="';\n";var g=n.variable,m=g;m||(g="obj",d="with ("+g+") {\n"+d+"\n}\n"),d=(r?d.replace(x,""):d).replace(C,"$1").replace(k,"$1;"),d="function("+g+") {\n"+(m?"":g+" || ("+g+" = {});\n")+"var __t, __p = '', __e = _.escape"+(r?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var v="\n/*\n//# sourceURL="+(n.sourceURL||"/lodash/template/source["+D++ +"]")+"\n*/";try{var y=gi(s,"return "+d+v).apply(f,l)}catch(b){throw b.source=d,b}return t?y(t):(y.source=d,y)}function ri(e,t,n){e=(e=+e)>-1?e:0;var i=-1,r=hi(e);for(t=Q(t,n,1);++i<e;)r[i]=t(i);return r}function oi(e){return null==e?"":wi(e).replace(nr,ht)}function ai(e){var t=++m;return wi(null==e?"":e)+t}function si(e){return e=new g(e),e.__chain__=!0,e}function li(e,t){return t(e),e}function ci(){return this.__chain__=!0,this}function ui(){return wi(this.__wrapped__)}function di(){return this.__wrapped__}n=n?Z.defaults(X.Object(),n,Z.pick(X,O)):X;var hi=n.Array,fi=n.Boolean,pi=n.Date,gi=n.Function,mi=n.Math,vi=n.Number,yi=n.Object,bi=n.RegExp,wi=n.String,xi=n.TypeError,Ci=[],ki=yi.prototype,_i=n._,Ei=ki.toString,Ti=bi("^"+wi(Ei).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),Ni=mi.ceil,Si=n.clearTimeout,Ri=mi.floor,$i=gi.prototype.toString,Ai=Ti.test(Ai=yi.getPrototypeOf)&&Ai,Oi=ki.hasOwnProperty,Di=Ti.test(Di=pi.now)&&Di||function(){return+new pi},Mi=Ci.push,Bi=n.setTimeout,ji=Ci.splice,Pi="function"==typeof(Pi=Y&&G&&Y.setImmediate)&&!Ti.test(Pi)&&Pi,Hi=function(){try{var e={},t=Ti.test(t=yi.defineProperty)&&t,n=t(e,e,e)&&t}catch(i){}return n}(),Ii=Ti.test(Ii=yi.create)&&Ii,qi=Ti.test(qi=hi.isArray)&&qi,Vi=n.isFinite,Li=n.isNaN,Fi=Ti.test(Fi=yi.keys)&&Fi,zi=mi.max,Wi=mi.min,Ui=n.parseInt,Ji=mi.random,Xi={};Xi[B]=hi,Xi[j]=fi,Xi[P]=pi,Xi[H]=gi,Xi[q]=yi,Xi[I]=vi,Xi[V]=bi,Xi[L]=wi,g.prototype=p.prototype;var Ki=p.support={};Ki.funcDecomp=!Ti.test(n.WinRTError)&&$.test(h),Ki.funcNames="string"==typeof gi.name,p.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:N,variable:"",imports:{_:p}},Ii||(K=function(){function e(){}return function(t){if(At(t)){e.prototype=t;var i=new e;e.prototype=null}return i||n.Object()}}());var Qi=Hi?function(e,t){W.value=t,Hi(e,"__bindData__",W)}:ei,Gi=qi||function(e){return e&&"object"==typeof e&&"number"==typeof e.length&&Ei.call(e)==B||!1},Yi=function(e){var t,n=e,i=[];if(!n)return i;if(!U[typeof e])return i;for(t in n)Oi.call(n,t)&&i.push(t);return i},Zi=Fi?function(e){return At(e)?Fi(e):[]}:Yi,er={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},tr=kt(er),nr=bi("("+Zi(tr).join("|")+")","g"),ir=bi("["+Zi(er).join("")+"]","g"),rr=function(e,t,n){var i,r=e,o=r;if(!r)return o;var a=arguments,s=0,l="number"==typeof n?2:a.length;if(l>3&&"function"==typeof a[l-2])var c=Q(a[--l-1],a[l--],2);else l>2&&"function"==typeof a[l-1]&&(c=a[--l]);for(;++s<l;)if(r=a[s],r&&U[typeof r])for(var u=-1,d=U[typeof r]&&Zi(r),h=d?d.length:0;++u<h;)i=d[u],o[i]=c?c(o[i],r[i]):r[i];return o},or=function(e,t,n){var i,r=e,o=r;if(!r)return o;for(var a=arguments,s=0,l="number"==typeof n?2:a.length;++s<l;)if(r=a[s],r&&U[typeof r])for(var c=-1,u=U[typeof r]&&Zi(r),d=u?u.length:0;++c<d;)i=u[c],"undefined"==typeof o[i]&&(o[i]=r[i]);return o},ar=function(e,t,n){var i,r=e,o=r;if(!r)return o;if(!U[typeof r])return o;t=t&&"undefined"==typeof n?t:Q(t,n,3);for(i in r)if(t(r[i],i,e)===!1)return o;return o},sr=function(e,t,n){var i,r=e,o=r;if(!r)return o;if(!U[typeof r])return o;t=t&&"undefined"==typeof n?t:Q(t,n,3);for(var a=-1,s=U[typeof r]&&Zi(r),l=s?s.length:0;++a<l;)if(i=s[a],t(r[i],i,e)===!1)return o;return o},lr=function(e){if(!e||Ei.call(e)!=q)return!1;var t=e.valueOf,n="function"==typeof t&&(n=Ai(t))&&Ai(n);return n?e==n||Ai(e)==n:dt(e)},cr=st(function(e,t,n){Oi.call(e,n)?e[n]++:e[n]=1}),ur=st(function(e,t,n){(Oi.call(e,n)?e[n]:e[n]=[]).push(t)}),dr=st(function(e,t,n){e[n]=t}),hr=Jt;Pi&&(Ln=function(e){if(!$t(e))throw new xi;return Pi.apply(n,arguments)});var fr=8==Ui(w+"08")?Ui:function(e,t){return Ui(jt(e)?e.replace(S,""):e,t||0)};return p.after=Mn,p.assign=rr,p.at=zt,p.bind=Bn,p.bindAll=jn,p.bindKey=Pn,p.chain=si,p.compact=fn,p.compose=Hn,p.countBy=cr,p.create=mt,p.createCallback=In,p.curry=qn,p.debounce=Vn,p.defaults=or,p.defer=Ln,p.delay=Fn,p.difference=pn,p.filter=Jt,p.flatten=yn,p.forEach=Qt,p.forEachRight=Gt,p.forIn=ar,p.forInRight=bt,p.forOwn=sr,p.forOwnRight=wt,p.functions=xt,p.groupBy=ur,p.indexBy=dr,p.initial=wn,p.intersection=xn,p.invert=kt,p.invoke=Yt,p.keys=Zi,p.map=Zt,p.max=en,p.memoize=zn,p.merge=Ht,p.min=tn,p.omit=It,p.once=Wn,p.pairs=qt,p.partial=Un,p.partialRight=Jn,p.pick=Vt,p.pluck=nn,p.pull=_n,p.range=En,p.reject=an,p.remove=Tn,p.rest=Nn,p.shuffle=ln,p.sortBy=dn,p.tap=li,p.throttle=Xn,p.times=ri,p.toArray=hn,p.transform=Lt,p.union=Rn,p.uniq=$n,p.values=Ft,p.where=hr,p.without=An,p.wrap=Kn,p.zip=On,p.zipObject=Dn,p.collect=Zt,p.drop=Nn,p.each=Qt,p.eachRight=Gt,p.extend=rr,p.methods=xt,p.object=Dn,p.select=Jt,p.tail=Nn,p.unique=$n,p.unzip=On,Yn(p),p.clone=pt,p.cloneDeep=gt,p.contains=Wt,p.escape=Qn,p.every=Ut,p.find=Xt,p.findIndex=gn,p.findKey=vt,p.findLast=Kt,p.findLastIndex=mn,p.findLastKey=yt,p.has=Ct,p.identity=Gn,p.indexOf=bn,p.isArguments=ft,p.isArray=Gi,p.isBoolean=_t,p.isDate=Et,p.isElement=Tt,p.isEmpty=Nt,p.isEqual=St,p.isFinite=Rt,p.isFunction=$t,p.isNaN=Ot,p.isNull=Dt,p.isNumber=Mt,p.isObject=At,p.isPlainObject=lr,p.isRegExp=Bt,p.isString=jt,p.isUndefined=Pt,p.lastIndexOf=kn,p.mixin=Yn,p.noConflict=Zn,p.noop=ei,p.parseInt=fr,p.random=ti,p.reduce=rn,p.reduceRight=on,p.result=ni,p.runInContext=h,p.size=cn,p.some=un,p.sortedIndex=Sn,p.template=ii,p.unescape=oi,p.uniqueId=ai,p.all=Ut,p.any=un,p.detect=Xt,p.findWhere=Xt,p.foldl=rn,p.foldr=on,p.include=Wt,p.inject=rn,sr(p,function(e,t){p.prototype[t]||(p.prototype[t]=function(){var t=[this.__wrapped__],n=this.__chain__;Mi.apply(t,arguments);var i=e.apply(p,t);return n?new g(i,n):i})}),p.first=vn,p.last=Cn,p.sample=sn,p.take=vn,p.head=vn,sr(p,function(e,t){var n="sample"!==t;p.prototype[t]||(p.prototype[t]=function(t,i){var r=this.__chain__,o=e(this.__wrapped__,t,i);return r||null!=t&&(!i||n&&"function"==typeof t)?new g(o,r):o})}),p.VERSION="2.3.0",p.prototype.chain=ci,p.prototype.toString=ui,p.prototype.value=di,p.prototype.valueOf=di,Qt(["join","pop","shift"],function(e){var t=Ci[e];p.prototype[e]=function(){var e=this.__chain__,n=t.apply(this.__wrapped__,arguments);return e?new g(n,e):n}}),Qt(["push","reverse","sort","unshift"],function(e){var t=Ci[e];p.prototype[e]=function(){return t.apply(this.__wrapped__,arguments),this}}),Qt(["concat","slice","splice"],function(e){var t=Ci[e];p.prototype[e]=function(){return new g(t.apply(this.__wrapped__,arguments),this.__chain__)}}),p}var f,p=[],g=[],m=0,v=+new Date+"",y=75,b=40,w=" 	\f ﻿\n\r\u2028\u2029 ᠎             　",x=/\b__p \+= '';/g,C=/\b(__p \+=) '' \+/g,k=/(__e\(.*?\)|\b__t\)) \+\n'';/g,_=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,E=/\w*$/,T=/^\s*function[ \n\r\t]+\w/,N=/<%=([\s\S]+?)%>/g,S=RegExp("^["+w+"]*0+(?=.$)"),R=/($^)/,$=/\bthis\b/,A=/['\n\r\t\u2028\u2029\\]/g,O=["Array","Boolean","Date","Function","Math","Number","Object","RegExp","String","_","attachEvent","clearTimeout","isFinite","isNaN","parseInt","setImmediate","setTimeout"],D=0,M="[object Arguments]",B="[object Array]",j="[object Boolean]",P="[object Date]",H="[object Function]",I="[object Number]",q="[object Object]",V="[object RegExp]",L="[object String]",F={};F[H]=!1,F[M]=F[B]=F[j]=F[P]=F[I]=F[q]=F[V]=F[L]=!0;var z={leading:!1,maxWait:0,trailing:!1},W={configurable:!1,enumerable:!1,value:null,writable:!1},U={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},J={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"},X=U[typeof window]&&window||this,K=U[typeof exports]&&exports&&!exports.nodeType&&exports,Q=U[typeof module]&&module&&!module.nodeType&&module,G=Q&&Q.exports===K&&K,Y=U[typeof global]&&global;!Y||Y.global!==Y&&Y.window!==Y||(X=Y);var Z=h();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(X._=Z,define("underscore",[],function(){return Z})):K&&Q?G?(Q.exports=Z)._=Z:K._=Z:X._=Z}.call(this),function(e){function t(){return"Markdown.mk_block( "+uneval(this.toString())+", "+uneval(this.trailing)+", "+uneval(this.lineNumber)+" )"}function n(){var e=require("util");return"Markdown.mk_block( "+e.inspect(this.toString())+", "+e.inspect(this.trailing)+", "+e.inspect(this.lineNumber)+" )"}function i(e){for(var t=0,n=-1;-1!==(n=e.indexOf("\n",n+1));)t++;return t}function r(e,t){function n(e){this.len_after=e,this.name="close_"+t}var i=e+"_state",r="strong"==e?"em_state":"strong_state";return function(o){if(this[i][0]==t)return this[i].shift(),[o.length,new n(o.length-t.length)];var a=this[r].slice(),s=this[i].slice();this[i].unshift(t);{var l=this.processInline(o.substr(t.length)),c=l[l.length-1];this[i].shift()}if(c instanceof n){l.pop();var u=o.length-c.len_after;return[u,[e].concat(l)]}return this[r]=a,this[i]=s,[t.length,t]}}function o(e){for(var t=e.split(""),n=[""],i=!1;t.length;){var r=t.shift();switch(r){case" ":i?n[n.length-1]+=r:n.push("");break;case"'":case'"':i=!i;break;case"\\":r=t.shift();default:n[n.length-1]+=r}}return n}function s(e){return m(e)&&e.length>1&&"object"==typeof e[1]&&!m(e[1])?e[1]:void 0}function l(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function c(e){if("string"==typeof e)return l(e);var t=e.shift(),n={},i=[];for(!e.length||"object"!=typeof e[0]||e[0]instanceof Array||(n=e.shift());e.length;)i.push(c(e.shift()));var r="";for(var o in n)r+=" "+o+'="'+l(n[o])+'"';return"img"==t||"br"==t||"hr"==t?"<"+t+r+"/>":"<"+t+r+">"+i.join("")+"</"+t+">"}function u(e,t,n){var i;n=n||{};var r=e.slice(0);"function"==typeof n.preprocessTreeNode&&(r=n.preprocessTreeNode(r,t));var o=s(r);if(o){r[1]={};for(i in o)r[1][i]=o[i];o=r[1]}if("string"==typeof r)return r;switch(r[0]){case"header":r[0]="h"+r[1].level,delete r[1].level;break;case"bulletlist":r[0]="ul";break;case"numberlist":r[0]="ol";break;case"listitem":r[0]="li";
break;case"para":r[0]="p";break;case"markdown":r[0]="html",o&&delete o.references;break;case"code_block":r[0]="pre",i=o?2:1;var a=["code"];a.push.apply(a,r.splice(i,r.length-i)),r[i]=a;break;case"inlinecode":r[0]="code";break;case"img":r[1].src=r[1].href,delete r[1].href;break;case"linebreak":r[0]="br";break;case"link":r[0]="a";break;case"link_ref":r[0]="a";var l=t[o.ref];if(!l)return o.original;delete o.ref,o.href=l.href,l.title&&(o.title=l.title),delete o.original;break;case"img_ref":r[0]="img";var l=t[o.ref];if(!l)return o.original;delete o.ref,o.src=l.href,l.title&&(o.title=l.title),delete o.original}if(i=1,o){for(var c in r[1]){i=2;break}1===i&&r.splice(i,1)}for(;i<r.length;++i)r[i]=u(r[i],t,n);return r}function d(e){for(var t=s(e)?2:1;t<e.length;)"string"==typeof e[t]?t+1<e.length&&"string"==typeof e[t+1]?e[t]+=e.splice(t+1,1)[0]:++t:(d(e[t]),++t)}var h=e.Markdown=function(e){switch(typeof e){case"undefined":this.dialect=h.dialects.Gruber;break;case"object":this.dialect=e;break;default:if(!(e in h.dialects))throw new Error("Unknown Markdown dialect '"+String(e)+"'");this.dialect=h.dialects[e]}this.em_state=[],this.strong_state=[],this.debug_indent=""};e.parse=function(e,t){var n=new h(t);return n.toTree(e)},e.toHTML=function(t,n,i){var r=e.toHTMLTree(t,n,i);return e.renderJsonML(r)},e.toHTMLTree=function(e,t,n){"string"==typeof e&&(e=this.parse(e,t));var i=s(e),r={};i&&i.references&&(r=i.references);var o=u(e,r,n);return d(o),o};var f=h.mk_block=function(e,i,r){1==arguments.length&&(i="\n\n");var o=new String(e);return o.trailing=i,o.inspect=n,o.toSource=t,void 0!=r&&(o.lineNumber=r),o};h.prototype.split_blocks=function(e){e=e.replace(/(\r\n|\n|\r)/g,"\n");var t,n=/([\s\S]+?)($|\n#|\n(?:\s*\n|$)+)/g,r=[],o=1;for(null!=(t=/^(\s*\n)/.exec(e))&&(o+=i(t[0]),n.lastIndex=t[0].length);null!==(t=n.exec(e));)"\n#"==t[2]&&(t[2]="\n",n.lastIndex--),r.push(f(t[1],t[2],o)),o+=i(t[0]);return r},h.prototype.processBlock=function(e,t){var n=this.dialect.block,i=n.__order__;if("__call__"in n)return n.__call__.call(this,e,t);for(var r=0;r<i.length;r++){var o=n[i[r]].call(this,e,t);if(o)return(!m(o)||o.length>0&&!m(o[0]))&&this.debug(i[r],"didn't return a proper array"),o}return[]},h.prototype.processInline=function(e){return this.dialect.inline.__call__.call(this,String(e))},h.prototype.toTree=function(e,t){var n=e instanceof Array?e:this.split_blocks(e),i=this.tree;try{for(this.tree=t||this.tree||["markdown"];n.length;){var r=this.processBlock(n.shift(),n);r.length&&this.tree.push.apply(this.tree,r)}return this.tree}finally{t&&(this.tree=i)}},h.prototype.debug=function(){var e=Array.prototype.slice.call(arguments);e.unshift(this.debug_indent),"undefined"!=typeof print&&print.apply(print,e),"undefined"!=typeof console&&"undefined"!=typeof console.log&&console.log.apply(null,e)},h.prototype.loop_re_over_block=function(e,t,n){for(var i,r=t.valueOf();r.length&&null!=(i=e.exec(r));)r=r.substr(i[0].length),n.call(this,i);return r},h.dialects={},h.dialects.Gruber={block:{atxHeader:function(e,t){var n=e.match(/^(#{1,6})\s*(.*?)\s*#*\s*(?:\n|$)/);if(!n)return void 0;var i=["header",{level:n[1].length}];return Array.prototype.push.apply(i,this.processInline(n[2])),n[0].length<e.length&&t.unshift(f(e.substr(n[0].length),e.trailing,e.lineNumber+2)),[i]},setextHeader:function(e,t){var n=e.match(/^(.*)\n([-=])\2\2+(?:\n|$)/);if(!n)return void 0;var i="="===n[2]?1:2,r=["header",{level:i},n[1]];return n[0].length<e.length&&t.unshift(f(e.substr(n[0].length),e.trailing,e.lineNumber+2)),[r]},code:function(e,t){var n=[],i=/^(?: {0,3}\t| {4})(.*)\n?/;if(!e.match(i))return void 0;e:for(;;){var r=this.loop_re_over_block(i,e.valueOf(),function(e){n.push(e[1])});if(r.length){t.unshift(f(r,e.trailing));break e}if(!t.length)break e;if(!t[0].match(i))break e;n.push(e.trailing.replace(/[^\n]/g,"").substring(2)),e=t.shift()}return[["code_block",n.join("\n")]]},horizRule:function(e,t){var n=e.match(/^(?:([\s\S]*?)\n)?[ \t]*([-_*])(?:[ \t]*\2){2,}[ \t]*(?:\n([\s\S]*))?$/);if(!n)return void 0;var i=[["hr"]];return n[1]&&i.unshift.apply(i,this.processBlock(n[1],[])),n[3]&&t.unshift(f(n[3])),i},lists:function(){function e(e){return new RegExp("(?:^("+l+"{0,"+e+"} {0,3})("+o+")\\s+)|(^"+l+"{0,"+(e-1)+"}[ ]{0,4})")}function t(e){return e.replace(/ {0,3}\t/g,"    ")}function n(e,t,n,i){if(t)return e.push(["para"].concat(n)),void 0;var r=e[e.length-1]instanceof Array&&"para"==e[e.length-1][0]?e[e.length-1]:e;i&&e.length>1&&n.unshift(i);for(var o=0;o<n.length;o++){var a=n[o],s="string"==typeof a;s&&r.length>1&&"string"==typeof r[r.length-1]?r[r.length-1]+=a:r.push(a)}}function i(e,t){for(var n=new RegExp("^("+l+"{"+e+"}.*?\\n?)*$"),i=new RegExp("^"+l+"{"+e+"}","gm"),r=[];t.length>0&&n.exec(t[0]);){var o=t.shift(),a=o.replace(i,"");r.push(f(a,o.trailing,o.lineNumber))}return r}function r(e,t,n){var i=e.list,r=i[i.length-1];if(!(r[1]instanceof Array&&"para"==r[1][0]))if(t+1==n.length)r.push(["para"].concat(r.splice(1,r.length-1)));else{var o=r.pop();r.push(["para"].concat(r.splice(1,r.length-1)),o)}}var o="[*+-]|\\d+\\.",a=/[*+-]/,s=new RegExp("^( {0,3})("+o+")[ 	]+"),l="(?: {0,3}\\t| {4})";return function(o,l){function c(e){var t=a.exec(e[2])?["bulletlist"]:["numberlist"];return f.push({list:t,indent:e[1]}),t}var u=o.match(s);if(!u)return void 0;for(var d,h,f=[],p=c(u),m=!1,v=[f[0].list];;){for(var y=o.split(/(?=\n)/),b="",w=0;w<y.length;w++){var x="",C=y[w].replace(/^\n/,function(e){return x=e,""}),k=e(f.length);if(u=C.match(k),void 0!==u[1]){b.length&&(n(d,m,this.processInline(b),x),m=!1,b=""),u[1]=t(u[1]);var _=Math.floor(u[1].length/4)+1;if(_>f.length)p=c(u),d.push(p),d=p[1]=["listitem"];else{var E=!1;for(h=0;h<f.length;h++)if(f[h].indent==u[1]){p=f[h].list,f.splice(h+1,f.length-(h+1)),E=!0;break}E||(_++,_<=f.length?(f.splice(_,f.length-_),p=f[_-1].list):(p=c(u),d.push(p))),d=["listitem"],p.push(d)}x=""}C.length>u[0].length&&(b+=x+C.substr(u[0].length))}b.length&&(n(d,m,this.processInline(b),x),m=!1,b="");var T=i(f.length,l);T.length>0&&(g(f,r,this),d.push.apply(d,this.toTree(T,[])));var N=l[0]&&l[0].valueOf()||"";if(!N.match(s)&&!N.match(/^ /))break;o=l.shift();var S=this.dialect.block.horizRule(o,l);if(S){v.push.apply(v,S);break}g(f,r,this),m=!0}return v}}(),blockquote:function(e,t){if(!e.match(/^>/m))return void 0;var n=[];if(">"!=e[0]){for(var i=e.split(/\n/),r=[],o=e.lineNumber;i.length&&">"!=i[0][0];)r.push(i.shift()),o++;var a=f(r.join("\n"),"\n",e.lineNumber);n.push.apply(n,this.processBlock(a,[])),e=f(i.join("\n"),e.trailing,o)}for(;t.length&&">"==t[0][0];){var l=t.shift();e=f(e+e.trailing+l,l.trailing,e.lineNumber)}var c=e.replace(/^> ?/gm,""),u=(this.tree,this.toTree(c,["blockquote"])),d=s(u);return d&&d.references&&(delete d.references,v(d)&&u.splice(1,1)),n.push(u),n},referenceDefn:function(e,t){var n=/^\s*\[(.*?)\]:\s*(\S+)(?:\s+(?:(['"])(.*?)\3|\((.*?)\)))?\n?/;if(!e.match(n))return void 0;s(this.tree)||this.tree.splice(1,0,{});var i=s(this.tree);void 0===i.references&&(i.references={});var r=this.loop_re_over_block(n,e,function(e){e[2]&&"<"==e[2][0]&&">"==e[2][e[2].length-1]&&(e[2]=e[2].substring(1,e[2].length-1));var t=i.references[e[1].toLowerCase()]={href:e[2]};void 0!==e[4]?t.title=e[4]:void 0!==e[5]&&(t.title=e[5])});return r.length&&t.unshift(f(r,e.trailing)),[]},para:function(e){return[["para"].concat(this.processInline(e))]}}},h.dialects.Gruber.inline={__oneElement__:function(e,t,n){var i,r;t=t||this.dialect.inline.__patterns__;var o=new RegExp("([\\s\\S]*?)("+(t.source||t)+")");if(i=o.exec(e),!i)return[e.length,e];if(i[1])return[i[1].length,i[1]];var r;return i[2]in this.dialect.inline&&(r=this.dialect.inline[i[2]].call(this,e.substr(i.index),i,n||[])),r=r||[i[2].length,i[2]]},__call__:function(e,t){function n(e){"string"==typeof e&&"string"==typeof r[r.length-1]?r[r.length-1]+=e:r.push(e)}for(var i,r=[];e.length>0;)i=this.dialect.inline.__oneElement__.call(this,e,t,r),e=e.substr(i.shift()),g(i,n);return r},"]":function(){},"}":function(){},__escape__:/^\\[\\`\*_{}\[\]()#\+.!\-]/,"\\":function(e){return this.dialect.inline.__escape__.exec(e)?[2,e.charAt(1)]:[1,"\\"]},"![":function(e){var t=e.match(/^!\[(.*?)\][ \t]*\([ \t]*([^")]*?)(?:[ \t]+(["'])(.*?)\3)?[ \t]*\)/);if(t){t[2]&&"<"==t[2][0]&&">"==t[2][t[2].length-1]&&(t[2]=t[2].substring(1,t[2].length-1)),t[2]=this.dialect.inline.__call__.call(this,t[2],/\\/)[0];var n={alt:t[1],href:t[2]||""};return void 0!==t[4]&&(n.title=t[4]),[t[0].length,["img",n]]}return t=e.match(/^!\[(.*?)\][ \t]*\[(.*?)\]/),t?[t[0].length,["img_ref",{alt:t[1],ref:t[2].toLowerCase(),original:t[0]}]]:[2,"!["]},"[":function y(e){var t=String(e),n=h.DialectHelpers.inline_until_char.call(this,e.substr(1),"]");if(!n)return[1,"["];var y,i,r=1+n[0],o=n[1];e=e.substr(r);var a=e.match(/^\s*\([ \t]*([^"']*)(?:[ \t]+(["'])(.*?)\2)?[ \t]*\)/);if(a){var s=a[1];if(r+=a[0].length,s&&"<"==s[0]&&">"==s[s.length-1]&&(s=s.substring(1,s.length-1)),!a[3])for(var l=1,c=0;c<s.length;c++)switch(s[c]){case"(":l++;break;case")":0==--l&&(r-=s.length-c,s=s.substring(0,c))}return s=this.dialect.inline.__call__.call(this,s,/\\/)[0],i={href:s||""},void 0!==a[3]&&(i.title=a[3]),y=["link",i].concat(o),[r,y]}return a=e.match(/^\s*\[(.*?)\]/),a?(r+=a[0].length,i={ref:(a[1]||String(o)).toLowerCase(),original:t.substr(0,r)},y=["link_ref",i].concat(o),[r,y]):1==o.length&&"string"==typeof o[0]?(i={ref:o[0].toLowerCase(),original:t.substr(0,r)},y=["link_ref",i,o[0]],[r,y]):[1,"["]},"<":function(e){var t;return null!=(t=e.match(/^<(?:((https?|ftp|mailto):[^>]+)|(.*?@.*?\.[a-zA-Z]+))>/))?t[3]?[t[0].length,["link",{href:"mailto:"+t[3]},t[3]]]:"mailto"==t[2]?[t[0].length,["link",{href:t[1]},t[1].substr("mailto:".length)]]:[t[0].length,["link",{href:t[1]},t[1]]]:[1,"<"]},"`":function(e){var t=e.match(/(`+)(([\s\S]*?)\1)/);return t&&t[2]?[t[1].length+t[2].length,["inlinecode",t[3]]]:[1,"`"]},"  \n":function(){return[3,["linebreak"]]}},h.dialects.Gruber.inline["**"]=r("strong","**"),h.dialects.Gruber.inline.__=r("strong","__"),h.dialects.Gruber.inline["*"]=r("em","*"),h.dialects.Gruber.inline._=r("em","_"),h.buildBlockOrder=function(e){var t=[];for(var n in e)"__order__"!=n&&"__call__"!=n&&t.push(n);e.__order__=t},h.buildInlinePatterns=function(e){var t=[];for(var n in e)if(!n.match(/^__.*__$/)){var i=n.replace(/([\\.*+?|()\[\]{}])/g,"\\$1").replace(/\n/,"\\n");t.push(1==n.length?i:"(?:"+i+")")}t=t.join("|"),e.__patterns__=t;var r=e.__call__;e.__call__=function(e,n){return void 0!=n?r.call(this,e,n):r.call(this,e,t)}},h.DialectHelpers={},h.DialectHelpers.inline_until_char=function(e,t){for(var n=0,i=[];;){if(e.charAt(n)==t)return n++,[n,i];if(n>=e.length)return null;var r=this.dialect.inline.__oneElement__.call(this,e.substr(n));n+=r[0],i.push.apply(i,r.slice(1))}},h.subclassDialect=function(e){function t(){}function n(){}return t.prototype=e.block,n.prototype=e.inline,{block:new t,inline:new n}},h.buildBlockOrder(h.dialects.Gruber.block),h.buildInlinePatterns(h.dialects.Gruber.inline),h.dialects.Maruku=h.subclassDialect(h.dialects.Gruber),h.dialects.Maruku.processMetaHash=function(e){for(var t=o(e),n={},i=0;i<t.length;++i)if(/^#/.test(t[i]))n.id=t[i].substring(1);else if(/^\./.test(t[i]))n["class"]=n["class"]?n["class"]+t[i].replace(/./," "):t[i].substring(1);else if(/\=/.test(t[i])){var r=t[i].split(/\=/);n[r[0]]=r[1]}return n},h.dialects.Maruku.block.document_meta=function(e){if(e.lineNumber>1)return void 0;if(!e.match(/^(?:\w+:.*\n)*\w+:.*$/))return void 0;s(this.tree)||this.tree.splice(1,0,{});var t=e.split(/\n/);for(p in t){var n=t[p].match(/(\w+):\s*(.*)$/),i=n[1].toLowerCase(),r=n[2];this.tree[1][i]=r}return[]},h.dialects.Maruku.block.block_meta=function(e){var t=e.match(/(^|\n) {0,3}\{:\s*((?:\\\}|[^\}])*)\s*\}$/);if(!t)return void 0;var n,i=this.dialect.processMetaHash(t[2]);if(""===t[1]){var r=this.tree[this.tree.length-1];if(n=s(r),"string"==typeof r)return void 0;n||(n={},r.splice(1,0,n));for(a in i)n[a]=i[a];return[]}var o=e.replace(/\n.*$/,""),l=this.processBlock(o,[]);n=s(l[0]),n||(n={},l[0].splice(1,0,n));for(a in i)n[a]=i[a];return l},h.dialects.Maruku.block.definition_list=function(e,t){var n,i,r=/^((?:[^\s:].*\n)+):\s+([\s\S]+)$/,o=["dl"];if(!(i=e.match(r)))return void 0;for(var a=[e];t.length&&r.exec(t[0]);)a.push(t.shift());for(var s=0;s<a.length;++s){var i=a[s].match(r),l=i[1].replace(/\n$/,"").split(/\n/),c=i[2].split(/\n:\s+/);for(n=0;n<l.length;++n)o.push(["dt",l[n]]);for(n=0;n<c.length;++n)o.push(["dd"].concat(this.processInline(c[n].replace(/(\n)\s+/,"$1"))))}return[o]},h.dialects.Maruku.block.table=function b(e){var t,n,i=function(e,t){t=t||"\\s",t.match(/^[\\|\[\]{}?*.+^$]$/)&&(t="\\"+t);for(var n,i=[],r=new RegExp("^((?:\\\\.|[^\\\\"+t+"])*)"+t+"(.*)");n=e.match(r);)i.push(n[1]),e=n[2];return i.push(e),i},r=/^ {0,3}\|(.+)\n {0,3}\|\s*([\-:]+[\-| :]*)\n((?:\s*\|.*(?:\n|$))*)(?=\n|$)/,o=/^ {0,3}(\S(?:\\.|[^\\|])*\|.*)\n {0,3}([\-:]+\s*\|[\-| :]*)\n((?:(?:\\.|[^\\|])*\|.*(?:\n|$))*)(?=\n|$)/;if(n=e.match(r))n[3]=n[3].replace(/^\s*\|/gm,"");else if(!(n=e.match(o)))return void 0;var b=["table",["thead",["tr"]],["tbody"]];n[2]=n[2].replace(/\|\s*$/,"").split("|");var a=[];for(g(n[2],function(e){e.match(/^\s*-+:\s*$/)?a.push({align:"right"}):e.match(/^\s*:-+\s*$/)?a.push({align:"left"}):e.match(/^\s*:-+:\s*$/)?a.push({align:"center"}):a.push({})}),n[1]=i(n[1].replace(/\|\s*$/,""),"|"),t=0;t<n[1].length;t++)b[1][1].push(["th",a[t]||{}].concat(this.processInline(n[1][t].trim())));return g(n[3].replace(/\|\s*$/gm,"").split("\n"),function(e){var n=["tr"];for(e=i(e,"|"),t=0;t<e.length;t++)n.push(["td",a[t]||{}].concat(this.processInline(e[t].trim())));b[2].push(n)},this),[b]},h.dialects.Maruku.inline["{:"]=function(e,t,n){if(!n.length)return[2,"{:"];var i=n[n.length-1];if("string"==typeof i)return[2,"{:"];var r=e.match(/^\{:\s*((?:\\\}|[^\}])*)\s*\}/);if(!r)return[2,"{:"];var o=this.dialect.processMetaHash(r[1]),a=s(i);a||(a={},i.splice(1,0,a));for(var l in o)a[l]=o[l];return[r[0].length,""]},h.dialects.Maruku.inline.__escape__=/^\\[\\`\*_{}\[\]()#\+.!\-|:]/,h.buildBlockOrder(h.dialects.Maruku.block),h.buildInlinePatterns(h.dialects.Maruku.inline);var g,m=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)};g=Array.prototype.forEach?function(e,t,n){return e.forEach(t,n)}:function(e,t,n){for(var i=0;i<e.length;i++)t.call(n||e,e[i],i,e)};var v=function(e){for(var t in e)if(hasOwnProperty.call(e,t))return!1;return!0};e.renderJsonML=function(e,t){t=t||{},t.root=t.root||!1;var n=[];if(t.root)n.push(c(e));else for(e.shift(),!e.length||"object"!=typeof e[0]||e[0]instanceof Array||e.shift();e.length;)n.push(c(e.shift()));return n.join("\n\n")}}(function(){return"undefined"==typeof exports?(window.markdown={},window.markdown):exports}()),define("markdown",[],function(){return markdown}),define("orderedcollection",["backbone"],function(e){var t=e.Collection.prototype,n=e.Collection.extend({contiguous:!0,comp:function(e){var t=this.comparator;return"string"==typeof t?e.get(t):t(e)},add:function(e,n){if(e){e.cid||(e=new this.model(e));var i=this.comp(e);"undefined"==typeof i?(i=this.length,"string"==typeof this.comparator&&e.set(this.comparator,i)):(i>=this.length&&this.contiguous&&(i=this.length,e.set(this.comparator,i)),this.updatePosition(i,!0)),n=n||{},n.at=i}t.add.call(this,e)},remove:function(e,n){e&&(order=this.comp(e),t.remove.call(this,e,n)),this.updatePosition(order,!1)},updatePosition:function(e,t){var n=t?1:-1,i=this,r=this.comparator;"string"==typeof r&&this.each(function(t){var o=i.comp(t);o>=e&&t.set(r,o+n)})},reorder:function(e,t,n){var i=this.comp(e);this.updatePosition(i,!1);var r=this.comp(t);n||(r+=1),this.updatePosition(r,!0),e.set(this.comparator,r),this.sort(),this.trigger("reorder",e,r)}});return n}),define("proxymodel",["backbone"],function(e){var t=e.Model.extend({proxyDefaults:{},constructor:function(t){this.wrappedModel=t,e.Model.prototype.constructor.call(this),e.Model.prototype.set.call(this,this.proxyDefaults)},initialize:function(){this.wrappedModel;this.listenTo(this.wrappedModel,"all",function(){e.Model.prototype.trigger.apply(this,arguments)}),this.listenTo(this.wrappedModel,"destory",function(){this.stopListening(),this.destroy()})},save:function(){return this.wrappedModel.save()},set:function(t,n){return _.has(this.proxyDefaults,t)?e.Model.prototype.set.call(this,t,n):this.wrappedModel.set(t,n)},get:function(t){return _.has(this.proxyDefaults,t)?e.Model.prototype.get.call(this,t):this.wrappedModel.get(t)},trigger:function(){this.wrappedModel.trigger.apply(this.wrappedModel,arguments)},toJSON:function(){var t=e.Model.prototype.toJSON();return _.extend(t,this.wrappedModel.toJSON())}});return t}),define("rangy",[],function(){return window.rangy=function(){function e(e,t){var n=typeof e[t];return n==d||!(n!=u||!e[t])||"unknown"==n}function t(e,t){return!(typeof e[t]!=u||!e[t])}function n(e,t){return typeof e[t]!=h}function i(e){return function(t,n){for(var i=n.length;i--;)if(!e(t,n[i]))return!1;return!0}}function r(e){return e&&v(e,m)&&b(e,g)}function o(e){window.alert("Rangy not supported in your browser. Reason: "+e),w.initialized=!0,w.supported=!1}function a(e){var t="Rangy warning: "+e;w.config.alertOnWarn?window.alert(t):typeof window.console!=h&&typeof window.console.log!=h&&window.console.log(t)}function s(){if(!w.initialized){var n,i=!1,a=!1;e(document,"createRange")&&(n=document.createRange(),v(n,p)&&b(n,f)&&(i=!0),n.detach());var s=t(document,"body")?document.body:document.getElementsByTagName("body")[0];s&&e(s,"createTextRange")&&(n=s.createTextRange(),r(n)&&(a=!0)),i||a||o("Neither Range nor TextRange are implemented"),w.initialized=!0,w.features={implementsDomRange:i,implementsTextRange:a};for(var l=C.concat(x),c=0,u=l.length;u>c;++c)try{l[c](w)}catch(d){t(window,"console")&&e(window.console,"log")&&window.console.log("Init listener threw an exception. Continuing.",d)}}}function l(e){e=e||window,s();for(var t=0,n=k.length;n>t;++t)k[t](e)}function c(e){this.name=e,this.initialized=!1,this.supported=!1}var u="object",d="function",h="undefined",f=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer","START_TO_START","START_TO_END","END_TO_START","END_TO_END"],p=["setStart","setStartBefore","setStartAfter","setEnd","setEndBefore","setEndAfter","collapse","selectNode","selectNodeContents","compareBoundaryPoints","deleteContents","extractContents","cloneContents","insertNode","surroundContents","cloneRange","toString","detach"],g=["boundingHeight","boundingLeft","boundingTop","boundingWidth","htmlText","text"],m=["collapse","compareEndPoints","duplicate","getBookmark","moveToBookmark","moveToElementText","parentElement","pasteHTML","select","setEndPoint","getBoundingClientRect"],v=i(e),y=i(t),b=i(n),w={version:"1.2.3",initialized:!1,supported:!0,util:{isHostMethod:e,isHostObject:t,isHostProperty:n,areHostMethods:v,areHostObjects:y,areHostProperties:b,isTextRange:r},features:{},modules:{},config:{alertOnWarn:!1,preferTextRange:!1}};w.fail=o,w.warn=a,{}.hasOwnProperty?w.util.extend=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}:o("hasOwnProperty not supported");var x=[],C=[];w.init=s,w.addInitListener=function(e){w.initialized?e(w):x.push(e)};var k=[];w.addCreateMissingNativeApiListener=function(e){k.push(e)},w.createMissingNativeApi=l,c.prototype.fail=function(e){throw this.initialized=!0,this.supported=!1,new Error("Module '"+this.name+"' failed to load: "+e)},c.prototype.warn=function(e){w.warn("Module "+this.name+": "+e)},c.prototype.createError=function(e){return new Error("Error in Rangy "+this.name+" module: "+e)},w.createModule=function(e,t){var n=new c(e);w.modules[e]=n,C.push(function(e){t(e,n),n.initialized=!0,n.supported=!0})},w.requireModules=function(e){for(var t,n,i=0,r=e.length;r>i;++i){if(n=e[i],t=w.modules[n],!(t&&t instanceof c))throw new Error("Module '"+n+"' not found");if(!t.supported)throw new Error("Module '"+n+"' not supported")}};var _=!1,E=function(){_||(_=!0,w.initialized||s())};return typeof window==h?(o("No window found"),void 0):typeof document==h?(o("No document found"),void 0):(e(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",E,!1),e(window,"addEventListener")?window.addEventListener("load",E,!1):e(window,"attachEvent")?window.attachEvent("onload",E):o("Window does not have required addEventListener or attachEvent method"),w)}(),rangy.createModule("DomUtil",function(e,t){function n(e){var t;return typeof e.namespaceURI==E||null===(t=e.namespaceURI)||"http://www.w3.org/1999/xhtml"==t}function i(e){var t=e.parentNode;return 1==t.nodeType?t:null}function r(e){for(var t=0;e=e.previousSibling;)t++;return t}function o(e){var t;return c(e)?e.length:(t=e.childNodes)?t.length:0}function a(e,t){var n,i=[];for(n=e;n;n=n.parentNode)i.push(n);for(n=t;n;n=n.parentNode)if(R(i,n))return n;return null}function s(e,t,n){for(var i=n?t:t.parentNode;i;){if(i===e)return!0;i=i.parentNode}return!1}function l(e,t,n){for(var i,r=n?e:e.parentNode;r;){if(i=r.parentNode,i===t)return r;r=i}return null}function c(e){var t=e.nodeType;return 3==t||4==t||8==t}function u(e,t){var n=t.nextSibling,i=t.parentNode;return n?i.insertBefore(e,n):i.appendChild(e),e}function d(e,t){var n=e.cloneNode(!1);return n.deleteData(0,t),e.deleteData(t,e.length-t),u(n,e),n}function h(e){if(9==e.nodeType)return e;if(typeof e.ownerDocument!=E)return e.ownerDocument;if(typeof e.document!=E)return e.document;if(e.parentNode)return h(e.parentNode);throw new Error("getDocument: no document found for node")}function f(e){var t=h(e);if(typeof t.defaultView!=E)return t.defaultView;if(typeof t.parentWindow!=E)return t.parentWindow;throw new Error("Cannot get a window object for node")}function p(e){if(typeof e.contentDocument!=E)return e.contentDocument;if(typeof e.contentWindow!=E)return e.contentWindow.document;throw new Error("getIframeWindow: No Document object found for iframe element")}function g(e){if(typeof e.contentWindow!=E)return e.contentWindow;if(typeof e.contentDocument!=E)return e.contentDocument.defaultView;throw new Error("getIframeWindow: No Window object found for iframe element")}function m(e){return T.isHostObject(e,"body")?e.body:e.getElementsByTagName("body")[0]}function v(e){for(var t;t=e.parentNode;)e=t;return e}function y(e,t,n,i){var o,s,c,u,d;if(e==n)return t===i?0:i>t?-1:1;if(o=l(n,e,!0))return t<=r(o)?-1:1;if(o=l(e,n,!0))return r(o)<i?-1:1;if(s=a(e,n),c=e===s?s:l(e,s,!0),u=n===s?s:l(n,s,!0),c===u)throw new Error("comparePoints got to case 4 and childA and childB are the same!");for(d=s.firstChild;d;){if(d===c)return-1;if(d===u)return 1;d=d.nextSibling}throw new Error("Should not be here!")}function b(e){for(var t,n=h(e).createDocumentFragment();t=e.firstChild;)n.appendChild(t);return n}function w(e){if(!e)return"[No node]";if(c(e))return'"'+e.data+'"';if(1==e.nodeType){var t=e.id?' id="'+e.id+'"':"";return"<"+e.nodeName+t+">["+e.childNodes.length+"]"}return e.nodeName}function x(e){this.root=e,this._next=e}function C(e){return new x(e)}function k(e,t){this.node=e,this.offset=t}function _(e){this.code=this[e],this.codeName=e,this.message="DOMException: "+this.codeName}var E="undefined",T=e.util;T.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||t.fail("document missing a Node creation method"),T.isHostMethod(document,"getElementsByTagName")||t.fail("document missing getElementsByTagName method");var N=document.createElement("div");T.areHostMethods(N,["insertBefore","appendChild","cloneNode"]||!T.areHostObjects(N,["previousSibling","nextSibling","childNodes","parentNode"]))||t.fail("Incomplete Element implementation"),T.isHostProperty(N,"innerHTML")||t.fail("Element is missing innerHTML property");var S=document.createTextNode("test");T.areHostMethods(S,["splitText","deleteData","insertData","appendData","cloneNode"]||!T.areHostObjects(N,["previousSibling","nextSibling","childNodes","parentNode"])||!T.areHostProperties(S,["data"]))||t.fail("Incomplete Text Node implementation");var R=function(e,t){for(var n=e.length;n--;)if(e[n]===t)return!0;return!1};x.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){var e,t,n=this._current=this._next;if(this._current)if(e=n.firstChild)this._next=e;else{for(t=null;n!==this.root&&!(t=n.nextSibling);)n=n.parentNode;this._next=t}return this._current},detach:function(){this._current=this._next=this.root=null}},k.prototype={equals:function(e){return this.node===e.node&this.offset==e.offset},inspect:function(){return"[DomPosition("+w(this.node)+":"+this.offset+")]"}},_.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11},_.prototype.toString=function(){return this.message},e.dom={arrayContains:R,isHtmlNamespace:n,parentElement:i,getNodeIndex:r,getNodeLength:o,getCommonAncestor:a,isAncestorOf:s,getClosestAncestorIn:l,isCharacterDataNode:c,insertAfter:u,splitDataNode:d,getDocument:h,getWindow:f,getIframeWindow:g,getIframeDocument:p,getBody:m,getRootContainer:v,comparePoints:y,inspectNode:w,fragmentFromNodeChildren:b,createIterator:C,DomPosition:k},e.DOMException=_}),rangy.createModule("DomRange",function(e){function t(e,t){return 3!=e.nodeType&&(P.isAncestorOf(e,t.startContainer,!0)||P.isAncestorOf(e,t.endContainer,!0))}function n(e){return P.getDocument(e.startContainer)}function i(e,t,n){var i=e._listeners[t];if(i)for(var r=0,o=i.length;o>r;++r)i[r].call(e,{target:e,args:n})}function r(e){return new H(e.parentNode,P.getNodeIndex(e))}function o(e){return new H(e.parentNode,P.getNodeIndex(e)+1)}function a(e,t,n){var i=11==e.nodeType?e.firstChild:e;return P.isCharacterDataNode(t)?n==t.length?P.insertAfter(e,t):t.parentNode.insertBefore(e,0==n?t:P.splitDataNode(t,n)):n>=t.childNodes.length?t.appendChild(e):t.insertBefore(e,t.childNodes[n]),i}function s(e){for(var t,i,r,o=n(e.range).createDocumentFragment();i=e.next();){if(t=e.isPartiallySelectedSubtree(),i=i.cloneNode(!t),t&&(r=e.getSubtreeIterator(),i.appendChild(s(r)),r.detach(!0)),10==i.nodeType)throw new I("HIERARCHY_REQUEST_ERR");o.appendChild(i)}return o}function l(e,t,n){var i,r;n=n||{stop:!1};for(var o,a;o=e.next();)if(e.isPartiallySelectedSubtree()){if(t(o)===!1)return n.stop=!0,void 0;if(a=e.getSubtreeIterator(),l(a,t,n),a.detach(!0),n.stop)return}else for(i=P.createIterator(o);r=i.next();)if(t(r)===!1)return n.stop=!0,void 0}function c(e){for(var t;e.next();)e.isPartiallySelectedSubtree()?(t=e.getSubtreeIterator(),c(t),t.detach(!0)):e.remove()}function u(e){for(var t,i,r=n(e.range).createDocumentFragment();t=e.next();){if(e.isPartiallySelectedSubtree()?(t=t.cloneNode(!1),i=e.getSubtreeIterator(),t.appendChild(u(i)),i.detach(!0)):e.remove(),10==t.nodeType)throw new I("HIERARCHY_REQUEST_ERR");r.appendChild(t)}return r}function d(e,t,n){var i,r=!(!t||!t.length),o=!!n;r&&(i=new RegExp("^("+t.join("|")+")$"));var a=[];return l(new f(e,!1),function(e){r&&!i.test(e.nodeType)||o&&!n(e)||a.push(e)}),a}function h(e){var t="undefined"==typeof e.getName?"Range":e.getName();return"["+t+"("+P.inspectNode(e.startContainer)+":"+e.startOffset+", "+P.inspectNode(e.endContainer)+":"+e.endOffset+")]"}function f(e,t){if(this.range=e,this.clonePartiallySelectedTextNodes=t,!e.collapsed){this.sc=e.startContainer,this.so=e.startOffset,this.ec=e.endContainer,this.eo=e.endOffset;var n=e.commonAncestorContainer;this.sc===this.ec&&P.isCharacterDataNode(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc!==n||P.isCharacterDataNode(this.sc)?P.getClosestAncestorIn(this.sc,n,!0):this.sc.childNodes[this.so],this._last=this.ec!==n||P.isCharacterDataNode(this.ec)?P.getClosestAncestorIn(this.ec,n,!0):this.ec.childNodes[this.eo-1])}}function p(e){this.code=this[e],this.codeName=e,this.message="RangeException: "+this.codeName}function g(e,t,n){this.nodes=d(e,t,n),this._next=this.nodes[0],this._position=0}function m(e){return function(t,n){for(var i,r=n?t:t.parentNode;r;){if(i=r.nodeType,P.arrayContains(e,i))return r;r=r.parentNode}return null}}function v(e,t){if(X(e,t))throw new p("INVALID_NODE_TYPE_ERR")}function y(e){if(!e.startContainer)throw new I("INVALID_STATE_ERR")}function b(e,t){if(!P.arrayContains(t,e.nodeType))throw new p("INVALID_NODE_TYPE_ERR")}function w(e,t){if(0>t||t>(P.isCharacterDataNode(e)?e.length:e.childNodes.length))throw new I("INDEX_SIZE_ERR")}function x(e,t){if(U(e,!0)!==U(t,!0))throw new I("WRONG_DOCUMENT_ERR")}function C(e){if(J(e,!0))throw new I("NO_MODIFICATION_ALLOWED_ERR")}function k(e,t){if(!e)throw new I(t)}function _(e){return!P.arrayContains(V,e.nodeType)&&!U(e,!0)}function E(e,t){return t<=(P.isCharacterDataNode(e)?e.length:e.childNodes.length)}function T(e){return!!e.startContainer&&!!e.endContainer&&!_(e.startContainer)&&!_(e.endContainer)&&E(e.startContainer,e.startOffset)&&E(e.endContainer,e.endOffset)}function N(e){if(y(e),!T(e))throw new Error("Range error: Range is no longer valid after DOM mutation ("+e.inspect()+")")}function S(){}function R(e){e.START_TO_START=et,e.START_TO_END=tt,e.END_TO_END=nt,e.END_TO_START=it,e.NODE_BEFORE=rt,e.NODE_AFTER=ot,e.NODE_BEFORE_AND_AFTER=at,e.NODE_INSIDE=st}function $(e){R(e),R(e.prototype)}function A(e,t){return function(){N(this);var n,i,r=this.startContainer,a=this.startOffset,s=this.commonAncestorContainer,c=new f(this,!0);r!==s&&(n=P.getClosestAncestorIn(r,s,!0),i=o(n),r=i.node,a=i.offset),l(c,C),c.reset();var u=e(c);return c.detach(),t(this,r,a,r,a),u}}function O(n,i,a){function s(e,t){return function(n){y(this),b(n,q),b(W(n),V);var i=(e?r:o)(n);(t?l:d)(this,i.node,i.offset)}}function l(e,t,n){var r=e.endContainer,o=e.endOffset;(t!==e.startContainer||n!==e.startOffset)&&((W(t)!=W(r)||1==P.comparePoints(t,n,r,o))&&(r=t,o=n),i(e,t,n,r,o))}function d(e,t,n){var r=e.startContainer,o=e.startOffset;(t!==e.endContainer||n!==e.endOffset)&&((W(t)!=W(r)||-1==P.comparePoints(t,n,r,o))&&(r=t,o=n),i(e,r,o,t,n))}function h(e,t,n){(t!==e.startContainer||n!==e.startOffset||t!==e.endContainer||n!==e.endOffset)&&i(e,t,n,t,n)}n.prototype=new S,e.util.extend(n.prototype,{setStart:function(e,t){y(this),v(e,!0),w(e,t),l(this,e,t)},setEnd:function(e,t){y(this),v(e,!0),w(e,t),d(this,e,t)},setStartBefore:s(!0,!0),setStartAfter:s(!1,!0),setEndBefore:s(!0,!1),setEndAfter:s(!1,!1),collapse:function(e){N(this),e?i(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):i(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(e){y(this),v(e,!0),i(this,e,0,e,P.getNodeLength(e))},selectNode:function(e){y(this),v(e,!1),b(e,q);var t=r(e),n=o(e);i(this,t.node,t.offset,n.node,n.offset)},extractContents:A(u,i),deleteContents:A(c,i),canSurroundContents:function(){N(this),C(this.startContainer),C(this.endContainer);var e=new f(this,!0),n=e._first&&t(e._first,this)||e._last&&t(e._last,this);return e.detach(),!n},detach:function(){a(this)},splitBoundaries:function(){N(this);var e=this.startContainer,t=this.startOffset,n=this.endContainer,r=this.endOffset,o=e===n;P.isCharacterDataNode(n)&&r>0&&r<n.length&&P.splitDataNode(n,r),P.isCharacterDataNode(e)&&t>0&&t<e.length&&(e=P.splitDataNode(e,t),o?(r-=t,n=e):n==e.parentNode&&r>=P.getNodeIndex(e)&&r++,t=0),i(this,e,t,n,r)},normalizeBoundaries:function(){N(this);var e=this.startContainer,t=this.startOffset,n=this.endContainer,r=this.endOffset,o=function(e){var t=e.nextSibling;t&&t.nodeType==e.nodeType&&(n=e,r=e.length,e.appendData(t.data),t.parentNode.removeChild(t))},a=function(i){var o=i.previousSibling;if(o&&o.nodeType==i.nodeType){e=i;var a=i.length;if(t=o.length,i.insertData(0,o.data),o.parentNode.removeChild(o),e==n)r+=t,n=e;else if(n==i.parentNode){var s=P.getNodeIndex(i);r==s?(n=i,r=a):r>s&&r--}}},s=!0;if(P.isCharacterDataNode(n))n.length==r&&o(n);else{if(r>0){var l=n.childNodes[r-1];l&&P.isCharacterDataNode(l)&&o(l)}s=!this.collapsed}if(s){if(P.isCharacterDataNode(e))0==t&&a(e);else if(t<e.childNodes.length){var c=e.childNodes[t];c&&P.isCharacterDataNode(c)&&a(c)}}else e=n,t=r;i(this,e,t,n,r)},collapseToPoint:function(e,t){y(this),v(e,!0),w(e,t),h(this,e,t)}}),$(n)}function D(e){e.collapsed=e.startContainer===e.endContainer&&e.startOffset===e.endOffset,e.commonAncestorContainer=e.collapsed?e.startContainer:P.getCommonAncestor(e.startContainer,e.endContainer)}function M(e,t,n,r,o){var a=e.startContainer!==t||e.startOffset!==n,s=e.endContainer!==r||e.endOffset!==o;e.startContainer=t,e.startOffset=n,e.endContainer=r,e.endOffset=o,D(e),i(e,"boundarychange",{startMoved:a,endMoved:s})}function B(e){y(e),e.startContainer=e.startOffset=e.endContainer=e.endOffset=null,e.collapsed=e.commonAncestorContainer=null,i(e,"detach",null),e._listeners=null}function j(e){this.startContainer=e,this.startOffset=0,this.endContainer=e,this.endOffset=0,this._listeners={boundarychange:[],detach:[]},D(this)
}e.requireModules(["DomUtil"]);var P=e.dom,H=P.DomPosition,I=e.DOMException;f.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null,this._next=this._first},hasNext:function(){return!!this._next},next:function(){var e=this._current=this._next;return e&&(this._next=e!==this._last?e.nextSibling:null,P.isCharacterDataNode(e)&&this.clonePartiallySelectedTextNodes&&(e===this.ec&&(e=e.cloneNode(!0)).deleteData(this.eo,e.length-this.eo),this._current===this.sc&&(e=e.cloneNode(!0)).deleteData(0,this.so))),e},remove:function(){var e,t,n=this._current;!P.isCharacterDataNode(n)||n!==this.sc&&n!==this.ec?n.parentNode&&n.parentNode.removeChild(n):(e=n===this.sc?this.so:0,t=n===this.ec?this.eo:n.length,e!=t&&n.deleteData(e,t-e))},isPartiallySelectedSubtree:function(){var e=this._current;return t(e,this.range)},getSubtreeIterator:function(){var e;if(this.isSingleCharacterDataNode)e=this.range.cloneRange(),e.collapse();else{e=new j(n(this.range));var t=this._current,i=t,r=0,o=t,a=P.getNodeLength(t);P.isAncestorOf(t,this.sc,!0)&&(i=this.sc,r=this.so),P.isAncestorOf(t,this.ec,!0)&&(o=this.ec,a=this.eo),M(e,i,r,o,a)}return new f(e,this.clonePartiallySelectedTextNodes)},detach:function(e){e&&this.range.detach(),this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}},p.prototype={BAD_BOUNDARYPOINTS_ERR:1,INVALID_NODE_TYPE_ERR:2},p.prototype.toString=function(){return this.message},g.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){return this._current=this._next,this._next=this.nodes[++this._position],this._current},detach:function(){this._current=this._next=this.nodes=null}};var q=[1,3,4,5,7,8,10],V=[2,9,11],L=[5,6,10,12],F=[1,3,4,5,7,8,10,11],z=[1,3,4,5,7,8],W=P.getRootContainer,U=m([9,11]),J=m(L),X=m([6,10,12]),K=document.createElement("style"),Q=!1;try{K.innerHTML="<b>x</b>",Q=3==K.firstChild.nodeType}catch(G){}e.features.htmlParsingConforms=Q;var Y=Q?function(e){var t=this.startContainer,n=P.getDocument(t);if(!t)throw new I("INVALID_STATE_ERR");var i=null;return 1==t.nodeType?i=t:P.isCharacterDataNode(t)&&(i=P.parentElement(t)),i=null===i||"HTML"==i.nodeName&&P.isHtmlNamespace(P.getDocument(i).documentElement)&&P.isHtmlNamespace(i)?n.createElement("body"):i.cloneNode(!1),i.innerHTML=e,P.fragmentFromNodeChildren(i)}:function(e){y(this);var t=n(this),i=t.createElement("body");return i.innerHTML=e,P.fragmentFromNodeChildren(i)},Z=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],et=0,tt=1,nt=2,it=3,rt=0,ot=1,at=2,st=3;S.prototype={attachListener:function(e,t){this._listeners[e].push(t)},compareBoundaryPoints:function(e,t){N(this),x(this.startContainer,t.startContainer);var n,i,r,o,a=e==it||e==et?"start":"end",s=e==tt||e==et?"start":"end";return n=this[a+"Container"],i=this[a+"Offset"],r=t[s+"Container"],o=t[s+"Offset"],P.comparePoints(n,i,r,o)},insertNode:function(e){if(N(this),b(e,F),C(this.startContainer),P.isAncestorOf(e,this.startContainer,!0))throw new I("HIERARCHY_REQUEST_ERR");var t=a(e,this.startContainer,this.startOffset);this.setStartBefore(t)},cloneContents:function(){N(this);var e,t;if(this.collapsed)return n(this).createDocumentFragment();if(this.startContainer===this.endContainer&&P.isCharacterDataNode(this.startContainer))return e=this.startContainer.cloneNode(!0),e.data=e.data.slice(this.startOffset,this.endOffset),t=n(this).createDocumentFragment(),t.appendChild(e),t;var i=new f(this,!0);return e=s(i),i.detach(),e},canSurroundContents:function(){N(this),C(this.startContainer),C(this.endContainer);var e=new f(this,!0),n=e._first&&t(e._first,this)||e._last&&t(e._last,this);return e.detach(),!n},surroundContents:function(e){if(b(e,z),!this.canSurroundContents())throw new p("BAD_BOUNDARYPOINTS_ERR");var t=this.extractContents();if(e.hasChildNodes())for(;e.lastChild;)e.removeChild(e.lastChild);a(e,this.startContainer,this.startOffset),e.appendChild(t),this.selectNode(e)},cloneRange:function(){N(this);for(var e,t=new j(n(this)),i=Z.length;i--;)e=Z[i],t[e]=this[e];return t},toString:function(){N(this);var e=this.startContainer;if(e===this.endContainer&&P.isCharacterDataNode(e))return 3==e.nodeType||4==e.nodeType?e.data.slice(this.startOffset,this.endOffset):"";var t=[],n=new f(this,!0);return l(n,function(e){(3==e.nodeType||4==e.nodeType)&&t.push(e.data)}),n.detach(),t.join("")},compareNode:function(e){N(this);var t=e.parentNode,n=P.getNodeIndex(e);if(!t)throw new I("NOT_FOUND_ERR");var i=this.comparePoint(t,n),r=this.comparePoint(t,n+1);return 0>i?r>0?at:rt:r>0?ot:st},comparePoint:function(e,t){return N(this),k(e,"HIERARCHY_REQUEST_ERR"),x(e,this.startContainer),P.comparePoints(e,t,this.startContainer,this.startOffset)<0?-1:P.comparePoints(e,t,this.endContainer,this.endOffset)>0?1:0},createContextualFragment:Y,toHtml:function(){N(this);var e=n(this).createElement("div");return e.appendChild(this.cloneContents()),e.innerHTML},intersectsNode:function(e,t){if(N(this),k(e,"NOT_FOUND_ERR"),P.getDocument(e)!==n(this))return!1;var i=e.parentNode,r=P.getNodeIndex(e);k(i,"NOT_FOUND_ERR");var o=P.comparePoints(i,r,this.endContainer,this.endOffset),a=P.comparePoints(i,r+1,this.startContainer,this.startOffset);return t?0>=o&&a>=0:0>o&&a>0},isPointInRange:function(e,t){return N(this),k(e,"HIERARCHY_REQUEST_ERR"),x(e,this.startContainer),P.comparePoints(e,t,this.startContainer,this.startOffset)>=0&&P.comparePoints(e,t,this.endContainer,this.endOffset)<=0},intersectsRange:function(e,t){if(N(this),n(e)!=n(this))throw new I("WRONG_DOCUMENT_ERR");var i=P.comparePoints(this.startContainer,this.startOffset,e.endContainer,e.endOffset),r=P.comparePoints(this.endContainer,this.endOffset,e.startContainer,e.startOffset);return t?0>=i&&r>=0:0>i&&r>0},intersection:function(e){if(this.intersectsRange(e)){var t=P.comparePoints(this.startContainer,this.startOffset,e.startContainer,e.startOffset),n=P.comparePoints(this.endContainer,this.endOffset,e.endContainer,e.endOffset),i=this.cloneRange();return-1==t&&i.setStart(e.startContainer,e.startOffset),1==n&&i.setEnd(e.endContainer,e.endOffset),i}return null},union:function(e){if(this.intersectsRange(e,!0)){var t=this.cloneRange();return-1==P.comparePoints(e.startContainer,e.startOffset,this.startContainer,this.startOffset)&&t.setStart(e.startContainer,e.startOffset),1==P.comparePoints(e.endContainer,e.endOffset,this.endContainer,this.endOffset)&&t.setEnd(e.endContainer,e.endOffset),t}throw new p("Ranges do not intersect")},containsNode:function(e,t){return t?this.intersectsNode(e,!1):this.compareNode(e)==st},containsNodeContents:function(e){return this.comparePoint(e,0)>=0&&this.comparePoint(e,P.getNodeLength(e))<=0},containsRange:function(e){return this.intersection(e).equals(e)},containsNodeText:function(e){var t=this.cloneRange();t.selectNode(e);var n=t.getNodes([3]);if(n.length>0){t.setStart(n[0],0);var i=n.pop();t.setEnd(i,i.length);var r=this.containsRange(t);return t.detach(),r}return this.containsNodeContents(e)},createNodeIterator:function(e,t){return N(this),new g(this,e,t)},getNodes:function(e,t){return N(this),d(this,e,t)},getDocument:function(){return n(this)},collapseBefore:function(e){y(this),this.setEndBefore(e),this.collapse(!1)},collapseAfter:function(e){y(this),this.setStartAfter(e),this.collapse(!0)},getName:function(){return"DomRange"},equals:function(e){return j.rangesEqual(this,e)},isValid:function(){return T(this)},inspect:function(){return h(this)}},O(j,M,B),e.rangePrototype=S.prototype,j.rangeProperties=Z,j.RangeIterator=f,j.copyComparisonConstants=$,j.createPrototypeRange=O,j.inspect=h,j.getRangeDocument=n,j.rangesEqual=function(e,t){return e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset},e.DomRange=j,e.RangeException=p}),rangy.createModule("WrappedRange",function(e){function t(e){var t=e.parentElement(),n=e.duplicate();n.collapse(!0);var i=n.parentElement();n=e.duplicate(),n.collapse(!1);var r=n.parentElement(),o=i==r?i:a.getCommonAncestor(i,r);return o==t?o:a.getCommonAncestor(t,o)}function n(e){return 0==e.compareEndPoints("StartToEnd",e)}function i(e,t,n,i){var r=e.duplicate();r.collapse(n);var o=r.parentElement();if(a.isAncestorOf(t,o,!0)||(o=t),!o.canHaveHTML)return new s(o.parentNode,a.getNodeIndex(o));var l,c,u,d,h,f=a.getDocument(o).createElement("span"),p=n?"StartToStart":"StartToEnd";do o.insertBefore(f,f.previousSibling),r.moveToElementText(f);while((l=r.compareEndPoints(p,e))>0&&f.previousSibling);if(h=f.nextSibling,-1==l&&h&&a.isCharacterDataNode(h)){r.setEndPoint(n?"EndToStart":"EndToEnd",e);var g;if(/[\r\n]/.test(h.data)){var m=r.duplicate(),v=m.text.replace(/\r\n/g,"\r").length;for(g=m.moveStart("character",v);-1==(l=m.compareEndPoints("StartToEnd",m));)g++,m.moveStart("character",1)}else g=r.text.length;d=new s(h,g)}else c=(i||!n)&&f.previousSibling,u=(i||n)&&f.nextSibling,d=u&&a.isCharacterDataNode(u)?new s(u,0):c&&a.isCharacterDataNode(c)?new s(c,c.length):new s(o,a.getNodeIndex(f));return f.parentNode.removeChild(f),d}function r(e,t){var n,i,r,o,s=e.offset,l=a.getDocument(e.node),c=l.body.createTextRange(),u=a.isCharacterDataNode(e.node);return u?(n=e.node,i=n.parentNode):(o=e.node.childNodes,n=s<o.length?o[s]:null,i=e.node),r=l.createElement("span"),r.innerHTML="&#feff;",n?i.insertBefore(r,n):i.appendChild(r),c.moveToElementText(r),c.collapse(!t),i.removeChild(r),u&&c[t?"moveStart":"moveEnd"]("character",s),c}e.requireModules(["DomUtil","DomRange"]);var o,a=e.dom,s=a.DomPosition,l=e.DomRange;if(!e.features.implementsDomRange||e.features.implementsTextRange&&e.config.preferTextRange){if(e.features.implementsTextRange){o=function(e){this.textRange=e,this.refresh()},o.prototype=new l(document),o.prototype.refresh=function(){var e,r,o=t(this.textRange);n(this.textRange)?r=e=i(this.textRange,o,!0,!0):(e=i(this.textRange,o,!0,!1),r=i(this.textRange,o,!1,!1)),this.setStart(e.node,e.offset),this.setEnd(r.node,r.offset)},l.copyComparisonConstants(o);var c=function(){return this}();"undefined"==typeof c.Range&&(c.Range=o),e.createNativeRange=function(e){return e=e||document,e.body.createTextRange()}}}else!function(){function t(e){for(var t,n=u.length;n--;)t=u[n],e[t]=e.nativeRange[t]}function n(e,t,n,i,r){var o=e.startContainer!==t||e.startOffset!=n,a=e.endContainer!==i||e.endOffset!=r;(o||a)&&(e.setEnd(i,r),e.setStart(t,n))}function i(e){e.nativeRange.detach(),e.detached=!0;for(var t,n=u.length;n--;)t=u[n],e[t]=null}var r,s,c,u=l.rangeProperties;o=function(e){if(!e)throw new Error("Range must be specified");this.nativeRange=e,t(this)},l.createPrototypeRange(o,n,i),r=o.prototype,r.selectNode=function(e){this.nativeRange.selectNode(e),t(this)},r.deleteContents=function(){this.nativeRange.deleteContents(),t(this)},r.extractContents=function(){var e=this.nativeRange.extractContents();return t(this),e},r.cloneContents=function(){return this.nativeRange.cloneContents()},r.surroundContents=function(e){this.nativeRange.surroundContents(e),t(this)},r.collapse=function(e){this.nativeRange.collapse(e),t(this)},r.cloneRange=function(){return new o(this.nativeRange.cloneRange())},r.refresh=function(){t(this)},r.toString=function(){return this.nativeRange.toString()};var d=document.createTextNode("test");a.getBody(document).appendChild(d);var h=document.createRange();h.setStart(d,0),h.setEnd(d,0);try{h.setStart(d,1),s=!0,r.setStart=function(e,n){this.nativeRange.setStart(e,n),t(this)},r.setEnd=function(e,n){this.nativeRange.setEnd(e,n),t(this)},c=function(e){return function(n){this.nativeRange[e](n),t(this)}}}catch(f){s=!1,r.setStart=function(e,n){try{this.nativeRange.setStart(e,n)}catch(i){this.nativeRange.setEnd(e,n),this.nativeRange.setStart(e,n)}t(this)},r.setEnd=function(e,n){try{this.nativeRange.setEnd(e,n)}catch(i){this.nativeRange.setStart(e,n),this.nativeRange.setEnd(e,n)}t(this)},c=function(e,n){return function(i){try{this.nativeRange[e](i)}catch(r){this.nativeRange[n](i),this.nativeRange[e](i)}t(this)}}}r.setStartBefore=c("setStartBefore","setEndBefore"),r.setStartAfter=c("setStartAfter","setEndAfter"),r.setEndBefore=c("setEndBefore","setStartBefore"),r.setEndAfter=c("setEndAfter","setStartAfter"),h.selectNodeContents(d),r.selectNodeContents=h.startContainer==d&&h.endContainer==d&&0==h.startOffset&&h.endOffset==d.length?function(e){this.nativeRange.selectNodeContents(e),t(this)}:function(e){this.setStart(e,0),this.setEnd(e,l.getEndOffset(e))},h.selectNodeContents(d),h.setEnd(d,3);var p=document.createRange();p.selectNodeContents(d),p.setEnd(d,4),p.setStart(d,2),r.compareBoundaryPoints=-1==h.compareBoundaryPoints(h.START_TO_END,p)&1==h.compareBoundaryPoints(h.END_TO_START,p)?function(e,t){return t=t.nativeRange||t,e==t.START_TO_END?e=t.END_TO_START:e==t.END_TO_START&&(e=t.START_TO_END),this.nativeRange.compareBoundaryPoints(e,t)}:function(e,t){return this.nativeRange.compareBoundaryPoints(e,t.nativeRange||t)},e.util.isHostMethod(h,"createContextualFragment")&&(r.createContextualFragment=function(e){return this.nativeRange.createContextualFragment(e)}),a.getBody(document).removeChild(d),h.detach(),p.detach()}(),e.createNativeRange=function(e){return e=e||document,e.createRange()};e.features.implementsTextRange&&(o.rangeToTextRange=function(e){if(e.collapsed){var t=r(new s(e.startContainer,e.startOffset),!0);return t}var n=r(new s(e.startContainer,e.startOffset),!0),i=r(new s(e.endContainer,e.endOffset),!1),o=a.getDocument(e.startContainer).body.createTextRange();return o.setEndPoint("StartToStart",n),o.setEndPoint("EndToEnd",i),o}),o.prototype.getName=function(){return"WrappedRange"},e.WrappedRange=o,e.createRange=function(t){return t=t||document,new o(e.createNativeRange(t))},e.createRangyRange=function(e){return e=e||document,new l(e)},e.createIframeRange=function(t){return e.createRange(a.getIframeDocument(t))},e.createIframeRangyRange=function(t){return e.createRangyRange(a.getIframeDocument(t))},e.addCreateMissingNativeApiListener(function(t){var n=t.document;"undefined"==typeof n.createRange&&(n.createRange=function(){return e.createRange(this)}),n=t=null})}),rangy.createModule("WrappedSelection",function(e,t){function n(e){return(e||window).getSelection()}function i(e){return(e||window).document.selection}function r(e,t,n){var i=n?"end":"start",r=n?"start":"end";e.anchorNode=t[i+"Container"],e.anchorOffset=t[i+"Offset"],e.focusNode=t[r+"Container"],e.focusOffset=t[r+"Offset"]}function o(e){var t=e.nativeSelection;e.anchorNode=t.anchorNode,e.anchorOffset=t.anchorOffset,e.focusNode=t.focusNode,e.focusOffset=t.focusOffset}function a(e){e.anchorNode=e.focusNode=null,e.anchorOffset=e.focusOffset=0,e.rangeCount=0,e.isCollapsed=!0,e._ranges.length=0}function s(t){var n;return t instanceof _?(n=t._selectionNativeRange,n||(n=e.createNativeRange(C.getDocument(t.startContainer)),n.setEnd(t.endContainer,t.endOffset),n.setStart(t.startContainer,t.startOffset),t._selectionNativeRange=n,t.attachListener("detach",function(){this._selectionNativeRange=null}))):t instanceof E?n=t.nativeRange:e.features.implementsDomRange&&t instanceof C.getWindow(t.startContainer).Range&&(n=t),n}function l(e){if(!e.length||1!=e[0].nodeType)return!1;for(var t=1,n=e.length;n>t;++t)if(!C.isAncestorOf(e[0],e[t]))return!1;return!0}function c(e){var t=e.getNodes();if(!l(t))throw new Error("getSingleElementFromRange: range "+e.inspect()+" did not consist of a single element");return t[0]}function u(e){return!!e&&"undefined"!=typeof e.text}function d(e,t){var n=new E(t);e._ranges=[n],r(e,n,!1),e.rangeCount=1,e.isCollapsed=n.collapsed}function h(t){if(t._ranges.length=0,"None"==t.docSelection.type)a(t);else{var n=t.docSelection.createRange();if(u(n))d(t,n);else{t.rangeCount=n.length;for(var i,o=C.getDocument(n.item(0)),s=0;s<t.rangeCount;++s)i=e.createRange(o),i.selectNode(n.item(s)),t._ranges.push(i);t.isCollapsed=1==t.rangeCount&&t._ranges[0].collapsed,r(t,t._ranges[t.rangeCount-1],!1)}}}function f(e,t){for(var n=e.docSelection.createRange(),i=c(t),r=C.getDocument(n.item(0)),o=C.getBody(r).createControlRange(),a=0,s=n.length;s>a;++a)o.add(n.item(a));try{o.add(i)}catch(l){throw new Error("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)")}o.select(),h(e)}function p(e,t,n){this.nativeSelection=e,this.docSelection=t,this._ranges=[],this.win=n,this.refresh()}function g(e,t){for(var n,i=C.getDocument(t[0].startContainer),r=C.getBody(i).createControlRange(),o=0;rangeCount>o;++o){n=c(t[o]);try{r.add(n)}catch(a){throw new Error("setRanges(): Element within the one of the specified Ranges could not be added to control selection (does it have layout?)")}}r.select(),h(e)}function m(e,t){if(e.anchorNode&&C.getDocument(e.anchorNode)!==C.getDocument(t))throw new T("WRONG_DOCUMENT_ERR")}function v(e){var t=[],n=new N(e.anchorNode,e.anchorOffset),i=new N(e.focusNode,e.focusOffset),r="function"==typeof e.getName?e.getName():"Selection";if("undefined"!=typeof e.rangeCount)for(var o=0,a=e.rangeCount;a>o;++o)t[o]=_.inspect(e.getRangeAt(o));return"["+r+"(Ranges: "+t.join(", ")+")(anchor: "+n.inspect()+", focus: "+i.inspect()+"]"}e.requireModules(["DomUtil","DomRange","WrappedRange"]),e.config.checkSelectionRanges=!0;var y,b,w="boolean",x="_rangySelection",C=e.dom,k=e.util,_=e.DomRange,E=e.WrappedRange,T=e.DOMException,N=C.DomPosition,S="Control",R=e.util.isHostMethod(window,"getSelection"),$=e.util.isHostObject(document,"selection"),A=$&&(!R||e.config.preferTextRange);A?(y=i,e.isSelectionValid=function(e){var t=(e||window).document,n=t.selection;return"None"!=n.type||C.getDocument(n.createRange().parentElement())==t}):R?(y=n,e.isSelectionValid=function(){return!0}):t.fail("Neither document.selection or window.getSelection() detected."),e.getNativeSelection=y;var O=y(),D=e.createNativeRange(document),M=C.getBody(document),B=k.areHostObjects(O,["anchorNode","focusNode"]&&k.areHostProperties(O,["anchorOffset","focusOffset"]));e.features.selectionHasAnchorAndFocus=B;var j=k.isHostMethod(O,"extend");e.features.selectionHasExtend=j;var P="number"==typeof O.rangeCount;e.features.selectionHasRangeCount=P;var H=!1,I=!0;k.areHostMethods(O,["addRange","getRangeAt","removeAllRanges"])&&"number"==typeof O.rangeCount&&e.features.implementsDomRange&&!function(){var e=document.createElement("iframe");e.frameBorder=0,e.style.position="absolute",e.style.left="-10000px",M.appendChild(e);var t=C.getIframeDocument(e);t.open(),t.write("<html><head></head><body>12</body></html>"),t.close();var n=C.getIframeWindow(e).getSelection(),i=t.documentElement,r=i.lastChild,o=r.firstChild,a=t.createRange();a.setStart(o,1),a.collapse(!0),n.addRange(a),I=1==n.rangeCount,n.removeAllRanges();var s=a.cloneRange();a.setStart(o,0),s.setEnd(o,2),n.addRange(a),n.addRange(s),H=2==n.rangeCount,a.detach(),s.detach(),M.removeChild(e)}(),e.features.selectionSupportsMultipleRanges=H,e.features.collapsedNonEditableSelectionsSupported=I;var q,V=!1;M&&k.isHostMethod(M,"createControlRange")&&(q=M.createControlRange(),k.areHostProperties(q,["item","add"])&&(V=!0)),e.features.implementsControlRange=V,b=B?function(e){return e.anchorNode===e.focusNode&&e.anchorOffset===e.focusOffset}:function(e){return e.rangeCount?e.getRangeAt(e.rangeCount-1).collapsed:!1};var L;k.isHostMethod(O,"getRangeAt")?L=function(e,t){try{return e.getRangeAt(t)}catch(n){return null}}:B&&(L=function(t){var n=C.getDocument(t.anchorNode),i=e.createRange(n);return i.setStart(t.anchorNode,t.anchorOffset),i.setEnd(t.focusNode,t.focusOffset),i.collapsed!==this.isCollapsed&&(i.setStart(t.focusNode,t.focusOffset),i.setEnd(t.anchorNode,t.anchorOffset)),i}),e.getSelection=function(e){e=e||window;var t=e[x],n=y(e),r=$?i(e):null;return t?(t.nativeSelection=n,t.docSelection=r,t.refresh(e)):(t=new p(n,r,e),e[x]=t),t},e.getIframeSelection=function(t){return e.getSelection(C.getIframeWindow(t))};var F=p.prototype;if(!A&&B&&k.areHostMethods(O,["removeAllRanges","addRange"])){F.removeAllRanges=function(){this.nativeSelection.removeAllRanges(),a(this)};var z=function(t,n){var i=_.getRangeDocument(n),r=e.createRange(i);r.collapseToPoint(n.endContainer,n.endOffset),t.nativeSelection.addRange(s(r)),t.nativeSelection.extend(n.startContainer,n.startOffset),t.refresh()};F.addRange=P?function(t,n){if(V&&$&&this.docSelection.type==S)f(this,t);else if(n&&j)z(this,t);else{var i;if(H?i=this.rangeCount:(this.removeAllRanges(),i=0),this.nativeSelection.addRange(s(t)),this.rangeCount=this.nativeSelection.rangeCount,this.rangeCount==i+1){if(e.config.checkSelectionRanges){var o=L(this.nativeSelection,this.rangeCount-1);o&&!_.rangesEqual(o,t)&&(t=new E(o))}this._ranges[this.rangeCount-1]=t,r(this,t,J(this.nativeSelection)),this.isCollapsed=b(this)}else this.refresh()}}:function(e,t){t&&j?z(this,e):(this.nativeSelection.addRange(s(e)),this.refresh())},F.setRanges=function(e){if(V&&e.length>1)g(this,e);else{this.removeAllRanges();for(var t=0,n=e.length;n>t;++t)this.addRange(e[t])}}}else{if(!(k.isHostMethod(O,"empty")&&k.isHostMethod(D,"select")&&V&&A))return t.fail("No means of selecting a Range or TextRange was found"),!1;F.removeAllRanges=function(){try{if(this.docSelection.empty(),"None"!=this.docSelection.type){var e;if(this.anchorNode)e=C.getDocument(this.anchorNode);else if(this.docSelection.type==S){var t=this.docSelection.createRange();t.length&&(e=C.getDocument(t.item(0)).body.createTextRange())}if(e){var n=e.body.createTextRange();n.select(),this.docSelection.empty()}}}catch(i){}a(this)},F.addRange=function(e){this.docSelection.type==S?f(this,e):(E.rangeToTextRange(e).select(),this._ranges[0]=e,this.rangeCount=1,this.isCollapsed=this._ranges[0].collapsed,r(this,e,!1))},F.setRanges=function(e){this.removeAllRanges();var t=e.length;t>1?g(this,e):t&&this.addRange(e[0])}}F.getRangeAt=function(e){if(0>e||e>=this.rangeCount)throw new T("INDEX_SIZE_ERR");return this._ranges[e]};var W;if(A)W=function(t){var n;e.isSelectionValid(t.win)?n=t.docSelection.createRange():(n=C.getBody(t.win.document).createTextRange(),n.collapse(!0)),t.docSelection.type==S?h(t):u(n)?d(t,n):a(t)};else if(k.isHostMethod(O,"getRangeAt")&&"number"==typeof O.rangeCount)W=function(t){if(V&&$&&t.docSelection.type==S)h(t);else if(t._ranges.length=t.rangeCount=t.nativeSelection.rangeCount,t.rangeCount){for(var n=0,i=t.rangeCount;i>n;++n)t._ranges[n]=new e.WrappedRange(t.nativeSelection.getRangeAt(n));r(t,t._ranges[t.rangeCount-1],J(t.nativeSelection)),t.isCollapsed=b(t)}else a(t)};else{if(!B||typeof O.isCollapsed!=w||typeof D.collapsed!=w||!e.features.implementsDomRange)return t.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1;W=function(e){var t,n=e.nativeSelection;n.anchorNode?(t=L(n,0),e._ranges=[t],e.rangeCount=1,o(e),e.isCollapsed=b(e)):a(e)}}F.refresh=function(e){var t=e?this._ranges.slice(0):null;if(W(this),e){var n=t.length;if(n!=this._ranges.length)return!1;for(;n--;)if(!_.rangesEqual(t[n],this._ranges[n]))return!1;return!0}};var U=function(e,t){var n=e.getAllRanges(),i=!1;e.removeAllRanges();for(var r=0,o=n.length;o>r;++r)i||t!==n[r]?e.addRange(n[r]):i=!0;e.rangeCount||a(e)};F.removeRange=V?function(e){if(this.docSelection.type==S){for(var t,n=this.docSelection.createRange(),i=c(e),r=C.getDocument(n.item(0)),o=C.getBody(r).createControlRange(),a=!1,s=0,l=n.length;l>s;++s)t=n.item(s),t!==i||a?o.add(n.item(s)):a=!0;o.select(),h(this)}else U(this,e)}:function(e){U(this,e)};var J;!A&&B&&e.features.implementsDomRange?(J=function(e){var t=!1;return e.anchorNode&&(t=1==C.comparePoints(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset)),t},F.isBackwards=function(){return J(this)}):J=F.isBackwards=function(){return!1},F.toString=function(){for(var e=[],t=0,n=this.rangeCount;n>t;++t)e[t]=""+this._ranges[t];return e.join("")},F.collapse=function(t,n){m(this,t);var i=e.createRange(C.getDocument(t));i.collapseToPoint(t,n),this.removeAllRanges(),this.addRange(i),this.isCollapsed=!0},F.collapseToStart=function(){if(!this.rangeCount)throw new T("INVALID_STATE_ERR");var e=this._ranges[0];this.collapse(e.startContainer,e.startOffset)},F.collapseToEnd=function(){if(!this.rangeCount)throw new T("INVALID_STATE_ERR");var e=this._ranges[this.rangeCount-1];this.collapse(e.endContainer,e.endOffset)},F.selectAllChildren=function(t){m(this,t);var n=e.createRange(C.getDocument(t));n.selectNodeContents(t),this.removeAllRanges(),this.addRange(n)},F.deleteFromDocument=function(){if(V&&$&&this.docSelection.type==S){for(var e,t=this.docSelection.createRange();t.length;)e=t.item(0),t.remove(e),e.parentNode.removeChild(e);this.refresh()}else if(this.rangeCount){var n=this.getAllRanges();this.removeAllRanges();for(var i=0,r=n.length;r>i;++i)n[i].deleteContents();this.addRange(n[r-1])}},F.getAllRanges=function(){return this._ranges.slice(0)},F.setSingleRange=function(e){this.setRanges([e])},F.containsNode=function(e,t){for(var n=0,i=this._ranges.length;i>n;++n)if(this._ranges[n].containsNode(e,t))return!0;return!1},F.toHtml=function(){var e="";if(this.rangeCount){for(var t=_.getRangeDocument(this._ranges[0]).createElement("div"),n=0,i=this._ranges.length;i>n;++n)t.appendChild(this._ranges[n].cloneContents());e=t.innerHTML}return e},F.getName=function(){return"WrappedSelection"},F.inspect=function(){return v(this)},F.detach=function(){this.win[x]=null,this.win=this.anchorNode=this.focusNode=null},p.inspect=v,e.Selection=p,e.selectionPrototype=F,e.addCreateMissingNativeApiListener(function(t){"undefined"==typeof t.getSelection&&(t.getSelection=function(){return e.getSelection(this)}),t=null})}),window.rangy}),define("rangycss",["rangy"],function(e){return e.createModule("CssClassApplier",function(e,t){function n(e){return e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function i(e,t){return e.className&&new RegExp("(?:^|\\s)"+t+"(?:\\s|$)").test(e.className)}function r(e,t){e.className?i(e,t)||(e.className+=" "+t):e.className=t}function o(e){return e.split(/\s+/).sort().join(" ")}function a(e){return o(e.className)}function s(e,t){return a(e)==a(t)}function l(e){for(var t=e.parentNode;e.hasChildNodes();)t.insertBefore(e.firstChild,e);t.removeChild(e)}function c(e,t){var n=e.cloneRange();n.selectNodeContents(t);var i=n.intersection(e),r=i?i.toString():"";return n.detach(),""!=r}function u(e){return e.getNodes([3],function(t){return c(e,t)})}function d(e,t){if(e.attributes.length!=t.attributes.length)return!1;for(var n,i,r,o=0,a=e.attributes.length;a>o;++o)if(n=e.attributes[o],r=n.name,"class"!=r){if(i=t.attributes.getNamedItem(r),n.specified!=i.specified)return!1;if(n.specified&&n.nodeValue!==i.nodeValue)return!1}return!0}function h(e,t){for(var n,i=0,r=e.attributes.length;r>i;++i)if(n=e.attributes[i].name,(!t||!T.arrayContains(t,n))&&e.attributes[i].specified&&"class"!=n)return!0;return!1}function f(e,t){for(var n in t)if(t.hasOwnProperty(n)&&e[n]!==t[n])return!1;return!0}function p(e){var t;return e&&1==e.nodeType&&((t=e.parentNode)&&9==t.nodeType&&"on"==t.designMode||R(e)&&!R(e.parentNode))}function g(e){return(R(e)||1!=e.nodeType&&R(e.parentNode))&&!p(e)}function m(e){return e&&1==e.nodeType&&!$.test(E(e,"display"))}function v(e){if(0==e.data.length)return!0;if(A.test(e.data))return!1;var t=E(e.parentNode,"whiteSpace");switch(t){case"pre":case"pre-wrap":case"-moz-pre-wrap":return!1;case"pre-line":if(/[\r\n]/.test(e.data))return!1}return m(e.previousSibling)||m(e.nextSibling)}function y(e,t){return T.isCharacterDataNode(e)?0==t?!!e.previousSibling:t==e.length?!!e.nextSibling:!0:t>0&&t<e.childNodes.length}function b(e,n,i,r){var o,a=0==i;if(T.isAncestorOf(n,e))return e;if(T.isCharacterDataNode(n))if(0==i)i=T.getNodeIndex(n),n=n.parentNode;else{if(i!=n.length)throw t.createError("splitNodeAt should not be called with offset in the middle of a data node ("+i+" in "+n.data);i=T.getNodeIndex(n)+1,n=n.parentNode}if(y(n,i)){if(!o){o=n.cloneNode(!1),o.id&&o.removeAttribute("id");for(var s;s=n.childNodes[i];)o.appendChild(s);T.insertAfter(o,n)}return n==e?o:b(e,o.parentNode,T.getNodeIndex(o),r)}if(e!=n){o=n.parentNode;var l=T.getNodeIndex(n);return a||l++,b(e,o,l,r)}return e}function w(e,t){return e.tagName==t.tagName&&s(e,t)&&d(e,t)}function x(e){var t=e?"nextSibling":"previousSibling";return function(n,i){var r=n.parentNode,o=n[t];if(o){if(o&&3==o.nodeType)return o}else if(i&&(o=r[t],o&&1==o.nodeType&&w(r,o)))return o[e?"firstChild":"lastChild"];return null}}function C(e){this.isElementMerge=1==e.nodeType,this.firstTextNode=this.isElementMerge?e.lastChild:e,this.textNodes=[this.firstTextNode]}function k(e,t,i){this.cssClass=e;var r,a,s,l,c=null;if("object"==typeof t&&null!==t){for(i=t.tagNames,c=t.elementProperties,a=0;l=M[a++];)t.hasOwnProperty(l)&&(this[l]=t[l]);r=t.normalize}else r=t;this.normalize="undefined"==typeof r?!0:r,this.attrExceptions=[];var u=document.createElement(this.elementTagName);this.elementProperties={};for(var d in c)c.hasOwnProperty(d)&&(B.hasOwnProperty(d)&&(d=B[d]),u[d]=c[d],this.elementProperties[d]=u[d],this.attrExceptions.push(d));this.elementSortedClassName=this.elementProperties.hasOwnProperty("className")?o(this.elementProperties.className+" "+e):e,this.applyToAnyTagName=!1;var h=typeof i;if("string"==h)"*"==i?this.applyToAnyTagName=!0:this.tagNames=n(i.toLowerCase()).split(/\s*,\s*/);else if("object"==h&&"number"==typeof i.length)for(this.tagNames=[],a=0,s=i.length;s>a;++a)"*"==i[a]?this.applyToAnyTagName=!0:this.tagNames.push(i[a].toLowerCase());else this.tagNames=[this.elementTagName]}function _(e,t,n){return new k(e,t,n)}e.requireModules(["WrappedSelection","WrappedRange"]);var E,T=e.dom,N="span",S=function(){function e(e,t,n){return t&&n?" ":""}return function(t,n){t.className&&(t.className=t.className.replace(new RegExp("(?:^|\\s)"+n+"(?:\\s|$)"),e))}}();"undefined"!=typeof window.getComputedStyle?E=function(e,t){return T.getWindow(e).getComputedStyle(e,null)[t]}:"undefined"!=typeof document.documentElement.currentStyle?E=function(e,t){return e.currentStyle[t]}:t.fail("No means of obtaining computed style properties found");var R;!function(){var e=document.createElement("div");R="boolean"==typeof e.isContentEditable?function(e){return e&&1==e.nodeType&&e.isContentEditable}:function(e){return e&&1==e.nodeType&&"false"!=e.contentEditable?"true"==e.contentEditable||R(e.parentNode):!1}}();var $=/^inline(-block|-table)?$/i,A=/[^\r\n\t\f \u200B]/,O=x(!1),D=x(!0);C.prototype={doMerge:function(){for(var e,t,n,i=[],r=0,o=this.textNodes.length;o>r;++r)e=this.textNodes[r],t=e.parentNode,i[r]=e.data,r&&(t.removeChild(e),t.hasChildNodes()||t.parentNode.removeChild(t));return this.firstTextNode.data=n=i.join(""),n},getLength:function(){for(var e=this.textNodes.length,t=0;e--;)t+=this.textNodes[e].length;return t},toString:function(){for(var e=[],t=0,n=this.textNodes.length;n>t;++t)e[t]="'"+this.textNodes[t].data+"'";return"[Merge("+e.join(",")+")]"}};var M=["elementTagName","ignoreWhiteSpace","applyToEditableOnly"],B={"class":"className"};k.prototype={elementTagName:N,elementProperties:{},ignoreWhiteSpace:!0,applyToEditableOnly:!1,hasClass:function(e){return 1==e.nodeType&&T.arrayContains(this.tagNames,e.tagName.toLowerCase())&&i(e,this.cssClass)},getSelfOrAncestorWithClass:function(e){for(;e;){if(this.hasClass(e,this.cssClass))return e;e=e.parentNode}return null},isModifiable:function(e){return!this.applyToEditableOnly||g(e)},isIgnorableWhiteSpaceNode:function(e){return this.ignoreWhiteSpace&&e&&3==e.nodeType&&v(e)},postApply:function(e,t,n){for(var i,r,o,a=e[0],s=e[e.length-1],l=[],c=a,u=s,d=0,h=s.length,f=0,p=e.length;p>f;++f)r=e[f],o=O(r,!n),o?(i||(i=new C(o),l.push(i)),i.textNodes.push(r),r===a&&(c=i.firstTextNode,d=c.length),r===s&&(u=i.firstTextNode,h=i.getLength())):i=null;var g=D(s,!n);if(g&&(i||(i=new C(s),l.push(i)),i.textNodes.push(g)),l.length){for(f=0,p=l.length;p>f;++f)l[f].doMerge();t.setStart(c,d),t.setEnd(u,h)}},createContainer:function(t){var n=t.createElement(this.elementTagName);return e.util.extend(n,this.elementProperties),r(n,this.cssClass),n},applyToTextNode:function(e){var t=e.parentNode;if(1==t.childNodes.length&&T.arrayContains(this.tagNames,t.tagName.toLowerCase()))r(t,this.cssClass);else{var n=this.createContainer(T.getDocument(e));e.parentNode.insertBefore(n,e),n.appendChild(e)}},isRemovable:function(e){return e.tagName.toLowerCase()==this.elementTagName&&a(e)==this.elementSortedClassName&&f(e,this.elementProperties)&&!h(e,this.attrExceptions)&&this.isModifiable(e)},undoToTextNode:function(e,t,n){if(!t.containsNode(n)){var i=t.cloneRange();i.selectNode(n),i.isPointInRange(t.endContainer,t.endOffset)&&(b(n,t.endContainer,t.endOffset,[t]),t.setEndAfter(n)),i.isPointInRange(t.startContainer,t.startOffset)&&(n=b(n,t.startContainer,t.startOffset,[t]))}this.isRemovable(n)?l(n):S(n,this.cssClass)},applyToRange:function(e){e.splitBoundaries();
var t=u(e);if(t.length){for(var n,i=0,r=t.length;r>i;++i)n=t[i],this.isIgnorableWhiteSpaceNode(n)||this.getSelfOrAncestorWithClass(n)||!this.isModifiable(n)||this.applyToTextNode(n);e.setStart(t[0],0),n=t[t.length-1],e.setEnd(n,n.length),this.normalize&&this.postApply(t,e,!1)}},applyToSelection:function(t){t=t||window;var n,i=e.getSelection(t),r=i.getAllRanges();i.removeAllRanges();for(var o=r.length;o--;)n=r[o],this.applyToRange(n),i.addRange(n)},undoToRange:function(e){e.splitBoundaries();var t,n,i=u(e),r=i[i.length-1];if(i.length){for(var o=0,a=i.length;a>o;++o)t=i[o],n=this.getSelfOrAncestorWithClass(t),n&&this.isModifiable(t)&&this.undoToTextNode(t,e,n),e.setStart(i[0],0),e.setEnd(r,r.length);this.normalize&&this.postApply(i,e,!0)}},undoToSelection:function(t){t=t||window;var n,i=e.getSelection(t),r=i.getAllRanges();i.removeAllRanges();for(var o=0,a=r.length;a>o;++o)n=r[o],this.undoToRange(n),i.addRange(n)},getTextSelectedByRange:function(e,t){var n=t.cloneRange();n.selectNodeContents(e);var i=n.intersection(t),r=i?i.toString():"";return n.detach(),r},isAppliedToRange:function(e){if(e.collapsed)return!!this.getSelfOrAncestorWithClass(e.commonAncestorContainer);for(var t,n=e.getNodes([3]),i=0;t=n[i++];)if(!this.isIgnorableWhiteSpaceNode(t)&&c(e,t)&&this.isModifiable(t)&&!this.getSelfOrAncestorWithClass(t))return!1;return!0},isAppliedToSelection:function(t){t=t||window;for(var n=e.getSelection(t),i=n.getAllRanges(),r=i.length;r--;)if(!this.isAppliedToRange(i[r]))return!1;return!0},toggleRange:function(e){this.isAppliedToRange(e)?this.undoToRange(e):this.applyToRange(e)},toggleSelection:function(e){this.isAppliedToSelection(e)?this.undoToSelection(e):this.applyToSelection(e)},detach:function(){}},k.util={hasClass:i,addClass:r,removeClass:S,hasSameClasses:s,replaceWithOwnChildren:l,elementsHaveSameNonClassAttributes:d,elementHasNonClassAttributes:h,splitNodeAt:b,isEditableElement:R,isEditingHost:p,isEditable:g},e.CssClassApplier=k,e.createCssClassApplier=_}),e.init(),e}),define("richeditorview",["jquery","underscore","selection","backbone","marionette","orderedcollection"],function(e,t,n,i,r,o){var a=(r.CompositeView.prototype,{13:"enter",32:"spacebar",9:"tab",8:"backspace",46:"delete",37:"left",38:"up",39:"right",40:"down",91:"cmd",16:"shift",17:"ctrl"}),s=i.Model.extend({defaults:{start:0,end:0,content:""}}),l=o.extend({model:s,comparator:"order"}),c=r.ItemView.extend({className:"bullet",template:function(){return""}}),u=r.CompositeView.extend({domEvents:{"keydown @ui.$edit":"keydown","keyup @ui.$edit":"keyup","keypress @ui.$edit":"keypress","paste @ui.$edit":"paste","copy @ui.$edit":"copy","cut @ui.$edit":"cut","mouseup @ui.$edit":"mouseup"},editRegion:"",childSel:"",richEvents:{},disableEditing:!1,calculateChildren:!1,itemView:c,otherInit:function(){},initialize:function(){t.extend(this.ui,{$edit:this.editRegion}),this.lastCharBounds={left:0,right:0,atBeginning:!0},t.extend(this.events,this.domEvents),this.events=this.normalizeUIKeys(t.result(this,"events")),r.bindEntityEvents(this,this,r.getOption(this,"richEvents")),this.otherInit(),this.calculateChildren&&(this.appendHtml=function(){},this.collection=new l)},constructEvent:function(){var e={},i=n.getRange();e.range=i;var r={},o={},a=this;return i?(e.charBounds=n.getCharBounds(i,this.ui.$edit,this.childSel),r.view=this.matchView(i.startContainer)):r.view=!1,e.models=[],e.modelsBetween=[],r.view&&(r.model=r.view.model,r.bounds=n.getCharBounds(i,r.view.$el),r.atBeginning=n.rangeAtBeginning(i,r.view.$el),r.atEnd=n.rangeAtEnd(i,r.view.$el),r.empty=r.view.isEmpty?r.view.isEmpty():""===r.view.$el.text(),r.nodes=r.view.$el.allNodes(),r.leftNode=t.first(r.nodes),r.rightNode=t.last(r.nodes),o.view=this.matchView(i.endContainer),o.view===r.view?(o=r,e.single=!0,e.models.push(r.model)):(e.single=!1,o.model=o.view.model,e.modelsBetween=this.modelsBetween(r.model,o.model),e.viewsBetween=t.map(e.modelsBetween,function(e){return a.children.findByModel(e)}),e.views=e.viewsBetween.slice(),e.views.unshift(r.view),e.views.push(o.view),e.models=e.modelsBetween.slice(),e.models.unshift(r.model),e.models.push(o.model),o.bounds=n.getCharBounds(i,o.view.$el),o.atBeginning=n.rangeAtBeginning(i,o.view.$el),o.atEnd=n.rangeAtEnd(i,o.view.$el),o.empty=o.view.isEmpty?o.view.isEmpty():""===o.view.$el.text(),r.nodes=r.view.$el.allNodes(),o.leftNode=t.first(o.nodes),o.rightNode=t.last(o.nodes))),e.bounds={startView:r.view,endView:o.view,single:e.single},e.start=r,e.end=o,e},matchView:function(t){return this.children.find(function(n){return e.contains(n.el,t)||n.$el.is(t)})},modelsBetween:function(e,t){var n=[],i=!1;return this.collection.each(function(r){r===t&&(i=!1),i&&n.push(r),r===e&&(i=!0)}),n},updateCharBounds:function(){this.lastCharBounds=n.getCharBounds(n.getRange(),this.$el,this.childSel)},restoreCursor:function(){var e=n.charBoundsToRange(this.lastCharBounds,this.$el);n.restoreRange(e)},triggerRich:function(e,t){var n=t.editEvt.single?"single:":"multi:";this.trigger(n+e,t),this.trigger("all:"+e,t)},triggerSelection:function(e){this.trigger("selection:change",e.editEvt,e)},keydown:function(e){var t=e.which,n=a[t]||"generic";e.editEvt=this.constructEvent(),this.triggerRich("keydown:"+n,e),this.triggerRich("keydown",e),this.updateCharBounds()},keyup:function(e){var t=e.which,n=a[t]||"generic";e.editEvt=this.constructEvent(),this.triggerRich("keyup:"+n,e),this.triggerRich("keyup",e,!0),this.triggerSelection(e)},keypress:function(e){e.editEvt=this.constructEvent(),this.triggerRich("keypress",e)},paste:function(e){e.editEvt=this.constructEvent(),this.triggerRich("paste",e)},copy:function(e){e.editEvt=this.constructEvent(),this.triggerRich("copy",e)},cut:function(e){e.editEvt=this.constructEvent(),this.triggerRich("cut",e)},mousedown:function(e){e.editEvt=this.constructEvent(),richeditorview.updateCharBounds(),this.triggerRich("mousedown",e)},mouseup:function(e){e.editEvt=this.constructEvent(),this.triggerRich("mouseup",e,!0);var n=this;t.delay(function(){e.editEvt=n.constructEvent(),n.triggerSelection(e)},1)},onRender:function(){this.calculateChildren&&this.parseChildren()},parseChildren:function(){var i=this,r=this.collection;r.reset();var o,a,l,c,u=this.ui.$edit.find(this.childSel);u=u.not(u.find("*")),t.each(u,function(t){c=e(t),l=new s({content:c.html()}),r.add(l),c.addClass("bullet-inner");var u=i.children.findByModel(l);c.replaceWith(u.el).appendTo(u.$el.find(".bullet-outer")),o=n.rangeAll(c),a=n.getCharBounds(o,i.$el,i.childSel),l.set({start:a.left,end:a.right}),i.trigger("item:elset",u)}),i.trigger("parsechildren:done",this)},withinBounds:function(t,n){t=Number(t),n=Number(n);var i,r,o={models:[],views:[],els:[],$els:e()};return this.children.each(function(a){i=a.model.get("start"),r=a.model.get("end"),i>=t&&n>=r||t>i&&r>t||n>i&&r>n?(o.models.push(a.model),o.views.push(a),o.els.push(a.el),o.$els=e().add(a.el)):0===o.models.length&&i>n&&(o.models.push(a.model),o.views.push(a),o.els.push(a.el),o.$els=e().add(a.el))}),o}});return u}),define("selection",["jquery"],function(e){var t="remove",n=e("<span>Text here</span>");n[0].childNodes[0][t]||(t="removeNode");var i={savedRange:!1,getRange:function(){var e=window.getSelection();return e.getRangeAt&&e.rangeCount?e.getRangeAt(0):void 0},saveRange:function(){this.savedRange=this.getRange()},restoreRange:function(e){if(e){var t=window.getSelection();try{t.removeAllRanges()}catch(n){document.body.createTextRange().select(),document.selection.empty()}t.addRange(e)}},restoreSavedRange:function(){this.restoreRange(this.savedRange)},getSmartRange:function(){return new this.SmartRange(this.getRange())},getPointRange:function(e,t,n,i){var r=document.createRange();return n=n||e,i=i||t,r.setStart(e,t),r.setEnd(e,t),r},newRange:function(e,t,n,i){var r=document.createRange();return n=n||e,i=i||t,r.setStart(e,t),r.setEnd(n,i),r},setCursor:function(e,t){var n=this.newRange(e,t);this.restoreRange(n)},setRange:function(e,t,n,i){var r=this.newRange(e,t,n,i);return this.restoreRange(r),r},getCharBounds:function(t,n,i){var r,o=n.allNodes(),a=0,s=0,l=0,c=!1;if(e.each(o,function(){(this===t.startContainer||e.contains(t.startContainer,this))&&(a=l+t.startOffset),(this===t.endContainer||e.contains(t.endContainer,this))&&(s=l+t.endOffset,r=this),l+=this.data.length}),i&&r&&t.collapsed){var u=n.find(i).has(r);c=this.rangeAtBeginning(t,u)}return{left:a,right:s,total:l,atBeginning:c}},charBoundsToRange:function(t,n){var i=n.allNodes(),r=n[0],o=0,a=!1,s=n[0],l=0,c=!1,u=0,d=!1,h=t.atBeginning||!1,f=t.left,p=t.right;return h&&f===p&&(f++,p++),e.each(i,function(){this.data.length+u>=f&&!a&&(r=this,o=f-u,a=!0),this.data.length+u>=p&&!c&&(s=this,l=p-u,c=!0),u+=this.data.length,d=this}),t.left>u&&d&&(r=d,o=u),t.right>u&&d&&(s=d,l=u),h&&(o=0,l=0),this.newRange(r,o,s,l)},clear:function(){var e=window.getSelection();try{e.removeAllRanges()}catch(t){document.body.createTextRange().select(),document.selection.empty()}},split:function(t,n,i){var r=n.clone(),o=n;i&&(n=n.clone());var a=n.allNodes(),s=o.allNodes(),l=r.allNodes(),c=t.startOffset,u=this,d=-1;return e.each(s,function(e,n){n===t.startContainer&&(d=e)}),d>=0&&(a[d].data=a[d].data.substr(0,c),l[d].data=l[d].data.substr(c),e.each(a,function(e,t){e>d&&u.removeNode(t)}),e.each(l,function(e,t){d>e&&u.removeNode(t)}),this.setCursor(a[d],c)),{$left:n,$right:r}},splitEnd:function(e,t,n){return this.split({startContainer:e.endContainer,startOffset:e.endOffset},t,n)},rangeAll:function(e){var t=0,n=e[0],i=0,r=e[0],o=e.allNodes();return o.length>0&&(n=o[0],r=o[o.length-1],i=r.data.length),this.newRange(n,t,r,i)},removeNode:function(e){e[t]()},rangeAtEnd:function(e,t){var n=t.allNodes(),i=n[n.length-1];if(!i)return!0;if(""===i.data&&(i=n[n.length-2]),!i)return!0;if(e.endContainer===i&&e.endOffset===i.data.length)return!0;var r=document.createRange();r.selectNodeContents(i);var o=e.compareBoundaryPoints(e.END_TO_END,r);return 0===o||1===o?!0:!1},rangeAtBeginning:function(e,t){var n=t.allNodes(),i=n[0];if(!i)return!0;if(""===i.data&&(i=n[1]),!i)return!0;if(e.startContainer===i&&0===e.startOffset)return!0;var r=document.createRange();r.selectNodeContents(i);var o=e.compareBoundaryPoints(e.START_TO_START,r);return 0===o||-1===o?!0:!1}},r=function(e){this.range=e,this.container=e.commonAncestorContainer,3===this.container.nodeType&&(this.container=this.container.parentElement)},o=r.prototype;return o.restore=function(){i.restoreRange(this.range)},o.getText=function(){},o.getElements=function(){this.range.startContainer.parentElement},i.SmartRange=r,e.fn.allNodes=function(){if(this.is(".node-exclude"))return[];var t=[];this[0]&&(t=this[0].childNodes);var n=[];return e.each(t,function(){3===this.nodeType?n.push(this):n=n.concat(e(this).allNodes())}),n},i}),define("tomarkdown",[],function(){for(var e,t,n=new RegExp("href\\s*=\\s*[\"']?([^\"']*)[\"']?","i"),i=/\*/g,r=/_/g,o=[{patterns:"a",replacement:function(e,t,i,r){var o=i.match(n);return o?"["+r+"]("+o[1]+")":e}},{patterns:"b|strong",replacement:function(e,t,n,i){return i?"**"+i+"**":""}},{patterns:"i|em",replacement:function(e,t,n,i){return i?"_"+i+"_":""}}],a=0,s=o.length;s>a;a++)e=o[a],t="<",t+="("+e.patterns+")",t+="\\b([^>]*)>([\\s\\S]*?)<\\/",t+="("+e.patterns+")",t+=">",e.re=new RegExp(t,"g");var l=function(e){var t;e=e.replace(i,"\\*"),e=e.replace(r,"\\_");for(var n=0,a=o.length;a>n;n++)t=o[n],e=e.replace(t.re,t.replacement);return e=e.replace("** **"," "),e=e.replace("_ _"," ")};return l}),function(){}.call(this),function(){}.call(this);